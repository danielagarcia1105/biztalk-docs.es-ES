---
title: Diseño del marco de administración de excepciones de ESB | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: cfc2688c-c01c-4244-9e35-3d482135d8b7
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f25bec37d7ee6ec02db5db28e32ce8ed5b62f724
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36996581"
---
# <a name="design-of-the-esb-exception-management-framework"></a><span data-ttu-id="0e3b0-102">Diseño del marco de administración de excepciones de ESB</span><span class="sxs-lookup"><span data-stu-id="0e3b0-102">Design of the ESB Exception Management Framework</span></span>
<span data-ttu-id="0e3b0-103">Patrones coherentes y reutilizables para administrar las excepciones son una consideración principal de cualquier proyecto de desarrollo; ayudan a maximizar la facilidad de mantenimiento y que sea más fácil admitir la aplicación después de la implementación.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-103">Consistent and re-usable patterns for managing exceptions are a core consideration of any development project; they help to maximize maintainability and make it easier to support the application after deployment.</span></span>  
  
 <span data-ttu-id="0e3b0-104">Una aplicación típica de BizTalk podría usar la características de mensajería de BizTalk, si lo desea iniciar una orquestación de procesamiento, llamar al motor de reglas de negocios, interactuar con varios sistemas (empresariales ERP) de planeamiento de recursos empresariales o con línea de negocio (LOB) y devolver un respuesta a un sistema independiente de otros fabricantes.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-104">A typical BizTalk application might use the BizTalk messaging features, optionally start processing an orchestration, call the Business Rule Engine, interact with several line-of-business (LOB) or enterprise resource planning (ERP) systems, and return a response to a separate third-party system.</span></span> <span data-ttu-id="0e3b0-105">Además, la ubicación en tiempo de ejecución de estos componentes, incluidos los subsistemas de BizTalk, puede residir en uno o más servidores distribuidos en todo el entorno actual.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-105">In addition, the run-time location of these components, including the BizTalk subsystems, may reside on one or more servers distributed throughout the current environment.</span></span> <span data-ttu-id="0e3b0-106">Esto es un escenario típico y requiere que el sistema para admitir detectar y notificar las excepciones que pueden producirse en cualquiera de los ESB o BizTalk desacoplan subsistemas o en los distintos sistemas LOB de terceros, cada uno de los cuales tiene sus propias restricciones de control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-106">This is a typical scenario and requires the system to support catching and reporting exceptions that may occur in any of the ESB or BizTalk decoupled subsystems or in the various third-party LOB systems, each of which has its own exception handling constraints.</span></span> <span data-ttu-id="0e3b0-107">Por ejemplo, el gran sistema puede rechazar un pedido enviado desde un sitio Web durante un ciclo de procesamiento normal; el sitio Web debe compensar este error y notificar al usuario.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-107">For example, the mainframe may reject an order sent from a Web site during a normal processing cycle; the Web site must compensate for this error and notify the user.</span></span>  
  
 <span data-ttu-id="0e3b0-108">Debido a su entorno y la complejidad de las aplicaciones de ESB, desarrollo de una solución coherente para la administración de excepciones de la aplicación debe representan los objetivos de diseño comunes siguientes:</span><span class="sxs-lookup"><span data-stu-id="0e3b0-108">Because of the complexity of ESB applications and their environment, development of a consistent solution for application exception management should embody the following common design goals:</span></span>  
  
- <span data-ttu-id="0e3b0-109">Proporcionar un enfoque estandarizado para detectar y controlar las excepciones que se producen en el entorno de BizTalk Server (es decir, en los subsistemas de mensajería y orquestación).</span><span class="sxs-lookup"><span data-stu-id="0e3b0-109">Provide a standardized approach for detecting and handling exceptions that occur in the BizTalk Server environment (that is, in the messaging and orchestration subsystems).</span></span>  
  
- <span data-ttu-id="0e3b0-110">Proporcionar patrones comunes que permiten a los procesos automatizados reaccionar ante y administrar las excepciones de aplicación.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-110">Provide common patterns that allow automated processes to react to and manage application exceptions.</span></span>  
  
- <span data-ttu-id="0e3b0-111">Proporcionan un modelo de administración de excepciones de acoplamiento flexible que facilita la reutilización.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-111">Provide a loosely coupled exception management pattern that facilitates reuse.</span></span>  
  
- <span data-ttu-id="0e3b0-112">Proporcionan un mecanismo de notificación comunes para las excepciones de aplicación y sus Estados de mensajes disponibles que pueden aplicar a cualquier subsistema de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-112">Provide a common reporting mechanism for application exceptions and their available message states that can apply to any BizTalk subsystem.</span></span>  
  
  <span data-ttu-id="0e3b0-113">Para entender por qué la [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] proporciona un mecanismo de error personalizado, es decir, el marco de administración de excepciones, y cómo funciona, es necesario comprender las características de administración de excepciones disponibles en BizTalk Server y por qué estas características no están totalmente capaz de satisfacer los objetivos de diseño anterior.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-113">To understand why the [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] provides a custom error mechanism, namely the Exception Management Framework, and how it works, it is necessary to understand the exception management features available in BizTalk Server and why these features are not fully capable of meeting the preceding design goals.</span></span>  
  
## <a name="biztalk-server-exception-reporting"></a><span data-ttu-id="0e3b0-114">Informes de excepción de servidor BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="0e3b0-114">BizTalk Server Exception Reporting</span></span>  
 <span data-ttu-id="0e3b0-115">BizTalk Server es compatible con el siguiente control de excepciones y mecanismos de informes:</span><span class="sxs-lookup"><span data-stu-id="0e3b0-115">BizTalk Server supports the following exception handling and reporting mechanisms:</span></span>  
  
- <span data-ttu-id="0e3b0-116">Enrutamiento de mensajes con errores</span><span class="sxs-lookup"><span data-stu-id="0e3b0-116">Failed Message Routing</span></span>  
  
- <span data-ttu-id="0e3b0-117">Consola de administración de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="0e3b0-117">BizTalk Server Administration Console</span></span>  
  
- <span data-ttu-id="0e3b0-118">Registro de eventos de Microsoft</span><span class="sxs-lookup"><span data-stu-id="0e3b0-118">Microsoft Event Log</span></span>  
  
- <span data-ttu-id="0e3b0-119">Opciones de desarrollo personalizado</span><span class="sxs-lookup"><span data-stu-id="0e3b0-119">Custom development options</span></span>  
  
  <span data-ttu-id="0e3b0-120">De forma predeterminada, las capacidades de BizTalk Server para controlar las excepciones dependen mucho intervención del operador.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-120">By default, BizTalk Server's capabilities for handling exceptions rely a great deal on operator intervention.</span></span> <span data-ttu-id="0e3b0-121">Por ejemplo, considere la situación donde un usuario envía un mensaje a BizTalk Server que se produce una excepción durante la fase de validación.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-121">For example, consider the situation where a user submits a message to BizTalk Server that causes an exception during the validation stage.</span></span> <span data-ttu-id="0e3b0-122">De forma predeterminada, el mensaje se publica en la base de datos de cuadro de mensaje, donde se enruta a una cola de suspensión.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-122">By default, the message is published to the Message Box database, where it is routed to a suspended queue.</span></span> <span data-ttu-id="0e3b0-123">Esto significa que un operador debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0e3b0-123">This means that an operator must do the following:</span></span>  
  
- <span data-ttu-id="0e3b0-124">Detectar independientemente de que se ha producido una excepción.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-124">Independently detect that an exception occurred.</span></span>  
  
- <span data-ttu-id="0e3b0-125">Guardar manualmente el mensaje con errores en el disco mediante la consola de administración de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-125">Manually save the failed message to disk using the BizTalk Server Administration Console.</span></span>  
  
- <span data-ttu-id="0e3b0-126">Editar manualmente y corregir el mensaje y volver a enviarlo al sistema.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-126">Manually edit and correct the message and re-submit it to the system.</span></span> <span data-ttu-id="0e3b0-127">En algunos casos, este proceso tiene la posibilidad de perder la información de contexto importante.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-127">In some instances, this process has the potential for losing important context information.</span></span>  
  
  <span data-ttu-id="0e3b0-128">Para resolver estos problemas, BizTalk Server proporciona el mecanismo de enrutamiento de mensajes de error.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-128">To resolve these issues, BizTalk Server provides the Failed Message Routing mechanism.</span></span> <span data-ttu-id="0e3b0-129">Los desarrolladores y administradores pueden utilizarlo para crear los procesos de orquestación o mensajería puertos de envío configurados para suscribirse a las excepciones que se producen en el subsistema de mensajería.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-129">Developers and administrators can use this to create orchestration processes or messaging send ports configured to subscribe to any exceptions that occur in the messaging subsystem.</span></span> <span data-ttu-id="0e3b0-130">Esto proporciona una detección de errores automatizada y el mecanismo de enrutamiento que conserva el estado del mensaje original y se resuelve el problema de detección de excepciones.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-130">This provides an automated error-detection and routing mechanism that preserves the original message state and solves the problem of detecting exceptions.</span></span>  
  
  <span data-ttu-id="0e3b0-131">Porque no se proporciona el enrutamiento automático de mensajes con errores para los procesos de orquestación, el desarrollador debe tener en cuenta si hay errores mediante la adición de bloques de controlador de excepción para formas de ámbito de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-131">Because automatic failed message routing is not provided for orchestration processes, the developer must account for errors by adding exception handler blocks to orchestration scope shapes.</span></span> <span data-ttu-id="0e3b0-132">Con esta solución, cada orquestación puede tener su propio control de excepciones, pero no hay ningún mecanismo para volver a usar la funcionalidad de control a través de varias orquestaciones de excepciones.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-132">With this solution, each orchestration can have its own exception handling, but there is no mechanism for reusing exception handling functionality across multiple orchestrations.</span></span>  
  
  <span data-ttu-id="0e3b0-133">Esto significa que ahora hay dos formas muy distintas en el que las excepciones de mensajería se procesan y administran en un sistema de BizTalk Server y en qué orquestación se procesan las excepciones de otra forma.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-133">This means that there are now two very different ways in which messaging exceptions are processed and managed in a BizTalk Server system, and a third way in which orchestration exceptions are processed.</span></span> <span data-ttu-id="0e3b0-134">Por lo tanto, los desarrolladores deben personalizar el mecanismo para que se adapte a sus propios requisitos si desean implementar un sistema que cumpla los requisitos descritos anteriormente en esta sección de control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-134">Therefore, developers must customize the exception handling mechanism to suit their own requirements if they want to implement a system that matches the requirements described earlier in this section.</span></span>  
  
## <a name="biztalk-server-administration-console"></a><span data-ttu-id="0e3b0-135">Consola de administración de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="0e3b0-135">BizTalk Server Administration Console</span></span>  
 <span data-ttu-id="0e3b0-136">La consola de administración de BizTalk Server proporciona un conjunto de páginas de información general del grupo, contemplada como el concentrador de grupo de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-136">The BizTalk Server Administration Console provides a set of Group Overview pages, referred to as the BizTalk Group Hub.</span></span> <span data-ttu-id="0e3b0-137">Con estas páginas, los administradores pueden consultar los mensajes suspendidos y excepciones agrupadas por aplicación, nombre de servicio, código de error o URI, como se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-137">Using these pages, administrators can query for suspended messages and exceptions grouped by application, service name, error code, or URI, as shown in Figure 1.</span></span>  
  
 <span data-ttu-id="0e3b0-138">![Consola de administración](../esb-toolkit/media/ch4-adminconsole.gif "Ch4-AdminConsole")</span><span class="sxs-lookup"><span data-stu-id="0e3b0-138">![Admin Console](../esb-toolkit/media/ch4-adminconsole.gif "Ch4-AdminConsole")</span></span>  
  
 <span data-ttu-id="0e3b0-139">**Figura 1**</span><span class="sxs-lookup"><span data-stu-id="0e3b0-139">**Figure 1**</span></span>  
  
 <span data-ttu-id="0e3b0-140">**Las páginas de información general de grupo de BizTalk Server Administration Console**</span><span class="sxs-lookup"><span data-stu-id="0e3b0-140">**The BizTalk Server Administration Console Group Overview pages**</span></span>  
  
 <span data-ttu-id="0e3b0-141">Aunque la característica de información general de grupo proporciona una interfaz de usuario común para ver las excepciones, las vistas se limitan a las instancias de servicio "live".</span><span class="sxs-lookup"><span data-stu-id="0e3b0-141">Although the Group Overview feature provides a common user interface to view exceptions, the views are limited to "live" service instances.</span></span> <span data-ttu-id="0e3b0-142">Examinar el estado puede ser una tarea compleja porque los administradores deben explorar en profundidad del árbol para cada elemento.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-142">Examining the state can be a cumbersome task because administrators must drill down through the tree to each item.</span></span> <span data-ttu-id="0e3b0-143">Además, otros factores limitan las capacidades de la consola de administración de BizTalk Server como una herramienta de informes de excepción de aplicación:</span><span class="sxs-lookup"><span data-stu-id="0e3b0-143">In addition, several other factors limit the BizTalk Server Administration Console capabilities as an application exception-reporting tool:</span></span>  
  
- <span data-ttu-id="0e3b0-144">No hay ninguna funcionalidad para los datos de inteligencia empresarial de minería de datos.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-144">There is no capability for mining the data for business intelligence.</span></span> <span data-ttu-id="0e3b0-145">Por ejemplo, no se puede consultar para las aplicaciones de peor infractor mensualmente o examinar tendencias trimestrales para las excepciones de aplicación.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-145">For example, you cannot query for the worst offending applications on a monthly basis or examine quarterly trends for application exceptions.</span></span>  
  
- <span data-ttu-id="0e3b0-146">Las empresas pueden requerir las alertas que se genera cuando se producen ciertas excepciones de aplicación o al alcanzar umbrales específicos, pero hay una funcionalidad para suscribirse a estos tipos de eventos de excepción.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-146">The business may require alerts to be raised when certain application exceptions occur or when reaching specific thresholds, but there is no facility to subscribe to these types of exception events.</span></span>  
  
- <span data-ttu-id="0e3b0-147">Microsoft Management Console (MMC) que usa la consola de administración como la interfaz de usuario mecanismo (interfaz de usuario) no es una interfaz ideal, y no siempre es conveniente tener acceso en entornos de producción.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-147">The Microsoft Management Console (MMC) that the Administration Console uses as its user interface (UI) mechanism is not an ideal interface, and it is not always convenient to access in production environments.</span></span> <span data-ttu-id="0e3b0-148">Como mínimo, requiere que los usuarios sean miembros del rol operadores de BizTalk; y, en entornos de producción, acceso a la consola MMC normalmente solo es posible a través de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-148">At minimum, it requires users to be members of the BizTalk Operators role; and, in production environments, access to the MMC is usually only possible through Terminal Server.</span></span>  
  
- <span data-ttu-id="0e3b0-149">La consola muestra solo (instancias de servicio suspendidas) de las excepciones no controladas.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-149">The console displays only unhandled exceptions (suspended service instances).</span></span> <span data-ttu-id="0e3b0-150">Si el desarrollador controla la excepción en la orquestación, lo que permite la orquestación puede finalizar naturalmente, la información de excepción nunca aparecerá en la consola de administración.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-150">If the developer handles the exception in the orchestration, allowing the orchestration to complete normally, the exception information will never appear in the Administration Console.</span></span>  
  
  <span data-ttu-id="0e3b0-151">El [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] trata estas limitaciones mediante el mecanismo de excepción enrutamiento de orquestación de error de ESB.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-151">The [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] addresses these limitations through the ESB Failed Orchestration Exception Routing mechanism.</span></span> <span data-ttu-id="0e3b0-152">Esto parece el mecanismo de enrutamiento de mensajes de error de servidor BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-152">This closely resembles the Failed Message Routing mechanism of BizTalk Server.</span></span> <span data-ttu-id="0e3b0-153">Además, el [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] incluye un componente de canalización en un puerto de envío se suscribe a mensajes generados desde el mecanismo de excepción enrutamiento de orquestación de error de ESB y el mecanismo de enrutamiento de mensajes de error y normaliza a ellos.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-153">In addition, the [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] includes a pipeline component in a send port that subscribes to messages generated from both the ESB Failed Orchestration Exception Routing mechanism and the Failed Message Routing mechanism and normalizes them.</span></span>  
  
  <span data-ttu-id="0e3b0-154">El marco de administración de excepciones de ESB aprovecha de otras características de BizTalk Server, como el modelo de suscripción y basado en eventos actividad de supervisión económica (BAM).</span><span class="sxs-lookup"><span data-stu-id="0e3b0-154">The ESB Exception Management Framework takes advantage of other features in BizTalk Server, such as the subscription model, and event-based Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="0e3b0-155">Esto significa que el marco de administración de excepciones de ESB puede realizar un seguimiento de los puntos de datos de excepción con BAM y, a continuación, publicarlos en el Portal de BAM de BizTalk para la supervisión.</span><span class="sxs-lookup"><span data-stu-id="0e3b0-155">This means that the ESB Exception Management Framework can track the exception data points with BAM, and then publish them to the BizTalk BAM Portal for monitoring.</span></span>