---
title: Optimizar el rendimiento de adaptador WCF de BizTalk Server | Documentos de Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 2900c845-15be-4466-8fa0-b51b2486842f
caps.latest.revision: "12"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5d5ce620e7d9da984081b0f0874985bfe762eeae
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="optimizing-biztalk-server-wcf-adapter-performance"></a>Optimizar el rendimiento de adaptador WCF de BizTalk Server
En este tema se proporciona recomendaciones para seleccionar el adaptador WCF adecuada o el tipo de enlace y la orientación para aplicar distintas opciones de configuración de adaptador WCF.  
  
## <a name="considerations-when-choosing-which-wcf-adapter-to-use-or-which-wcf-customwcf-customisolated-binding-type-to-use"></a>Consideraciones al elegir qué adaptador WCF a usar o qué tipo de enlace de WCF-Custom o WCF-CustomIsolated debe utilizar  
  
-   No utilice seguridad de nivel de mensaje si no es estrictamente necesario porque aumenta el tamaño de los mensajes. A su vez, esto puede reducir el rendimiento general de la solución.  
  
-   Al elegir qué adaptador WCF a usar o qué WCF-Custom o WCF-CustomIsolated **tipo de enlace** para utilizar, considere cuidadosamente los requisitos de la aplicación, como compatibilidad, rendimiento, plataforma de hospedaje, seguridad y admite transportes. Las instrucciones que se indican a continuación se aplican a WCF en general y no son específicas de BizTalk Server:  
  
    -   **BasicHttpBinding** debe usarse si el servicio WCF necesita compatibilidad con clientes antiguos como servicios WebSphere Web o las aplicaciones de .NET 1.1 que esperan un servicio Web de ASMX. Puesto que BasicHttpBinding implementan ninguna seguridad de forma predeterminada, si necesita seguridad de mensajes o el transporte, debe configurarlo explícitamente en este enlace. Utilizar BasicHttpBinding para exponer extremos que pueden comunicarse con servicios Web basados en ASMX y clientes y otros servicios que cumplan con WS-I Basic Profile 1.1. Cuando configure la seguridad de transporte, BasicHttpBinding el valor predeterminado es no usar credenciales simplemente como un servicio Web de ASMX clásico. BasicHttpBinding le permite hospedar el servicio WCF en IIS 7.5 o IIS 7.0.  
  
    -   **WsHttpBinding** debe usarse si el servicio WCF se llamará a los clientes de WCF a través de Internet. WsHttpBinding es una buena opción para escenarios de Internet en el que no es necesario que admitir a los clientes heredados que esperan un servicio Web de ASMX y WsHttpBinding le permite hospedar el servicio WCF en IIS 7.5 o IIS 7.0. Si necesita compatibilidad con clientes heredados, considere la posibilidad de usar BasicHttpBinding en su lugar.   
        WsHttpBinding debe usarse cuando necesite exponer a ubicaciones de recepción de WCF o adoptar los puertos de envío que son compatibles con WS-* protocolos, como WS-Security o WS-AtomicTransactions.  
  
    -   **NetTcpBinding** es una excelente opción si tiene que admitir clientes dentro de la intranet. NetTcpBinding es una buena opción para escenarios de intranet si el rendimiento de transporte es importante para usted, y si es aceptable para hospedar el servicio en un servicio de Windows en lugar de en IIS. Utilice este enlace cuando desea proporcionar un entorno seguro y confiable de enlace para. NET para .NET la comunicación entre equipos. Tenga en cuenta que se debe hospedar NetTcpBinding en un servicio de Windows o en IIS 7.5 o 7.0.  
  
    -   **NetNamedPipeBinding** debe usarse si tiene que admitir clientes WCF en el mismo equipo que el servicio. Este enlace proporciona un entorno de enlace seguro y confiable para la comunicación entre procesos, el mismo equipo. Utilizar este enlace si desea hacer uso de la canalización con nombre protocolo. Tenga en cuenta que se debe hospedar el NetNamedPipeBinding en un servicio de Windows o en IIS 7.5 o 7.0.  
  
    -   **NetMsmqBinding** debe usarse si necesita admitir Queue desconectado. Queue Server se proporciona mediante el uso de Message Queue Server (también conocido como MSMQ) como transporte, lo que permite la compatibilidad con operaciones desconectadas, aislamiento de errores y equilibrio de la carga. Puede usar NetMsmqBinding cuando el cliente y el servicio no tienen que estar conectados al mismo tiempo. También puede administrar cualquier número de mensajes entrantes mediante el uso de equilibrio de carga. Message Queue Server es compatible con aislamiento de errores, donde los mensajes pueden producir un error sin que ello afecte el procesamiento de otros mensajes. Tenga en cuenta que se debe hospedar NetMsmqBinding en un servicio de Windows o en IIS 7.5 o 7.0.  
  
    -   **WsDualHttpBinding** debe usarse si necesita admitir un servicio dúplex. Un servicio dúplex es un servicio que usa patrones de mensajes dúplex, lo que proporciona la capacidad de una comunicación de servicio al cliente a través de una devolución de llamada. Tenga en cuenta que se debe hospedar WsDualHttpBinding en un servicio de Windows o en IIS 7.5 o 7.0.  
  
## <a name="wcf-binding-comparison"></a>Comparación de enlace de WCF  
 Enlaces proporcionan un mecanismo para configurar las pilas de canales. Un enlace crea un proceso para compilar una pila de canales con un canal de transporte, un codificador de mensajes y un conjunto de canales de protocolo. Windows Communication Foundation se distribuye con varios enlaces integrados que vienen preconfigurados para tratar los escenarios más comunes de comunicación.  
  
|Nombre de la clase de enlace|Transporte|Codificación de mensajes|Modo de seguridad|Mensajería de confianza|Flujo de transacciones (deshabilitado de forma predeterminada)|  
|------------------------|---------------|----------------------|-------------------|------------------------|----------------------------------------------|  
|BasicHttpBinding|HTTP|Texto|Ninguno|No compatible|No compatible|  
|WSHttpBinding|HTTP|Texto|de mensaje|Deshabilitado|WS-AtomicTransactions|  
|NetTcpBinding|TCP|Binario|Transporte|Deshabilitado|OleTransactions|  
|NetNamedPipesBinding|Canalizaciones con nombre|Binario|Transporte|No compatible|OleTransactions|  
|NetMsmqBinding|MSMQ|Binario|de mensaje|No compatible|No compatible|  
|CustomBinding|Decide|Decide|Decide|Decide|Decide|  
  
 Puede seleccionar un enlace determinado según sus necesidades de comunicación. Por ejemplo:  
  
-   **BasicHttpBinding** está diseñado para la interoperabilidad con servicios Web simples. BasicHttpBinding usa HTTP para el transporte y el texto para la codificación de mensajes.  
  
-   **WSHttpBinding** está diseñado para la interoperabilidad con servicios Web más avanzados que puede aprovechar las ventajas de diferentes WS-* protocolos.  WSHttpBinding también usa HTTP para el transporte y el texto para la codificación de mensajes.  
  
-   **NetTcpBinding** y **NetNamedPipeBinding** están diseñados para eficaz y realizar la comunicación de hormigas con otras aplicaciones de WCF en los equipos o en el mismo equipo respectivamente.  
  
-   Si necesita tener una flexibilidad máxima mediante el uso de uno o varios canales de protocolo personalizado en tiempo de ejecución, puede utilizar el **CustomBinding** que le ofrece la posibilidad de decidir qué elementos de enlace de crear el enlace.  
  
> [!NOTE]  
>  Enlaces tienen características diferentes en cuanto a tiempo de respuesta y el rendimiento. Por lo tanto, el Consejo general para aumentar el rendimiento está usando los NetTcpBindind y NetNamesPipeBinding siempre que sea posible.  
  
## <a name="use-the-tcp-transport-and-binary-message-encoding-to-maximize-wcf-adapter-throughput-and-minimize-wcf-adapter-latency"></a>Usar el mensaje de transporte y binarios TCP codificación para maximizar el rendimiento del adaptador WCF y minimizar la latencia de adaptador WCF  
 Utilice el adaptador de WCF-NetTcp cuando sea posible para maximizar el rendimiento. El adaptador WCF-NetTcp usa el protocolo de transporte de TCP/IP y los mensajes binarios codificación que juntas ofrecen un rendimiento mejorado en comparación con otros WCF-* adaptadores.  
  
 Como alternativa, puede configurar el WCF-Custom (o adaptador de WCF-CustomIsolated para ubicaciones de recepción) con un **customBinding** tipo de enlace. A continuación, agregue el **binaryMessageEncoding** extensión para implementar la codificación binaria de mensajes de enlace y la **tcpTransport** extensión implementar TCP/IP como el protocolo de transporte de mensajes de enlace. Este enfoque es muy flexible, ya que permite seleccionar y configurar solo los elementos de enlace que necesita y para crear canales personalizados para extender el comportamiento predeterminado del motor de mensajería de BizTalk. Si implementa el adaptador de WCF-Custom con la **customBinding** tipo de enlace especifique estos valores para los parámetros de configuración de extensión de enlace maximizar el rendimiento y minimizar la latencia.  
  
 **Valores de configuración de puerto de envío:**  
  
|Configuración|Valor predeterminado|Valor recomendado|  
|-------------|-------------------|-----------------------|  
|**TcpTransportBindingElement.ConnectionPoolSettings.maxOutboundConnectionsPerEndpoint** : Obtiene o establece el número máximo de conexiones salientes para cada extremo almacenado en memoria caché del grupo de conexiones. Esto limita el número de conexiones que se almacena en la caché para cada extremo remoto único. Si este valor se supera por tener conexiones de cliente más activas, puede parecer que el servicio no responde al cliente y este valor se debería ajustar para dar cabida al número máximo de conexiones esperadas que se almacenan en caché para cada extremo remoto único. Para obtener más información acerca de esta propiedad, vea [TcpConnectionPoolSettings.MaxOutboundConnectionsPerEndpoint propiedad](http://go.microsoft.com/fwlink/?LinkId=157737) (http://go.microsoft.com/fwlink/?LinkId=157737) en MSDN.|10|Intente > = 20|  
  
 **Valores de configuración de puerto de recepción:**  
  
|Configuración|Valor predeterminado de .NET Framework 4|Valor recomendado para .NET Framework 4|Valor predeterminado de .NET Framework 3.5|Valor recomendado para .NET Framework 3.5|  
|-------------|----------------------------------------|--------------------------------------------|------------------------------------------|----------------------------------------------|  
|**TcpTransportBindingElement.MaxPendingAccepts** : Obtiene o establece el máximo número de pendientes de aceptación asincrónica las operaciones que están disponibles para procesar conexiones entrantes en el servicio. En escenarios con altos niveles de la apertura de conexiones simultáneas, este valor puede resultar inadecuado y debería ajustar junto con el **MaxPendingConnections** propiedad que se va a administrar niveles más altos de conexiones de cliente simultáneas intentos. No debería ser necesario establecer esta propiedad en un valor mayor que el número de procesadores presentes en el equipo que hospeda el servicio. Para obtener más información acerca de esta propiedad, vea [ConnectionOrientedTransportBindingElement.MaxPendingAccepts propiedad](http://go.microsoft.com/fwlink/?LinkId=157738) (http://go.microsoft.com/fwlink/?LinkId=157738) en MSDN.|1|2 * ProcessorCount|1|Intente > = 20|  
|**TcpTransportBindingElement.MaxPendingConnections** : Obtiene o establece el número máximo de conexiones pendientes de distribución en el servicio. Esto limita el número de conexiones de cliente simultáneas pendientes de distribución. Si este valor es demasiado bajo, pueden que se rechacen intentos de conexión de cliente por el servicio. Si es demasiado alto, puede parecer que el servicio lento o no responde a los clientes durante los períodos de carga elevada. Esta propiedad debe establecerse en un valor que permite que el servicio para ejecutarse con la máxima capacidad y no versiones posteriores. Cuando una capa superior en la pila de llamadas **AcceptDispatch**, esa conexión se quita de la cola de conexiones pendientes de distribución. Para obtener más información acerca de esta propiedad, vea [ConnectionOrientedTransportBindingElement.MaxPendingConnections propiedad](http://go.microsoft.com/fwlink/?LinkId=157735) (http://go.microsoft.com/fwlink/?LinkId=157735) en MSDN.|10|16 * ProcessorCount|10|Intente > = 20|  
|**TcpTransportBindingElement.ListenBacklog** : Obtiene o establece el número máximo de solicitudes de conexión en cola que pueden estar pendientes. **ListenBacklog** es una propiedad de nivel de socket que describe el número de "pendientes de aceptación" solicitudes de poner en cola. Asegúrese de que la cola de socket subyacente no se supera el número máximo de conexiones simultáneas. Para obtener más información acerca de esta propiedad, vea [TcpTransportBindingElement.ListenBacklog propiedad](http://go.microsoft.com/fwlink/?LinkId=157734) (http://go.microsoft.com/fwlink/?LinkId=157734) en MSDN.|10|16 * ProcessorCount|10|Intente > = 20|  
  
 **Agregue el comportamiento del servicio ServiceThrottlingBehavior en una ubicación de recepción de WCF-CustomIsolated o WCF-Custom y use las siguientes opciones:**  
  
> [!NOTE]  
>  Antes de que se puede modificar cualquier elemento de comportamiento de servicio de ServiceThrottlingBehavior, primero debe agregar el **serviceThrottling** extensión de comportamiento a la **comportamientos** pestaña de la  **WCF-Custom\* propiedades de transporte** cuadro de diálogo. Para agregar serviceThrottling a la lista de comportamientos, seleccione la **comportamientos** pestaña de la **WCF-Custom\* propiedades de transporte** cuadro de diálogo, haga clic en **ServiceBehavior**  en **comportamiento**, haga clic en **Agregar extensión**, seleccione **serviceThrottling**y, a continuación, haga clic en **Aceptar**. A continuación, haga clic para seleccionar las propiedades disponibles en **ServiceThrottlingElement** y cambie el valor de las propiedades según sea necesario.  
  
|Configuración|Valor predeterminado de .NET Framework 4|Valor recomendado para .NET Framework 4|Valor predeterminado de .NET Framework 3.5|Valor recomendado para .net Framework 3.5|  
|-------------|----------------------------------------|--------------------------------------------|------------------------------------------|----------------------------------------------|  
|**ServiceThrottlingBehavior.MaxConcurrentCalls** : Obtiene o establece un valor que especifica el número máximo de mensajes que se procesan activamente en un **ServiceHost**. El **MaxConcurrentCalls** propiedad especifica el número máximo de mensajes que se procesan activamente en un **ServiceHost** objeto. Cada canal puede tener un mensaje pendiente que no cuentan para el valor de **MaxConcurrentCalls** hasta que WCF empezar a procesarlo. Para obtener más información acerca de esta propiedad, vea [ServiceThrottlingBehavior.MaxConcurrentCalls](http://go.microsoft.com/fwlink/?LinkId=157838) (http://go.microsoft.com/fwlink/?LinkId=157838) en MSDN. Adaptadores de recepción el valor predeterminado para el BizTalk WCF-Custom y WCF-CustomIsolated **MaxConcurrentCalls** propiedad es **16** por CPU. **Nota:** adaptadores que no sea la exposición de adaptador de WCF-Custom y WCF-CustomIsolated de recepción de WCF de BizTalk Server una **máximo de llamadas simultáneas** propiedad en el **enlace** pestaña de la  **WCF -\* propiedades de transporte** cuadro de diálogo para configurar este comportamiento. El valor predeterminado de la **máximo de llamadas simultáneas** quedará **200**.|16 * ProcessorCount|16 * ProcessorCount|-adaptadores de recepción 16 de BizTalk WCF-Custom y WCF-CustomIsolated.<br />-200 para WCF otro adaptadores de recepción.|-Intentar > = 200 para adaptadores de recepción de la WCF-Custom y WCF-CustomIsolated.<br />-Intentar > 200 para la **máximo de llamadas simultáneas** propiedad en el **enlace** pestaña de la **WCF -\* propiedades de transporte** cuadro de diálogo de WCF de BizTalk Server adaptadores que no sea el adaptador WCF-Custom y WCF-CustomIsolated de recepción.|  
|**ServiceThrottlingBehavior.maxConcurrentInstances** : Obtiene o establece un valor que especifica el número máximo de **InstanceContext** objetos en el servicio que se pueden ejecutar al mismo tiempo. El **MaxConcurrentInstances** propiedad especifica el número máximo de **InstanceContext** objetos en el servicio. Es importante tener en cuenta la relación existente entre la **MaxConcurrentInstances** propiedad y el **InstanceContextMode** propiedad. Si **InstanceContextMode** sea PerSession, el valor resultante es el número total de sesiones. Si **InstanceContextMode** es PerCall, el valor resultante es el número de llamadas simultáneas. Si llega un mensaje cuando el número máximo de **InstanceContext** objetos ya existen, el mensaje se mantiene hasta un **InstanceContext** objeto se cierra. Para obtener más información acerca de esta propiedad, vea [ServiceThrottlingBehavior.MaxConcurrentInstances propiedad](http://go.microsoft.com/fwlink/?LinkId=157897) (http://go.microsoft.com/fwlink/?LinkId=157897) en MSDN. El valor predeterminado para el WCF-Custom y WCF-CustomIsolated propiedad MaxConcurrentInstances del adaptador de recepción es **116** por CPU. **Nota:** ya que WCF reciben ubicaciones se implementan como instancias de la clase de BizTalkServiceInstance contenidos en el ensamblado Microsoft.BizTalk.Adapter.Wcf.Runtime.dll y dado que esta clase está marcada como ServiceBehavior (InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode=ConcurrencyMode.Multiple). todas las solicitudes entrantes se administran mediante el mismo objeto singleton y este parámetro se ignora. Para establecer la propiedad maxConcurrentInstances en cierta WCF-Custom ubicaciones de recepción no tiene ningún efecto, ya que el número de instancias activas es siempre igual a 1.|116 * ProcessorCount|116 * ProcessorCount|26|Intente > = 200|  
|**ServiceThrottlingBehavior.MaxConcurrentSessions** - la **MaxConcurrentSessions** propiedad obtiene o establece el número máximo de sesiones un **ServiceHost** objeto puede aceptar al mismo tiempo . Es importante comprender que las sesiones en este caso no no se limita a solo los canales que admiten las sesiones confiables. Cada objeto de agente de escucha puede tener una sesión de canal que no cuentan para el valor de pendiente **MaxConcurrentSessions** hasta que WCF acepta la sesión de canal y empieza a procesar los mensajes de sesión de canal. Esta propiedad resulta muy útil en situaciones que utilizan sesiones. Cuando esta propiedad se establece en un valor menor que el número de subprocesos del cliente, se pueden obtener en cola las solicitudes de varios clientes en la misma conexión de socket. Se bloquearán las solicitudes del cliente que no se ha creado una sesión con el servicio. Permanecerá bloqueados hasta que el servicio cierre su sesión con los otros clientes, si el número de sesiones abiertas en el servicio ha alcanzado el valor especificado para **MaxConcurrentSessions**. Las solicitudes de cliente que no se sirven a continuación, se agotó y el servicio cierra la sesión. Para evitar esta situación, considere la posibilidad de subprocesos en ejecución del cliente de distintos dominios de aplicación para que los mensajes de solicitud se aceptan las conexiones de socket diferentes. Para obtener más información acerca de esta propiedad, vea [ServiceThrottlingBehavior.MaxConcurrentSessions propiedad](http://go.microsoft.com/fwlink/?LinkID=157864) (http://go.microsoft.com/fwlink/?LinkId=157864) en MSDN.|100 * ProcessorCount|100 * ProcessorCount|10|Intente > = 200|  
  
 Al modificar la configuración de puerto aplica cambios metódicamente; modificar individualmente cada parámetro y probar los efectos del cambio en el rendimiento y la estabilidad general. Como siempre, el valor adecuado para aplicar depende del escenario en particular: si se establece un valor demasiado bajo, se puede reducir la escalabilidad; mientras que si se establece un valor demasiado alto, el requisito de la aplicación puede superar la capacidad de recursos físicos en el equipo. Además, dado que estas propiedades están relacionadas, debe establecerse de forma coherente y coherente. Para obtener más información sobre el uso de ServiceThrottlingBehavior para controlar el rendimiento del servicio de WCF, vea [utilizando ServiceThrottlingBehavior para controlar el rendimiento de servicio de WCF](http://go.microsoft.com/fwlink/?LinkId=157908) (http://go.microsoft.com/fwlink/?LinkId=157908) en MSDN.  
  
## <a name="see-also"></a>Vea también  
 [Optimizar el rendimiento de BizTalk Server](../technical-guides/optimizing-biztalk-server-performance.md)