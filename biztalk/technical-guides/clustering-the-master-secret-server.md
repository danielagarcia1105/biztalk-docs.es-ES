---
title: "El servidor secreto principal de agrupación en clústeres | Documentos de Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 14aa3622-8462-4ed9-abde-40090d4f96ff
caps.latest.revision: "3"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 674cbf64e11817c951d3841ebdc9f6ee979c0e8c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="clustering-the-master-secret-server"></a><span data-ttu-id="70b10-102">El servidor secreto principal de agrupación en clústeres</span><span class="sxs-lookup"><span data-stu-id="70b10-102">Clustering the Master Secret Server</span></span>
<span data-ttu-id="70b10-103">El [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] servicio de la aplicación mantiene una dependencia codificada de forma rígida con el servicio de inicio de sesión único (SSO) empresarial que se instala con [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="70b10-103">The [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] application service maintains a hard-coded dependency upon the Enterprise Single Sign-On (SSO) service that is installed with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="70b10-104">El servicio SSO debe poder comunicarse con el servidor secreto principal para iniciar.</span><span class="sxs-lookup"><span data-stu-id="70b10-104">The SSO service must be able to communicate with the master secret server to start.</span></span> <span data-ttu-id="70b10-105">Se recomienda agrupar el servicio SSO en el servidor secreto principal para proporcionar tolerancia a errores para el servidor secreto principal.</span><span class="sxs-lookup"><span data-stu-id="70b10-105">We recommend that you cluster the SSO service on the master secret server to provide fault tolerance for the master secret server.</span></span> <span data-ttu-id="70b10-106">Para obtener más información, consulte [opciones de instalación de SSO de alta disponibilidad](http://go.microsoft.com/fwlink/?LinkId=156838) (http://go.microsoft.com/fwlink/?LinkId=156838) en [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] ayuda.</span><span class="sxs-lookup"><span data-stu-id="70b10-106">For more information, see [High-Availability SSO Installation Options](http://go.microsoft.com/fwlink/?LinkId=156838) (http://go.microsoft.com/fwlink/?LinkId=156838) in [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] Help.</span></span>  
  
## <a name="preparing-for-clustering-the-master-secret-server"></a><span data-ttu-id="70b10-107">Preparar el servidor secreto principal de agrupación en clústeres</span><span class="sxs-lookup"><span data-stu-id="70b10-107">Preparing for Clustering the Master Secret Server</span></span>  
  
### <a name="deciding-whether-to-use-a-dedicated-cluster-or-the-sql-server-cluster"></a><span data-ttu-id="70b10-108">Decidir entre usar un clúster dedicado o el clúster de SQL Server</span><span class="sxs-lookup"><span data-stu-id="70b10-108">Deciding Whether to Use a Dedicated Cluster or the SQL Server Cluster</span></span>  
 <span data-ttu-id="70b10-109">Agrupación en clústeres de hardware es costoso.</span><span class="sxs-lookup"><span data-stu-id="70b10-109">Clustering hardware is expensive.</span></span> <span data-ttu-id="70b10-110">Para reducir los recursos de hardware para una solución de alta disponibilidad, puede agregar el servidor secreto principal como recurso de clúster en su [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] clúster de base de datos.</span><span class="sxs-lookup"><span data-stu-id="70b10-110">To reduce the hardware resources for a highly available solution, you can add the master secret server as a cluster resource in your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] database cluster.</span></span> <span data-ttu-id="70b10-111">Si usas el [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] clúster de base de datos, se recomienda no colocar el servidor secreto principal en el mismo nodo activo como la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="70b10-111">If you use the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] database cluster, we recommend that you do not put the master secret server on the same active node as the MessageBox database.</span></span> <span data-ttu-id="70b10-112">La base de datos de cuadro de mensajes es normalmente más ocupado que otras bases de datos.</span><span class="sxs-lookup"><span data-stu-id="70b10-112">The MessageBox database is usually busier than other databases.</span></span> <span data-ttu-id="70b10-113">Aunque el servidor secreto principal no consume muchos recursos de hardware, es mejor moverlo a un nodo de clúster activo diferente desde el nodo activo de base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="70b10-113">Even though the master secret server doesn't consume many hardware resources, it is better to move it to a different active cluster node from the active MessageBox database node.</span></span>  
  
### <a name="clustering-the-sso-database"></a><span data-ttu-id="70b10-114">Agrupación en clústeres de la base de datos SSO</span><span class="sxs-lookup"><span data-stu-id="70b10-114">Clustering the SSO Database</span></span>  
 <span data-ttu-id="70b10-115">El servidor secreto principal depende de la base de datos SSO.</span><span class="sxs-lookup"><span data-stu-id="70b10-115">The master secret server depends on the SSO database.</span></span> <span data-ttu-id="70b10-116">Para compilar un SSO de alta disponibilidad, debe agrupar la base de datos SSO.</span><span class="sxs-lookup"><span data-stu-id="70b10-116">To build a high-availability SSO, you must cluster the SSO database.</span></span> <span data-ttu-id="70b10-117">Para obtener más información acerca de la agrupación de las bases de datos de BizTalk, consulte [agrupación en clústeres los Databases2 de BizTalk Server](../technical-guides/clustering-the-biztalk-server-databases2.md).</span><span class="sxs-lookup"><span data-stu-id="70b10-117">For more information about clustering BizTalk databases, see [Clustering the BizTalk Server Databases2](../technical-guides/clustering-the-biztalk-server-databases2.md).</span></span>  
  
### <a name="creating-domain-groups-and-accounts"></a><span data-ttu-id="70b10-118">Creación de cuentas y grupos de dominio</span><span class="sxs-lookup"><span data-stu-id="70b10-118">Creating Domain Groups and Accounts</span></span>  
 <span data-ttu-id="70b10-119">Debe configurar los siguientes grupos de dominio y cuentas antes de agrupar el servidor secreto principal:</span><span class="sxs-lookup"><span data-stu-id="70b10-119">You need to configure the following domain groups and accounts before clustering the master secret server:</span></span>  
  
-   <span data-ttu-id="70b10-120">Crear grupos de dominio con los nombres de los administradores de SSO y de administradores afiliados de SSO.</span><span class="sxs-lookup"><span data-stu-id="70b10-120">Create domain groups with the names SSO Administrators and SSO Affiliate Administrators.</span></span> <span data-ttu-id="70b10-121">Para crear una instancia en clúster del servicio SSO empresarial, debe crear los grupos de administradores de SSO y de administradores afiliados de SSO como grupos de dominio.</span><span class="sxs-lookup"><span data-stu-id="70b10-121">To create a clustered instance of the Enterprise SSO service, you must create the SSO Administrators and SSO Affiliate Administrators groups as domain groups.</span></span>  
  
-   <span data-ttu-id="70b10-122">Cree o designe una cuenta de dominio que sea miembro del grupo de dominio de administradores de SSO.</span><span class="sxs-lookup"><span data-stu-id="70b10-122">Create or designate a domain account that is a member of the SSO Administrators domain group.</span></span> <span data-ttu-id="70b10-123">El Servicio SSO empresarial de cada nodo se configurará para iniciar sesión como esta cuenta de dominio.</span><span class="sxs-lookup"><span data-stu-id="70b10-123">The Enterprise SSO service on each node will be configured to log on as this domain account.</span></span> <span data-ttu-id="70b10-124">Esta cuenta debe tener el derecho "Iniciar sesión como servicio" en cada nodo del clúster.</span><span class="sxs-lookup"><span data-stu-id="70b10-124">This account must have the "Log on as a service" right on each node in the cluster.</span></span> <span data-ttu-id="70b10-125">Esta cuenta también debe tener acceso de Control total para el clúster.</span><span class="sxs-lookup"><span data-stu-id="70b10-125">This account must also be granted Full Control access to the cluster.</span></span>  
  
## <a name="clustering-the-master-secret-server"></a><span data-ttu-id="70b10-126">El servidor secreto principal de agrupación en clústeres</span><span class="sxs-lookup"><span data-stu-id="70b10-126">Clustering the Master Secret Server</span></span>  
 <span data-ttu-id="70b10-127">Estos son los pasos básicos para el servidor secreto principal de agrupación en clústeres:</span><span class="sxs-lookup"><span data-stu-id="70b10-127">Here are the basic steps for clustering the master secret server:</span></span>  
  
1.  <span data-ttu-id="70b10-128">Instalar y configurar SSO empresarial en los nodos del clúster.</span><span class="sxs-lookup"><span data-stu-id="70b10-128">Install and configure Enterprise SSO on the cluster nodes.</span></span>  
  
2.  <span data-ttu-id="70b10-129">Crear el recurso de SSO empresarial agrupado y los recursos dependientes.</span><span class="sxs-lookup"><span data-stu-id="70b10-129">Create the clustered Enterprise SSO resource and the dependent resources.</span></span>  
  
3.  <span data-ttu-id="70b10-130">Restaurar el secreto principal en el segundo nodo de clúster.</span><span class="sxs-lookup"><span data-stu-id="70b10-130">Restore the master secret on the second cluster node.</span></span> <span data-ttu-id="70b10-131">Si mueve el servidor secreto principal para el clúster, debe restaurar el secreto principal en el primer nodo de clúster.</span><span class="sxs-lookup"><span data-stu-id="70b10-131">If you move the master secret server to the cluster, you must restore the master secret on the first cluster node as well.</span></span>  
  
4.  <span data-ttu-id="70b10-132">Conecte el grupo de clúster que contiene el servicio SSO, en línea.</span><span class="sxs-lookup"><span data-stu-id="70b10-132">Bring the cluster group that contains the SSO service, online.</span></span>  
  
5.  <span data-ttu-id="70b10-133">Actualice el nombre de secreto maestro en la base de datos de administración.</span><span class="sxs-lookup"><span data-stu-id="70b10-133">Update the master secret name in the Management database.</span></span>  
  
 <span data-ttu-id="70b10-134">Para obtener pasos detallados acerca de los clústeres del servidor secreto principal, consulte [cómo agrupar el servidor secreto principal](http://go.microsoft.com/fwlink/?LinkId=156839) (http://go.microsoft.com/fwlink/?LinkId=156839) en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ayuda.</span><span class="sxs-lookup"><span data-stu-id="70b10-134">For detailed steps on clustering the master secret server, see [How to Cluster the Master Secret Server](http://go.microsoft.com/fwlink/?LinkId=156839) (http://go.microsoft.com/fwlink/?LinkId=156839) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="70b10-135">Vea también</span><span class="sxs-lookup"><span data-stu-id="70b10-135">See Also</span></span>  
 [<span data-ttu-id="70b10-136">La designación de un nuevo servidor de secreto principal manualmente</span><span class="sxs-lookup"><span data-stu-id="70b10-136">Designating a New Master Secret Server Manually</span></span>](../technical-guides/designating-a-new-master-secret-server-manually.md)