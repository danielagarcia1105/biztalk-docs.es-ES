---
title: Configuración posterior a la base de datos Optimizations2 | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 609eda22-8399-4b7c-b860-21b495d2f68d
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8489d69489a23d6c81efb8443cccbb40c7a357ea
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36993797"
---
# <a name="post-configuration-database-optimizations"></a><span data-ttu-id="284cb-102">Optimizaciones de configuración posterior a la base de datos</span><span class="sxs-lookup"><span data-stu-id="284cb-102">Post-Configuration Database Optimizations</span></span>
<span data-ttu-id="284cb-103">Además de seguir las recomendaciones de [Optimizations2 de base de datos de configuración previa](../technical-guides/pre-configuration-database-optimizations2.md), se deben seguir varios pasos para optimizar el rendimiento de la base de datos de BizTalk Server en SQL Server *después* Se ha instalado BizTalk Server y se han configurado las bases de datos de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-103">In addition to following the recommendations in [Pre-Configuration Database Optimizations2](../technical-guides/pre-configuration-database-optimizations2.md), several steps should be followed to optimize BizTalk Server database performance on SQL Server *after* BizTalk Server has been installed and the BizTalk Server databases have been configured.</span></span> <span data-ttu-id="284cb-104">En este tema se proporciona una lista de estas optimizaciones.</span><span class="sxs-lookup"><span data-stu-id="284cb-104">This topic provides a list of these optimizations.</span></span>  
  
## <a name="consider-setting-the-text-in-row-table-option-on-specific-messagebox-database-tables"></a><span data-ttu-id="284cb-105">Considere la posibilidad de establecer la opción de tabla 'text in row' en tablas de base de datos de cuadro de mensajes específicas</span><span class="sxs-lookup"><span data-stu-id="284cb-105">Consider setting the 'text in row' table option on specific MessageBox database tables</span></span>  
 <span data-ttu-id="284cb-106">SQL Server proporciona una opción de tabla denominada **texto en fila** para declarar que el contenido de los campos de tipo **texto**, **ntext**, o **imagen** datos cuyas dimensiones son menores que los de una página de datos (8Kb) deben almacenarse en una fila de datos.</span><span class="sxs-lookup"><span data-stu-id="284cb-106">SQL Server provides a table option called **text in row** to declare that the contents of the fields of type **text**, **ntext**, or **image** data whose dimensions are smaller than those of a data page (8Kb) must be stored in a data row.</span></span> <span data-ttu-id="284cb-107">Al establecer esta opción en las tablas de BizTalkMsgBoxDb (tabla de piezas, tabla de cola de impresión y las tablas de DynamicStateInfo), puede aumentar el rendimiento de los mensajes cuando se trabaja con mensajes pequeños que tienen un pequeño contexto y las orquestaciones que tienen un tamaño pequeño de persistencia.</span><span class="sxs-lookup"><span data-stu-id="284cb-107">By setting this option on BizTalkMsgBoxDb tables (Parts table, Spool table and DynamicStateInfo Tables) , you can increase message throughput when working with small messages which have a small context and orchestrations that have a small persistence size.</span></span>  
  
- <span data-ttu-id="284cb-108">**Tabla de piezas**: cuando el tamaño del mensaje es menor que las dimensiones de una página de datos que son de 8kb, aplicar el **texto en fila** opción de tabla en la tabla Parts puede dar lugar a la mejora del rendimiento de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-108">**Parts Table**: When the message size is smaller than the dimensions of a data page that are of 8kb, applying the **text in row** table option on the Parts table can lead to BizTalk Server performance improvement.</span></span> <span data-ttu-id="284cb-109">La tabla Parts contiene los siguientes campos:</span><span class="sxs-lookup"><span data-stu-id="284cb-109">The Parts table contains the following fields:</span></span>  
  
  - <span data-ttu-id="284cb-110">**ImgPart**: contiene un fragmento de parte de mensaje o parte de mensaje.</span><span class="sxs-lookup"><span data-stu-id="284cb-110">**ImgPart**: Contains a message part or message part fragment.</span></span>  
  
  - <span data-ttu-id="284cb-111">**ImgPropBag**: contiene el contenedor de propiedades de la parte de mensaje.</span><span class="sxs-lookup"><span data-stu-id="284cb-111">**ImgPropBag**: Contains the message part property bag.</span></span>  
  
    <span data-ttu-id="284cb-112">De este modo, cuando el bucle en el cuadro de mensajes, el agente de mensajes que se ejecutan en un host de BizTalk puede recuperar un lote de mensajes de la tabla Parts leyendo una pequeña cantidad de páginas.</span><span class="sxs-lookup"><span data-stu-id="284cb-112">This way, when looping against the MessageBox, the Message Agent running within a BizTalk host can retrieve a batch of messages from the Parts table by reading small amount of pages.</span></span> <span data-ttu-id="284cb-113">Según el escenario concreto y la configuración de hardware, esta técnica puede reducir el uso de CPU tanto en el servidor de BizTalk y SQL Server y proporcionar una mejora considerable en términos de latencia y rendimiento.</span><span class="sxs-lookup"><span data-stu-id="284cb-113">Depending on the specific scenario and hardware configuration, this technique can reduce CPU utilization both on the SQL Server and BizTalk Server, and provide a significant improvement in terms of latency and throughput.</span></span>  
  
- <span data-ttu-id="284cb-114">**Tabla de cola de impresión**: cuando el tamaño promedio del contexto del mensaje es menor que 8 kb, lo que permite el **texto en fila** opción de tabla en la tabla de cola de impresión le ayuda a reducir el número de accesos al leer los mensajes del cuadro de mensajes a lo largo de con su contexto.</span><span class="sxs-lookup"><span data-stu-id="284cb-114">**Spool Table**: When the average size of the message context is less than 8 kb, enabling the **text in row** table option on the Spool table helps you reduce the number of accesses when reading messages from the MessageBox along with their context.</span></span> <span data-ttu-id="284cb-115">Para aplicar esta opción a la tabla de cola de impresión, debe eliminar las propiedades de contexto innecesarios y los campos distintivos para reducir el tamaño del contexto del mensaje menor que 8 Kb.</span><span class="sxs-lookup"><span data-stu-id="284cb-115">To apply this option to the Spool table, you must eliminate unnecessary context properties and distinguished fields to reduce the size of the message context lower than 8 Kb.</span></span>  
  
- <span data-ttu-id="284cb-116">**Las tablas DynamicStateInfo** estas tablas, una para cada host, contengan un campo de tipo de imagen denominado imgData que contiene el estado de la orquestación serializado como binario cuando encuentran un punto de persistencia durante su ejecución.</span><span class="sxs-lookup"><span data-stu-id="284cb-116">**DynamicStateInfo Tables** These tables, one for each host, contain a field of type image called imgData that contains binary-serialized orchestration state when they encounter a persistence point during their execution.</span></span> <span data-ttu-id="284cb-117">Cuando el estado interno de las orquestaciones contenidas en un host HostA es tan pequeño que su tamaño una vez serializado es menor que 8 kb, el **texto en fila** técnica correctamente se puede aplicar a la tabla DynamicStateInfo_HostA.</span><span class="sxs-lookup"><span data-stu-id="284cb-117">When the internal state of orchestrations within a host HostA is so small that its size once serialized is less than 8 kb, the **text in row** technique can successfully be applied to the DynamicStateInfo_HostA table.</span></span> <span data-ttu-id="284cb-118">Por lo tanto, se recomienda que mantenga el estado interno de orquestaciones tan pequeña como sea posible.</span><span class="sxs-lookup"><span data-stu-id="284cb-118">Therefore we recommend that you keep the internal state of orchestrations as small as possible.</span></span> <span data-ttu-id="284cb-119">Esta técnica puede reducir significativamente el tiempo que emplea el motor de XLANG para serializar, conservar, deserializar y restaurar el estado interno de una orquestación en el caso de punto de persistencia.</span><span class="sxs-lookup"><span data-stu-id="284cb-119">This technique can significantly reduce the time that is spent by the XLANG Engine to serialize, persist, de-serialize and restore the internal state of an orchestration in case of persistence point.</span></span>  
  
  <span data-ttu-id="284cb-120">Se utiliza la siguiente configuración en nuestras pruebas de laboratorio:</span><span class="sxs-lookup"><span data-stu-id="284cb-120">We used the following settings in our lab tests:</span></span>  
  
- <span data-ttu-id="284cb-121">EXEC sp_tableoption N'Spool', 'text in row', '6000'</span><span class="sxs-lookup"><span data-stu-id="284cb-121">EXEC sp_tableoption N'Spool', 'text in row', '6000'</span></span>  
  
- <span data-ttu-id="284cb-122">EXEC sp_tableoption de N'Parts, 'text in row', '6000'</span><span class="sxs-lookup"><span data-stu-id="284cb-122">EXEC sp_tableoption N'Parts', 'text in row', '6000'</span></span>  
  
## <a name="define-auto-growth-settings-for-biztalk-server-databases-to-a-fixed-value-instead-of-a-percentage-value"></a><span data-ttu-id="284cb-123">Definir la configuración de crecimiento automático de las bases de datos de BizTalk Server en un valor fijo en lugar de un valor de porcentaje</span><span class="sxs-lookup"><span data-stu-id="284cb-123">Define auto-growth settings for BizTalk Server databases to a fixed value instead of a percentage value</span></span>  
  
-   <span data-ttu-id="284cb-124">Crecimiento automático base de datos SQL Server es una operación de bloqueo, lo que afecta negativamente al rendimiento de la base de datos de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-124">SQL Server database auto-growth is a blocking operation, which hinders BizTalk Server database performance.</span></span> <span data-ttu-id="284cb-125">Por lo tanto, es importante asignar suficiente espacio para las bases de datos de BizTalk Server de antemano minimizar la aparición de crecimiento automático de base de datos.</span><span class="sxs-lookup"><span data-stu-id="284cb-125">Therefore it is important to allocate sufficient space for the BizTalk Server databases in advance to minimize the occurrence of database auto-growth.</span></span>  
  
-   <span data-ttu-id="284cb-126">Crecimiento automático de base de datos debe establecerse en un número fijo de megabytes, en lugar de a un porcentaje (especificar el crecimiento del archivo **en Megabytes**).</span><span class="sxs-lookup"><span data-stu-id="284cb-126">Database auto-growth should be set to a fixed number of megabytes instead of to a percentage (specify file growth **In Megabytes**).</span></span> <span data-ttu-id="284cb-127">Esto debe hacerse para que, si se produce el crecimiento automático, lo hace en un modo medido.</span><span class="sxs-lookup"><span data-stu-id="284cb-127">This should be done so that, if auto-growth occurs, it does so in a measured fashion.</span></span> <span data-ttu-id="284cb-128">Esto reduce la probabilidad del crecimiento excesivo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="284cb-128">This reduces the likelihood of excessive database growth.</span></span> <span data-ttu-id="284cb-129">El incremento de crecimiento de las bases de datos de BizTalk Server debe ser generalmente no inferior a 100 MB.</span><span class="sxs-lookup"><span data-stu-id="284cb-129">The growth increment for BizTalk Server databases should generally be no lower than 100 MB.</span></span>  
  
## <a name="pre-size-biztalk-server-databases-to-appropriate-size-with-multiple-data-files"></a><span data-ttu-id="284cb-130">Ajustar previamente el tamaño de las bases de datos de BizTalk Server para el tamaño adecuado con varios archivos de datos</span><span class="sxs-lookup"><span data-stu-id="284cb-130">Pre-size BizTalk Server databases to appropriate size with multiple data files</span></span>  
 <span data-ttu-id="284cb-131">Cuando SQL Server aumenta el tamaño de un archivo, primero debe inicializar el nuevo espacio antes de poder usarlo.</span><span class="sxs-lookup"><span data-stu-id="284cb-131">When SQL Server increases the size of a file, it must first initialize the new space before it can be used.</span></span> <span data-ttu-id="284cb-132">Se trata de una operación de bloqueo que implica rellenar el nuevo espacio con páginas vacías.</span><span class="sxs-lookup"><span data-stu-id="284cb-132">This is a blocking operation that involves filling the new space with empty pages.</span></span> <span data-ttu-id="284cb-133">SQL Server 2005 o posterior ejecutándose en Windows Server 2003 o posterior admite "inicialización instantánea de archivos".</span><span class="sxs-lookup"><span data-stu-id="284cb-133">SQL Server 2005 or later running on Windows Server 2003 or later supports “instant file initialization.”</span></span> <span data-ttu-id="284cb-134">Esto puede reducir considerablemente el impacto del rendimiento de una operación de crecimiento de archivos.</span><span class="sxs-lookup"><span data-stu-id="284cb-134">This can greatly reduce the performance impact of a file growth operation.</span></span> <span data-ttu-id="284cb-135">Para obtener más información, consulte [la inicialización de archivos de base de datos](http://go.microsoft.com/fwlink/?LinkId=132063) (http://go.microsoft.com/fwlink/?LinkId=132063) en los libros en pantalla de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-135">For more information, see [Database File Initialization](http://go.microsoft.com/fwlink/?LinkId=132063) (http://go.microsoft.com/fwlink/?LinkId=132063) in the SQL Server books online.</span></span> <span data-ttu-id="284cb-136">En este tema proporciona los pasos para habilitar la inicialización instantánea de archivos.</span><span class="sxs-lookup"><span data-stu-id="284cb-136">This topic provides steps for enabling instant file initialization.</span></span>  
  
 <span data-ttu-id="284cb-137">En la lista siguiente se describe las configuraciones de base de datos de BizTalk Server utilizadas en nuestras pruebas de laboratorio:</span><span class="sxs-lookup"><span data-stu-id="284cb-137">The following list describes the BizTalk Server database configurations used in our lab tests:</span></span>  
  
- <span data-ttu-id="284cb-138">**BizTalk DTADB (archivos de base de datos de seguimiento de BizTalk):** archivo de datos que tiene un tamaño de 2048 MB con el crecimiento de 100 MB y un archivo de registro de 1024 MB con el crecimiento de 100 MB.</span><span class="sxs-lookup"><span data-stu-id="284cb-138">**BizTalk DTADB (BizTalk Tracking database files):** Data file having a file size of 2048 MB with 100 MB growth and a log file of 1024 MB with 100 MB growth.</span></span>  
  
- <span data-ttu-id="284cb-139">**BizTalkMgmtdb (archivos de base de datos de administración de BizTalk):** archivo de datos que tiene un tamaño de 512 MB con el crecimiento de 100 MB y un archivo de registro de 512 MB con el crecimiento de 100 MB.</span><span class="sxs-lookup"><span data-stu-id="284cb-139">**BizTalkMgmtdb (BizTalk Management database files):** Data file having a file size of 512 MB with 100 MB growth and a log file of 512 MB with 100 MB growth.</span></span>  
  
- <span data-ttu-id="284cb-140">**SSODB:** archivo de datos que tiene un tamaño de 512 MB con el crecimiento de 100 MB y un archivo de registro de 512 MB con el crecimiento de 100 MB.</span><span class="sxs-lookup"><span data-stu-id="284cb-140">**SSODB:** Data file having a file size of 512 MB with 100 MB growth and a log file of 512 MB with 100 MB growth.</span></span>  
  
- <span data-ttu-id="284cb-141">**BizTalkMsgBoxDb (bases de datos de BizTalk MessageBox):** archivos de datos: 8, cada uno con un tamaño de archivo de 2 GB con el crecimiento de 100 MB y un archivo de registro de 20 GB con el crecimiento de 100 MB.</span><span class="sxs-lookup"><span data-stu-id="284cb-141">**BizTalkMsgBoxDb (BizTalk MessageBox databases):** 8 data files, each having a file size of 2 GB with 100 MB growth and a log file of 20 GB with 100 MB growth.</span></span> <span data-ttu-id="284cb-142">Dado que las bases de datos de BizTalk MessageBox son los más activos, se recomienda que colocar los archivos de datos y archivos de registro de transacciones en unidades de disco dedicados para reducir la probabilidad de problemas de contención de E/S de disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-142">Because the BizTalk MessageBox databases are the most active, we recommend you place the data files and transaction log files on dedicated drives to reduce the likelihood of problems with disk I/O contention.</span></span> <span data-ttu-id="284cb-143">En nuestro entorno de laboratorio, se utiliza una unidad para cada una de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="284cb-143">In our lab environment, we used one drive for each of the following:</span></span>  
  
  -   <span data-ttu-id="284cb-144">Archivos de datos de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="284cb-144">MessageBox data files</span></span>  
  
  -   <span data-ttu-id="284cb-145">Archivos de registro de transacciones de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="284cb-145">MessageBox transaction log files</span></span>  
  
  <span data-ttu-id="284cb-146">El siguiente script SQL puede usarse para cambiar el tamaño previamente BizTalkMsgBoxDb que inicialmente tiene un archivo de datos en la unidad J (J:\BizTalkMsgBoxDb.mdf) y un archivo de registro en la unidad K (K:\BizTalkMsgBoxDb_log. LDF):</span><span class="sxs-lookup"><span data-stu-id="284cb-146">The following SQL script can be used to pre-size BizTalkMsgBoxDb which initially has a data file on drive J (J:\BizTalkMsgBoxDb.mdf) and a log file on drive K (K:\BizTalkMsgBoxDb_log.LDF):</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="284cb-147">Este script es siempre "tal cual", está diseñado para demostración o solo con fines educativos y debe utilizarse bajo su responsabilidad.</span><span class="sxs-lookup"><span data-stu-id="284cb-147">This script is provided “as is,” is intended for demo or educational purposes only, and is to be used at your own risk.</span></span> <span data-ttu-id="284cb-148">Uso de esta secuencia de comandos no es compatible con Microsoft y Microsoft no ofrece ninguna garantía sobre la idoneidad de este script.</span><span class="sxs-lookup"><span data-stu-id="284cb-148">Use of this script is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this script.</span></span>  
  
```  
EXEC dbo.sp_helpdb BizTalkMsgBoxDb  
ALTER DATABASE BizTalkMsgBoxDb MODIFY FILE (NAME = BizTalkMsgBoxDb , FILENAME = 'J:\BizTalkMsgBoxDb.mdf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_2 , FILENAME = 'J:\BizTalkMsgBoxDb_2.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_3 , FILENAME = 'J:\BizTalkMsgBoxDb_3.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_4 , FILENAME = 'J:\BizTalkMsgBoxDb_4.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_5 , FILENAME = 'J:\BizTalkMsgBoxDb_5.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_6 , FILENAME = 'J:\BizTalkMsgBoxDb_6.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_7 , FILENAME = 'J:\BizTalkMsgBoxDb_7.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_8 , FILENAME = 'J:\BizTalkMsgBoxDb_8.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
GO  
ALTER DATABASE BizTalkMsgBoxDb MODIFY FILE (NAME = BizTalkMsgBoxDb_log , FILENAME = 'K:\BizTalkMsgBoxDb_log.LDF', SIZE =  20GB , FILEGROWTH = 100MB)  
GO  
```  
  
## <a name="move-the-backup-biztalk-server-output-directory-to-a-dedicated-lun"></a><span data-ttu-id="284cb-149">Mover el directorio de salida de copia de seguridad de BizTalk Server a un LUN dedicado</span><span class="sxs-lookup"><span data-stu-id="284cb-149">Move the Backup BizTalk Server output directory to a dedicated LUN</span></span>  
 <span data-ttu-id="284cb-150">Mover el directorio de salida de copia de seguridad de BizTalk (copia de seguridad completa y de registro) a un LUN dedicado y, a continuación, edite el trabajo Backup BizTalk Server para que apunte a la LUN dedicado.</span><span class="sxs-lookup"><span data-stu-id="284cb-150">Move the Backup BizTalk (Full and Log backup) output directory to a dedicated LUN, and then edit the Backup BizTalk Server job to point to the dedicated LUN.</span></span> <span data-ttu-id="284cb-151">Mover el directorio de salida de copia de seguridad de BizTalk Server a un LUN dedicado reducir la contención de E/S de disco cuando se ejecuta el trabajo al escribir en un disco diferente que el trabajo esté leyendo.</span><span class="sxs-lookup"><span data-stu-id="284cb-151">Moving the Backup BizTalk Server output directory to a dedicated LUN will reduce disk I/O contention when the job is running by writing to a different disk than the job is reading from.</span></span> <span data-ttu-id="284cb-152">Para obtener más información acerca de cómo configurar el trabajo de copia de seguridad de BizTalk Server, consulte [cómo configurar el trabajo de copia de seguridad de BizTalk Server](http://go.microsoft.com/fwlink/?LinkID=153813) (http://go.microsoft.com/fwlink/?LinkID=153813) en la Ayuda de BizTalk Server 2010.</span><span class="sxs-lookup"><span data-stu-id="284cb-152">For more information about configuring the Backup BizTalk Server job see [How to Configure the Backup BizTalk Server Job](http://go.microsoft.com/fwlink/?LinkID=153813) (http://go.microsoft.com/fwlink/?LinkID=153813) in BizTalk Server 2010 help.</span></span>  
  
## <a name="verify-that-the-biztalk-server-sql-agent-jobs-are-running"></a><span data-ttu-id="284cb-153">Compruebe que se ejecutan los trabajos del agente de SQL de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="284cb-153">Verify that the BizTalk Server SQL Agent Jobs are running</span></span>  
 <span data-ttu-id="284cb-154">BizTalk Server incluye varios trabajos del Agente SQL Server que realizan funciones importantes para mantener los servidores operativos y en buen estado.</span><span class="sxs-lookup"><span data-stu-id="284cb-154">BizTalk Server includes several SQL Server Agent jobs that perform important functions to keep your servers operational and healthy.</span></span> <span data-ttu-id="284cb-155">Debe supervisar el estado de estos trabajos y asegurarse de que se ejecutan sin errores.</span><span class="sxs-lookup"><span data-stu-id="284cb-155">You should monitor the health of these jobs and ensure they are running without errors.</span></span> <span data-ttu-id="284cb-156">Una de las causas más comunes de problemas de rendimiento de BizTalk Server es que los trabajos del agente de SQL de BizTalk Server no están en ejecución, lo que a su vez puede provocar que el cuadro de mensajes y el seguimiento de las bases de datos crecen sin control.</span><span class="sxs-lookup"><span data-stu-id="284cb-156">One of the most common causes of performance problems in BizTalk Server is the BizTalk Server SQL Agent Jobs are not running, which in turn can cause the MessageBox and Tracking databases to grow unchecked.</span></span> <span data-ttu-id="284cb-157">Siga estos pasos para asegurarse de que los trabajos del agente de SQL de BizTalk Server se ejecutan sin problemas:</span><span class="sxs-lookup"><span data-stu-id="284cb-157">Follow these steps to ensure the BizTalk Server SQL Agent Jobs are running without problems:</span></span>  
  
1.  <span data-ttu-id="284cb-158">**Compruebe que se está ejecutando el servicio Agente SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="284cb-158">**Verify that the SQL Server Agent service is running**.</span></span>  
  
2.  <span data-ttu-id="284cb-159">**Compruebe que los trabajos del Agente SQL Server instalados por BizTalk Server están habilitados y ejecutándose correctamente**.</span><span class="sxs-lookup"><span data-stu-id="284cb-159">**Verify that the SQL Server Agent jobs installed by BizTalk Server are enabled and running successfully**.</span></span>  
    <span data-ttu-id="284cb-160">Los trabajos del Agente SQL Server de BizTalk Server son fundamentales: si no se están ejecutando, se degradará el rendimiento del sistema con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="284cb-160">The BizTalk Server SQL Server Agent jobs are crucial: if they are not running, system performance will degrade over time.</span></span>  
  
3.  <span data-ttu-id="284cb-161">**Compruebe que se completan los trabajos del Agente SQL Server de BizTalk Server de manera oportuna**.</span><span class="sxs-lookup"><span data-stu-id="284cb-161">**Verify that the BizTalk Server SQL Server Agent jobs are completing in a timely manner**.</span></span>   
    <span data-ttu-id="284cb-162">Configurar la versión más reciente de Microsoft System Center Operations Manager para supervisar los trabajos.</span><span class="sxs-lookup"><span data-stu-id="284cb-162">Set up the most recent version of Microsoft System Center Operations Manager to monitor the jobs.</span></span>  
    <span data-ttu-id="284cb-163">Debe ser consciente de las programaciones que son específicas de determinados trabajos:</span><span class="sxs-lookup"><span data-stu-id="284cb-163">You should be aware of schedules that are particular to certain jobs:</span></span>  
  
    -   <span data-ttu-id="284cb-164">El trabajo MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb continuamente se ejecuta de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="284cb-164">The MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job runs continuously by default.</span></span> <span data-ttu-id="284cb-165">Software de supervisión debe tener esta programación en la cuenta y no generan advertencias.</span><span class="sxs-lookup"><span data-stu-id="284cb-165">Monitoring software should take this schedule into account and not produce warnings.</span></span>  
  
    -   <span data-ttu-id="284cb-166">El trabajo MessageBox_Message_Cleanup_BizTalkMsgBoxDb no está habilitado o programado, pero se inicia el trabajo MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb cada 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="284cb-166">The MessageBox_Message_Cleanup_BizTalkMsgBoxDb job is not enabled or scheduled, but it is started by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job every 10 seconds.</span></span> <span data-ttu-id="284cb-167">Por lo tanto, este trabajo debe no ser habilitado, programado o iniciar de forma manual.</span><span class="sxs-lookup"><span data-stu-id="284cb-167">Therefore, this job should not be enabled, scheduled, or manually started.</span></span>  
  
4.  <span data-ttu-id="284cb-168">**Compruebe que el tipo de inicio del servicio Agente SQL Server está configurado correctamente**.</span><span class="sxs-lookup"><span data-stu-id="284cb-168">**Verify that the Startup type of the SQL Server Agent service is configured correctly**.</span></span>  
    <span data-ttu-id="284cb-169">Compruebe que el servicio Agente SQL Server está configurado con un **tipo de inicio** de **automática** a menos que el servicio Agente SQL Server está configurado como un recurso de clúster en un clúster de Windows Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-169">Verify the SQL Server Agent service is configured with a **Startup type** of **Automatic** unless the SQL Server Agent service is configured as a cluster resource on a Windows Server cluster.</span></span> <span data-ttu-id="284cb-170">Si el servicio Agente SQL Server está configurado como un recurso de clúster, se debe configurar el **tipo de inicio** como **Manual** porque el servicio se administrarán mediante el servicio de clúster.</span><span class="sxs-lookup"><span data-stu-id="284cb-170">If the SQL Server Agent service is configured as a cluster resource, then you should configure the **Startup type** as **Manual** because the service will be managed by the Cluster service.</span></span>  
  
## <a name="configure-purging-and-archiving-of-tracking-data"></a><span data-ttu-id="284cb-171">Configurar la depuración y el archivo de datos de seguimiento</span><span class="sxs-lookup"><span data-stu-id="284cb-171">Configure Purging and Archiving of Tracking Data</span></span>  
 <span data-ttu-id="284cb-172">Siga estos pasos para asegurarse de que purga y el archivado de datos de seguimiento está configurado correctamente:</span><span class="sxs-lookup"><span data-stu-id="284cb-172">Follow these steps to ensure that purging and archiving of tracking data is configured correctly:</span></span>  
  
1.  <span data-ttu-id="284cb-173">Asegúrese de que el trabajo del Agente SQL "DTA Purge y Archive" está correctamente configurado, habilitado y completando correctamente.</span><span class="sxs-lookup"><span data-stu-id="284cb-173">Ensure the SQL Agent job “DTA Purge and Archive” is properly configured, enabled, and successfully completing.</span></span> <span data-ttu-id="284cb-174">Para obtener más información, consulte [cómo configurar el trabajo DTA Purge and Archive](http://go.microsoft.com/fwlink/?LinkID=153814) (http://go.microsoft.com/fwlink/?LinkID=153814) en la documentación de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-174">For more information, see [How to Configure the DTA Purge and Archive Job](http://go.microsoft.com/fwlink/?LinkID=153814) (http://go.microsoft.com/fwlink/?LinkID=153814) in the BizTalk Server documentation.</span></span>  
  
2.  <span data-ttu-id="284cb-175">Asegúrese de que el trabajo es capaz de purgar los datos de seguimiento tan rápido como el seguimiento de los datos entrantes se generaron.</span><span class="sxs-lookup"><span data-stu-id="284cb-175">Ensure the job is able to purge the tracking data as fast as the incoming tracking data is generated.</span></span> <span data-ttu-id="284cb-176">Para obtener más información, consulte [medir el rendimiento máximo sostenible seguimiento](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815) en la documentación de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-176">For more information, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815) in the BizTalk Server documentation.</span></span>  
  
3.  <span data-ttu-id="284cb-177">Revise la purga condicional y purga incondicional parámetros para asegurarse de que mantienen los datos durante el período de tiempo óptimo.</span><span class="sxs-lookup"><span data-stu-id="284cb-177">Review the soft purge and hard purge parameters to ensure you are keeping data for the optimal length of time.</span></span> <span data-ttu-id="284cb-178">Para obtener más información, consulte [archivar y purgar la base de datos de seguimiento de BizTalk](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816) en la documentación de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-178">For more information, see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816) in the BizTalk Server documentation.</span></span>  
  
4.  <span data-ttu-id="284cb-179">Si solo necesita purgar los datos antiguos y necesita archivarla en primer lugar, cambio el Agente SQL de trabajos para llamar al procedimiento almacenado "dtasp_PurgeTrackingDatabase."</span><span class="sxs-lookup"><span data-stu-id="284cb-179">If you only need to purge the old data and do not need to archive it first, change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase.”</span></span> <span data-ttu-id="284cb-180">Para obtener más información, consulte [cómo purgar datos de la base de datos de seguimiento de BizTalk](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817) en la documentación de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-180">For more information, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817) in the BizTalk Server documentation.</span></span>  
  
## <a name="monitor-and-reduce-dtc-log-file-disk-io-contention"></a><span data-ttu-id="284cb-181">Supervisar y reducir la contención de E/S de disco del archivo de registro DTC</span><span class="sxs-lookup"><span data-stu-id="284cb-181">Monitor and reduce DTC log file disk I/O contention</span></span>  
 <span data-ttu-id="284cb-182">El archivo de registro del Coordinador de transacciones distribuidas (DTC) puede convertirse en un cuello de botella de E/S de disco en entornos con muchas transacciones.</span><span class="sxs-lookup"><span data-stu-id="284cb-182">The Distributed Transaction Coordinator (DTC) log file can become a disk I/O bottleneck in transaction-intensive environments.</span></span> <span data-ttu-id="284cb-183">Esto es especialmente cierto cuando se utilizan los adaptadores que admiten transacciones, como MQSeries, MSMQ o SQL Server, o en un entorno de varios mensajes.</span><span class="sxs-lookup"><span data-stu-id="284cb-183">This is especially true when using adapters that support transactions, such as SQL Server, MSMQ, or MQSeries, or in a multi-MessageBox environment.</span></span> <span data-ttu-id="284cb-184">Los adaptadores transaccionales usen transacciones DTC y entornos de varios mensajes usan en gran medida de transacciones de DTC.</span><span class="sxs-lookup"><span data-stu-id="284cb-184">Transactional adapters use DTC transactions, and multi-MessageBox environments make extensive use of DTC transactions.</span></span> <span data-ttu-id="284cb-185">Para asegurarse de que el archivo de registro DTC no es un cuello de botella de E/S de disco, debe supervisar el uso de E/S del disco donde reside el archivo de registro DTC en los servidores de base de datos de SQL Server del disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-185">To ensure the DTC log file does not become a disk I/O bottleneck, you should monitor the disk I/O usage for the disk where the DTC log file resides on the SQL Server database servers.</span></span> <span data-ttu-id="284cb-186">Si se convierte en disco, uso de E/S del disco donde reside el archivo de registro DTC excesiva, considere la posibilidad de mover el archivo de registro DTC a un disco más rápido.</span><span class="sxs-lookup"><span data-stu-id="284cb-186">If disk I/O usage for the disk where the DTC log file resides becomes excessive, consider moving the DTC log file to a faster disk.</span></span> <span data-ttu-id="284cb-187">En un entorno donde está en el clúster de SQL Server, esto no es supone un problema porque el archivo de registro ya estará en una unidad compartida, que probablemente será una unidad de SAN rápida con varios ejes.</span><span class="sxs-lookup"><span data-stu-id="284cb-187">In an environment where SQL Server is clustered, this is not as much of a concern because the log file will already be on a shared drive, which will likely be a fast SAN drive with multiple spindles.</span></span> <span data-ttu-id="284cb-188">Sin embargo, todavía debe supervisar el uso de E/S de disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-188">You should nevertheless still monitor the disk I/O usage.</span></span> <span data-ttu-id="284cb-189">Esto es porque puede convertirse en un cuello de botella en entornos no agrupado, o cuando es el archivo de registro DTC en un disco compartido con otros archivos de uso intensivo del disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-189">This is because it can become a bottleneck in non-clustered environments or when the DTC log file is on a shared disk with other disk-intensive files.</span></span>  
  
## <a name="separate-the-messagebox-and-tracking-databases"></a><span data-ttu-id="284cb-190">Separar el cuadro de mensajes y las bases de datos de seguimiento</span><span class="sxs-lookup"><span data-stu-id="284cb-190">Separate the MessageBox and Tracking Databases</span></span>  
 <span data-ttu-id="284cb-191">Dado que las bases de datos de BizTalk MessageBox y seguimiento de BizTalk son los más activos, se recomienda que colocar los archivos de datos y los archivos de registro de transacciones para cada una de ellas en unidades de disco dedicados para reducir la probabilidad de problemas de contención de E/S de disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-191">Because the BizTalk MessageBox and BizTalk Tracking databases are the most active, we recommend you place the data files and transaction log files for each of these on dedicated drives to reduce the likelihood of problems with disk I/O contention.</span></span> <span data-ttu-id="284cb-192">Por ejemplo, necesitaría cuatro unidades para los archivos de base de datos de cuadro de mensajes y seguimiento de BizTalk, una para cada una de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="284cb-192">For example, you would need four drives for the MessageBox and BizTalk Tracking database files, one drive for each of the following:</span></span>  
  
- <span data-ttu-id="284cb-193">Archivos de datos de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="284cb-193">MessageBox data files</span></span>  
  
- <span data-ttu-id="284cb-194">Archivos de registro de transacciones de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="284cb-194">MessageBox transaction log files</span></span>  
  
- <span data-ttu-id="284cb-195">Archivos de datos de seguimiento de BizTalk (DTA)</span><span class="sxs-lookup"><span data-stu-id="284cb-195">BizTalk Tracking (DTA) data files</span></span>  
  
- <span data-ttu-id="284cb-196">Archivos de registro de transacciones de seguimiento de BizTalk (DTA)</span><span class="sxs-lookup"><span data-stu-id="284cb-196">BizTalk Tracking (DTA) transaction log files</span></span>  
  
  <span data-ttu-id="284cb-197">Separar las bases de datos de BizTalk MessageBox y seguimiento de BizTalk y separación de los archivos de base de datos y archivos de registro de transacciones en discos físicos diferentes se consideran mejores prácticas para reducir la contención de E/S de disco.</span><span class="sxs-lookup"><span data-stu-id="284cb-197">Separating the BizTalk MessageBox and BizTalk Tracking databases and separating the database files and transaction log files on different physical disks are considered best practices for reducing disk I/O contention.</span></span> <span data-ttu-id="284cb-198">Pruebe a distribuir la E/S de disco en ejes físicos tantos como sea posible.</span><span class="sxs-lookup"><span data-stu-id="284cb-198">Try to spread the disk I/O across as many physical spindles as possible.</span></span> <span data-ttu-id="284cb-199">También puede reducir la contención de E/S de disco mediante la colocación de la base de datos de seguimiento de BizTalk en un servidor dedicado de SQL; Sin embargo, todavía debe seguir las prácticas anteriormente con respecto a la separación de los archivos de datos y los archivos de registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="284cb-199">You can also reduce disk I/O contention by placing the BizTalk Tracking database on a dedicated SQL Server; however, you should still follow the practices above with regards to separating data files and transaction log files.</span></span>  
  
## <a name="optimize-filegroups-for-the-biztalk-server-databases"></a><span data-ttu-id="284cb-200">Optimizar los grupos de archivos para las bases de datos de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="284cb-200">Optimize filegroups for the BizTalk Server databases</span></span>  
 <span data-ttu-id="284cb-201">Siga los pasos de [optimización de grupos de archivos para el Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md) y [optimización de base de datos de BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=101578) notas del producto ([http://go.microsoft.com/fwlink/?LinkId=101578](http://go.microsoft.com/fwlink/?LinkId=101578)) para crear más grupos de archivos y archivos para las bases de datos de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="284cb-201">Follow the steps in [Optimizing Filegroups for the Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md) and the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkId=101578) white paper ([http://go.microsoft.com/fwlink/?LinkId=101578](http://go.microsoft.com/fwlink/?LinkId=101578)) to create additional filegroups and files for the BizTalk Server databases.</span></span> <span data-ttu-id="284cb-202">Esto aumentará considerablemente el rendimiento de las bases de datos de BizTalk Server desde una configuración de disco único.</span><span class="sxs-lookup"><span data-stu-id="284cb-202">This will greatly increase the performance of the BizTalk Server databases from a single disk configuration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="284cb-203">Vea también</span><span class="sxs-lookup"><span data-stu-id="284cb-203">See Also</span></span>  
 [<span data-ttu-id="284cb-204">Optimización del rendimiento de la base de datos</span><span class="sxs-lookup"><span data-stu-id="284cb-204">Optimizing Database Performance</span></span>](../technical-guides/optimizing-database-performance.md)