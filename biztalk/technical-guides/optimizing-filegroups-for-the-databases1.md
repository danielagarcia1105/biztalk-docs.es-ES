---
title: Optimizar los grupos de archivos de base de datos | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f7dbed4d-95d6-4a41-a69e-737a6f2f5a82
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6df4f1213ed35c06b14ae127cf0593abfdd8ff35
ms.sourcegitcommit: 36350889f318e1f7e0ac9506dc8df794d475bda6
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/20/2018
ms.locfileid: "26010885"
---
# <a name="optimizing-filegroups-for-the-databases"></a><span data-ttu-id="51850-102">Optimizar los grupos de archivos para las bases de datos</span><span class="sxs-lookup"><span data-stu-id="51850-102">Optimizing Filegroups for the Databases</span></span>
<span data-ttu-id="51850-103">Archivo de entrada/salida contención (E/S) suele ser un factor limitador o cuello de botella en un entorno de BizTalk Server de producción.</span><span class="sxs-lookup"><span data-stu-id="51850-103">File input/output (I/O) contention is frequently a limiting factor, or bottleneck, in a production BizTalk Server environment.</span></span> <span data-ttu-id="51850-104">BizTalk Server es una aplicación de uso intensivo de la parte de la base de datos y a su vez, la base de datos de SQL Server que utiliza BizTalk Server es intensivo de E/S de archivo muy.</span><span class="sxs-lookup"><span data-stu-id="51850-104">BizTalk Server is a very database intensive application and in turn, the SQL Server database used by BizTalk Server is very file I/O intensive.</span></span>  
  
 <span data-ttu-id="51850-105">En este tema se describe cómo realizar un uso óptimo de los archivos y la característica de grupos de archivos de SQL Server para minimizar la aparición de contención de E/S de archivo y mejorar el rendimiento general de una solución de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-105">This topic describes how to make optimal use of the files and filegroups feature of SQL Server to minimize the occurrence of file I/O contention and improve the overall performance of a BizTalk Server solution.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="51850-106">Información general</span><span class="sxs-lookup"><span data-stu-id="51850-106">Overview</span></span>  
 <span data-ttu-id="51850-107">Cada solución de BizTalk Server finalmente experimentarán contención de E/S de archivo tal y como se aumenta el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="51850-107">Every BizTalk Server solution will eventually encounter file I/O contention as throughput is increased.</span></span> <span data-ttu-id="51850-108">El subsistema de E/S o el motor de almacenamiento, es un componente clave de cualquier base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="51850-108">The I/O subsystem, or storage engine, is a key component of any relational database.</span></span> <span data-ttu-id="51850-109">Una implementación correcta de base de datos suele requerir un diseño cuidadoso en las primeras etapas de un proyecto.</span><span class="sxs-lookup"><span data-stu-id="51850-109">A successful database implementation typically requires careful planning at the early stages of a project.</span></span> <span data-ttu-id="51850-110">Este planeamiento o diseño debería tener en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="51850-110">This planning should include consideration of the following issues:</span></span>  
  
-   <span data-ttu-id="51850-111">El tipo de disco que se va a utilizar, por ejemplo, los dispositivos RAID (matriz redundante de discos independientes).</span><span class="sxs-lookup"><span data-stu-id="51850-111">What type of disk hardware to use, such as RAID (redundant array of independent disks) devices.</span></span> 
  
-   <span data-ttu-id="51850-112">Cómo distribuir los datos en los discos que utilizan archivos y grupos de archivos.</span><span class="sxs-lookup"><span data-stu-id="51850-112">How to apportion data on the disks using files and filegroups.</span></span> <span data-ttu-id="51850-113">Para obtener más información acerca del uso de archivos y grupos de archivos en SQL Server, vea [archivos de base de datos y grupos de archivos](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups).</span><span class="sxs-lookup"><span data-stu-id="51850-113">For more information about using files and filegroups in SQL Server, see [Database Files and Filegroups](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups).</span></span>
  
-   <span data-ttu-id="51850-114">Implementar el diseño de índices óptimo para mejorar el rendimiento al obtener acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="51850-114">Implementing the optimal index design for improving performance when accessing data.</span></span> <span data-ttu-id="51850-115">Para obtener más información sobre el diseño de índices, vea [diseñar índices](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide).</span><span class="sxs-lookup"><span data-stu-id="51850-115">For more information about designing indexes, see [Designing Indexes](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide).</span></span>
  
-   <span data-ttu-id="51850-116">Cómo establecer parámetros de configuración de SQL Server para obtener un rendimiento óptimo.</span><span class="sxs-lookup"><span data-stu-id="51850-116">How to set SQL Server configuration parameters for optimal performance.</span></span> <span data-ttu-id="51850-117">Para obtener más información acerca de cómo establecer los parámetros de configuración óptima para SQL Server, vea [opciones de configuración de servidor](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server).</span><span class="sxs-lookup"><span data-stu-id="51850-117">For more information about setting optimal configuration parameters for SQL Server, see [Server Configuration Options](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server).</span></span> 
  
 <span data-ttu-id="51850-118">Uno de los objetivos principales de diseño de BizTalk Server es asegurarse de que un mensaje es **nunca** perdido.</span><span class="sxs-lookup"><span data-stu-id="51850-118">One of the primary design goals of BizTalk Server is to ensure that a message is **never** lost.</span></span> <span data-ttu-id="51850-119">Con el fin de reducir la posibilidad de pérdida de mensajes, los mensajes se escriben con frecuencia en la base de datos de cuadro de mensajes cuando se procesa el mensaje.</span><span class="sxs-lookup"><span data-stu-id="51850-119">In order to mitigate the possibility of message loss, messages are frequently written to the MessageBox database as the message is processed.</span></span> <span data-ttu-id="51850-120">Cuando se procesan los mensajes por una orquestación, el mensaje se escribe en la base de datos de cuadro de mensajes en cada punto de persistencia en la orquestación.</span><span class="sxs-lookup"><span data-stu-id="51850-120">When messages are processed by an Orchestration, the message is written to the MessageBox database at every persistence point in the orchestration.</span></span> <span data-ttu-id="51850-121">Estos puntos de persistencia hacer que el cuadro de mensajes escribir el mensaje y el estado relacionado en el disco físico.</span><span class="sxs-lookup"><span data-stu-id="51850-121">These persistence points cause the MessageBox to write the message and related state to physical disk.</span></span> <span data-ttu-id="51850-122">En un mayor rendimiento, esta persistencia puede dar lugar a la contención de disco considerable y podría convertirse en un cuello de botella.</span><span class="sxs-lookup"><span data-stu-id="51850-122">At higher throughputs, this persistence can result in considerable disk contention and can potentially become a bottleneck.</span></span>  
  
 <span data-ttu-id="51850-123">Lo óptimo el uso de los archivos y resolver los cuellos de botella de E/S de archivos de forma efectiva y mejorar el rendimiento general en soluciones de BizTalk Server haya demostrado característica de grupos de archivos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="51850-123">Making optimal use of the files and filegroups feature in SQL Server has been shown to effectively address File IO bottlenecks and improve overall performance in BizTalk Server solutions.</span></span> <span data-ttu-id="51850-124">Esta optimización solo debe realizarse por un administrador experimentado de base de datos de SQL Server y solo después todas las bases de datos de BizTalk Server se han realizado copias correctamente una.</span><span class="sxs-lookup"><span data-stu-id="51850-124">This optimization should only be done by an experienced SQL Server database administrator and only after all BizTalk Server databases have been properly backed up.</span></span> <span data-ttu-id="51850-125">Esta optimización debe realizarse en todos los equipos de SQL Server en el entorno de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-125">This optimization should be performed on all SQL Server computers in the BizTalk Server environment.</span></span>  
  
 <span data-ttu-id="51850-126">Archivos y grupos de archivos de SQL Server se pueden utilizar para mejorar el rendimiento de la base de datos porque esta funcionalidad permite que se crea una base de datos en varios discos, varios controladores de disco o RAID de sistemas (matriz redundante de discos independientes).</span><span class="sxs-lookup"><span data-stu-id="51850-126">SQL Server files and filegroups can be utilized to improve database performance because this functionality allows a database be created across multiple disks, multiple disk controllers, or RAID (redundant array of independent disks) systems.</span></span> <span data-ttu-id="51850-127">Por ejemplo, si su equipo tiene cuatro discos, puede crear una base de datos que contenga tres archivos de datos y un archivo de registro, y mantener un archivo en cada disco.</span><span class="sxs-lookup"><span data-stu-id="51850-127">For example, if your computer has four disks, you can create a database that is made up of three data files and one log file, with one file on each disk.</span></span> <span data-ttu-id="51850-128">Tal y como se tiene acceso a datos, cuatro cabezales de lectura/escritura al mismo tiempo pueden tener acceso a los datos en paralelo.</span><span class="sxs-lookup"><span data-stu-id="51850-128">As data is accessed, four read/write heads can concurrently access the data in parallel.</span></span> <span data-ttu-id="51850-129">Esto acelera significativamente las operaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="51850-129">This speeds up database operations significantly.</span></span> <span data-ttu-id="51850-130">Para obtener más información acerca de cómo implementar soluciones de hardware para discos de SQL Server, consulte "Rendimiento de base de datos" en los libros de SQL Server en línea en [ http://go.microsoft.com/fwlink/?LinkID=71419 ](http://go.microsoft.com/fwlink/?LinkID=71419).</span><span class="sxs-lookup"><span data-stu-id="51850-130">For more information about implementing hardware solutions for SQL Server disks, see “Database Performance” in the SQL Server Books online at [http://go.microsoft.com/fwlink/?LinkID=71419](http://go.microsoft.com/fwlink/?LinkID=71419).</span></span>  
  
 <span data-ttu-id="51850-131">Además, los archivos y grupos de archivos Habilitar selección de ubicación de datos, porque se pueden crear tablas en grupos de archivos específicos.</span><span class="sxs-lookup"><span data-stu-id="51850-131">Additionally, files and filegroups enable data placement, because tables can be created in specific filegroups.</span></span> <span data-ttu-id="51850-132">Esto mejora el rendimiento, dado que todas las E/S de archivo para una tabla específica pueden dirigirse a un disco concreto.</span><span class="sxs-lookup"><span data-stu-id="51850-132">This improves performance, because all file I/O for a given table can be directed at a specific disk.</span></span> <span data-ttu-id="51850-133">Por ejemplo, una tabla de usa muy elevado puede colocarse en un archivo en un grupo de archivos ubicado en un disco, y las otras tablas menos utilizadas de la base de datos se pueden ubicar en distintos archivos de otro grupo de archivos, ubicado en un segundo disco.</span><span class="sxs-lookup"><span data-stu-id="51850-133">For example, a heavily used table can be placed on a file in a filegroup, located on one disk, and the other less heavily accessed tables in the database can be located on different files in another filegroup, located on a second disk.</span></span>  
  
 <span data-ttu-id="51850-134">Los cuellos de botella de E/S de archivo se tratan detalladamente considerable en [cuellos de botella en el nivel de base de datos](../technical-guides/bottlenecks-in-the-database-tier.md).</span><span class="sxs-lookup"><span data-stu-id="51850-134">File IO bottlenecks are discussed in considerable detail in [Bottlenecks in the Database Tier](../technical-guides/bottlenecks-in-the-database-tier.md).</span></span> <span data-ttu-id="51850-135">El indicador más comunes que la E/S de archivo (E/S de disco) es un cuello de botella es el valor del contador de "Longitud de cola de físico: promedio de disco disco".</span><span class="sxs-lookup"><span data-stu-id="51850-135">The most common indicator that File I/O (Disk I/O) is a bottleneck is the value of the “Physical Disk:Average Disk Queue Length” counter.</span></span> <span data-ttu-id="51850-136">Cuando el valor del contador de "Longitud de cola de físico: promedio de disco disco" es mayor que 3 para cualquier disco determinado en cualquiera de los servidores SQL Server, E/S de archivos es probable que un cuello de botella.</span><span class="sxs-lookup"><span data-stu-id="51850-136">When the value of the “Physical Disk:Average Disk Queue Length” counter is greater than about 3 for any given disk on any of the SQL Servers, then file I/O is likely a bottleneck.</span></span>  
  
 <span data-ttu-id="51850-137">Si la aplicación de optimización de archivos o no resuelve un problema de cuello de botella de E/S de archivos, puede ser necesario aumentar el rendimiento del subsistema del disco mediante la adición de física adicional o unidades de SAN.</span><span class="sxs-lookup"><span data-stu-id="51850-137">If applying file or filegroup optimization doesn't resolve a file I/O bottleneck problem, then it may be necessary to increase the throughput of the disk subsystem by adding additional physical or SAN drives.</span></span>  
  
 <span data-ttu-id="51850-138">Este tema describe cómo aplicar manualmente las optimizaciones de file y filegroup, pero estas optimizaciones también pueden incluirse en scripts.</span><span class="sxs-lookup"><span data-stu-id="51850-138">This topic describes how to manually apply file and filegroup optimizations but these optimizations can also be scripted.</span></span> <span data-ttu-id="51850-139">Se proporciona un script de SQL de ejemplo al final de este tema.</span><span class="sxs-lookup"><span data-stu-id="51850-139">A sample SQL script is provided at the end of this topic.</span></span> <span data-ttu-id="51850-140">Es importante tener en cuenta que este script deba modificarse para alojar el archivo, el grupo de archivos y la configuración del disco utilizado por las bases de datos de SQL Server para cualquier solución de BizTalk Server determinado.</span><span class="sxs-lookup"><span data-stu-id="51850-140">It is important to note that this script would need to be modified to accommodate the file, filegroup, and disk configuration used by the SQL Server database(s) for any given BizTalk Server solution.</span></span>  
  
 
## <a name="databases-created-with-a-default-biztalk-server-configuration"></a><span data-ttu-id="51850-141">Bases de datos creadas con un valor predeterminado de configuración de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="51850-141">Databases created with a default BizTalk Server configuration</span></span>  
 <span data-ttu-id="51850-142">Dependiendo de qué características están habilitadas al configurar BizTalk Server, hasta 13 diferentes bases de datos se puede crear en SQL Server y todas las bases de datos se crean en el grupo de archivos predeterminado.</span><span class="sxs-lookup"><span data-stu-id="51850-142">Depending on which features are enabled when configuring BizTalk Server, up to 13 different databases may be created in SQL Server and all of these databases are created in the default file group.</span></span> <span data-ttu-id="51850-143">El grupo de archivos predeterminado para SQL Server es el grupo de archivos principal, a menos que se cambie el grupo de archivos predeterminado mediante el comando ALTER DATABASE.</span><span class="sxs-lookup"><span data-stu-id="51850-143">The default filegroup for SQL Server is the PRIMARY filegroup unless the default filegroup is changed by using the ALTER DATABASE command.</span></span> <span data-ttu-id="51850-144">En la tabla siguiente se enumera las bases de datos que se crean en SQL Server si todas las características están habilitadas al configurar BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-144">The table below lists the databases that are created in SQL Server if all features are enabled when configuring BizTalk Server.</span></span>  
  
### <a name="biztalk-server-databases"></a><span data-ttu-id="51850-145">Bases de datos de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="51850-145">BizTalk Server Databases</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="51850-146">**Base de datos**</span><span class="sxs-lookup"><span data-stu-id="51850-146">**Database**</span></span>|<span data-ttu-id="51850-147">**Nombre de base de datos predeterminada**</span><span class="sxs-lookup"><span data-stu-id="51850-147">**Default Database Name**</span></span>|<span data-ttu-id="51850-148">**Description**</span><span class="sxs-lookup"><span data-stu-id="51850-148">**Description**</span></span>|  
|<span data-ttu-id="51850-149">Base de datos de configuración</span><span class="sxs-lookup"><span data-stu-id="51850-149">Configuration database</span></span>|<span data-ttu-id="51850-150">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="51850-150">BizTalkMgmtDb</span></span>|<span data-ttu-id="51850-151">Almacenar la central de metainformación para todas las instancias del servidor BizTalk Server en el grupo de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-151">The central meta-information store for all instances of BizTalk Server in the BizTalk Server group.</span></span>|  
|<span data-ttu-id="51850-152">Base de datos de BizTalk MessageBox</span><span class="sxs-lookup"><span data-stu-id="51850-152">BizTalk MessageBox database</span></span>|<span data-ttu-id="51850-153">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="51850-153">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="51850-154">Almacena los predicados de suscripción.</span><span class="sxs-lookup"><span data-stu-id="51850-154">Stores subscriptions predicates.</span></span> <span data-ttu-id="51850-155">Es una plataforma de host y mantiene las colas y tablas de estado para cada host de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-155">It is a host platform, and keeps queues and state tables for each BizTalk Server host.</span></span> <span data-ttu-id="51850-156">La base de datos de cuadro de mensajes también almacena los mensajes y sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="51850-156">The MessageBox database also stores the messages and message properties.</span></span>|  
|<span data-ttu-id="51850-157">Base de datos de seguimiento de BizTalk</span><span class="sxs-lookup"><span data-stu-id="51850-157">BizTalk Tracking database</span></span>|<span data-ttu-id="51850-158">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="51850-158">BizTalkDTADb</span></span>|<span data-ttu-id="51850-159">Almacena económicos y mantenimiento de datos de seguimiento por el motor de seguimiento de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-159">Stores business and health monitoring data tracked by the BizTalk Server tracking engine.</span></span>|  
|<span data-ttu-id="51850-160">Base de datos de análisis de BAM</span><span class="sxs-lookup"><span data-stu-id="51850-160">BAM Analysis database</span></span>|<span data-ttu-id="51850-161">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="51850-161">BAMAnalysis</span></span>|<span data-ttu-id="51850-162">Base de datos de SQL Server Analysis Services que mantiene los datos históricos de las actividades económicas.</span><span class="sxs-lookup"><span data-stu-id="51850-162">SQL Server Analysis Services database that keeps the aggregated historical data for Business Activities.</span></span>|  
|<span data-ttu-id="51850-163">Base de datos de esquema de estrella de SAE</span><span class="sxs-lookup"><span data-stu-id="51850-163">BAM Star Schema database</span></span>|<span data-ttu-id="51850-164">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="51850-164">BAMStarSchema</span></span>|<span data-ttu-id="51850-165">Transforma los datos recopilados de supervisión de la actividad de negocio para el procesamiento OLAP.</span><span class="sxs-lookup"><span data-stu-id="51850-165">Transforms the data collected from Business Activity Monitoring for OLAP Processing.</span></span> <span data-ttu-id="51850-166">Esta base de datos es necesario cuando se utiliza la base de datos de análisis de BAM.</span><span class="sxs-lookup"><span data-stu-id="51850-166">This database is required when using the BAM Analysis database.</span></span>|  
|<span data-ttu-id="51850-167">Base de datos de importación principal de BAM</span><span class="sxs-lookup"><span data-stu-id="51850-167">BAM Primary Import database</span></span>|<span data-ttu-id="51850-168">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="51850-168">BAMPrimaryImport</span></span>|<span data-ttu-id="51850-169">Almacena los eventos de actividades económicas y, a continuación, las consultas para el progreso y los datos después de instancias de actividad.</span><span class="sxs-lookup"><span data-stu-id="51850-169">Stores the events from Business Activities and then queries for the progress and data after activity instances.</span></span> <span data-ttu-id="51850-170">Esta base de datos también realiza agregaciones en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="51850-170">This database also performs real-time aggregations.</span></span>|  
|<span data-ttu-id="51850-171">Base de datos de archivo SAE</span><span class="sxs-lookup"><span data-stu-id="51850-171">BAM Archive database</span></span>|<span data-ttu-id="51850-172">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="51850-172">BAMArchive</span></span>|<span data-ttu-id="51850-173">Almacena los predicados de suscripción.</span><span class="sxs-lookup"><span data-stu-id="51850-173">Stores subscription predicates.</span></span> <span data-ttu-id="51850-174">La base de datos de archivo de BAM minimiza la acumulación de datos de la actividad económica en la base de datos de importación principal de BAM.</span><span class="sxs-lookup"><span data-stu-id="51850-174">The BAM Archive database minimizes the accumulation of Business Activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="51850-175">base de datos de SSO</span><span class="sxs-lookup"><span data-stu-id="51850-175">SSO database</span></span>|<span data-ttu-id="51850-176">SSODB</span><span class="sxs-lookup"><span data-stu-id="51850-176">SSODB</span></span>|<span data-ttu-id="51850-177">Almacena la configuración de forma segura información para las ubicaciones de recepción.</span><span class="sxs-lookup"><span data-stu-id="51850-177">Securely stores the configuration information for receive locations.</span></span> <span data-ttu-id="51850-178">Almacena la información para SSO afiliadas aplicaciones, así como las credenciales de usuario cifradas a todas las aplicaciones afiliadas.</span><span class="sxs-lookup"><span data-stu-id="51850-178">Stores information for SSO affiliate applications, as well as the encrypted user credentials to all the affiliate applications.</span></span>|  
|<span data-ttu-id="51850-179">Base de datos del motor de reglas</span><span class="sxs-lookup"><span data-stu-id="51850-179">Rule Engine database</span></span>|<span data-ttu-id="51850-180">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="51850-180">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="51850-181">Repositorio de:</span><span class="sxs-lookup"><span data-stu-id="51850-181">Repository for:</span></span><br /><br /> <span data-ttu-id="51850-182">-Directivas, que son conjuntos de reglas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="51850-182">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="51850-183">-Vocabularios, que son colecciones de nombres descriptivos y específico de dominio para referencias de datos de reglas.</span><span class="sxs-lookup"><span data-stu-id="51850-183">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>|  
|<span data-ttu-id="51850-184">Base de datos de administración de servidor de análisis de seguimiento</span><span class="sxs-lookup"><span data-stu-id="51850-184">Tracking Analysis Server Administration database</span></span>|<span data-ttu-id="51850-185">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="51850-185">BizTalkAnalysisDb</span></span>|<span data-ttu-id="51850-186">Almacena los cubos OLAP de supervisión de estado y de negocios.</span><span class="sxs-lookup"><span data-stu-id="51850-186">Stores both business and health monitoring OLAP cubes.</span></span>|  
  
## <a name="separation-of-data-files-and-log-files"></a><span data-ttu-id="51850-187">Separación de los archivos de datos y archivos de registro</span><span class="sxs-lookup"><span data-stu-id="51850-187">Separation of data files and log files</span></span>  
 <span data-ttu-id="51850-188">Como se mencionó anteriormente, un valor predeterminado de configuración de BizTalk Server coloca la base de datos de cuadro de mensajes en un único archivo en el grupo de archivos predeterminado.</span><span class="sxs-lookup"><span data-stu-id="51850-188">As noted above, a default BizTalk Server configuration places the MessageBox Database into a single file in the default filegroup.</span></span> <span data-ttu-id="51850-189">De manera predeterminada, los registros de transacciones y de datos para la base de datos de cuadro de mensajes se colocan en la misma unidad y ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="51850-189">By default, the data and transaction logs for the MessageBox database are placed on the same drive and path.</span></span> <span data-ttu-id="51850-190">Esto se hace para dar cabida a sistemas con un único disco.</span><span class="sxs-lookup"><span data-stu-id="51850-190">This is done to accommodate systems with a single disk.</span></span> <span data-ttu-id="51850-191">La configuración de una único archivo o grupo de archivos/disco es **no óptimo** en un entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="51850-191">A single file/filegroup/disk configuration is **not optimal** in a production environment.</span></span> <span data-ttu-id="51850-192">Para obtener un rendimiento óptimo, se deben colocar los archivos de datos y archivos de registro en discos independientes.</span><span class="sxs-lookup"><span data-stu-id="51850-192">For optimal performance, the data files and log files should be placed on separate disks.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="51850-193">Los archivos de registro nunca forman parte de un grupo de archivos.</span><span class="sxs-lookup"><span data-stu-id="51850-193">Log files are never part of a filegroup.</span></span> <span data-ttu-id="51850-194">El espacio del registro se administra de forma independiente del espacio de datos.</span><span class="sxs-lookup"><span data-stu-id="51850-194">Log space is managed separately from data space.</span></span>  
  
## <a name="the-8020-rule-of-distributing-biztalk-server-databases"></a><span data-ttu-id="51850-195">La regla 80/20 de distribuir las bases de datos de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="51850-195">The 80/20 rule of distributing BizTalk Server databases</span></span>  
 <span data-ttu-id="51850-196">El origen principal de contención en la mayoría de soluciones de BizTalk Server, ya sea debido a la contención de E/S de disco o contención de base de datos, es la base de datos de cuadro de mensajes de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-196">The main source of contention in most BizTalk Server solutions, either because of disk I/O contention or database contention, is the BizTalk Server MessageBox database.</span></span> <span data-ttu-id="51850-197">Esto es cierto en escenarios único y múltiple de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="51850-197">This is true in both single and multi-MessageBox scenarios.</span></span> <span data-ttu-id="51850-198">Es razonable suponer que siempre que el 80% del valor de la distribución de las bases de datos de BizTalk se derivan de optimizar los archivos de datos de cuadro de mensajes y el archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="51850-198">It is reasonable to assume that as much as 80% of the value of distributing BizTalk databases will be derived from optimizing the MessageBox data files and log file.</span></span> <span data-ttu-id="51850-199">El escenario de ejemplo que se detallan a continuación, se centra en optimizar los archivos de datos para una base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="51850-199">The sample scenario detailed below is focused on optimizing the data files for a MessageBox database.</span></span> <span data-ttu-id="51850-200">Estos pasos pueden, a continuación, seguir para otras bases de datos según sea necesario, por ejemplo, si la solución requiere seguimiento extenso, a continuación, también se puede optimizar la base de datos de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="51850-200">These steps can then be followed for other databases as needed, for example, if the solution requires extensive tracking, then the Tracking database can also be optimized.</span></span>  
  
## <a name="manually-adding-files-to-the-messagebox-database-step-by-step"></a><span data-ttu-id="51850-201">Agregar manualmente archivos de la base de datos de cuadro de mensajes, paso a paso</span><span class="sxs-lookup"><span data-stu-id="51850-201">Manually adding files to the MessageBox database, step-by-step</span></span>  
 <span data-ttu-id="51850-202">Esta sección describen los pasos que pueden seguirse para agregar manualmente archivos de la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="51850-202">This section describes the steps that can be followed to manually add files to the MessageBox database.</span></span> <span data-ttu-id="51850-203">En este ejemplo se agregan tres grupos de archivos y, a continuación, se agrega un archivo para cada grupo de archivos para distribuir los archivos para el cuadro de mensajes en varios discos.</span><span class="sxs-lookup"><span data-stu-id="51850-203">In this example three filegroups are added and then a file is added to each filegroup to distribute the files for the MessageBox across multiple disks.</span></span>   
  
> [!NOTE]  
>  <span data-ttu-id="51850-204">Para fines de pruebas de rendimiento que se realiza en esta guía, los grupos de archivos se optimizaron mediante el uso de una secuencia de comandos que se va a publicar como parte de la Guía de optimizaciones de rendimiento de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="51850-204">For purposes of the performance testing done for this guide, filegroups were optimized through the use of a script which will be published as part of the BizTalk Server Performance Optimizations Guide.</span></span> <span data-ttu-id="51850-205">Los pasos siguientes se proporcionan únicamente con fines de referencia.</span><span class="sxs-lookup"><span data-stu-id="51850-205">The steps below are provided for reference purposes only.</span></span>  
  
### <a name="manually-adding-files-to-the-messagebox-database-on-sql-server"></a><span data-ttu-id="51850-206">Agregar manualmente archivos de la base de datos de cuadro de mensajes en SQL Server</span><span class="sxs-lookup"><span data-stu-id="51850-206">Manually adding files to the MessageBox database on SQL Server</span></span>
  
1. <span data-ttu-id="51850-207">Abra **SQL Server Management Studio** para mostrar la **conectar al servidor** cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="51850-207">Open **SQL Server Management Studio** to display the **Connect to Server** dialog box.</span></span>  
  
     <span data-ttu-id="51850-208">![Pantalla de inicio de sesión de administración de SQL Server](../technical-guides/media/641a03f4-362c-4dde-8c9d-ac313d8881e3.gif "641a03f4-362c-4dde-8c9d-ac313d8881e3")</span><span class="sxs-lookup"><span data-stu-id="51850-208">![SQL Server Administration login screen](../technical-guides/media/641a03f4-362c-4dde-8c9d-ac313d8881e3.gif "641a03f4-362c-4dde-8c9d-ac313d8881e3")</span></span>  
  
2.  <span data-ttu-id="51850-209">En el **nombre del servidor** campo de la **conectar al servidor** cuadro de diálogo, escriba el nombre de la instancia de SQL Server que aloja las bases de datos de cuadro de mensajes de BizTalk Server y, a continuación, haga clic en el **conectar**  botón para mostrar el **Microsoft SQL Server Management Studio** cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="51850-209">In the **Server name** field of the **Connect to Server** dialog box, enter the name of the SQL Server instance that houses the BizTalk Server MessageBox databases, and then click the **Connect** button to display the **Microsoft SQL Server Management Studio** dialog box.</span></span>  
  
     <span data-ttu-id="51850-210">En el **Explorador de objetos** panel de SQL Server Management Studio, expanda **bases de datos** para ver las bases de datos para esta instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="51850-210">In the **Object Explorer** pane of SQL Server Management Studio, expand **Databases** to view the databases for this instance of SQL Server.</span></span>  
  
     <span data-ttu-id="51850-211">![SQL Server Management Studio, Explorador de objetos](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span><span class="sxs-lookup"><span data-stu-id="51850-211">![SQL Server Management Studio, Object Explorer](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span></span>  
  
3.  <span data-ttu-id="51850-212">Haga clic en la base de datos que se va a agregar los archivos y, a continuación, haga clic en **propiedades** para mostrar la **propiedades de la base de datos** cuadro de diálogo de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="51850-212">Right-click the database for which to add the files, and then click **Properties** to display the **Database Properties** dialog box for the database.</span></span>  
  
     <span data-ttu-id="51850-213">![Cuadro de diálogo de propiedades de base de datos de SQL Server](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span><span class="sxs-lookup"><span data-stu-id="51850-213">![SQL Server Database Properties dialog box](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span></span>  
  
4.  <span data-ttu-id="51850-214">En el **propiedades de la base de datos** cuadro de diálogo, seleccione la **grupos de archivos** página.</span><span class="sxs-lookup"><span data-stu-id="51850-214">In the **Database Properties** dialog box, select the **Filegroups** page.</span></span> <span data-ttu-id="51850-215">Haga clic en el **agregar** botón para crear grupos de archivos adicionales para las bases de datos BizTalkMsgBoxDb.</span><span class="sxs-lookup"><span data-stu-id="51850-215">Click the **Add** button to create additional filegroups for the BizTalkMsgBoxDb databases.</span></span> <span data-ttu-id="51850-216">En el ejemplo siguiente, se agregan tres grupos de archivos adicionales.</span><span class="sxs-lookup"><span data-stu-id="51850-216">In the example below, three additional filegroups are added.</span></span>  
  
     <span data-ttu-id="51850-217">![SQL Server, agregar grupos de archivos a una base de datos](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span><span class="sxs-lookup"><span data-stu-id="51850-217">![SQL Server, adding filegroups to a database](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span></span>  
  
5.  <span data-ttu-id="51850-218">En el cuadro de diálogo **Propiedades de la base de datos** , seleccione la página **Archivos** .</span><span class="sxs-lookup"><span data-stu-id="51850-218">In the **Database Properties** dialog box, select the **Files** page.</span></span>  
  
     <span data-ttu-id="51850-219">Haga clic en el **agregar** botón para crear archivos adicionales para agregar a los grupos de archivos y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="51850-219">Click the **Add** button to create additional files to add to the filegroups, and then click **OK**.</span></span> <span data-ttu-id="51850-220">La base de datos de cuadro de mensajes ahora se distribuye en varios discos, lo que le proporcionará una importante ventaja de rendimiento respecto a una configuración de uno de los discos.</span><span class="sxs-lookup"><span data-stu-id="51850-220">The MessageBox database is now distributed across multiple disks, which will provide a significant performance advantage over a single disk configuration.</span></span>  
  
     <span data-ttu-id="51850-221">En el ejemplo siguiente, se crea un archivo para cada uno de los grupos de archivos creada con anterioridad y se coloca cada archivo en un disco independiente.</span><span class="sxs-lookup"><span data-stu-id="51850-221">In the example below, a file is created for each of the filegroups that were created earlier and each file is placed on a separate disk.</span></span>  
  
     <span data-ttu-id="51850-222">![SQL Server, agregar archivos a un grupo de archivos](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span><span class="sxs-lookup"><span data-stu-id="51850-222">![SQL Server, adding files to a filegroup](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span></span>  
  
## <a name="sample-sql-script-for-adding-filegroups-and-files-to-the-biztalk-messagebox-database"></a><span data-ttu-id="51850-223">Script SQL de ejemplo para agregar grupos de archivos y archivos de la base de datos de BizTalk MessageBox</span><span class="sxs-lookup"><span data-stu-id="51850-223">Sample SQL script for adding filegroups and files to the BizTalk MessageBox database</span></span>  
 <span data-ttu-id="51850-224">El script SQL de ejemplo siguiente realiza las mismas tareas que se completaron manualmente en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="51850-224">The sample SQL script below performs the same tasks that were completed manually in the previous section.</span></span>  
<span data-ttu-id="51850-225">Este script de ejemplo supone la existencia de distintas unidades lógicas G a través de J. El script crea archivos y grupos de archivos para cada grupo de archivos y coloca los archivos de registro en la unidad J.</span><span class="sxs-lookup"><span data-stu-id="51850-225">This sample script assumes the existence of distinct logical drives G through J. The script creates filegroups and files for each filegroup and places the log files on the J drive.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="51850-226">Dado que SQL Server se escribe en los archivos de registro secuencialmente, no hay ninguna ventaja de rendimiento realizada mediante la creación de varios archivos de registro para una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="51850-226">Because SQL Server writes to its log files sequentially, there is no performance advantage realized by creating multiple log files for a SQL Server database.</span></span>  
  
```  
-- Filegroup changes are made using the master database  
USE [master]  
GO  
  
-- Script-wide declarations  
DECLARE @CommandBuffer nvarchar(2048)  
DECLARE @FG1_Path nvarchar(1024)  
DECLARE @FG2_Path nvarchar(1024)  
DECLARE @FG3_Path nvarchar(1024)  
DECLARE @Log_Path nvarchar(1024)  
  
-- Set the default path for all filegroups  
SET @FG1_Path = N'G:\BizTalkMsgBoxDATA\'  
SET @FG2_Path = N'H:\BizTalkMsgBoxDATA\'  
SET @FG3_Path = N'I:\BizTalkMsgBoxDATA\'  
SET @Log_Path = N'J:\BizTalkMsgBoxLog\'  
  
ALTER DATABASE [BizTalkMsgBoxDb] ADD FILEGROUP [BTS_MsgBox_FG1]  
SET @CommandBuffer = N'ALTER DATABASE [BizTalkMsgBoxDb] ADD FILE ( NAME = N''BizTalkMsgBoxDb_FG1'', FILENAME = N''' + @FG1_Path +   
N'BizTalkMsgBoxDb_FG1.ndf'' , SIZE = 102400KB , MAXSIZE = UNLIMITED, FILEGROWTH = 10240KB ) TO FILEGROUP [BTS_MsgBox_FG1]'  
EXECUTE (@CommandBuffer)  
  
ALTER DATABASE [BizTalkMsgBoxDb] ADD FILEGROUP [BTS_MsgBox_FG2]  
SET @CommandBuffer = N'ALTER DATABASE [BizTalkMsgBoxDb] ADD FILE ( NAME = N''BizTalkMsgBoxDb_FG1'', FILENAME = N''' + @FG2_Path +   
N'BizTalkMsgBoxDb_FG2.ndf'' , SIZE = 102400KB , MAXSIZE = UNLIMITED, FILEGROWTH = 10240KB ) TO FILEGROUP [BTS_MsgBox_FG2]'  
EXECUTE (@CommandBuffer)  
  
ALTER DATABASE [BizTalkMsgBoxDb] ADD FILEGROUP [BTS_MsgBox_FG3]  
SET @CommandBuffer = N'ALTER DATABASE [BizTalkMsgBoxDb] ADD FILE ( NAME = N''BizTalkMsgBoxDb_FG1'', FILENAME = N''' + @FG3_Path +   
N'BizTalkMsgBoxDb_FG3.ndf'' , SIZE = 102400KB , MAXSIZE = UNLIMITED, FILEGROWTH = 10240KB ) TO FILEGROUP [BTS_MsgBox_FG3]'  
EXECUTE (@CommandBuffer)  
  
ALTER DATABASE [BizTalkMsgBoxDb] MODIFY FILE ( NAME = N'BizTalkMsgBoxDb_log', SIZE = 10240KB , MAXSIZE = UNLIMITED, FILEGROWTH = 10240KB )  
  
GO -- Completes the previous batch, as necessary  
```  
  
 <span data-ttu-id="51850-227">El script SQL de ejemplo siguiente se podría utilizar para establecer un determinado grupo de archivos como el grupo de archivos predeterminado:</span><span class="sxs-lookup"><span data-stu-id="51850-227">The sample SQL script below could be used to set a particular filegroup as the default filegroup:</span></span>  
  
```  
USE [BizTalkMsgBoxDb]  
GO  
declare @isdefault bit  
SELECT @isdefault=convert(bit, (status & 0x10)) FROM sysfilegroups WHERE groupname=N'BTS_MsgBox_FG1'  
if(@isdefault=0)  
ALTER DATABASE [BizTalkMsgBoxDb] MODIFY FILEGROUP [BTS_MsgBox_FG1] DEFAULT  
GO  
```  
  
 <span data-ttu-id="51850-228">La ventaja de secuencias de comandos es que las secuencias de comandos pueden realizar varias tareas rápidamente, se pueden reproducir con precisión y reducirán la posibilidad de que se produzcan errores humanos.</span><span class="sxs-lookup"><span data-stu-id="51850-228">The advantage to scripting is that scripts can perform multiple tasks quickly, can be reproduced precisely, and reduce the possibility of human error.</span></span> <span data-ttu-id="51850-229">La desventaja de secuencias de comandos es que la ejecución de una secuencia de comandos incorrecta puede provocar problemas graves que podrían requerir las bases de datos de BizTalk Server para volver a configurarse desde el principio.</span><span class="sxs-lookup"><span data-stu-id="51850-229">The disadvantage of scripting is that the execution of an incorrectly written script can potentially cause serious problems that could require the BizTalk Server databases to be re-configured from scratch.</span></span> <span data-ttu-id="51850-230">Por lo tanto, es de máxima importancia que los scripts SQL como el script de ejemplo que se enumeran en este tema son exhaustivamente probarla antes de que se está ejecutando en un entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="51850-230">Therefore, it is of utmost importance that SQL scripts such as the sample script listed in this topic are thoroughly tested before being executed in a production environment.</span></span>