---
title: "Lista de comprobación: Mantenimiento y solución de problemas de las bases de datos de servidor BizTalk Server | Documentos de Microsoft"
ms.custom: 
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 58931faf-fc84-46fe-8359-506da94c3756
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3e5ef7cdc4fb136a9fc80b04a04cdbe4f1e064e3
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="checklist-maintaining-and-troubleshooting-biztalk-server-databases"></a>Lista de comprobación: Mantenimiento y solución de problemas de las bases de datos de servidor BizTalk Server
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]bases de datos y su estado de mantenimiento son muy importantes para una correcta [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] entorno de mensajería de base de datos. En este tema se enumera los pasos que se deben seguir al realizar mantenimiento o solución de problemas de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] las bases de datos.  
  
-   [Mantener bases de datos de servidor BizTalk Server](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_MaintainDB)  
  
-   [Solución de problemas de las bases de datos de servidor BizTalk Server](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_Troubleshoot)  
  
<a name="BKMK_MaintainDB"></a>   
## <a name="maintaining-biztalk-server-databases"></a>Mantener bases de datos de servidor BizTalk Server  
  
|Pasos|Referencia|  
|-----------|---------------|  
|Deshabilitar la **actualizar estadísticas automáticamente** y **crear estadísticas automáticamente** opciones (aplicable únicamente a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos de cuadro de mensajes).|**Nota:** esta configuración se realiza de forma predeterminada como parte de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuración. No debe realizar cambios en esta configuración. <br /><br /> Debe deshabilitar la **crear estadísticas automáticamente** y **actualizar estadísticas automáticamente** opciones. Para determinar si se deshabilita esta configuración, ejecute los siguientes procedimientos almacenados en SQL Server:<br /><br /> exec sp_dboption 'BizTalkMsgBoxDB', 'crear estadísticas automáticamente' exec sp_dboption 'BizTalkMsgBoxDB', 'Actualizar estadísticas automáticamente'<br /><br /> El valor devuelto para **CurrentSetting** debe establecerse en OFF. Si este valor se devuelve para **CurrentSetting** es ON, cámbielo a OFF mediante la ejecución de los siguientes procedimientos almacenados en SQL Server:<br /><br /> exec sp_dboption 'BizTalkMsgBoxDB', 'crear estadísticas automáticamente', 'off' exec sp_dboption 'BizTalkMsgBoxDB', 'Actualizar estadísticas automáticamente', 'off'<br /><br /> Para obtener más información acerca de estas opciones, vea los siguientes artículos de Microsoft Knowledge Base:<br /><br /> -   **917845**:["Experimentas bloqueo, deadlock condiciones u otros problemas SQL Server al intentar conectarse a la base de datos BizTalkMsgBoxDb de BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).<br />-   **912262**:["la opción de estadísticas de actualización automática, la creación automática de opción de estadísticas y la configuración de paralelismo están desactivados en la instancia de base de datos SQL Server que hospeda la base de datos BizTalkMsgBoxDB de BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153430) (http://go.microsoft.com/fwlink/?LinkId=153430).|  
|Establecer the Max Degree de propiedad de paralelismo|**Nota:** esta configuración se realiza de forma predeterminada como parte de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuración. No debe realizar cambios en esta configuración. <br /><br /> Establecer the Max Degree of Parallelism **run_value** y **config_value** propiedades en un valor de uno (1) en el [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] las instancias que hospedan la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos de cuadro de mensajes. Para comprobar la Max Degree of configuración paralelismo, ejecute el siguiente procedimiento para el maestro de almacenado en la base de datos [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:<br /><br /> exec sp_configure 'max degree of parallelism'<br /><br /> Si el **run_value** y **config_value** son no se establece en un valor de uno (1), ejecute el siguiente procedimiento almacenado en SQL Server:<br /><br /> exec sp_configure 'max degree of parallelism', '1' reconfigure con invalidación<br /><br /> Para obtener más información acerca de cómo afecta la Max Degree of paralelismo [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], vea los siguientes artículos de Microsoft Knowledge Base:<br /><br /> -   **899000**:["El valor de configuración de paralelismo para la instancia de SQL Server al configurar BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).<br />-   **917845**:["Experimentas bloqueo, deadlock condiciones u otros problemas SQL Server al intentar conectarse a la base de datos BizTalkMsgBoxDb de BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).|  
|Determinar cuándo se puede recompilar [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] índices|La mayoría de los índices de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] se agrupan en clústeres las bases de datos (Id. de índice: 1). El comando DBCC SHOWCONTIG se puede usar para mostrar información de fragmentación de tablas en el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos. Estos índices están basados en GUID por lo que es normal que se produzca la fragmentación. Si el valor de densidad de recorrido de DBCC SHOWCONTIG es inferior a 30%, se pueden volver a generar los índices durante el tiempo de inactividad. Muchas tablas en el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos contienen columnas que usan las definiciones de tipo de datos donde la indización en línea no se puede realizar. Por lo tanto, los índices de tablas en el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos nunca deben generarse mientras BizTalk está procesando datos. Para obtener más información acerca de cómo volver a generar los índices de BizTalk, vea el artículo de Microsoft Knowledge Base siguiente:<br /><br /> -   **917845**:["Experimentas bloqueo, deadlock condiciones u otros problemas SQL Server al intentar conectarse a la base de datos BizTalkMsgBoxDb de BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).<br /><br /> Para obtener más información acerca de los tipos de cargas de trabajo y fragmentación de índice, vea las notas del producto [prácticas recomendadas del desfragmentación de índices de Microsoft SQL Server 2000](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580). **Nota:** también puede usar la función sys.dm_db_index_physical_stats para buscar información de fragmentación en [!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)] y [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]. Para obtener más información, consulte [sys.dm_db_index_physical_stats (Transact-SQL)](http://go.microsoft.com/fwlink/?LinkId=158493) (http://go.microsoft.com/fwlink/?LinkId=158493).|  
|Supervisar la base de datos para bloqueos, bloques o interbloqueos|Es un comportamiento normal de bloqueos y bloques para que tenga lugar la [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] bases de datos utilizadas por [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]. Sin embargo, no se espera que estos bloqueos ni bloques continúen durante un largo período de tiempo. Extendidos bloqueos y los interbloqueos en el [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] bases de datos usan [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] es un indicador de un posible problema. Para el conocido actual hace de interbloqueos y bloqueo en la [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] bases de datos utilizadas por [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], revise el artículo de Microsoft Knowledge Base siguiente:<br /><br /> -   **917845**:["Experimentas bloqueo, deadlock condiciones u otros problemas SQL Server al intentar conectarse a la base de datos BizTalkMsgBoxDb de BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).|  
|Supervisar el tamaño de las bases de datos y tablas|El tamaño de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de cuadro de mensajes debe ser por lo general no más de aproximadamente 5 GB.  La base de datos BizTalkMsgBoxDb no se deben mantener los datos y debe considerarse un búfer hasta que los datos se procesa o se mueven a la base de datos de BizTalkDTADb. Un entorno con un back-end eficaz de SQL Server y varias orquestaciones de larga ejecución puede tener una base de datos de BizTalkMsgBoxDb superior a 5GB. Un entorno de gran volumen con ningún orquestaciones de larga ejecución debe tener un [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de cuadro de mensajes mucho menor que 5 GB. El [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de seguimiento puede variar en gran medida de tamaño, pero si disminuye drásticamente el rendimiento de las consultas, a continuación, la base de datos de seguimiento es probablemente demasiado grande. Como regla general, un [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] mayor que 15-20 GB es demasiado grande y puede afectar negativamente al rendimiento de la base de datos de seguimiento. Los siguientes problemas pueden distribuirse a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos que son demasiado grandes:<br /><br /> -El [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de cuadro de mensajes continúa aumentando mientras que el tamaño de datos (no solo en el archivo de registro) sigue siendo grande. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]tarda más tiempo de lo normal para procesar incluso un escenario de flujo de mensaje simple.<br />-Las consultas de concentrador de grupo llevar más tiempo de lo normal y pueden incluso tiempo de espera.<br />-El archivo de registro de base de datos nunca se trunca.<br />-Los trabajos del agente de SQL de BizTalk se ejecutan más lentamente de lo normal.<br />-Algunas tablas son bastante grandes o tienen demasiadas filas en comparación a su estado normal.<br /><br /> El [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos pueden llegar a ser grandes por varios motivos incluidos:<br /><br /> -BizTalk trabajos del Agente SQL no se está ejecutando<br />-Mensaje suspendido excesivo o instancias de servicio<br />: Errores de disco<br />-Altos niveles de seguimiento<br />-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]limitación<br />-Deficiente [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] rendimiento<br />: Problemas de latencia de red<br /><br /> De forma similar, puede tener demasiadas filas en una tabla. No hay ningún número de conjunto de filas que es demasiado elevado. Además, este número de filas varía según el tipo de datos se almacena en la tabla. Por ejemplo, un *dta_DebugTrace* tabla que tiene más de 1 millón de filas probablemente tiene demasiadas filas. A *HostNameQ_Suspended* tabla que tiene más de 200.000 filas probablemente tiene demasiadas filas.<br /><br /> Asegúrese de que conoce las expectativas del entorno para determinar si se está produciendo un problema de datos.|  
|Habilitar el seguimiento en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host|De forma predeterminada, el seguimiento está habilitado en el host predeterminado. BizTalk requiere la **Permitir seguimiento de Host** se activa la opción en un solo HOST. Cuando el seguimiento está habilitado, el servicio de descodificación de datos de seguimiento (TDDS) mueve el seguimiento de datos de evento desde el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de cuadro de mensajes para el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de seguimiento. Si no hay ningún [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] hosts estén configurados con la opción de **Permitir seguimiento de Host** , o si el host de seguimiento se detiene, TDDS no se ejecutará y las tablas de TrackingData_x_x en el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de cuadro de mensajes crecerá desactivada . Por lo tanto, una dedicado [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host debe estar configurado con la opción **Permitir seguimiento de Host**. Para obtener más información acerca de cómo configurar un host de seguimiento dedicado vea [configurar un Host de seguimiento dedicado](~/technical-guides/configuring-a-dedicated-tracking-host.md). **Nota:** para permitir que TDDS mantener los nuevos eventos de seguimiento en escenarios de gran volumen, puede crear varias instancias de host de seguimiento único, pero no más de un host debe estar configurado para el seguimiento.|  
|Use los trabajos del Agente SQL Server de BizTalk correctos|Ejecución de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] son cruciales para la administración de trabajos del Agente SQL el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos y para mantener un rendimiento óptimo.<br /><br /> -El **copia de seguridad [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**  trabajo del Agente SQL Server es el único método admitido para realizar una copia de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] las bases de datos. Este trabajo requiere configurar todas [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos para utilizar un modelo de recuperación completa. Debe configurar este trabajo para un correcto [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] entorno. Puede usar los métodos de SQL Server para realizar una copia de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solo si se detiene el servicio SQL Server y si todas las bases de datos [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] procesos se detienen. **Nota:** para obtener más información acerca de cómo utilizar el modelo de recuperación completa de SQL Server al configurar la copia de seguridad del Agente SQL [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] de trabajo, consulte [trasvase de registros](http://go.microsoft.com/fwlink/?LinkId=153450) (http://go.Microsoft.com/fwlink/?) LinkId = 153450) o [copia de seguridad en el modelo de recuperación completa](http://go.microsoft.com/fwlink/?LinkId=156509) (http://go.Microsoft.com/fwlink/?) LinkId = 156509).<br />-El **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** trabajo del Agente SQL Server está diseñado para ejecutarse de forma indefinida. Como resultado el historial de trabajos del Agente SQL no puede indicar que se haya completado correctamente este trabajo del Agente SQL; Este comportamiento es así por diseño. Si se produce un error, el trabajo reiniciará en 1 minuto y debe seguir ejecutándose sin alteraciones. Por lo tanto, normalmente se pueden omitir las notificaciones de error para este trabajo. Si el historial de trabajos para el trabajo de agente SQL Server de MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb indica que este trabajo es un error y reiniciar constantemente investigación adicional en la causa del error o reinicio ciclo pueden requerir.<br />-El **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** trabajo del Agente SQL Server es el trabajo único que no debe estar manualmente habilitado porque se inicia el trabajo MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb.<br />-El **DTA Purge and Archive** trabajo del Agente SQL Server mantiene el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] base de datos de seguimiento purgar y archivar los mensajes controlados. Este trabajo lee todas las filas de la tabla y compara la marca de tiempo de cada fila para determinar si se debe quitar el registro. **Nota:** al solucionar problemas de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] trabajos del Agente SQL Server, compruebe que todos los trabajos del Agente SQL excepto el MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb se completan sin errores. <br /><br /> Para obtener más información sobre la [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] trabajos del Agente SQL utilizados en [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:<br /><br /> : Vea [estructura y los trabajos de la base de datos](http://go.microsoft.com/fwlink/?LinkId=153451) (http://go.microsoft.com/fwlink/?LinkId=153451).<br />: Vea [trabajos descripción del Agente SQL Server en BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153452) (http://go.microsoft.com/fwlink/?LinkId=153452).|  
|Supervisar y finalizar instancias suspendidas|Instancias de servicio pueden ser suspendidas (reanudables) o suspendidas (no reanudables). Estas instancias de servicio pueden ser mensajería, orquestación o puerto. [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]contempla la terminación y la eliminación de estas instancias mediante la página concentrador de grupo en el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] consola de administración o mediante el uso de la secuencia de comandos Terminate.vbs. Para obtener más información acerca de la secuencia de comandos Terminate.vbs, vea [quitar instancia del servicio suspendido](http://go.microsoft.com/fwlink/?LinkId=153453) (http://go.microsoft.com/fwlink/?LinkId=153453). **Sugerencia:** también puede usar la herramienta de terminador para quitar las instancias suspendidas. El [herramienta terminador](http://go.microsoft.com/fwlink/?LinkId=151931) está disponible en [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931). Uso de esta herramienta no es compatible con Microsoft y Microsoft no otorga ninguna garantía sobre la idoneidad de este programa. La utilización de este programa queda bajo su propia responsabilidad. <br /><br /> Los términos "huérfanas" y "zombies" se suelen usar indistintamente. Un mensaje huérfano o zombie es un mensaje que no tiene una instancia de los servicios asociados, normalmente porque la instancia del servicio ha terminado antes de que se recibió el mensaje. Un servicio huérfano o zombie es un servicio que no tiene ningún mensaje asociado. Para obtener más información acerca de mensajes de zombie e instancias de servicio en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] vea [Zombies en BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153454) (http://go.microsoft.com/fwlink/?LinkId=153454).|  
|Supervisar los contadores de rendimiento de la **PhysicalDisk** objeto de rendimiento|[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]realiza un gran número de transacciones cortas, muy rápidas a SQL Server en un minuto. Si el servidor SQL Server no puede admitir esta actividad, puede experimentar [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] problemas de rendimiento. Monitor de la **AVG. Segundos de disco/lectura**, **AVG. Segundos/transferencia**, y **AVG. Segundos/escritura** contadores de monitor de rendimiento en el **PhysicalDisk** objeto de rendimiento. El valor óptimo es inferior a 10 ms (milisegundos). Un valor de 20 ms o superior se considera un rendimiento bajo.<br /><br /> -Para obtener más información sobre el rendimiento de SQL Server 2005, consulte [solucionar problemas de rendimiento en SQL Server 2005](http://go.microsoft.com/fwlink/?LinkID=153585) (http://go.microsoft.com/fwlink/?LinkID=153585).<br />-Para obtener más información sobre el rendimiento de SQL Server 2008, consulte [solucionar problemas de rendimiento en SQL Server 2008](http://go.microsoft.com/fwlink/?LinkID=153586) (http://go.microsoft.com/fwlink/?LinkID=153586).<br />-Para obtener más información acerca de [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] base de datos de alta disponibilidad, vea [proporcionar una alta disponibilidad para bases de datos de BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153587) (http://go.microsoft.com/fwlink/?LinkId=153587).<br /><br /> También puede hacer referencia a los artículos de Microsoft Knowledge Base siguientes para obtener más información sobre el rendimiento de SQL Server:<br /><br /> -   **298475** : ["Cómo solucionar problemas de rendimiento de SQL Server"](http://go.microsoft.com/fwlink/?LinkId=153588) (http://go.microsoft.com/fwlink/?LinkId=153588).<br />-   **271509** : ["Cómo supervisar los bloqueos en SQL Server 2005"](http://go.microsoft.com/fwlink/?LinkId=153589) (http://go.microsoft.com/fwlink/?LinkId=153589).|  
|Siga las prácticas recomendadas para [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] las bases de datos.|Vea [prácticas recomendadas para el mantenimiento de bases de datos de BizTalk Server](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md).|  
  
<a name="BKMK_Troubleshoot"></a>   
## <a name="troubleshooting-biztalk-server-databases"></a>Solución de problemas de las bases de datos de servidor BizTalk Server  
 Realizar las siguientes tareas para solucionar los problemas con [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos.  
  
|Pasos|Referencia|  
|-----------|---------------|  
|Asegúrese de que todas las necesarias trabajos del Agente SQL Server de BizTalk están habilitados y en ejecución|Todos los BizTalk Agente SQL Server trabajos excepto la **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** trabajo debe estar habilitado y ejecutándose correctamente. No deshabilite cualquier otro trabajo.<br /><br /> Si se produce un error, use la **Ver historial** opción en SQL Server para ver la información de error y, a continuación, solucionar el problema en consecuencia. Recuerde que el **_Message_ManageRefCountLog_BizTalkMsgBoxDb MessageBox** trabajo del Agente SQL Server se ejecutará infinitamente. Por lo tanto, solo deben preocuparle si el historial de trabajos informa de que el trabajo constantemente se produce un error y se reinicia.|  
|Utilice la herramienta MsgBoxViewer para analizar el BizTalk MessageBox y otras bases de datos|**Importante:** no se admite el uso de esta herramienta por Microsoft y Microsoft no otorga ninguna garantía sobre la idoneidad de este programa. La utilización de este programa queda bajo su propia responsabilidad. <br /><br /> Está disponible en la herramienta de MsgBoxViewer [http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930). La herramienta MsgBoxViewer es útil para solucionar problemas porque proporciona un informe HTML que contiene información detallada sobre el tamaño de la tabla y el recuento de filas. El informe también puede ayudar a determinar si [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] está limitando. Además, la herramienta proporciona una instantánea de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos y la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuración.<br /><br /> Cuando [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] está ejecutando más lentamente de lo habitual, ejecute la herramienta MsgBoxViewer, haga clic para seleccionar todas las consultas en el **consultas opcional** ficha y, a continuación, revise el informe HTML generado para cualquier problema. El **informe resumen** sección enumeran las advertencias en amarillos y posibles problemas en rojo.<br /><br /> Además, puede usar la herramienta MsgBoxViewer para determinar qué tablas son los más grandes y tienen la mayoría de los registros. Para obtener una lista de tablas que suelen alcanzar el larges y para obtener instrucciones sobre cómo administrar las tablas, consulte [crezca de grandes tablas de base de datos de BizTalk Server](~/technical-guides/large-growing-biztalk-server-database-tables.md).|  
|Usar la herramienta de terminador para resolver los problemas, si existe, identificado por la herramienta MsgBoxViewer|**Importante:** no se admite el uso de esta herramienta por Microsoft y Microsoft no otorga ninguna garantía sobre la idoneidad de este programa. La utilización de este programa queda bajo su propia responsabilidad. <br /><br /> Ejecutar la herramienta de terminador disponible en [terminador](http://go.microsoft.com/fwlink/?LinkId=151931) (http://go.microsoft.com/fwlink/?LinkId=151931). Esta herramienta permite a los usuarios a resolver fácilmente los problemas identificados por la herramienta de BizTalk MsgBoxViewer. Para obtener más información sobre cómo la herramienta de terminador se integra con la herramienta de BizTalk MsgBoxViewer, consulte [utilizando el terminador de BizTalk para resolver los problemas identificados por BizTalk MsgBoxViewer](http://go.microsoft.com/fwlink/?LinkId=151932) (http://go.microsoft.com/fwlink/?LinkId=151932).|  
|Investigar los escenarios de interbloqueo|En una situación de interbloqueo, habilitar el seguimiento de DBCC en SQL Server para que la información de interbloqueo se escribe en el registro SQLERROR.<br /><br /> En SQL Server 2008 o SQL Server 2005, ejecute la instrucción siguiente para habilitar el seguimiento de DBCC para escenarios de interbloqueo:<br /><br /> DBCC TRACEON (1222, -1)<br /><br /> También puede usar la utilidad PSSDIAG para recopilar datos en el **Lock: Deadlock** eventos y la **Lock: Deadlock Chain** eventos. Para obtener más información acerca de la utilidad PSSDIAG, consulte [herramienta de recopilación de datos PSSDIAG](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).<br /><br /> La base de datos BizTalkMsgBoxDB es una base de datos de procesamiento de transacciones en línea (OLTP) de gran volumen y altos niveles de transacciones. Con esas bases de datos, se espera que algunos interbloqueos y este interbloqueo se controla internamente el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] motor. Cuando se produce este comportamiento, errores no se muestran en los registros de errores. Cuando se investiga un escenario de interbloqueo, el interbloqueo que está investigando en la salida debe poner en correlación con un error de interbloqueo en los registros de eventos.|  
|Buscar procesos bloqueados|Puede usar a Monitor de actividad en SQL Server para obtener el identificador de proceso de servidor (SPID) de un proceso de sistema de bloqueo. A continuación, puede ejecutar el analizador de SQL para determinar la instrucción SQL que se está ejecutando en el SPID de bloqueo. Puede usar la utilidad PSSDIAG para solucionar problemas de bloqueo en SQL Server. La utilidad de captura todos los eventos de Transact-SQL que tienen un bloqueo script habilitado. Para obtener más información acerca de la utilidad PSSDIAG, consulte [herramienta de recopilación de datos PSSDIAG](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).<br /><br /> En SQL Server 2005 y versiones posteriores, puede especificar el **bloqueado umbral de procesos** configuración para determinar qué SPID o SPID están bloqueando ya que el umbral especificado. Para obtener más información acerca de la opción de umbral de procesos bloqueados, consulte [bloquea la opción de umbral de proceso](http://go.microsoft.com/fwlink/?LinkId=153628) (http://go.microsoft.com/fwlink/?LinkId=153628). **Nota:** cuando experimenta un problema de bloqueo o de bloqueo en SQL Server, se recomienda que póngase en contacto con los servicios de soporte técnico de Microsoft. Servicios de soporte técnico de Microsoft puede ayudarle a configurar las opciones de la utilidad PSSDiag correctas.|  
|Eliminar todos los datos no deseados|Si las bases de datos han aumentado y es demasiado grande y los datos contenidos en las bases de datos no será necesarios ya, es el método preferido eliminar los datos. **Precaución:** no utilice este método en cualquier entorno donde los datos son cruciales para la empresa o si se necesitan los datos. <br /><br /> **Para purgar la base de datos BizTalkMsgBox**<br /> 1.  Descargue e instale la herramienta de terminador en [terminador de Biztalk](http://go.microsoft.com/fwlink/?LinkId=220869) (http://go.microsoft.com/fwlink/?LinkId=220869).<br />2.  Siga los pasos descritos en el tema [cómo purgar datos manualmente desde la base de datos de cuadro de mensajes en un entorno de prueba](http://go.microsoft.com/fwlink/?LinkID=158064) (http://go.microsoft.com/fwlink/?LinkID=158064) para crear el bts_CleanupMsgbox el procedimiento almacenado en la base de datos de BizTalk MessageBox.<br />3.  Utilice la herramienta de terminador para ejecutar el procedimiento almacenado bts_CleanupMsgbox y purgar la base de datos de BizTalk MessageBox. **Advertencia:** no ejecute el procedimiento almacenado bts_CleanupMsgbox en un servidor de producción que ejecuta BizTalk Server. solo debe ejecutar el procedimiento almacenado bts_CleanupMsgbox en un entorno de prueba. No se admite la ejecución del procedimiento almacenado bts_CleanupMsgbox en un entorno de producción.<br />4.  Reinicie todos los hosts y [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] servicios.<br /><br /> **Para purgar la base de datos de BizTalkDTADb**<br /> <ul><li>**Método 1**<br /><br /> <ol><li>Realizar copias de seguridad de todos los [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] las bases de datos.</li><li>Ejecute el **dtasp_PurgeAllCompletedTrackingData** procedimiento almacenado. Para obtener más información acerca del procedimiento almacenado, vea [cómo purgar datos manualmente desde la base de datos de seguimiento de BizTalk](http://go.microsoft.com/fwlink/?LinkId=153635) (http://go.microsoft.com/fwlink/?LinkId=153635).</li></ol></li><li>**Método 2**. Utilice esta opción únicamente si la base de datos de BizTalkDTADb contiene muchas instancias incompletas que se deben quitar.<br /><br /> <ol><li>Realizar copias de seguridad de todos los [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] las bases de datos.</li><li>Detenga todos los hosts de BizTalk, servicios y adaptadores aislados personalizados. Si usa el adaptador SOAP o HTTP, reinicie los servicios IIS.</li><li>Ejecute el **dtasp_CleanHMData** procedimiento almacenado en la base de datos de BizTalkDTADb.</li><li>Reinicie todos los hosts y [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] servicios.</li></ol></li></ul> **Nota:** si es necesario disponer los datos de seguimiento, realizar copias de seguridad la base de datos BizTalkDTADb, restaurar la base de datos a otro servidor SQL Server y, a continuación, purgar la base de datos de BizTalkDTADb original.|  
  
 Si necesita ayuda para analizar los datos de MsgBoxViewer o la salida PSSDIAG, póngase en contacto con los servicios de soporte técnico de Microsoft. Antes de ponerse en contacto con los servicios de soporte técnico al cliente, comprimir los datos de MsgBoxViewer, la salida PSSDIAG y los registros de eventos actualizados (archivos evt). Puede que tenga que enviar estos archivos a un [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ingeniero de soporte técnico  
  
## <a name="in-this-section"></a>En esta sección  
  
-   [Prácticas recomendadas para el mantenimiento de bases de datos de servidor BizTalk Server](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)  
  
-   [Tablas de base de datos de servidor BizTalk Server de gran crecimiento](~/technical-guides/large-growing-biztalk-server-database-tables.md)  
  
-   [Herramientas y utilidades para solucionar problemas](../technical-guides/tools-and-utilities-for-troubleshooting.md)  
  
## <a name="see-also"></a>Vea también  
 [Configuración de SQL Server que no se debe cambiar](~/technical-guides/sql-server-settings-that-should-not-be-changed.md)