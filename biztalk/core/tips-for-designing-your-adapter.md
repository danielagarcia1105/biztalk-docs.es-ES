---
title: Sugerencias para diseñar un adaptador | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 0bb60988-4e48-4654-9cf4-512dd7c97239
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 306cb2ae9aeca57804a57f0dfa8c1de1bfd0025d
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36982685"
---
# <a name="tips-for-designing-your-adapter"></a><span data-ttu-id="e14b1-102">Sugerencias para diseñar un adaptador</span><span class="sxs-lookup"><span data-stu-id="e14b1-102">Tips for Designing Your Adapter</span></span>
<span data-ttu-id="e14b1-103">Esta sección contiene sugerencias e ideas que los programadores de adaptadores han aprendido al diseñar adaptadores.</span><span class="sxs-lookup"><span data-stu-id="e14b1-103">This section contains hints and tips that adapter developers have learned while designing adapters.</span></span>  
  
## <a name="handler-properties-should-be-strings-if-used-as-default-configurations"></a><span data-ttu-id="e14b1-104">Las propiedades de controlador deben ser cadenas si se usan como configuraciones predeterminadas</span><span class="sxs-lookup"><span data-stu-id="e14b1-104">Handler Properties Should Be Strings if Used as Default Configurations</span></span>  
 <span data-ttu-id="e14b1-105">Parece interesante usar las propiedades en la hoja de propiedades de controlador generado mediante XSD como valores predeterminados para sus **ubicación** propiedades porque si el valor no se establece **ubicación** el tiempo de ejecución automáticamente usa el valor establecido en el controlador.</span><span class="sxs-lookup"><span data-stu-id="e14b1-105">It seems attractive to use the properties on the XSD-generated handler property sheet as defaults for their **Location** properties because if the value is not set in **Location** the runtime automatically uses the value set in the handler.</span></span> <span data-ttu-id="e14b1-106">Pero existen varios problemas que reducen la utilidad de esta posibilidad.</span><span class="sxs-lookup"><span data-stu-id="e14b1-106">But there are several issues that make this less useful.</span></span>  
  
 <span data-ttu-id="e14b1-107">El problema aparece cuando no se sabe si el valor presentado en tiempo de ejecución debe sobrescribirse o no.</span><span class="sxs-lookup"><span data-stu-id="e14b1-107">The problem comes with not knowing whether the value presented to the runtime is to be overridden or not.</span></span> <span data-ttu-id="e14b1-108">La forma habitual de hacerlo es definir alguna noción de NULL para los valores y, a continuación, ejecutar una prueba con ese valor.</span><span class="sxs-lookup"><span data-stu-id="e14b1-108">The typical way of doing this is to have some notion of NULL defined for values and then run a test against that value.</span></span> <span data-ttu-id="e14b1-109">El problema de usar hojas de propiedades basadas en XSD en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] es que NULL solo se admite para cadenas.</span><span class="sxs-lookup"><span data-stu-id="e14b1-109">The problem when using the XSD-based property sheets in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is that NULL is only supported for strings.</span></span> <span data-ttu-id="e14b1-110">Aunque desee que el adaptador tenga una configuración predeterminada mediante el uso de esta prueba de NULL y esté dispuesto a restringir el adaptador a los tipos de cadena, sigue arriesgándose a obtener una interfaz de usuario de lo más extraño.</span><span class="sxs-lookup"><span data-stu-id="e14b1-110">Even if you want your adapter to have default settings through the use of this NULL test and are willing to restrict the adapter to string types, it is still exposed to a very odd piece of user interface.</span></span>  
  
 <span data-ttu-id="e14b1-111">Las hojas de propiedades generado mediante XSD solo admiten la configuración de una propiedad en NULL con el botón secundario de la propiedad, momento en que un **anulan?** aparece el menú contextual y la propiedad puede establecerse en NULL.</span><span class="sxs-lookup"><span data-stu-id="e14b1-111">The XSD-generated property sheets only support the setting of a property back to NULL by right-clicking the property, at which point a **nullify?** context menu appears and the property can be set to NULL.</span></span> <span data-ttu-id="e14b1-112">No existe ninguna información visual que indique si una propiedad es NULL.</span><span class="sxs-lookup"><span data-stu-id="e14b1-112">There is no visual feedback as to whether a property is NULL.</span></span>  
  
## <a name="considerations-for-implementing-schema-generation-wizards"></a><span data-ttu-id="e14b1-113">Consideraciones sobre la implementación de asistentes para generación de esquemas</span><span class="sxs-lookup"><span data-stu-id="e14b1-113">Considerations for Implementing Schema Generation Wizards</span></span>  
 <span data-ttu-id="e14b1-114">Los programadores prefieren escribir código basado en modelos de objetos de tipo seguro.</span><span class="sxs-lookup"><span data-stu-id="e14b1-114">Programmers like to code against strongly typed object models.</span></span> <span data-ttu-id="e14b1-115">Al principio, manipular XML en el código puede parecer extraño y proclive a errores.</span><span class="sxs-lookup"><span data-stu-id="e14b1-115">Manipulating XML in code can at first seem awkward and prone to error.</span></span> <span data-ttu-id="e14b1-116">Pero algunos trucos y el uso inteligente de la compatibilidad que ofrece .NET Framework pueden simplificarlo todo de manera drástica.</span><span class="sxs-lookup"><span data-stu-id="e14b1-116">But some tricks and smart use of the support offered by the .NET Framework can dramatically simplify matters.</span></span>  
  
#### <a name="do-not-create-xml-documents-with-string-concatenation"></a><span data-ttu-id="e14b1-117">No cree documentos XML con concatenación de cadenas</span><span class="sxs-lookup"><span data-stu-id="e14b1-117">Do not create XML documents with string concatenation</span></span>  
 <span data-ttu-id="e14b1-118">Una de las peores equivocaciones que puede cometer con XML es intentar generarlo mediante la concatenación de cadenas e imprimir las instrucciones en la memoria.</span><span class="sxs-lookup"><span data-stu-id="e14b1-118">One of the worst mistakes to make with XML is to try and generate it from string concatenation and print statements in memory.</span></span> <span data-ttu-id="e14b1-119">Esto consume grandes cantidades de tiempo de la CPU y de memoria.</span><span class="sxs-lookup"><span data-stu-id="e14b1-119">This consumes large amounts of CPU time and memory.</span></span> <span data-ttu-id="e14b1-120">Incluso para el fragmento de código XML más trivial, resulta más fácil utilizar una herramienta como XmlWriter o el modelo de objetos de documento (DOM).</span><span class="sxs-lookup"><span data-stu-id="e14b1-120">Even for the most trivial XML snippet, it is easier to use a tool like XmlWriter or the Document Object Model (DOM).</span></span> <span data-ttu-id="e14b1-121">Si usa XmlWriter, no use la capacidad de escritura sin formato, porque el escritor pierde el estado del documento.</span><span class="sxs-lookup"><span data-stu-id="e14b1-121">If you are using XmlWriter, do not use the raw write capability, because the writer loses the state of the document.</span></span>  
  
 <span data-ttu-id="e14b1-122">En tiempo de ejecución, XmlWriter es preferible a DOM XML por los problemas de consumo elevado de memoria asociados al DOM.</span><span class="sxs-lookup"><span data-stu-id="e14b1-122">At run time, XmlWriter is preferred over the XML DOM because of high memory consumption issues associated with the DOM.</span></span> <span data-ttu-id="e14b1-123">Sin embargo, en tiempo de configuración o diseño lo más probable es que no plantee ningún problema.</span><span class="sxs-lookup"><span data-stu-id="e14b1-123">However, at configuration or design time this will most likely not be an issue.</span></span> <span data-ttu-id="e14b1-124">El uso del DOM facilita el uso de consultas XPATH, que pueden constituir una herramienta adicional de gran utilidad.</span><span class="sxs-lookup"><span data-stu-id="e14b1-124">Using the DOM facilitates the use of XPATH queries, which can be a useful additional tool.</span></span>  
  
#### <a name="consider-defining-the-skeleton-of-your-xml-document-as-a-resource"></a><span data-ttu-id="e14b1-125">Estudie la posibilidad de definir el esqueleto del documento XML como recurso</span><span class="sxs-lookup"><span data-stu-id="e14b1-125">Consider defining the skeleton of your XML document as a resource</span></span>  
 <span data-ttu-id="e14b1-126">Si va a generar un documento XML de gran tamaño mediante una herramienta de diseño y ese documento generado siempre sigue la misma estructura básica, puede ser conveniente colocar todo el esqueleto del archivo XML en el proyecto para permitir la realización de cambios cuando sea preciso modificarlo.</span><span class="sxs-lookup"><span data-stu-id="e14b1-126">If you are generating a large XML document from a design tool and that generated document always follows the same basic structure, consider placing the whole skeletal XML file as a resource in the project to allow making changes when you need to edit it.</span></span>  
  
 <span data-ttu-id="e14b1-127">Cargue el código en un modelo de objetos de documento (DOM) y agregue los elementos necesarios al esqueleto del documento usando XPATH para seleccionar el nodo al que desee agregarlos.</span><span class="sxs-lookup"><span data-stu-id="e14b1-127">Load the code into a DOM and then add the necessary flesh to the bones of the document by using XPATH to pick out the node you want to add it to.</span></span> <span data-ttu-id="e14b1-128">En este caso, se crea un archivo Lenguaje de descripción de servicios Web (WSDL).</span><span class="sxs-lookup"><span data-stu-id="e14b1-128">In this case, you are creating a Web Services Description Language (WSDL) file.</span></span> <span data-ttu-id="e14b1-129">El asistente almacena el archivo WSDL del esqueleto en un recurso y agrega los elementos secundarios en el Lenguaje de definición de esquema XML (XSD) generados.</span><span class="sxs-lookup"><span data-stu-id="e14b1-129">The wizard stores the skeletal WSDL file in a resource and adds the generated XML Schema Definition (XSD) child parts.</span></span> <span data-ttu-id="e14b1-130">Utiliza selectNode con XPath para encontrar el elemento principal correspondiente.</span><span class="sxs-lookup"><span data-stu-id="e14b1-130">It uses selectNode with an xpath to find the right parent.</span></span> <span data-ttu-id="e14b1-131">Se trata de código de interfaz de usuario, con lo que el rendimiento no constituye un problema y la implementación resultante es limpia, robusta y mantenible.</span><span class="sxs-lookup"><span data-stu-id="e14b1-131">This is user interface code, so performance is not an issue, and the resulting implementation is clean, robust, and maintainable.</span></span>  
  
## <a name="consider-placing-processing-steps-in-the-biztalk-pipeline"></a><span data-ttu-id="e14b1-132">Estudie la posibilidad de colocar pasos de procesamiento en la canalización de BizTalk</span><span class="sxs-lookup"><span data-stu-id="e14b1-132">Consider Placing Processing Steps in the BizTalk Pipeline</span></span>  
 <span data-ttu-id="e14b1-133">En general, los adaptadores generados en Microsoft quitan del adaptador el procesamiento basado en formato de mensajes y lo colocan en la canalización de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="e14b1-133">In general the adapters built at Microsoft move message format-based processing out of the adapter and into the BizTalk pipeline.</span></span> <span data-ttu-id="e14b1-134">Un buen ejemplo de ello es un adaptador para un origen de datos estructurado que no es XML.</span><span class="sxs-lookup"><span data-stu-id="e14b1-134">A good example is an adapter to a structured but non-XML data source.</span></span>  
  
 <span data-ttu-id="e14b1-135">En este caso, el adaptador se limita a obtener los datos, y se usa la canalización de BizTalk para analizarlos y convertirlos a un equivalente de XML.</span><span class="sxs-lookup"><span data-stu-id="e14b1-135">In this case, the adapter only gets the data and the BizTalk pipeline is used to parse it and convert it into an XML equivalent.</span></span> <span data-ttu-id="e14b1-136">La ventaja es que el propio componente de canalización se convierte en una pieza reutilizable de la arquitectura.</span><span class="sxs-lookup"><span data-stu-id="e14b1-136">The benefit is that the pipeline component itself becomes a reusable piece of the architecture.</span></span>  
  
## <a name="make-adapter-behavior-configurable"></a><span data-ttu-id="e14b1-137">Permita la configuración del comportamiento del adaptador</span><span class="sxs-lookup"><span data-stu-id="e14b1-137">Make Adapter Behavior Configurable</span></span>  
 <span data-ttu-id="e14b1-138">Una de las conclusiones extraídas del programa beta del adaptador de MQSeries fue que no todos los clientes estaban satisfechos con el mismo comportamiento.</span><span class="sxs-lookup"><span data-stu-id="e14b1-138">One of the lessons learned from the MQSeries adapter beta program was that not all customers were happy with the same behavior.</span></span> <span data-ttu-id="e14b1-139">Esto se cumplía especialmente en lo relativo al control de errores y al orden.</span><span class="sxs-lookup"><span data-stu-id="e14b1-139">This was especially true when it came to handling errors and ordering.</span></span> <span data-ttu-id="e14b1-140">La solución fue hacer que el comportamiento del adaptador fuera configurable.</span><span class="sxs-lookup"><span data-stu-id="e14b1-140">The solution was to make the behavior configurable.</span></span> <span data-ttu-id="e14b1-141">Puede especificar si el adaptador admitirá la ordenación, si los fracasos se moverán a la cola de suspensión o si harán que el adaptador deje de procesar y se deshabilite.</span><span class="sxs-lookup"><span data-stu-id="e14b1-141">You can specify whether the adapter is to support ordering, whether failures are moved to the Suspended queue, or whether they cause the adapter to stop processing and disable itself.</span></span> <span data-ttu-id="e14b1-142">Permitir la configuración de este tipo de comportamientos puede simplificar de manera significativa la vida del cliente, que en caso contrario tendría que escribir orquestaciones o secuencias de comandos externas de gran complejidad a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] para lograr el mismo resultado.</span><span class="sxs-lookup"><span data-stu-id="e14b1-142">Making such behaviors configurable can significantly simplify customers' lives when they would need to write complex orchestrations or scripts external to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to achieve the same result.</span></span>  
  
## <a name="support-correlation-with-message-queues"></a><span data-ttu-id="e14b1-143">Admita la correlación con las colas de mensajes</span><span class="sxs-lookup"><span data-stu-id="e14b1-143">Support Correlation with Message Queues</span></span>  
 <span data-ttu-id="e14b1-144">Numerosas plataformas de mensajería admiten la noción de un Id. de correlación en el encabezado de mensaje para proporcionar compatibilidad con un escenario de solicitud-respuesta de nivel de aplicación.</span><span class="sxs-lookup"><span data-stu-id="e14b1-144">Many messaging platforms support the notion of a correlation ID in the message header to support an application-level request-response scenario.</span></span> <span data-ttu-id="e14b1-145">Algunos ejemplos de ello son MQSeries, MSMQ y SQL Service Broker.</span><span class="sxs-lookup"><span data-stu-id="e14b1-145">Examples include MQSeries, MSMQ, and SQL Service Broker.</span></span> <span data-ttu-id="e14b1-146">Podría parecer interesante asignar el patrón de solicitud-respuesta del sistema de mensajería externo a un adaptador de envío-respuesta de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e14b1-146">It would seem attractive to map the request-response pattern of the external messaging system to a send-response adapter in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="e14b1-147">Sin embargo, esto no tiene sentido por el lugar donde residen las transacciones.</span><span class="sxs-lookup"><span data-stu-id="e14b1-147">However this does not make sense because of where the transactions live.</span></span> <span data-ttu-id="e14b1-148">En concreto, un envío al sistema de mensajería externa exige una confirmación transaccional antes de que el otro extremo de la cola pueda ver los datos.</span><span class="sxs-lookup"><span data-stu-id="e14b1-148">Specifically, a send to the external messaging system requires a transactional commit before the other end of the queue sees the data.</span></span> <span data-ttu-id="e14b1-149">La recepción también debe ser una transacción independiente.</span><span class="sxs-lookup"><span data-stu-id="e14b1-149">The receive must also be a separate transaction.</span></span>  
  
 <span data-ttu-id="e14b1-150">La solución en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] es:</span><span class="sxs-lookup"><span data-stu-id="e14b1-150">The solution in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is to:</span></span>  
  
- <span data-ttu-id="e14b1-151">Usar conjuntos de correlaciones en la orquestación</span><span class="sxs-lookup"><span data-stu-id="e14b1-151">Use correlation sets in orchestration</span></span>  
  
- <span data-ttu-id="e14b1-152">Configurar dos puertos independientes: uno para el envío y otro para la recepción</span><span class="sxs-lookup"><span data-stu-id="e14b1-152">Configure two separate ports: one for the send and one for the receive</span></span>  
  
  <span data-ttu-id="e14b1-153">En un caso sencillo, la orquestación especifica el Id. de correlación asociado al mensaje por el adaptador.</span><span class="sxs-lookup"><span data-stu-id="e14b1-153">In a simple case the orchestration specifies the correlation ID that is associated with the message by the adapter.</span></span> <span data-ttu-id="e14b1-154">Éste se pasa al adaptador como propiedad de contexto en el mensaje.</span><span class="sxs-lookup"><span data-stu-id="e14b1-154">This is passed to the adapter as a context property on the message.</span></span> <span data-ttu-id="e14b1-155">En un caso más complejo, el escenario llama al sistema de mensajería externa asignar el identificador.</span><span class="sxs-lookup"><span data-stu-id="e14b1-155">In a more complex case, the scenario calls for the external messaging system to allocate the ID.</span></span> <span data-ttu-id="e14b1-156">En este caso se puede pasar desde el puerto de envío a la orquestación con un mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="e14b1-156">In this case it can be passed back from the send port to the orchestration with a response message.</span></span> <span data-ttu-id="e14b1-157">Este mensaje de respuesta se utiliza exclusivamente para devolver el Id., y no es la verdadera respuesta al mensaje.</span><span class="sxs-lookup"><span data-stu-id="e14b1-157">This response message is just to pass back the ID and is not the true message response.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e14b1-158">Existe una condición de anticipación en el motor de orquestación que permite que la verdadera respuesta al mensaje llegue antes que la respuesta del Id. correspondiente al envío.</span><span class="sxs-lookup"><span data-stu-id="e14b1-158">There is a race condition in the orchestration engine such that the true response to the message could win against the ID response from the send.</span></span> <span data-ttu-id="e14b1-159">Esta condición de anticipación se debe controlar en la propia orquestación.</span><span class="sxs-lookup"><span data-stu-id="e14b1-159">This race condition must be handled in the orchestration itself.</span></span>