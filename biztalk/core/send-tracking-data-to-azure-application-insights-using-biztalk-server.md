---
title: Realizar un seguimiento de los datos para Application Insights o concentradores de eventos | Documentos de Microsoft
description: Instalar feature pack para habilitar el análisis de datos de seguimiento con Azure Application Insights o concentradores de eventos de Azure en BizTalk Server
ms.custom: fp1, fp2
ms.date: 11/16/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: b3ff6cb9-44d0-46cd-9b4f-a346365afb7b
caps.latest.revision: 10
author: tordgladnordahl
ms.author: mandia
manager: anneta
ms.openlocfilehash: f5ddd60f72955c7196edfc8bf2310b73226d2abe
ms.sourcegitcommit: 32f380810b90b70e5df7be72a6a14988a747868e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/28/2018
ms.locfileid: "29710783"
---
# <a name="send-biztalk-tracking-data-to-azure-application-insights-or-event-hubs"></a><span data-ttu-id="27823-103">Enviar datos a Azure Application Insights o concentradores de eventos de seguimiento de BizTalk</span><span class="sxs-lookup"><span data-stu-id="27823-103">Send BizTalk tracking data to Azure Application Insights or Event Hubs</span></span>

<span data-ttu-id="27823-104">**A partir de [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] [!INCLUDE[featurepack1](../includes/featurepack1.md)]** , le permitirán procesar y enviar los datos de seguimiento a Azure Application Insights.</span><span class="sxs-lookup"><span data-stu-id="27823-104">**Starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] [!INCLUDE[featurepack1](../includes/featurepack1.md)]**, you can process and send your tracking data to Azure Application Insights.</span></span> 
          
<span data-ttu-id="27823-105">**A partir de [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Feature Pack 2 de**:</span><span class="sxs-lookup"><span data-stu-id="27823-105">**Starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Feature Pack 2**:</span></span>

* <span data-ttu-id="27823-106">Visión de la aplicación es compatible con instancias predeterminadas SQL y las instancias con nombre de SQL</span><span class="sxs-lookup"><span data-stu-id="27823-106">Application Insights supports SQL default instances, and SQL named instances</span></span>
* <span data-ttu-id="27823-107">Le permitirán procesar y enviar datos de seguimiento a los centros de eventos de Azure</span><span class="sxs-lookup"><span data-stu-id="27823-107">You can process and send tracking data to Azure Event Hubs</span></span>

<span data-ttu-id="27823-108">Utilice estos servicios de Azure para realizar el seguimiento de las instancias de puertos de recepción, puertos de envío y orquestaciones.</span><span class="sxs-lookup"><span data-stu-id="27823-108">Use these Azure services to track your instances from receive ports, send ports, and orchestrations.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="27823-109">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="27823-109">Prerequisites</span></span>
* <span data-ttu-id="27823-110">Crear una nueva instancia de [Application Insights](https://docs.microsoft.com/azure/application-insights/app-insights-create-new-resource).</span><span class="sxs-lookup"><span data-stu-id="27823-110">Create a new instance of [Application Insights](https://docs.microsoft.com/azure/application-insights/app-insights-create-new-resource).</span></span> <span data-ttu-id="27823-111">BizTalk Server utiliza el **clave de instrumentación** para autenticar.</span><span class="sxs-lookup"><span data-stu-id="27823-111">BizTalk Server uses the **Instrumentation Key** to authenticate.</span></span>
* <span data-ttu-id="27823-112">Crear un [concentrador de espacio de nombres y eventos de los centros de eventos de Azure](https://docs.microsoft.com/azure/event-hubs/event-hubs-create).</span><span class="sxs-lookup"><span data-stu-id="27823-112">Create an [Azure Event Hubs namespace and event hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-create).</span></span> <span data-ttu-id="27823-113">BizTalk Server utiliza la directiva de nivel del centro de eventos o SAS (nivel de espacio de nombres) para autenticar.</span><span class="sxs-lookup"><span data-stu-id="27823-113">BizTalk Server uses the SAS (namespace-level) or event hub-level policy to authenticate.</span></span>
* <span data-ttu-id="27823-114">Instalar [Feature Pack 2 de](https://aka.ms/bts2016fp2) en el</span><span class="sxs-lookup"><span data-stu-id="27823-114">Install [Feature Pack 2](https://aka.ms/bts2016fp2) on your</span></span> [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)]

## <a name="enable-analytics-for-your-environment"></a><span data-ttu-id="27823-115">Habilitar el análisis de su entorno</span><span class="sxs-lookup"><span data-stu-id="27823-115">Enable analytics for your environment</span></span>

1. <span data-ttu-id="27823-116">Abra la **administración de BizTalk Server** de la consola, haga clic en el **grupo de BizTalk**y seleccione **configuración**.</span><span class="sxs-lookup"><span data-stu-id="27823-116">Open the **BizTalk Server Administration** console, right-click the **BizTalk Group**, and select **Settings**.</span></span> 
2. <span data-ttu-id="27823-117">Comprobar **habilitar el análisis de nivel de grupo**.</span><span class="sxs-lookup"><span data-stu-id="27823-117">Check **Enable group-level analytics**.</span></span>
3. <span data-ttu-id="27823-118">Para el **tipo de destino**, seleccione **Application Insight** o **concentrador de eventos** en la lista.</span><span class="sxs-lookup"><span data-stu-id="27823-118">For the **Target type**, select **Application Insight** or **Event Hub** from the list.</span></span>
    <span data-ttu-id="27823-119">![Habilitar el análisis de su entorno](../core/media/environmentsettingapplicationinishgt.PNG)</span><span class="sxs-lookup"><span data-stu-id="27823-119">![Enable analytics for your environment](../core/media/environmentsettingapplicationinishgt.PNG)</span></span>

4. <span data-ttu-id="27823-120">Para el **parámetros de conexión**, seleccione la **...**  botón, y **inicio de sesión** a su cuenta de Azure.</span><span class="sxs-lookup"><span data-stu-id="27823-120">For the **Connection parameters**, select the **...** button, and **Sign-in** to your Azure account.</span></span>  

    <span data-ttu-id="27823-121">**Para Application Insights**</span><span class="sxs-lookup"><span data-stu-id="27823-121">**For Application Insights**</span></span>  
    <span data-ttu-id="27823-122">Seleccione el **suscripción**, **grupo de recursos**y la instancia de Application Insights.</span><span class="sxs-lookup"><span data-stu-id="27823-122">Select your **Subscription**, **Resource Group**, and your Application Insights instance.</span></span>

    ![Habilitar el análisis de su entorno](../core/media/analytics-group-application-insights.png)

    <span data-ttu-id="27823-124">**Para el concentrador de eventos**</span><span class="sxs-lookup"><span data-stu-id="27823-124">**For Event Hub**</span></span>  
    <span data-ttu-id="27823-125">Seleccione el **suscripción**, **grupo de recursos**, espacio de nombres del centro de eventos y centro de eventos.</span><span class="sxs-lookup"><span data-stu-id="27823-125">Select your **Subscription**, **Resource Group**, Event Hub namespace, and event hub.</span></span> <span data-ttu-id="27823-126">Para la autenticación, puede usar una firma de acceso (SAS) en el nivel de espacio de nombres, o la firma de entidad en el nivel del centro de eventos.</span><span class="sxs-lookup"><span data-stu-id="27823-126">For authentication, you can use an access signature (SAS) at the namespace-level, or entity signature at the event hub-level.</span></span> <span data-ttu-id="27823-127">Las claves disponibles son rellena automáticamente con los valores configurados previamente en [Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="27823-127">Your available keys are auto-populated with the values previously configured within [Azure](https://portal.azure.com).</span></span>

    ![Habilitar el análisis de su entorno](../core/media/send-tracking-data-to-azure.png)

5. <span data-ttu-id="27823-129">Seleccione **Aceptar** para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="27823-129">Select **OK** to save your changes.</span></span> 

<span data-ttu-id="27823-130">Una vez habilitada, [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] está listo para transmitir datos al recurso de Azure.</span><span class="sxs-lookup"><span data-stu-id="27823-130">Once enabled, [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] is ready to transmit data to your Azure resource.</span></span> <span data-ttu-id="27823-131">A continuación, habilitar el análisis en los puertos y orquestaciones.</span><span class="sxs-lookup"><span data-stu-id="27823-131">Next, enable analytics on your ports and orchestrations.</span></span> 

## <a name="enable-analytics-on-your-artifacts"></a><span data-ttu-id="27823-132">Habilitar el análisis en los artefactos</span><span class="sxs-lookup"><span data-stu-id="27823-132">Enable analytics on your artifacts</span></span>

1. <span data-ttu-id="27823-133">En administración de BizTalk Server, haga clic en un **puerto de recepción**, **puerto de envío** o **orquestación**y seleccione **seguimiento**.</span><span class="sxs-lookup"><span data-stu-id="27823-133">In BizTalk Server Administration, right-click a **receive port**, **send port** or **orchestration**, and select **Tracking**.</span></span>
2. <span data-ttu-id="27823-134">En **análisis**, comprobar **Habilitar análisis**, de forma similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="27823-134">Under **Analytics**, check **Enable Analytics**, similar to the following.</span></span> <span data-ttu-id="27823-135">Esta opción inicia el seguimiento y transmitir datos desde el artefacto a los recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="27823-135">This setting starts tracking and transmitting data from the artifact to your Azure resource.</span></span>
    
    ![Datos de seguimiento para la orquestación](../core/media/orchestrationsettingsapplicationinsight.PNG)

3. <span data-ttu-id="27823-137">Seleccione **Aceptar** para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="27823-137">Select **OK** to save your changes.</span></span>
4. <span data-ttu-id="27823-138">Reinicie la instancia de host de seguimiento y confirme que se inicia la aplicación de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="27823-138">Restart the tracking host Instance, and confirm the BizTalk Application is started.</span></span>

> [!TIP]
> <span data-ttu-id="27823-139">Conectar los análisis de BizTalk Server con otros sistemas para obtener más información sobre los datos de las organizaciones.</span><span class="sxs-lookup"><span data-stu-id="27823-139">Connect your BizTalk Server Analytics with other systems to gain even more insight into your organizations data.</span></span>

## <a name="view-your-data"></a><span data-ttu-id="27823-140">Ver los datos</span><span class="sxs-lookup"><span data-stu-id="27823-140">View your data</span></span>

#### <a name="use-application-insights"></a><span data-ttu-id="27823-141">Use Application Insights</span><span class="sxs-lookup"><span data-stu-id="27823-141">Use Application Insights</span></span>
<span data-ttu-id="27823-142">Una vez que los datos se envían a Application Insights, puede usar las herramientas de análisis dentro de Azure para crear consultas avanzadas y analizar los datos.</span><span class="sxs-lookup"><span data-stu-id="27823-142">Once the data is sent to Application Insights, you can use the analytics tools within Azure to create advanced queries, and analyze your data.</span></span>

1. <span data-ttu-id="27823-143">Inicie sesión en el [Portal de Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="27823-143">Sign in to the [Azure Portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="27823-144">Abra el recurso de Application Insights y seleccione **métricas explorador**.</span><span class="sxs-lookup"><span data-stu-id="27823-144">Open your Application Insights resource, and select **Metrics Explorer**.</span></span>
3. <span data-ttu-id="27823-145">Pueden mostrar gráficos vacíos.</span><span class="sxs-lookup"><span data-stu-id="27823-145">Empty charts may display.</span></span> <span data-ttu-id="27823-146">En un gráfico, seleccione **editar**.</span><span class="sxs-lookup"><span data-stu-id="27823-146">In a chart, select **Edit**.</span></span> <span data-ttu-id="27823-147">En **métricas**, seleccione **personalizado** para ver las propiedades de seguimiento disponibles.</span><span class="sxs-lookup"><span data-stu-id="27823-147">Under **Metrics**, select **Custom** to see the available tracked properties.</span></span> <span data-ttu-id="27823-148">Seleccione algunas de las distintas opciones para ver los cambios en el gráfico:</span><span class="sxs-lookup"><span data-stu-id="27823-148">Select some of the different options to see the changes on your chart:</span></span> 

    ![Análisis de Azure](../core/media/azure-stream-metrics-custom.png)

4. <span data-ttu-id="27823-150">Volver al recurso de Application Insights y seleccione **análisis**.</span><span class="sxs-lookup"><span data-stu-id="27823-150">Go back to your Application Insights resource, and select **Analytics**.</span></span> <span data-ttu-id="27823-151">En **uso**, seleccione **ejecutar**.</span><span class="sxs-lookup"><span data-stu-id="27823-151">In **Usage**, select **Run**.</span></span> <span data-ttu-id="27823-152">Se ejecuta una consulta de ejemplo y los resultados se muestran en un gráfico.</span><span class="sxs-lookup"><span data-stu-id="27823-152">A sample query is executed, and the results are displayed in a chart.</span></span>  

> [!TIP]
> <span data-ttu-id="27823-153">Azure Application Insights es una herramienta eficaz.</span><span class="sxs-lookup"><span data-stu-id="27823-153">Azure Application Insights is a powerful tool.</span></span> <span data-ttu-id="27823-154">No hay recursos para ayudarle a escribir consultas en Application Insights en [funciones analíticas en Application Insights](https://docs.microsoft.com/azure/application-insights/app-insights-analytics)e incluso para empezar a trabajar en [¿qué es Application Insights?](https://docs.microsoft.com/azure/application-insights/app-insights-overview).</span><span class="sxs-lookup"><span data-stu-id="27823-154">There are resources to help you write queries in Application Insights at [Analytics in Application Insights](https://docs.microsoft.com/azure/application-insights/app-insights-analytics), and even to get started at [What is Application Insights?](https://docs.microsoft.com/azure/application-insights/app-insights-overview).</span></span>

#### <a name="use-event-hubs"></a><span data-ttu-id="27823-155">Usar centros de eventos</span><span class="sxs-lookup"><span data-stu-id="27823-155">Use Event Hubs</span></span>
<span data-ttu-id="27823-156">Una vez que los datos se envían a los centros de eventos, hay un par de maneras para ver los datos.</span><span class="sxs-lookup"><span data-stu-id="27823-156">Once the data is sent to Event Hubs, there are a couple of ways to see the data.</span></span> <span data-ttu-id="27823-157">Muchos usuarios de los centros de eventos están usando la captura de los centros de eventos para cargar datos de transmisión por secuencias en Azure.</span><span class="sxs-lookup"><span data-stu-id="27823-157">Many Event Hubs users are using Event Hubs Capture to load streaming data into Azure.</span></span> <span data-ttu-id="27823-158">La intención es que centrarse en el procesamiento de datos, en lugar de captura de datos.</span><span class="sxs-lookup"><span data-stu-id="27823-158">The intent is for you to focus on data processing, rather than on data capture.</span></span> <span data-ttu-id="27823-159">[Captura de los centros de eventos](https://docs.microsoft.com/azure/event-hubs/event-hubs-capture-overview) explica cómo funciona y cómo se configura.</span><span class="sxs-lookup"><span data-stu-id="27823-159">[Event Hubs Capture](https://docs.microsoft.com/azure/event-hubs/event-hubs-capture-overview) explains how it works, and how to set it up.</span></span>

<span data-ttu-id="27823-160">Otra opción es crear un puerto de recepción y ubicación de recepción mediante el adaptador de concentrador de eventos.</span><span class="sxs-lookup"><span data-stu-id="27823-160">Another option is to create a receive port and receive location using the Event Hub Adapter.</span></span> <span data-ttu-id="27823-161">A continuación, puede generar los datos en una carpeta.</span><span class="sxs-lookup"><span data-stu-id="27823-161">Then, you can output the data to a folder.</span></span> <span data-ttu-id="27823-162">Esta idea puede ser la mejor si desea probar el escenario.</span><span class="sxs-lookup"><span data-stu-id="27823-162">This idea may be best if you want to test the scenario.</span></span> <span data-ttu-id="27823-163">[Adaptador de concentradores de eventos](event-hubs-adapter.md) enumera los pasos necesarios para recibir mensajes en BizTalk Server desde los centros de eventos.</span><span class="sxs-lookup"><span data-stu-id="27823-163">[Event Hubs adapter](event-hubs-adapter.md) lists the steps to receive messages into BizTalk Server from Event Hubs.</span></span>

## <a name="where-the-data-is-stored"></a><span data-ttu-id="27823-164">Donde se almacenan los datos</span><span class="sxs-lookup"><span data-stu-id="27823-164">Where the data is stored</span></span>

<span data-ttu-id="27823-165">Los datos de seguimiento deben mostrarse con bastante rapidez (dentro de unos minutos) en los recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="27823-165">Your tracking data should display fairly quickly (within a few minutes) within your Azure resources.</span></span> <span data-ttu-id="27823-166">Si no es así, puede haber un problema con el host de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="27823-166">If it doesn't, then there may be an issue with the tracking host.</span></span> <span data-ttu-id="27823-167">En SQL Server, los datos de análisis se almacenan en la base de datos BizTalkMsgBoxDb en la TrackingData_2_*x* tablas.</span><span class="sxs-lookup"><span data-stu-id="27823-167">In SQL Server, the Analytics data is stored in the BizTalkMsgBoxDb database, in the TrackingData_2_*x* tables.</span></span> <span data-ttu-id="27823-168">En SQL Server Management Studio, devuelve las 1000 filas superiores en estos cuatro tablas.</span><span class="sxs-lookup"><span data-stu-id="27823-168">In SQL Server Management Studio, return the top 1000 rows on these four tables.</span></span> <span data-ttu-id="27823-169">Si los datos existe, el host de seguimiento no es mover los datos de la base de datos de BizTalkDTADb.</span><span class="sxs-lookup"><span data-stu-id="27823-169">If the data is there, then the tracking host is not moving the data to the BizTalkDTADb database.</span></span> 

<span data-ttu-id="27823-170">Algunas soluciones posibles:</span><span class="sxs-lookup"><span data-stu-id="27823-170">Some possible resolutions:</span></span>

1. <span data-ttu-id="27823-171">Reinicie el host de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="27823-171">Restart the tracking host.</span></span>
2. <span data-ttu-id="27823-172">Crear un host de seguimiento dedicado.</span><span class="sxs-lookup"><span data-stu-id="27823-172">Create a dedicated tracking host.</span></span> <span data-ttu-id="27823-173">Cuando se instala BizTalk Server, el seguimiento puede habilitarse en el **BizTalk Server Application 1** host.</span><span class="sxs-lookup"><span data-stu-id="27823-173">When BizTalk Server is installed, tracking may be enabled on the **BizTalk Server Application 1** host.</span></span> <span data-ttu-id="27823-174">Normalmente, esta aplicación también se usa para procesar los mensajes.</span><span class="sxs-lookup"><span data-stu-id="27823-174">Typically, this application is also used to process messages.</span></span> <span data-ttu-id="27823-175">Crear un host de seguimiento dedicado siguiendo estos pasos:</span><span class="sxs-lookup"><span data-stu-id="27823-175">Create a dedicated tracking host using the following steps:</span></span> 

    1. <span data-ttu-id="27823-176">En administración de BizTalk Server, abra las propiedades del host de BizTalk Server Application 1 y desactive la opción **Permitir seguimiento de Host**.</span><span class="sxs-lookup"><span data-stu-id="27823-176">In BizTalk Server Administration, open the properties of the BizTalk Server Application 1 host, and uncheck **Allow Host Tracking**.</span></span> <span data-ttu-id="27823-177">Reinicie la instancia de host.</span><span class="sxs-lookup"><span data-stu-id="27823-177">Restart this host instance.</span></span>

    2. <span data-ttu-id="27823-178">Cree un nuevo host denominado **seguimiento**y compruebe **Permitir seguimiento de Host**.</span><span class="sxs-lookup"><span data-stu-id="27823-178">Create a new host named **Tracking**, and check **Allow Host Tracking**.</span></span> <span data-ttu-id="27823-179">Crear una instancia de host e inícielo.</span><span class="sxs-lookup"><span data-stu-id="27823-179">Create a host instance, and start it.</span></span>

<span data-ttu-id="27823-180">A continuación, volver a consultar las tablas de BizTalkMsgBoxDb TrackingData_2_x.</span><span class="sxs-lookup"><span data-stu-id="27823-180">Now, query the BizTalkMsgBoxDb TrackingData_2_x tables again.</span></span> <span data-ttu-id="27823-181">Si las tablas están vacías, a continuación, los datos se ha movido y deben comenzar a mostrar en Application Insights.</span><span class="sxs-lookup"><span data-stu-id="27823-181">If the tables are empty, then the data was moved, and should start displaying in Application Insights.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="27823-182">Vea también</span><span class="sxs-lookup"><span data-stu-id="27823-182">See also</span></span>
 [<span data-ttu-id="27823-183">Instalar y configurar el Feature Pack</span><span class="sxs-lookup"><span data-stu-id="27823-183">Install & configure the Feature Pack</span></span>](../core/configure-the-feature-pack.md)