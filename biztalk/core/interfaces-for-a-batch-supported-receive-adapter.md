---
title: Interfaces para admite lote del adaptador de recepción | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: fa6ee780-189c-41e3-9ab0-6b869e791c0a
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 9b009a3ff5b7ac8aa8f449c7b2c58ad95ededec8
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36973189"
---
# <a name="interfaces-for-a-batch-supported-receive-adapter"></a><span data-ttu-id="f1a75-102">Interfaces de un adaptador de recepción compatible con lotes</span><span class="sxs-lookup"><span data-stu-id="f1a75-102">Interfaces for a Batch-Supported Receive Adapter</span></span>
<span data-ttu-id="f1a75-103">Un adaptador de recepción siempre envía mensajes en un lote.</span><span class="sxs-lookup"><span data-stu-id="f1a75-103">A receive adapter always submits messages in a batch.</span></span> <span data-ttu-id="f1a75-104">Un lote es una unidad de operaciones de base de datos que se puede utilizar para realizar acciones que no sean envíos.</span><span class="sxs-lookup"><span data-stu-id="f1a75-104">A batch is a unit of database operations that you can use for actions other than submission.</span></span> <span data-ttu-id="f1a75-105">Por ejemplo, un adaptador de recepción puede enviar un conjunto de mensajes, suspender un conjunto diferente de mensajes y eliminar otro conjunto de mensajes en el mismo lote.</span><span class="sxs-lookup"><span data-stu-id="f1a75-105">For example, a receive adapter can submit one set of messages, suspend a different set of messages, and delete another set of messages in the same batch.</span></span> <span data-ttu-id="f1a75-106">Agrupar estas operaciones individuales en el mismo lote optimiza el rendimiento, con lo que se minimiza el número de ciclos de ida y vuelta de bases de datos necesario y se recomienda encarecidamente.</span><span class="sxs-lookup"><span data-stu-id="f1a75-106">Grouping these separate operations in the same batch optimizes performance by minimizing the number of database round trips required and is strongly encouraged.</span></span>  
  
 <span data-ttu-id="f1a75-107">Los adaptadores de recepción aislados y de tipo En curso necesitan implementar las siguientes interfaces para enviar lotes de mensajes al servidor:</span><span class="sxs-lookup"><span data-stu-id="f1a75-107">In-process and isolated receive adapters need to implement the following interfaces to submit batches of messages into the server:</span></span>  
  
- <span data-ttu-id="f1a75-108">**IBTTransport**</span><span class="sxs-lookup"><span data-stu-id="f1a75-108">**IBTTransport**</span></span>  
  
- <span data-ttu-id="f1a75-109">**IBTTransportControl** (solo adaptadores en curso)</span><span class="sxs-lookup"><span data-stu-id="f1a75-109">**IBTTransportControl** (in-process adapters only)</span></span>  
  
- <span data-ttu-id="f1a75-110">**IBTTransportConfig**</span><span class="sxs-lookup"><span data-stu-id="f1a75-110">**IBTTransportConfig**</span></span>  
  
- <span data-ttu-id="f1a75-111">**IBaseComponent**</span><span class="sxs-lookup"><span data-stu-id="f1a75-111">**IBaseComponent**</span></span>  
  
- <span data-ttu-id="f1a75-112">**IPersistPropertyBag**</span><span class="sxs-lookup"><span data-stu-id="f1a75-112">**IPersistPropertyBag**</span></span>  
  
- <span data-ttu-id="f1a75-113">**IBTBatchCallBack**</span><span class="sxs-lookup"><span data-stu-id="f1a75-113">**IBTBatchCallBack**</span></span>  
  
  <span data-ttu-id="f1a75-114">Los siguientes pasos describen la secuencia de acciones que realiza un adaptador de recepción para enviar mensajes al servidor.</span><span class="sxs-lookup"><span data-stu-id="f1a75-114">The following steps describe the sequence of actions that a receive adapter performs to submit messages into the server.</span></span>  
  
1. <span data-ttu-id="f1a75-115">Un adaptador de recepción Obtiene el lote del proxy de transporte mediante una llamada a la **GetBatch** método de la **IBTTransportProxy** interfaz.</span><span class="sxs-lookup"><span data-stu-id="f1a75-115">A receive adapter obtains the batch from the transport proxy by calling the **GetBatch** method of the **IBTTransportProxy** interface.</span></span> <span data-ttu-id="f1a75-116">En su llamada a **GetBatch** el adaptador pasa un puntero a su **IBTBatchCallback** implementación de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="f1a75-116">In its call to **GetBatch** the adapter passes in a pointer to its **IBTBatchCallback** interface implementation.</span></span>  
  
2. <span data-ttu-id="f1a75-117">Un adaptador agrega mensajes de uno a la vez en el lote mediante una llamada a la **SubmitMessage** método de la **IBTTransportBatch** interfaz.</span><span class="sxs-lookup"><span data-stu-id="f1a75-117">An adapter adds the messages one at a time into the batch by calling the **SubmitMessage** method of the **IBTTransportBatch** interface.</span></span> <span data-ttu-id="f1a75-118">Si se trata de una operación bidireccional como mensajería petición-respuesta, el **SubmitResponseMessage** se llama el método de esta misma interfaz para enviar el mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="f1a75-118">If this is a two-way operation such as solicit-response messaging, the **SubmitResponseMessage** method of this same interface is called to submit the response message.</span></span>  
  
3. <span data-ttu-id="f1a75-119">Todos los mensajes se han agregado al lote, el adaptador llama a la **realiza** método de la **IBTTransportBatch** interfaz para enviar el lote al proxy de transporte.</span><span class="sxs-lookup"><span data-stu-id="f1a75-119">When all the messages have been added to the batch, the adapter calls the **Done** method of the **IBTTransportBatch** interface to submit the batch to the transport proxy.</span></span> <span data-ttu-id="f1a75-120">Dado que recibe los adaptadores son de naturaleza asíncrona, el adaptador inmediatamente puede obtener un nuevo lote y comenzar a enviar otros mensajes después de llamar al **realiza**.</span><span class="sxs-lookup"><span data-stu-id="f1a75-120">Because receive adapters are asynchronous in nature, the adapter can immediately obtain a new batch and start submitting other messages after it calls **Done**.</span></span>  
  
4. <span data-ttu-id="f1a75-121">Una vez procesado el lote, el motor de mensajería invoca el adaptador **BatchComplete** método de devolución de llamada mediante el proxy de transporte para realizar la llamada real.</span><span class="sxs-lookup"><span data-stu-id="f1a75-121">After the batch has been processed, the Messaging Engine invokes the adapter's **BatchComplete** callback method using the transport proxy to make the actual call.</span></span> <span data-ttu-id="f1a75-122">Una matriz de **BTBatchOperationStatus** objetos que contiene el estado del envío se pasa al adaptador.</span><span class="sxs-lookup"><span data-stu-id="f1a75-122">An array of **BTBatchOperationStatus** objects containing the status of the submission is passed to the adapter.</span></span> <span data-ttu-id="f1a75-123">Cada objeto corresponde a un tipo de operación y contiene el estado general de la operación, así como el estado para cada uno de los mensajes para los que se ha realizado la operación.</span><span class="sxs-lookup"><span data-stu-id="f1a75-123">Each object corresponds to an operation type and contains the overall status of the operation as well as the status for each message for which the operation was performed.</span></span> <span data-ttu-id="f1a75-124">Las siguiente secuencia describe las acciones que el adaptador necesita realizar para analizar el estado de proceso por lotes:</span><span class="sxs-lookup"><span data-stu-id="f1a75-124">The following sequence describes the actions the adapter needs to perform to analyze the status of batch processing:</span></span>  
  
   1.  <span data-ttu-id="f1a75-125">Compruebe el estado de lote general valor HRESULT pasado como parámetro a la **BatchComplete** método.</span><span class="sxs-lookup"><span data-stu-id="f1a75-125">Check the overall batch status HRESULT value passed as a parameter to the **BatchComplete** method.</span></span> <span data-ttu-id="f1a75-126">Si se produce un error significa que al menos una de las operaciones del lote no se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="f1a75-126">If it is a failure, it means that at least one of the operations in the batch was unsuccessful.</span></span> <span data-ttu-id="f1a75-127">Por tanto, se ha producido un error en el envío del lote completo como una entidad.</span><span class="sxs-lookup"><span data-stu-id="f1a75-127">Therefore the submission of the entire batch as one entity failed.</span></span> <span data-ttu-id="f1a75-128">El adaptador debe intentar descubrir los mensajes infractores y reenviar por lotes solo los que al principio no produjeron error.</span><span class="sxs-lookup"><span data-stu-id="f1a75-128">The adapter should then try to discover the offending message(s) and resubmit as a batch only the ones that did not initially cause a failure.</span></span>  
  
        <span data-ttu-id="f1a75-129">Si el estado de lote general se completó correctamente, significa que todos los mensajes que se entregaron al proxy de transporte se han guardado en el disco.</span><span class="sxs-lookup"><span data-stu-id="f1a75-129">If the overall batch status succeeded, it means that all the messages that were given to the transport proxy were persisted to disk.</span></span> <span data-ttu-id="f1a75-130">Sin embargo, no quiere decir que la canalización haya procesado todos los mensajes correctamente.</span><span class="sxs-lookup"><span data-stu-id="f1a75-130">However, it does not mean that the pipeline successfully processed all the messages.</span></span> <span data-ttu-id="f1a75-131">Es posible que los mensajes que han producido errores en la canalización se suspendan.</span><span class="sxs-lookup"><span data-stu-id="f1a75-131">It is possible that messages that failed in the pipeline were suspended.</span></span> <span data-ttu-id="f1a75-132">En cuanto a los mensajes que producen errores en la canalización, el estado de lote general devuelto es correcto, debido a que los datos se han escrito en el disco.</span><span class="sxs-lookup"><span data-stu-id="f1a75-132">For messages that fail in the pipeline, the overall batch status returned is successful because the data was written to disk.</span></span>  
  
   2.  <span data-ttu-id="f1a75-133">Compruebe el estado de cada tipo de operación en el parámetro `operationStatus`.</span><span class="sxs-lookup"><span data-stu-id="f1a75-133">Check the status for each operation type in the `operationStatus` parameter.</span></span> <span data-ttu-id="f1a75-134">Si el estado es **S_OK**, el envío de esta operación se realizó correctamente y no es necesario comprobar el estado de cualquier aún más.</span><span class="sxs-lookup"><span data-stu-id="f1a75-134">If the status is **S_OK**, the submission for this operation succeeded and you do not need to check the status any further.</span></span> <span data-ttu-id="f1a75-135">Si el estado se establece en **BTS_S_EPM_MESSAGE_SUSPENDED** algunos de los mensajes se han suspendido.</span><span class="sxs-lookup"><span data-stu-id="f1a75-135">If the status is set to **BTS_S_EPM_MESSAGE_SUSPENDED** some of the messages were suspended.</span></span> <span data-ttu-id="f1a75-136">**BTS_S_EPM_SECURITY_CHECK_FAILED** significa que algunos mensajes de error de autenticación en el puerto de recepción de un requiere autenticación.</span><span class="sxs-lookup"><span data-stu-id="f1a75-136">**BTS_S_EPM_SECURITY_CHECK_FAILED** signifies that some messages failed authentication in an authentication-required receive port.</span></span> <span data-ttu-id="f1a75-137">Si **E_FAIL** se devuelve, o cualquier HRESULT tiene un valor que es menor que cero, el envío de mensajes de este error en la operación.</span><span class="sxs-lookup"><span data-stu-id="f1a75-137">If **E_FAIL** is returned, or any HRESULT with a value that is less than zero, the message submission for this operation failed.</span></span>  
  
   3.  <span data-ttu-id="f1a75-138">Compruebe el estado de los mensajes individuales para el tipo de operación.</span><span class="sxs-lookup"><span data-stu-id="f1a75-138">Check the status of individual messages for the operation type.</span></span> <span data-ttu-id="f1a75-139">Para el tipo de operación de envío, el estado de cada mensaje se establece en **S_OK** si el envío se realizó correctamente.</span><span class="sxs-lookup"><span data-stu-id="f1a75-139">For the submit operation type, the status of each message is set to **S_OK** if the submission succeeded.</span></span> <span data-ttu-id="f1a75-140">**BTS_S_EPM_MESSAGE_SUSPENDED** se devuelve si el mensaje se suspende.</span><span class="sxs-lookup"><span data-stu-id="f1a75-140">**BTS_S_EPM_MESSAGE_SUSPENDED** is returned if the message was suspended.</span></span> <span data-ttu-id="f1a75-141">**BTS_S_EPM_SECURITY_CHECK_FAILED** se devuelve si el mensaje de error de autenticación en un puerto de recepción que requiere autenticación.</span><span class="sxs-lookup"><span data-stu-id="f1a75-141">**BTS_S_EPM_SECURITY_CHECK_FAILED** is returned if the message failed authentication on a receive port that requires authentication.</span></span> <span data-ttu-id="f1a75-142">**E_BTS_NO_SUBSCRIPTION** vuelve a aparecer si no había suscriptores para el mensaje publicado.</span><span class="sxs-lookup"><span data-stu-id="f1a75-142">**E_BTS_NO_SUBSCRIPTION** comes back if there were no subscribers for the published message.</span></span> <span data-ttu-id="f1a75-143">Si **E_FAIL** se devuelve, o cualquier HRESULT tiene un valor que es menor que cero, el error de envío de mensaje.</span><span class="sxs-lookup"><span data-stu-id="f1a75-143">If **E_FAIL** is returned, or any HRESULT with a value that is less than zero, the message submission failed.</span></span>  
  
   4.  <span data-ttu-id="f1a75-144">Según el adaptador, es posible que desea suspender mensajes que devuelven **E_FAIL** o cualquier HRESULT que produzca errores.</span><span class="sxs-lookup"><span data-stu-id="f1a75-144">Depending on your adapter, you may want to suspend messages that return **E_FAIL** or any failing HRESULT.</span></span>  
  
5. <span data-ttu-id="f1a75-145">El **BatchComplete** método debe devolver **S_OK** o **E_FAIL** para indicar el resultado de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f1a75-145">The **BatchComplete** method needs to return either **S_OK** or **E_FAIL** to indicate the result of execution.</span></span> <span data-ttu-id="f1a75-146">Si el **BatchComplete** devuelve del método **E_FAIL** o cualquier HRESULT negativo, el proxy de transporte registra un error.</span><span class="sxs-lookup"><span data-stu-id="f1a75-146">If the **BatchComplete** method returns **E_FAIL** or any negative HRESULT, the transport proxy logs an error.</span></span>  
  
   <span data-ttu-id="f1a75-147">La ilustración siguiente muestra las interacciones de objetos implicadas en la creación de un adaptador de recepción compatible con lotes.</span><span class="sxs-lookup"><span data-stu-id="f1a75-147">The following figure shows the object interactions involved in creating a batch-supported receive adapter.</span></span>  
  
   <span data-ttu-id="f1a75-148">![](../core/media/ebiz-sdk-devadapter1.gif "ebiz_sdk_devadapter1")</span><span class="sxs-lookup"><span data-stu-id="f1a75-148">![](../core/media/ebiz-sdk-devadapter1.gif "ebiz_sdk_devadapter1")</span></span>  
   <span data-ttu-id="f1a75-149">Flujo de trabajo de un adaptador de recepción que envía un lote de mensajes</span><span class="sxs-lookup"><span data-stu-id="f1a75-149">Workflow for a receive adapter submitting a batch of messages</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1a75-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="f1a75-150">See Also</span></span>  
 <span data-ttu-id="f1a75-151">[Variables de adaptador](../core/adapter-variables.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-151">[Adapter Variables](../core/adapter-variables.md) </span></span>  
 <span data-ttu-id="f1a75-152">[Desarrollar un adaptador de recepción](../core/developing-a-receive-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-152">[Developing a Receive Adapter](../core/developing-a-receive-adapter.md) </span></span>  
 <span data-ttu-id="f1a75-153">[Crear instancias e inicializar un adaptador de recepción](../core/instantiating-and-initializing-a-receive-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-153">[Instantiating and Initializing a Receive Adapter](../core/instantiating-and-initializing-a-receive-adapter.md) </span></span>  
 <span data-ttu-id="f1a75-154">[Interfaces para un proceso en el adaptador de recepción](../core/interfaces-for-an-in-process-receive-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-154">[Interfaces for an In-Process Receive Adapter](../core/interfaces-for-an-in-process-receive-adapter.md) </span></span>  
 <span data-ttu-id="f1a75-155">[Adaptador de recepción de las interfaces para un aislado](../core/interfaces-for-an-isolated-receive-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-155">[Interfaces for an Isolated Receive Adapter](../core/interfaces-for-an-isolated-receive-adapter.md) </span></span>  
 <span data-ttu-id="f1a75-156">[Interfaces para un transaccional compatible con lotes del adaptador de recepción](../core/interfaces-for-a-transactional-batch-supported-receive-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="f1a75-156">[Interfaces for a Transactional Batch-Supported Receive Adapter](../core/interfaces-for-a-transactional-batch-supported-receive-adapter.md) </span></span>  
 [<span data-ttu-id="f1a75-157">Interfaces para un adaptador de recepción sincrónico de solicitud-respuesta</span><span class="sxs-lookup"><span data-stu-id="f1a75-157">Interfaces for a Synchronous Request-Response Receive Adapter</span></span>](../core/interfaces-for-a-synchronous-request-response-receive-adapter.md)