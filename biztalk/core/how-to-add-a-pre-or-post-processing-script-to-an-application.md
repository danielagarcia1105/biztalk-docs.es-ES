---
title: Cómo agregar una secuencia de comandos previa y posteriores al procesamiento a una aplicación | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- managing [applications], adding scripts
- managing [scripts], applications
- applications, scripts
- managing [scripts], adding
- scripts, adding to applications
- scripts
ms.assetid: 729cb236-b9cf-468a-8b98-a24d86e60d3c
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7959e0e9fe1f7733817aeddd980ea7ca96c1f5e3
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "37005661"
---
# <a name="how-to-add-a-pre--or-post-processing-script-to-an-application"></a><span data-ttu-id="77e50-102">Cómo agregar secuencias de comandos previas y posteriores al procesamiento a una aplicación</span><span class="sxs-lookup"><span data-stu-id="77e50-102">How to Add a Pre- or Post-processing Script to an Application</span></span>
<span data-ttu-id="77e50-103">En este tema se describe cómo usar la consola de administración de BizTalk Server o la línea de comandos para agregar una secuencia de comandos previa o posterior al procesamiento a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="77e50-103">This topic describes how to use the BizTalk Server Administration console or the command line to add a pre- or post-processing script to an application.</span></span> <span data-ttu-id="77e50-104">Al agregar una secuencia de comandos a una aplicación, la secuencia de comandos se incluye en el archivo .msi de la aplicación y se ejecuta cuando se importa, se instala o se desinstala la aplicación.</span><span class="sxs-lookup"><span data-stu-id="77e50-104">When you add a script to an application, the script is included in the application .msi file, and runs when the application is imported, installed, or uninstalled.</span></span>  
  
 <span data-ttu-id="77e50-105">Al agregar una secuencia de comandos, debe especificar si es una secuencia de comandos previa al procesamiento (que se ejecutará antes de que se importe la aplicación o de que se inicie la instalación) o si se trata de una secuencia de comandos posterior al procesamiento (que se ejecutará después de la importación de la aplicación o cuando finalice la instalación).</span><span class="sxs-lookup"><span data-stu-id="77e50-105">When you add a script, you must specify whether it is a pre-preprocessing script, which will run before application import or installation starts, or a post-processing script, which will run after application import or installation completes.</span></span> <span data-ttu-id="77e50-106">Las secuencias de comandos previas y posteriores al procesamiento se ejecutan también en la desinstalación, en orden inverso al que se ejecutaron durante la instalación: ejecutan secuencias de comandos previas al procesamiento después de desinstalar y ejecutan scripts posteriores al procesamiento antes de la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-106">Pre- and post-processing scripts also run at uninstallation, in the opposite order to that in which they ran at installation: pre-processing scripts run after uninstallation and post-processing scripts run before uninstallation.</span></span>  
  
 <span data-ttu-id="77e50-107">También puede quitar una secuencia de comandos de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="77e50-107">You can also remove a script from an application.</span></span> <span data-ttu-id="77e50-108">Para obtener instrucciones, consulte [cómo quitar un prefijo o un Script de posprocesamiento desde una aplicación](../core/how-to-remove-a-pre-or-post-processing-script-from-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="77e50-108">For instructions, see [How to Remove a Pre- or Post-processing Script from an Application](../core/how-to-remove-a-pre-or-post-processing-script-from-an-application.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="77e50-109">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="77e50-109">Prerequisites</span></span>  
 <span data-ttu-id="77e50-110">Para realizar los procedimientos descritos en este tema, deberá iniciar la sesión con una cuenta que sea miembro del grupo de administradores de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="77e50-110">To perform the procedures in this topic, you must be logged on with an account that is a member of the BizTalk Server Administrators group.</span></span> <span data-ttu-id="77e50-111">Para obtener más información sobre los permisos, consulte [los permisos necesarios para implementar y administrar una aplicación de BizTalk](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="77e50-111">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
## <a name="to-add-a-script-to-an-application"></a><span data-ttu-id="77e50-112">Para agregar una secuencia de comandos a una aplicación</span><span class="sxs-lookup"><span data-stu-id="77e50-112">To add a script to an application</span></span>  
  
#### <a name="using-the-biztalk-server-administration-console"></a><span data-ttu-id="77e50-113">Mediante la consola de administración de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="77e50-113">Using the BizTalk Server Administration console</span></span>  
  
1. <span data-ttu-id="77e50-114">Haga clic en **iniciar**, haga clic en **todos los programas**, haga clic en [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]y, a continuación, haga clic en **administración de BizTalk Server**.</span><span class="sxs-lookup"><span data-stu-id="77e50-114">Click **Start**, click **All Programs**, click [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2. <span data-ttu-id="77e50-115">Expanda el grupo de BizTalk, expanda Aplicaciones y, a continuación, haga clic con el botón secundario en la carpeta de la aplicación a la que desee agregar una secuencia de comandos.</span><span class="sxs-lookup"><span data-stu-id="77e50-115">Expand the BizTalk group, expand Applications, and then right-click the folder of the application to which you want to add a script.</span></span>  
  
3. <span data-ttu-id="77e50-116">Seleccione **agregar**, y realice una de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="77e50-116">Point to **Add**, and do one of the following:</span></span>  
  
   -   <span data-ttu-id="77e50-117">Haga clic en **secuencias de comandos de procesamiento previo** si desea que el script se ejecute antes de importar la aplicación o comienza la instalación o después de la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-117">Click **Pre-processing Scripts** if you want the script to run before application import or installation begins or after uninstallation.</span></span>  
  
   -   <span data-ttu-id="77e50-118">Haga clic en **secuencias de comandos posteriores al procesamiento** si desea que el script se ejecute después de la instalación o importación de la aplicación, o antes de la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-118">Click **Post-processing Scripts** if you want the script to run after application import or installation, or before uninstallation.</span></span>  
  
4. <span data-ttu-id="77e50-119">Haga clic en **agregar** y busque el archivo de script para agregar.</span><span class="sxs-lookup"><span data-stu-id="77e50-119">Click **Add** and browse to the script file to add.</span></span>  
  
5. <span data-ttu-id="77e50-120">Seleccione el archivo de script y haga clic en **abierto**.</span><span class="sxs-lookup"><span data-stu-id="77e50-120">Select the script file and click **Open**.</span></span>  
  
6. <span data-ttu-id="77e50-121">Si desea sobrescribir un archivo de script que ya existe en la aplicación, seleccione la **sobrescribir todos** casilla de verificación.</span><span class="sxs-lookup"><span data-stu-id="77e50-121">If you want to overwrite a script file that already exists in the application, select the **Overwrite all** check box.</span></span> <span data-ttu-id="77e50-122">El archivo de secuencias de comandos debe tener el mismo nombre de archivo que el que se va agregar para sobrescribirse.</span><span class="sxs-lookup"><span data-stu-id="77e50-122">The script file must have the same file name as the one being added to be overwritten.</span></span> <span data-ttu-id="77e50-123">De no ser así, se agregará la secuencia de comandos nueva, y la existente permanecerá en la aplicación sin cambios.</span><span class="sxs-lookup"><span data-stu-id="77e50-123">Otherwise the new script will be added, and the existing script will remain in the application unchanged.</span></span>  
  
7. <span data-ttu-id="77e50-124">Haga clic en el **tipo de archivo** lista desplegable y haga clic en el tipo de archivo: **BizTalk: preprocessingscript** o **BizTalk: postprocessingscript**.</span><span class="sxs-lookup"><span data-stu-id="77e50-124">Click the **File type** drop-down list and click the file type – either **System.BizTalk:PreprocessingScript** or **System.BizTalk:PostprocessingScript**.</span></span>  
  
8. <span data-ttu-id="77e50-125">Si es necesario, en **ubicación de destino** escriba la ruta de acceso donde desea que la secuencia de comandos de archivo para que se copia cuando se instala la aplicación y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="77e50-125">If necessary, in **Destination location** type the path where you want the script file to be copied when the application is installed, and then click **OK**.</span></span> <span data-ttu-id="77e50-126">La ruta predeterminada instalará la secuencia de comandos en la carpeta de instalación de la aplicación (%BTAD_InstallDir%).</span><span class="sxs-lookup"><span data-stu-id="77e50-126">The default path will install the script to the application installation folder (%BTAD_InstallDir%).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="77e50-127">Si no proporciona la ruta, la secuencia de comandos no se copiará en el sistema de archivos local durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-127">If you do not provide this path, the script will not be copied to the local file system on installation.</span></span> <span data-ttu-id="77e50-128">Si la secuencia de comandos se debe ejecutar cuando la aplicación esté desinstalada, asegúrese de proporcionar esta ruta; de lo contrario, la secuencia de comandos no estará presente en el sistema de archivos local y no se ejecutará durante la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-128">If the script should run when the application is uninstalled, be sure to provide this path; otherwise the script will not be present on the local file system and will not run during uninstallation.</span></span>  
  
 <span data-ttu-id="77e50-129">La secuencia de comandos se agrega a la aplicación y se muestra en la carpeta Recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="77e50-129">The script is added to the application and is displayed in the Resources folder of the application.</span></span>  
  
#### <a name="using-the-command-line"></a><span data-ttu-id="77e50-130">Utilizar la línea de comandos</span><span class="sxs-lookup"><span data-stu-id="77e50-130">Using the command line</span></span>  
  
1. <span data-ttu-id="77e50-131">Abra un símbolo del sistema como sigue: haga clic en **iniciar**, haga clic en **ejecutar**, tipo `cmd`y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="77e50-131">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2. <span data-ttu-id="77e50-132">Escriba el siguiente comando, sustituyendo los valores según corresponda, como se describe en la tabla que se presenta a continuación:</span><span class="sxs-lookup"><span data-stu-id="77e50-132">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
    <span data-ttu-id="77e50-133">**BTSTask AddResource** [**/ApplicationName:**<em>valor</em>] **/Type:System.BizTalk:PreProcessingScript** &#124;  **BizTalk: postprocessingscript** [**/Overwrite**] **/Source:**<em>valor</em> [**/Destination:**  <em>valor</em>] [**/Server:**<em>valor</em>] [**/Database:**<em>valor</em>] [ **/Property: args = "** <em>lista de argumentos</em>**"**]</span><span class="sxs-lookup"><span data-stu-id="77e50-133">**BTSTask AddResource** [**/ApplicationName:**<em>value</em>] **/Type:System.BizTalk:PreProcessingScript**&#124;**System.BizTalk:PostProcessingScript** [**/Overwrite**] **/Source:**<em>value</em> [**/Destination:**<em>value</em>] [**/Server:**<em>value</em>] [**/Database:**<em>value</em>][**/Property:Args="**<em>argument list</em>**"**]</span></span>  
  
    <span data-ttu-id="77e50-134">Ejemplo:</span><span class="sxs-lookup"><span data-stu-id="77e50-134">Example:</span></span>  
  
    <span data-ttu-id="77e50-135">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:PreProcessingScript / Overwrite/Source: "C:\Source Scripts\MyScript.vbs" /Destination: "C:\New Scripts\MyScript.vbs" /Server:MyDatabaseServer /Database:BizTalkMgmtDb / Property: args = "argumento1 argumento2"**</span><span class="sxs-lookup"><span data-stu-id="77e50-135">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:PreProcessingScript /Overwrite /Source:"C:\Source Scripts\MyScript.vbs" /Destination:"C:\New Scripts\MyScript.vbs" /Server:MyDatabaseServer /Database:BizTalkMgmtDb /Property:Args="argument1 argument2"**</span></span>  
  
   |<span data-ttu-id="77e50-136">Parámetro</span><span class="sxs-lookup"><span data-stu-id="77e50-136">Parameter</span></span>|<span data-ttu-id="77e50-137">Valor</span><span class="sxs-lookup"><span data-stu-id="77e50-137">Value</span></span>|  
   |---------------|-----------|  
   |<span data-ttu-id="77e50-138">**/ ApplicationName**</span><span class="sxs-lookup"><span data-stu-id="77e50-138">**/ApplicationName**</span></span>|<span data-ttu-id="77e50-139">Nombre de la aplicación de BizTalk a la que se agrega la secuencia de comandos.</span><span class="sxs-lookup"><span data-stu-id="77e50-139">Name of the BizTalk application to which to add the script.</span></span> <span data-ttu-id="77e50-140">Si no se especifica el nombre de aplicación, se utiliza la aplicación predeterminada de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="77e50-140">If the application name is not specified, the default BizTalk application is used.</span></span> <span data-ttu-id="77e50-141">Si el nombre incluye espacios, debe encerrarlo entre comillas dobles (").</span><span class="sxs-lookup"><span data-stu-id="77e50-141">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
   |<span data-ttu-id="77e50-142">**/ Tipo**</span><span class="sxs-lookup"><span data-stu-id="77e50-142">**/Type**</span></span>|<span data-ttu-id="77e50-143">**BizTalk: preprocessingscript** o **BizTalk: postprocessingscript**, según el tipo de script que se va a agregar.</span><span class="sxs-lookup"><span data-stu-id="77e50-143">**System.BizTalk:PreProcessingScript** or **System.BizTalk:PostProcessingScript**, depending on the type of script to add.</span></span> <span data-ttu-id="77e50-144">Use **BizTalk: preprocessingscript** si desea que el script se ejecute antes de importar la aplicación o la instalación o después de la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-144">Use **System.BizTalk:PreProcessingScript** if you want the script to run before application import or installation or after uninstallation.</span></span> <span data-ttu-id="77e50-145">Use **BizTalk: postprocessingscript** si desea que el script se ejecute después de la instalación o importación de la aplicación, o antes de la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-145">Use **System.BizTalk:PostProcessingScript** if you want the script to run after application import or installation, or before uninstallation.</span></span>|  
   |<span data-ttu-id="77e50-146">**/ Sobrescribir**</span><span class="sxs-lookup"><span data-stu-id="77e50-146">**/Overwrite**</span></span>|<span data-ttu-id="77e50-147">Actualice una secuencia de comandos existente.</span><span class="sxs-lookup"><span data-stu-id="77e50-147">Update an existing script.</span></span> <span data-ttu-id="77e50-148">Si no se especifica y ya existe un archivo de secuencias de comandos en la aplicación que tiene el mismo nombre que el archivo de secuencia de comandos que se agrega, se producirá un error en la operación de agregación.</span><span class="sxs-lookup"><span data-stu-id="77e50-148">If not specified, and a script file already exists in the application that has the same name as the script file being added, the add operation will fail.</span></span>|  
   |<span data-ttu-id="77e50-149">**Código fuente**</span><span class="sxs-lookup"><span data-stu-id="77e50-149">**/Source**</span></span>|<span data-ttu-id="77e50-150">Ruta completa del archivo de secuencia de comandos, incluido el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="77e50-150">Full path of the script file, including the file name.</span></span> <span data-ttu-id="77e50-151">Si la ruta incluye espacios, la debe encerrar entre comillas dobles (").</span><span class="sxs-lookup"><span data-stu-id="77e50-151">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
   |<span data-ttu-id="77e50-152">**/ Destino**</span><span class="sxs-lookup"><span data-stu-id="77e50-152">**/Destination**</span></span>|<span data-ttu-id="77e50-153">Ruta completa de la ubicación en la que se va a copiar el archivo de secuencias de comandos cuando se instale la aplicación desde el archivo MSI.</span><span class="sxs-lookup"><span data-stu-id="77e50-153">Full path of the location where the script file is to be copied when the application is installed from the MSI file.</span></span> <span data-ttu-id="77e50-154">Si no se proporciona, el archivo no se copia al sistema de archivos local durante instalación.</span><span class="sxs-lookup"><span data-stu-id="77e50-154">If not provided, the file is not copied to the local file system during installation.</span></span> <span data-ttu-id="77e50-155">Si la ruta incluye espacios, la debe encerrar entre comillas dobles (").</span><span class="sxs-lookup"><span data-stu-id="77e50-155">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
   |<span data-ttu-id="77e50-156">**/ Servidor**</span><span class="sxs-lookup"><span data-stu-id="77e50-156">**/Server**</span></span>|<span data-ttu-id="77e50-157">Nombre del servidor SQL Server que aloja la base de datos de administración de BizTalk en el formato Nombredelservidor\Nombredeinstancia,Puerto.</span><span class="sxs-lookup"><span data-stu-id="77e50-157">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="77e50-158">Sólo se necesita el nombre de instancia cuando el nombre de instancia es diferente del nombre de servidor.</span><span class="sxs-lookup"><span data-stu-id="77e50-158">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="77e50-159">Sólo se necesita el puerto cuando el servidor SQL Server utiliza un nombre de puerto diferente al predeterminado (1433)</span><span class="sxs-lookup"><span data-stu-id="77e50-159">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="77e50-160">Ejemplos:</span><span class="sxs-lookup"><span data-stu-id="77e50-160">Examples:</span></span><br /><br /> <span data-ttu-id="77e50-161">Servidor = MyServer</span><span class="sxs-lookup"><span data-stu-id="77e50-161">Server=MyServer</span></span><br /><br /> <span data-ttu-id="77e50-162">Servidor = MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="77e50-162">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="77e50-163">Si no se proporciona, se utiliza el nombre de la instancia de SQL Server que se ejecuta en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="77e50-163">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
   |<span data-ttu-id="77e50-164">**/ Base de datos**</span><span class="sxs-lookup"><span data-stu-id="77e50-164">**/Database**</span></span>|<span data-ttu-id="77e50-165">Nombre de la base de datos de administración de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="77e50-165">Name of the BizTalk Management database.</span></span> <span data-ttu-id="77e50-166">Si no se especifica, se utiliza la base de datos de administración de BizTalk que se ejecuta en la instancia local de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="77e50-166">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
   |<span data-ttu-id="77e50-167">**/ Property: args =**</span><span class="sxs-lookup"><span data-stu-id="77e50-167">**/Property:Args=**</span></span>|<span data-ttu-id="77e50-168">Cero o más argumentos.</span><span class="sxs-lookup"><span data-stu-id="77e50-168">Zero or more arguments.</span></span> <span data-ttu-id="77e50-169">Los argumentos que se proporcionen aquí pasarán a la secuencia de comandos cuando ésta se invoque.</span><span class="sxs-lookup"><span data-stu-id="77e50-169">The arguments provided here will be passed into the script when it is invoked.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="77e50-170">Vea también</span><span class="sxs-lookup"><span data-stu-id="77e50-170">See Also</span></span>  
 <span data-ttu-id="77e50-171">[Administrar secuencias de comandos previas y posteriores al procesamiento](../core/managing-pre-and-post-processing-scripts.md) </span><span class="sxs-lookup"><span data-stu-id="77e50-171">[Managing Pre- and Post-processing Scripts](../core/managing-pre-and-post-processing-scripts.md) </span></span>  
 <span data-ttu-id="77e50-172">[AddResource (comando): Script de preprocesamiento](../core/addresource-command-preprocessing-script.md) </span><span class="sxs-lookup"><span data-stu-id="77e50-172">[AddResource Command: Preprocessing Script](../core/addresource-command-preprocessing-script.md) </span></span>  
 [<span data-ttu-id="77e50-173">AddResource (comando): script de posprocesamiento</span><span class="sxs-lookup"><span data-stu-id="77e50-173">AddResource Command: Postprocessing Script</span></span>](../core/addresource-command-postprocessing-script.md)