---
title: 'P+F del adaptador de WCF: Utilizar servicios de WCF | Documentos de Microsoft'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: befa2268-8a65-465f-8086-70a66808845e
caps.latest.revision: ''
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 41d02fe0b7be1f53edaac4c18cfd7717a25c3a71
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/28/2018
---
# <a name="wcf-adapter-faq-using-wcf-services"></a><span data-ttu-id="fbc52-102">P+F del Adaptador de WCF: Utilizar Servicios de WCF</span><span class="sxs-lookup"><span data-stu-id="fbc52-102">WCF Adapter FAQ: Using WCF Services</span></span>
## <a name="how-does-biztalk-server-use-its-wcf-adapters-to-access-wcf-services"></a><span data-ttu-id="fbc52-103">¿Cómo usa BizTalk Server sus adaptadores de WCF para obtener acceso a los servicios WCF?</span><span class="sxs-lookup"><span data-stu-id="fbc52-103">How does BizTalk Server use its WCF adapters to access WCF services?</span></span>  
 <span data-ttu-id="fbc52-104">Los adaptadores de WCF de BizTalk se configuran en BizTalk Server mediante una ubicación de recepción o un puerto de envío WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-104">BizTalk WCF adapters are configured in BizTalk Server through either a WCF receive location or a send port.</span></span> <span data-ttu-id="fbc52-105">Cuando se habilita una ubicación de recepción que usa un adaptador de WCF, se crea una instancia única de ServiceHost y se inicializa para cada ubicación de recepción.</span><span class="sxs-lookup"><span data-stu-id="fbc52-105">When a receive location using a WCF adapter is enabled, a single ServiceHost instance is instantiated and initialized for each receive location.</span></span> <span data-ttu-id="fbc52-106">ServiceHost ejecuta un servicio genérico que acepta los mensajes de WCF entrantes y los convierte en mensajes de BizTalk antes de publicarlos en la base de datos de cuadro de mensajes de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="fbc52-106">The ServiceHost runs a generic service that accepts incoming WCF messages, and converts them to BizTalk messages before publishing them to the BizTalk MessageBox database.</span></span> <span data-ttu-id="fbc52-107">El servicio ServiceHost genérico es interno en la implementación del adaptador de recepción de BizTalk de WCF y expone un contrato sin tipo.</span><span class="sxs-lookup"><span data-stu-id="fbc52-107">The generic ServiceHost service is internal to the WCF BizTalk receive adapter implementation and exposes a typeless contract.</span></span> <span data-ttu-id="fbc52-108">En WCF, un contrato sin tipo consiste en firmas de funcionamiento que toman un único parámetro de tipo System.ServiceModel.Channel.Message de WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-108">In WCF, a typeless contract consists of operation signatures that take a single parameter of type WCF System.ServiceModel.Channel.Message.</span></span>  
  
 <span data-ttu-id="fbc52-109">La operación de un servicio WCF se debe marcar como IsOneWay=false si un puerto de envío de BizTalk debe obtener acceso al mismo aunque no haya ningún dato para devolver.</span><span class="sxs-lookup"><span data-stu-id="fbc52-109">The operation  of a WCF service should be marked as IsOneWay=false if they are to be accessed by a BizTalk send port even if there is no data to return.</span></span> <span data-ttu-id="fbc52-110">Las operaciones del contrato en el lado del cliente se deben anotar con IsOneWay=false y ReplyAction=”\*”.</span><span class="sxs-lookup"><span data-stu-id="fbc52-110">The operations on the client-side contract should be annotated with IsOneWay=false and ReplyAction=”\*”.</span></span>  <span data-ttu-id="fbc52-111">Además, todas las llamadas del cliente se deben marcar como IsOneWay=”false”.</span><span class="sxs-lookup"><span data-stu-id="fbc52-111">Additionally all calls from the client should be marked at IsOneWay=”false”.</span></span> <span data-ttu-id="fbc52-112">Una operación de servicio bidireccional puede devolver un valor de tipo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="fbc52-112">A two-way service operation may return a value of type Message.</span></span> <span data-ttu-id="fbc52-113">La excepción a esto es usar el adaptador de WCF-NetMsmq, ya que ejecuta una operación unidireccional que publica un mensaje en una cola MSMQ.</span><span class="sxs-lookup"><span data-stu-id="fbc52-113">The exception to this is using the WCF-NetMsmq adapter since it executes a one-way operation that posts a message into an MSMQ queue.</span></span> <span data-ttu-id="fbc52-114">En este caso, el puerto de envío puede ser unidireccional y cualquier operación se marca como IsOneWay=true.</span><span class="sxs-lookup"><span data-stu-id="fbc52-114">In this case the send port can be one-way and any service operation marked as IsOneWay=true.</span></span>  
  
 <span data-ttu-id="fbc52-115">Puede llevar a confusión que también sea posible en WCF definir isOneWay=false OperationContract en un método que realmente devuelve un valor nulo.</span><span class="sxs-lookup"><span data-stu-id="fbc52-115">It may be a little confusing that it is also possible in WCF to define an isOneWay=false OperationContract on a method that actually returns void.</span></span> <span data-ttu-id="fbc52-116">En esta situación, en realidad se devuelve un mensaje en la red creado automáticamente por el tiempo de ejecución de WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-116">In such a situation there is actually a message returned on the wire created by the WCF runtime for you.</span></span>  
  
 <span data-ttu-id="fbc52-117">Los adaptadores de WCF de BizTalk usan esta característica.</span><span class="sxs-lookup"><span data-stu-id="fbc52-117">The BizTalk WCF adapters make use of this feature.</span></span> <span data-ttu-id="fbc52-118">Cuando se especifica un puerto de BizTalk unidireccional, en realidad se obtiene un método nulo con isOneWay=false dentro de la implementación del adaptador de WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-118">When you specify a one-way BizTalk port you actually get a void method with isOneWay=false within the implementation of the WCF adapter.</span></span> <span data-ttu-id="fbc52-119">El caso es que un puerto unidireccional de BizTalk, cuando usa un canal directo como HTTP o net.tcp, en realidad corresponderá a isOneWay=false OperationContract.</span><span class="sxs-lookup"><span data-stu-id="fbc52-119">The point is that a BizTalk one-way port, when using a direct channel such as HTTP or net.tcp, will actually correspond to an isOneWay=false OperationContract.</span></span> <span data-ttu-id="fbc52-120">Los canales en cola, tal como net.msmq, son diferentes en que un puerto de BizTalk unidireccional llama a isOneWay=true OperationContract.</span><span class="sxs-lookup"><span data-stu-id="fbc52-120">Queued channels such as net.msmq are different in that a one-way BizTalk port does happen to talk to an isOneWay=true OperationContract.</span></span> <span data-ttu-id="fbc52-121">La situación es distinta, ya que el distribuidor WCF usa una transacción en el canal.</span><span class="sxs-lookup"><span data-stu-id="fbc52-121">The situation is different because the WCF dispatcher is using a transaction against the channel.</span></span>  
  
## <a name="how-do-you-create-and-use-a-custom-binding-with-a-wcf-custom-adapter"></a><span data-ttu-id="fbc52-122">¿Cómo se crea y usa un enlace personalizado con un adaptador personalizado de WCF?</span><span class="sxs-lookup"><span data-stu-id="fbc52-122">How do you create and use a custom binding with a WCF custom adapter?</span></span>  
 <span data-ttu-id="fbc52-123">Un enlace CustomBinding de WCF consta de una colección de BindingElements.</span><span class="sxs-lookup"><span data-stu-id="fbc52-123">A WCF CustomBinding consists of a collection of BindingElements.</span></span> <span data-ttu-id="fbc52-124">Un enlace CustomBinding se puede crear al combinar BindingElements preexistentes (por ejemplo, un transporte preexistente con un codificador preexistente de otro origen).</span><span class="sxs-lookup"><span data-stu-id="fbc52-124">A CustomBinding can be created by pulling together pre-existing BindingElements (for example, combining a pre-existing Transport with a pre-existing Encoder from another source).</span></span> <span data-ttu-id="fbc52-125">O bien, se puede crear al combinar un BindingElement preexistente con un BindingElement personalizado que se acaba de escribir.</span><span class="sxs-lookup"><span data-stu-id="fbc52-125">Or it can be created by combining a pre-existing BindingElement with a newly written custom BindingElement.</span></span> <span data-ttu-id="fbc52-126">Un enlace CustomBinding se puede crear con código a partir de estos componentes BindingElements, al agregarlos mediante programación.</span><span class="sxs-lookup"><span data-stu-id="fbc52-126">In code a CustomBinding can be built from these component BindingElements by adding them programmatically.</span></span> <span data-ttu-id="fbc52-127">WCF también permite esta construcción a través de la configuración de .NET (archivos de configuración).</span><span class="sxs-lookup"><span data-stu-id="fbc52-127">WCF also allows this construction through .NET Configuration (config files).</span></span> <span data-ttu-id="fbc52-128">Mediante el uso de BizTalk Server, este enlace CustomBinding puede crearse a través del adaptador personalizado de WCF de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="fbc52-128">By using BizTalk Server this CustomBinding can be created through the BizTalk WCF Custom adapter.</span></span>  
  
 <span data-ttu-id="fbc52-129">El adaptador personalizado de WCF de BizTalk no solo permite crear un nuevo enlace a partir de BindingsElements, sino que también permite configurar un nuevo enlace directamente.</span><span class="sxs-lookup"><span data-stu-id="fbc52-129">The BizTalk WCF Custom adapter not only allows you to build a new binding from BindingElements but also lets you configure a new binding directly.</span></span> <span data-ttu-id="fbc52-130">Además permite configurar comportamientos en enlaces estándar.</span><span class="sxs-lookup"><span data-stu-id="fbc52-130">It also allows you to configure behaviors on standard bindings.</span></span> <span data-ttu-id="fbc52-131">Esto es de particular utilidad porque escribir comportamientos personalizados es mucho más fácil que escribir nuevos objetos BindingElements.</span><span class="sxs-lookup"><span data-stu-id="fbc52-131">This is particularly useful because writing custom behaviors is much easier than writing new BindingElements objects.</span></span>  
  
 <span data-ttu-id="fbc52-132">Creación de un objeto BindingElement es un ejercicio de desarrollo complejo y la mejor fuente de referencia es los ejemplos WCF en HYPERLINK "http://go.microsoft.com/fwlink/?LinkId=142449" \t "_blank" http://go.microsoft.com/fwlink/?LinkId=142449.</span><span class="sxs-lookup"><span data-stu-id="fbc52-132">Building a BindingElement is an involved development exercise and the best source of reference for it is the WCF samples at  HYPERLINK "http://go.microsoft.com/fwlink/?LinkId=142449" \t "_blank" http://go.microsoft.com/fwlink/?LinkId=142449.</span></span> <span data-ttu-id="fbc52-133">Para crear un BindingElement personalizado, debe crear una clase que se derive de BindingElement.</span><span class="sxs-lookup"><span data-stu-id="fbc52-133">To create a custom BindingElement you create a class that derives from BindingElement.</span></span> <span data-ttu-id="fbc52-134">Un objeto BindingElement nuevo tendrá que estar en un ensamblado nuevo.</span><span class="sxs-lookup"><span data-stu-id="fbc52-134">A new BindingElement will have to be in a new assembly.</span></span> <span data-ttu-id="fbc52-135">Este ensamblado debe estar instalado en la memoria caché global de ensamblados (GAC) del equipo de administración donde están configurados el host, el puerto de envío y la ubicación de recepción de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="fbc52-135">This assembly must be installed into the Global Assembly Cache (GAC) of the administration computer where the BizTalk Host, send port, and receive location are configured.</span></span> <span data-ttu-id="fbc52-136">Para asociar un enlace personalizado con un puerto de envío específico o ubicación de recepción, primero debe agregarlo a la \<bindingElementExtensions\> sección del archivo machine.config en el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="fbc52-136">To associate a custom binding with a specific send port or receive location, you first need to add it to the \<bindingElementExtensions\> section of the machine.config file on the same computer.</span></span>  
  
 <span data-ttu-id="fbc52-137">Después de realizar ese cambio, a continuación, puede poner en funcionamiento la **configuración de propiedades de transporte** cuadro de diálogo para configurar el enlace.</span><span class="sxs-lookup"><span data-stu-id="fbc52-137">After making that change you can then bring up the **Transport Properties Configuration** dialog box to configure the binding.</span></span>  
  
1.  <span data-ttu-id="fbc52-138">En el **enlace** ficha, para el tipo de enlace, seleccione **customBinding**.</span><span class="sxs-lookup"><span data-stu-id="fbc52-138">On the **Binding** tab, for Binding type, select **customBinding**.</span></span>  
  
2.  <span data-ttu-id="fbc52-139">En el **enlace** panel, haga clic en **CustomBindingElement**y seleccione **Agregar extensión**.</span><span class="sxs-lookup"><span data-stu-id="fbc52-139">In the **Binding** pane, right-click **CustomBindingElement**, and select **Add Extension**.</span></span>  
  
3.  <span data-ttu-id="fbc52-140">Seleccione el elemento de enlace que especificó en el archivo machine.config y configure el enlace según se necesario.</span><span class="sxs-lookup"><span data-stu-id="fbc52-140">Select the binding element you specified in the machine.config file and configure the binding as required.</span></span> <span data-ttu-id="fbc52-141">Ahora está listo para usarse en la transmisión o recepción de mensajes.</span><span class="sxs-lookup"><span data-stu-id="fbc52-141">It is now ready to use for message transmission or receipt.</span></span>  
  
 <span data-ttu-id="fbc52-142">BizTalk realiza una validación muy limitada de un enlace personalizado cuando se ha agregado de esta manera.</span><span class="sxs-lookup"><span data-stu-id="fbc52-142">BizTalk does very limited validation for a custom binding when it has been added in this manner.</span></span> <span data-ttu-id="fbc52-143">Por lo tanto, es importante asegurarse de que los elementos de enlace se enumeran en el orden correcto.</span><span class="sxs-lookup"><span data-stu-id="fbc52-143">Therefore, it is important to ensure the binding elements are listed in the correct order.</span></span> <span data-ttu-id="fbc52-144">El elemento de enlace que desea invocar primero en tiempo de ejecución debe estar en al final del árbol de enlace CustomBindingElement del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="fbc52-144">The binding element you want invoked first at runtime must be on the bottom of the CustomBindingElement binding tree in the dialog box.</span></span> <span data-ttu-id="fbc52-145">La lista de BindingElements debe contener un transporte y este último debe encontrarse al final de la lista.</span><span class="sxs-lookup"><span data-stu-id="fbc52-145">The list of BindingElements must contain a Transport and that Transport must be at the bottom of the list.</span></span> <span data-ttu-id="fbc52-146">El conjunto de BindingElements también puede contener un codificador.</span><span class="sxs-lookup"><span data-stu-id="fbc52-146">The set of BindingElements may also contain an Encoder.</span></span> <span data-ttu-id="fbc52-147">Para obtener más información, consulte la documentación de WCF en elementos de enlace en [ http://go.microsoft.com/fwlink/?LinkId=142449 ](http://go.microsoft.com/fwlink/?LinkId=142449).</span><span class="sxs-lookup"><span data-stu-id="fbc52-147">For more information, see the WCF documentation on binding elements at [http://go.microsoft.com/fwlink/?LinkId=142449](http://go.microsoft.com/fwlink/?LinkId=142449).</span></span>  
  
## <a name="what-is-a-wcf-custom-behavior-and-how-do-i-use-one-with-biztalk-server"></a><span data-ttu-id="fbc52-148">¿Qué es un comportamiento personalizado de WCF? y cómo se usa con BizTalk Server?</span><span class="sxs-lookup"><span data-stu-id="fbc52-148">What is a WCF custom behavior and how do I use one with BizTalk Server?</span></span>  
 <span data-ttu-id="fbc52-149">Una de las ventajas de usar WCF como mecanismo de comunicación de mensajes es la oportunidad de ampliar la funcionalidad de sus servicios mediante código personalizado.</span><span class="sxs-lookup"><span data-stu-id="fbc52-149">One of the advantages of using WCF as a message communication mechanism is the opportunity to extend the functionality of its services by using custom code.</span></span> <span data-ttu-id="fbc52-150">Las extensiones del comportamiento personalizado son una de las características que distinguen a WCF de otras tecnologías de servicios web del mercado.</span><span class="sxs-lookup"><span data-stu-id="fbc52-150">Custom behavior extensions are one of the features that differentiate WCF from other Web services technologies in the market.</span></span>  
  
 <span data-ttu-id="fbc52-151">Hay diferentes puntos dentro del flujo de un mensaje de WCF para interceptar y ejecutar el procesamiento personalizado antes de que un mensaje alcance su destino final.</span><span class="sxs-lookup"><span data-stu-id="fbc52-151">There are different points within the flow of a WCF message to intercept and execute custom processing before a message reaches its final destination.</span></span> <span data-ttu-id="fbc52-152">Las extensiones de comportamiento personalizado de WCF son uno de estos tipos de mecanismos de interceptación y se pueden usar para ampliar el Servicio WCF o la funcionalidad de cliente en niveles de granularidad diferentes.</span><span class="sxs-lookup"><span data-stu-id="fbc52-152">WCF custom behavior extensions are one such type of interception mechanism and can be used to extend WCF service or client functionality at different levels of granularity.</span></span> <span data-ttu-id="fbc52-153">Las extensiones de comportamiento personalizado pueden existir en los niveles de servicio y cliente WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-153">Custom behavior extensions can exist at both the WCF service and client levels.</span></span> <span data-ttu-id="fbc52-154">La configuración de un comportamiento en la pila de llamada para un Servicio WCF no influye en el enlace de comunicación que se usa para realizar la llamada.</span><span class="sxs-lookup"><span data-stu-id="fbc52-154">Configuring a behavior on the call stack to a WCF service has no influence on the communication binding used to make the call.</span></span> <span data-ttu-id="fbc52-155">De hecho, los comportamientos suelen ser invisibles para el cliente porque no se muestran en los metadatos que un servicio publica.</span><span class="sxs-lookup"><span data-stu-id="fbc52-155">In fact, behaviors are typically invisible to the client because they are not displayed in the metadata a service publishes.</span></span> <span data-ttu-id="fbc52-156">El cliente normalmente no tiene ni idea que los comportamientos se están ejecutando durante una llamada a una operación de WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-156">The client typically has no idea that the behaviors are executing during a call to a WCF operation.</span></span>  
  
 <span data-ttu-id="fbc52-157">La capacidad de implementar el procesamiento personalizado en una llamada a un Servicio WCF es una de las principales razones por las que WCF es un paradigma de programación tan eficaz en comparación con otras maneras de comunicación entre aplicaciones web.</span><span class="sxs-lookup"><span data-stu-id="fbc52-157">The ability to easily implement custom processing in a call to a WCF service is one of the main reasons why WCF is such a rich programming paradigm compared to other ways of communication between Web applications.</span></span> <span data-ttu-id="fbc52-158">Este procesamiento personalizado puede tomar cualquier forma según impongan los requisitos de extensibilidad dentro de una aplicación web.</span><span class="sxs-lookup"><span data-stu-id="fbc52-158">This custom processing can take almost any form as dictated by extensibility requirements within a Web application.</span></span> <span data-ttu-id="fbc52-159">Los programadores pueden crear extensiones personalizadas que inspeccionen y validen la configuración del servicio o modifiquen el comportamiento de tiempo de ejecución en las aplicaciones de cliente y Servicio WCF.</span><span class="sxs-lookup"><span data-stu-id="fbc52-159">Developers can create custom extensions that inspect and validate service configuration or modify runtime behavior in WCF client and service applications.</span></span> <span data-ttu-id="fbc52-160">Comportamientos pueden complementar el procesamiento normal de mensajes, modificar el mensaje durante el procesamiento, inspeccionar determinados criterios de configuración y tome las medidas adecuadas, validar las identidades del llamador y pasar el mensaje si es correcto, etcetera. Implementar independientemente de la extensibilidad del mecanismo de procesamiento porque se trata realmente de un personalizado debe la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fbc52-160">Behaviors can supplement normal message processing, modify the message during processing, scrutinize certain configuration criteria and take appropriate action, validate identities of the caller and pass the message on if it is successful, etc. Because it is truly a custom processing mechanism you implement whatever extensibility your application needs.</span></span>  
  
 <span data-ttu-id="fbc52-161">Para usar un comportamiento personalizado de WCF en BizTalk Server, configura mediante el uso de la **comportamiento** pestaña para el adaptador de WCF-Custom o WCF-CustomIsolated para una ubicación de recepción o un puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="fbc52-161">To use a WCF custom behavior in BizTalk Server you will configure it by using the **Behavior** tab for the WCF-Custom or WCF-CustomIsolated adapter for a receive location or a send port.</span></span>