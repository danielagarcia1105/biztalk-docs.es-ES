---
title: Configurar el trabajo de copia de seguridad de BizTalk Server | Documentos de Microsoft
ms.custom: 
ms.date: 11/02/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 026622c9-fcb4-4db0-af48-1379feb30372
caps.latest.revision: "42"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 67765cfacc7753d649c14677c5399e9c2c7b1e39
ms.sourcegitcommit: 6095645d541bf84f39ff5f342f782284c22e875b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/06/2017
---
# <a name="configure-the-backup-biztalk-server-job"></a><span data-ttu-id="02956-102">Configurar el trabajo de copia de seguridad de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="02956-102">Configure the Backup BizTalk Server Job</span></span>
<span data-ttu-id="02956-103">Enumera los pasos necesarios para configurar el trabajo de copia de seguridad de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="02956-103">Lists the steps necessary to configure the Backup BizTalk Server job.</span></span>  

## <a name="overview"></a><span data-ttu-id="02956-104">Información general</span><span class="sxs-lookup"><span data-stu-id="02956-104">Overview</span></span>
<span data-ttu-id="02956-105">Después de instalar y configurar BizTalk Server, configure la copia de seguridad [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] trabajo de copia de seguridad de los datos.</span><span class="sxs-lookup"><span data-stu-id="02956-105">After you install and configure BizTalk Server, configure the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up your data.</span></span> <span data-ttu-id="02956-106">El **copia de seguridad de BizTalk Server (BizTalkMgmtDb)** trabajo incluye los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="02956-106">The **Backup BizTalk Server (BizTalkMgmtDb)** job includes the following steps:</span></span>

-   <span data-ttu-id="02956-107">Paso 1: **opción de compresión de Set**: habilitar o deshabilitar la compresión durante la copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="02956-107">Step 1 – **Set Compression Option**: Enable or disable compression during backup</span></span>

-   <span data-ttu-id="02956-108">Paso 2: **BackupFull**: total de ejecuciones de copias de seguridad de base de datos de las bases de datos de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="02956-108">Step 2 – **BackupFull**: Runs full database backups of the BizTalk Server databases</span></span>

-   <span data-ttu-id="02956-109">Paso 3: **MarkAndBackUpLog**: realiza una copia de seguridad de los registros de base de datos de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="02956-109">Step 3 – **MarkAndBackUpLog**: Backs up the BizTalk Server database logs</span></span>

-   <span data-ttu-id="02956-110">Paso 4: **Borrar historial de copia de seguridad**: elija cuánto tiempo se conserva el historial de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="02956-110">Step 4 – **Clear Backup History**: Choose how long the backup history is kept</span></span>

<span data-ttu-id="02956-111">Para configurar este trabajo, debe:</span><span class="sxs-lookup"><span data-stu-id="02956-111">To configure this job, you'll need to:</span></span>  
  
-   <span data-ttu-id="02956-112">Identificar los servidores de SQL Server principal y de destino y otras opciones de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="02956-112">Identify the primary and destination SQL Servers and other backup options</span></span>
  
-   <span data-ttu-id="02956-113">Elegir una cuenta de usuario Windows para realizar la copia de seguridad de las bases de datos y crear un inicio de sesión de SQL Server para esa cuenta.</span><span class="sxs-lookup"><span data-stu-id="02956-113">Choose a Windows user account to back up your databases and create a SQL Server login for this account</span></span>
  
-   <span data-ttu-id="02956-114">Asignar los inicios de sesión del servidor SQL Server al rol de base de datos BTS_BACKUP_USERS en las bases de datos de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="02956-114">Map SQL Server logins to the BTS_BACKUP_USERS database role in the BizTalk Server databases</span></span>
  
-   <span data-ttu-id="02956-115">Asegurarse de que el servicio MSDTC está activo en todos los nodos.</span><span class="sxs-lookup"><span data-stu-id="02956-115">Ensure MSDTC service is active on all nodes.</span></span> <span data-ttu-id="02956-116">En caso contrario, no puede agregar un servidor vinculado entre el nodo de origen y el nodo de destino</span><span class="sxs-lookup"><span data-stu-id="02956-116">Else, adding a linked server between the source node and the destination node fails</span></span>
  
## <a name="before-you-begin"></a><span data-ttu-id="02956-117">Antes de empezar</span><span class="sxs-lookup"><span data-stu-id="02956-117">Before you begin</span></span>  
  
-   <span data-ttu-id="02956-118">Determinadas operaciones de copia de seguridad y configuración requieren la pertenencia en el rol de SQL Server sysadmin.</span><span class="sxs-lookup"><span data-stu-id="02956-118">Certain configuration and backup operations require membership in the sysadmin SQL Server role.</span></span> <span data-ttu-id="02956-119">Para realizar una copia de su [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos, debe iniciar sesión en el servidor principal con una cuenta que sea miembro del rol de servidor sysadmin de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="02956-119">To back up your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must be signed in the primary server with an account that is a member of the SQL Server sysadmin Server role.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="02956-120">configuración agrega el rol de base de datos BTS_BACKUP_USERS.</span><span class="sxs-lookup"><span data-stu-id="02956-120"> configuration adds the BTS_BACKUP_USERS database role.</span></span> <span data-ttu-id="02956-121">La cuenta de usuario que se usa para hacer copia de seguridad de las bases de datos no requiere permisos de administrador del sistema (rol de SQL Server sysadmin) en todos los servidores de SQL que puede estar implicado en una copia de seguridad, excepto el servidor principal.</span><span class="sxs-lookup"><span data-stu-id="02956-121">The user account you use to back up your databases does not require System Administrator (sysadmin SQL Server role) permissions on all the SQL Servers that may be involved in a backup, except for the primary server.</span></span>  
  
-   <span data-ttu-id="02956-122">Decida qué cuenta de inicio de sesión se usa para ejecutar su [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] copias de seguridad de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="02956-122">Decide which sign in account you use to run your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] database backups.</span></span> <span data-ttu-id="02956-123">Puede usar una cuenta local, o más de una cuenta, pero generalmente resulta más fácil y más seguro crear una cuenta de usuario del dominio Windows exclusiva específicamente para este propósito.</span><span class="sxs-lookup"><span data-stu-id="02956-123">You can use a local account, and you can use more than one account, but it is generally simpler and more secure to create one dedicated Windows domain user account specifically for this purpose.</span></span> <span data-ttu-id="02956-124">Debe configurar una cuenta de inicio de sesión de SQL Server para este usuario, y el usuario debe asignarse a un inicio de sesión de SQL Server para todos los servidores SQL Server que participen en el proceso de copia de seguridad, ya sean servidores principales (origen) o secundarios (destino).</span><span class="sxs-lookup"><span data-stu-id="02956-124">You must configure a SQL Server logon account for this user, and the user must be mapped to a SQL Server login for all of the SQL Servers that participate in the backup process, either as primary (source) or secondary (destination) servers.</span></span> <span data-ttu-id="02956-125">Asigne este usuario al rol de la base de datos BTS_BACKUP_USERS de BizTalk para cada una de las bases de datos de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] de las que quiera realizar copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="02956-125">Assign this user to the BizTalk BTS_BACKUP_USERS database role for each of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases you back up.</span></span>  
  
-   <span data-ttu-id="02956-126">El trabajo de copia de seguridad de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] no elimina archivos de copia de seguridad obsoletos, por lo que la administración manual de este tipo de archivos resulta necesaria para ahorrar espacio en disco.</span><span class="sxs-lookup"><span data-stu-id="02956-126">The Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job does not delete outdated backup files, so you need to manually manage those backup files to conserve disk space.</span></span> <span data-ttu-id="02956-127">Después de crear una nueva copia de seguridad completa de las bases de datos, debería mover los archivos de copia de seguridad obsoletos a un dispositivo de almacenamiento de archivado para recuperar espacio en el disco principal.</span><span class="sxs-lookup"><span data-stu-id="02956-127">After you have created a new full backup of your databases, you should move the outdated backup files onto an archival storage device to reclaim space on the primary disk.</span></span> <span data-ttu-id="02956-128">Consulte la [paquetes SSIS](http://www.biztalkbill.com/2015/05/26/ssis-packages-to-help-management-biztalk-server-environments/) para administrar estos archivos.</span><span class="sxs-lookup"><span data-stu-id="02956-128">See the [SSIS packages](http://www.biztalkbill.com/2015/05/26/ssis-packages-to-help-management-biztalk-server-environments/) to manage these files.</span></span>  
  
-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="02956-129">no escribe datos de seguimiento directamente en la base de datos de seguimiento de BizTalk; en su lugar se almacena en caché los datos de la base de datos de cuadro de mensajes y, a continuación, se mueve a la base de datos de seguimiento de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="02956-129"> does not write tracking data directly to the BizTalk Tracking database; rather it caches the data in the MessageBox database, and then moves it to the BizTalk Tracking database.</span></span> <span data-ttu-id="02956-130">Si se pierden datos de cuadro de mensajes, es posible que también se pierdan algunos datos de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="02956-130">If MessageBox data loss occurs, some tracking data may also be lost.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="02956-131">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="02956-131">Prerequisites</span></span>  
* <span data-ttu-id="02956-132">Inicie sesión en SQL Server con una cuenta que sea miembro del rol sysadmin de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="02956-132">Sign in to SQL Server using an account that is a member of the sysadmin SQL Server role.</span></span>  
  
* <span data-ttu-id="02956-133">Configure el servicio de Agente de SQL Server para ejecutarse bajo una cuenta de dominio (recomendado, aunque se pueden usar cuentas locales), con un usuario asignado en cada instancia de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="02956-133">Configure the SQL Server Agent service to run under a domain account (recommended, although local accounts can be used), with a mapped user login on each instance of SQL Server.</span></span>  
  
## <a name="configure-the-job"></a><span data-ttu-id="02956-134">Configurar el trabajo</span><span class="sxs-lookup"><span data-stu-id="02956-134">Configure the job</span></span>  
  
1.  <span data-ttu-id="02956-135">En el servidor SQL Server que hospeda la base de datos de administración de BizTalk, abra **SQL Server Management Studio**y conectarse a su [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="02956-135">On the SQL Server that hosts the BizTalk Management database, open **SQL Server Management Studio**, and connect to your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span>  
  
2.  <span data-ttu-id="02956-136">Expanda **Agente SQL Server** y **Trabajos**.</span><span class="sxs-lookup"><span data-stu-id="02956-136">Expand **SQL Server Agent**, and expand **Jobs**.</span></span>  
  
3.  <span data-ttu-id="02956-137">Haga clic en **copia de seguridad de BizTalk Server (BizTalkMgmtDb)** y seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="02956-137">Right-click **Backup BizTalk Server (BizTalkMgmtDb)** and select **Properties**.</span></span> <span data-ttu-id="02956-138">En las propiedades del trabajo, seleccione **pasos**.</span><span class="sxs-lookup"><span data-stu-id="02956-138">In the job properties, select **Steps**.</span></span>  
  
4.  <span data-ttu-id="02956-139">Seleccione el **establecer opción de compresión** paso a paso y seleccione **editar**:</span><span class="sxs-lookup"><span data-stu-id="02956-139">Select the **Set Compression Option** step, and select **Edit**:</span></span>  

    <span data-ttu-id="02956-140">Llama a este paso la `sp_SetBackupCompression` procedimiento almacenado en la base de datos de administración de BizTalk (BizTalkMgmtDb) para establecer el valor en el `adm_BackupSettings` tabla.</span><span class="sxs-lookup"><span data-stu-id="02956-140">This step calls the `sp_SetBackupCompression` stored procedure in the BizTalk management database (BizTalkMgmtDb) to set the value on the `adm_BackupSettings` table.</span></span> <span data-ttu-id="02956-141">El procedimiento almacenado tiene un parámetro:  **@bCompression** .</span><span class="sxs-lookup"><span data-stu-id="02956-141">The stored procedure has one parameter: **@bCompression**.</span></span> <span data-ttu-id="02956-142">De forma predeterminada, se establece en **0** (compresión de copia de seguridad está desactivada).</span><span class="sxs-lookup"><span data-stu-id="02956-142">By default, it is set to **0** (backup compression is off).</span></span> <span data-ttu-id="02956-143">Para aplicar compresión, cambie el valor a **1**:</span><span class="sxs-lookup"><span data-stu-id="02956-143">To apply compression, change the value to **1**:</span></span>  
  
    ```  
    exec [dbo].[sp_SetBackupCompression] @bCompression = 1 /*0 - Do not use Compression, 1 - Use Compression */  
    ```  
  
     <span data-ttu-id="02956-144">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="02956-144">Select **OK**.</span></span>  
  
5.  <span data-ttu-id="02956-145">Seleccione el **BackupFull** paso a paso y seleccione **editar**.</span><span class="sxs-lookup"><span data-stu-id="02956-145">Select the **BackupFull** step, and select **Edit**.</span></span> <span data-ttu-id="02956-146">En el **comando** cuadro, actualice los valores de parámetro:</span><span class="sxs-lookup"><span data-stu-id="02956-146">In the **Command** box, update the parameter values:</span></span>  
  
    1. <span data-ttu-id="02956-147">**Frecuencia**: el valor predeterminado es **d.** (diariamente;) que es la configuración recomendada.</span><span class="sxs-lookup"><span data-stu-id="02956-147">**Frequency**: The default is **d** (daily); which is the recommended setting.</span></span> <span data-ttu-id="02956-148">Otros valores son **h** (cada hora), **w** (semanalmente), **m** (mensualmente), o **y** (anualmente).</span><span class="sxs-lookup"><span data-stu-id="02956-148">Other values include **h** (hourly), **w** (weekly), **m** (monthly), or **y** (yearly).</span></span>  
  
    2. <span data-ttu-id="02956-149">**Nombre**: el valor predeterminado es **BTS**.</span><span class="sxs-lookup"><span data-stu-id="02956-149">**Name**: The default is **BTS**.</span></span> <span data-ttu-id="02956-150">El nombre se usa como parte del nombre del archivo de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="02956-150">The name is used as part of the backup file name.</span></span>  
  
    3. <span data-ttu-id="02956-151">**Ubicación de archivos de copia de seguridad**: reemplazar '*\<ruta de acceso de destino >*' con la ruta de acceso completa (la ruta de acceso debe incluir las comillas simples) del equipo y la carpeta donde desea realizar una copia de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de datos.</span><span class="sxs-lookup"><span data-stu-id="02956-151">**Location of backup files**: Replace '*\<destination path>*' with the full path (the path must include the single quotes) to the computer and folder where you want to back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  

        > [!IMPORTANT]
        >  - <span data-ttu-id="02956-152">Si escribe una ruta de acceso local, tendrá que copiar manualmente todos los archivos en la misma carpeta del sistema de destino siempre que la copia de seguridad [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] trabajo crea nuevos archivos.</span><span class="sxs-lookup"><span data-stu-id="02956-152">If you enter a local path, then you have to manually copy all the files to the same folder on the destination system whenever the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job creates new files.</span></span>  
        >   
        >      <span data-ttu-id="02956-153">Para especificar una ruta de acceso remoto, especifique un recurso compartido UNC como \\ \\  *\<ServerName >*\\*\<SharedDrive >* \\ , donde  *\<ServerName >* es el nombre del servidor donde desea que los archivos, y  *\<SharedDrive >* es el nombre de la unidad o carpeta compartida.</span><span class="sxs-lookup"><span data-stu-id="02956-153">To specify a remote path, enter a UNC share such as \\\\*\<ServerName>*\\*\<SharedDrive>*\\, where *\<ServerName>* is the name of the server where you want the files, and *\<SharedDrive>* is name of the shared drive or folder.</span></span>  
        >   
        >      <span data-ttu-id="02956-154">La creación de copias de seguridad de datos a través de la red está sujeta a posibles problemas de red.</span><span class="sxs-lookup"><span data-stu-id="02956-154">Backing up data over a network is subject to any network issues.</span></span> <span data-ttu-id="02956-155">Si usa una ubicación remota, al finalizar el trabajo de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] de copia de seguridad, compruebe que la copia de seguridad se haya creado correctamente.</span><span class="sxs-lookup"><span data-stu-id="02956-155">When using a remote location, verify the backup succeeded when the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job finishes.</span></span>  
        > - <span data-ttu-id="02956-156">Para evitar una pérdida de datos potencial, configure un disco de copia de seguridad distinto de los discos de registro y de datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="02956-156">To avoid potential data loss, configure the backup disk to be a different disk than the database data and log disks.</span></span> <span data-ttu-id="02956-157">De este modo, podrá acceder a las copias de seguridad en caso de error en el disco de registro o datos.</span><span class="sxs-lookup"><span data-stu-id="02956-157">This is necessary so you can access the backups if the data or log disk fails.</span></span>  

    4. <span data-ttu-id="02956-158">Opcional.</span><span class="sxs-lookup"><span data-stu-id="02956-158">Optional.</span></span> <span data-ttu-id="02956-159">**Forzar copia de seguridad completa después de los errores de copia de seguridad parciales** (@ForceFullBackupAfterPartialSetFailure): el valor predeterminado es **0**.</span><span class="sxs-lookup"><span data-stu-id="02956-159">**Force full backup after partial backup failures** (@ForceFullBackupAfterPartialSetFailure): The default is **0**.</span></span> <span data-ttu-id="02956-160">Si se produce un error en una copia de seguridad del registro, no hay copias de seguridad completas se ejecutó hasta que se alcance el siguiente intervalo de frecuencia de copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="02956-160">If a log backup fails, no full backups are ran until the next full backup frequency interval is reached.</span></span> <span data-ttu-id="02956-161">Reemplace por **1** si desea que se ejecutó una copia de seguridad completa cada vez que se produce un error de copia de seguridad del registro.</span><span class="sxs-lookup"><span data-stu-id="02956-161">Replace with **1** if you want a full backup ran whenever a log backup failure occurs.</span></span>
    
    5. <span data-ttu-id="02956-162">Opcional.</span><span class="sxs-lookup"><span data-stu-id="02956-162">Optional.</span></span> <span data-ttu-id="02956-163">**Hora local para el proceso de copia de seguridad ejecutar**: el valor predeterminado es NULL.</span><span class="sxs-lookup"><span data-stu-id="02956-163">**Local time hour for the backup process to run**: The default is NULL.</span></span> <span data-ttu-id="02956-164">El trabajo de copia de seguridad no está asociado a la zona horaria de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] equipo y se ejecuta a medianoche UTC (0000) de tiempo.</span><span class="sxs-lookup"><span data-stu-id="02956-164">The backup job is not associated with the time zone of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, and runs at midnight UTC time (0000).</span></span> <span data-ttu-id="02956-165">Si desea que copia de seguridad a una hora concreta en la zona horaria de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] equipo, escriba un valor entero comprendido entre 0 (medianoche) a 23 (11 PM) como la hora local para la **BackupHour** parámetro.</span><span class="sxs-lookup"><span data-stu-id="02956-165">If you want to backup at a specific hour in the time zone of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, enter an integer value from 0 (midnight) to 23 (11 PM) as the local time hour for the **BackupHour** parameter.</span></span> 

    6. <span data-ttu-id="02956-166">Opcional.</span><span class="sxs-lookup"><span data-stu-id="02956-166">Optional.</span></span> <span data-ttu-id="02956-167">**Usar la hora local** (@UseLocalTime): indica el procedimiento para usar la hora local.</span><span class="sxs-lookup"><span data-stu-id="02956-167">**Use local time** (@UseLocalTime): Tells the procedure to use local time.</span></span> <span data-ttu-id="02956-168">El valor predeterminado es 0 y utiliza 01:34:11.933 de 2007-05-04 de – GETUTCDATE(): hora UTC actual.</span><span class="sxs-lookup"><span data-stu-id="02956-168">The default value is 0, and uses current UTC time – GETUTCDATE() – 2007-05-04 01:34:11.933.</span></span> <span data-ttu-id="02956-169">Si se establece en 1, a continuación, utiliza hora local: GETDATE() – 2007-05-03 18:34:11.933</span><span class="sxs-lookup"><span data-stu-id="02956-169">If set to 1, then it uses local time – GETDATE() – 2007-05-03 18:34:11.933</span></span>
  
    <span data-ttu-id="02956-170">En el ejemplo siguiente, copias de seguridad diarias son creados a las 2 a.m. y se almacena en la unidad m:\:</span><span class="sxs-lookup"><span data-stu-id="02956-170">In the following example, daily backups are created at 2am, and stored in the m:\ drive:</span></span>  
  
    ```  
    exec [dbo].[sp_BackupAllFull_Schedule]   
    'd' /* Frequency */,   
    'BTS' /* Name */,   
    'm:\BizTalkBackups' /* location of backup files */,   
    0 /* 0 (default) or 1 ForceFullBackupAfterPartialSetFailure */,   
    '2' /* local time hour for the backup process to run */  
    ```  
  
     <span data-ttu-id="02956-171">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="02956-171">Select **OK**.</span></span>  
  
6.  <span data-ttu-id="02956-172">Seleccione el **MarkAndBackupLog** paso a paso y seleccione **editar**.</span><span class="sxs-lookup"><span data-stu-id="02956-172">Select the **MarkAndBackupLog** step, and select **Edit**.</span></span> <span data-ttu-id="02956-173">En el **comando** cuadro, actualice los valores de parámetro:</span><span class="sxs-lookup"><span data-stu-id="02956-173">In the **Command** box, update the parameter values:</span></span>  
  
    1.  <span data-ttu-id="02956-174">**@MarkName**: Esto forma parte de la convención de nomenclatura para archivos de copia de seguridad: <Server Name>  _<Database Name>  **_registro_**< nombre de la marca de registro >_<Timestamp></span><span class="sxs-lookup"><span data-stu-id="02956-174">**@MarkName**: This is part of the naming convention for backup files: <Server Name>_<Database Name>**_Log_**< Log Mark Name >_<Timestamp></span></span>  
    
    2.  <span data-ttu-id="02956-175">**@BackupPath**: Ruta de destino completa (incluidas las comillas simples) del equipo y la carpeta donde desea almacenar el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="02956-175">**@BackupPath**: Full destination path (including single quotes) to the computer and folder where you want to store the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] database logs.</span></span> <span data-ttu-id="02956-176">El  *\<ruta de acceso de destino >* puede ser local o una ruta de acceso UNC a otro servidor.</span><span class="sxs-lookup"><span data-stu-id="02956-176">The *\<destination path>* may be local or a UNC path to another server.</span></span>  
  
     <span data-ttu-id="02956-177">El paso MarkAndBackupLog marca los registros para realizar la copia de seguridad y después realiza la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="02956-177">The MarkAndBackupLog step marks the logs for backup, and then backs them up.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="02956-178">Para evitar **posible pérdida de datos** y **mejora del rendimiento**,  *\<ruta de acceso de destino >* debe establecerse en un equipo diferente, o unidad de disco duro, diferente de la que se usa para almacenar los registros de base de datos original.</span><span class="sxs-lookup"><span data-stu-id="02956-178">To avoid **potential data loss** and for **performance improvement**, the *\<destination path>* should be set to a different computer, or hard drive, different from what is used to store the original database logs.</span></span>  
  
     <span data-ttu-id="02956-179">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="02956-179">Select **OK**.</span></span>  
  
7.  <span data-ttu-id="02956-180">Seleccione el **Borrar historial de copia de seguridad** paso a paso y seleccione **editar**.</span><span class="sxs-lookup"><span data-stu-id="02956-180">Select the **Clear Backup History** step, and select **Edit**.</span></span> <span data-ttu-id="02956-181">En el **comando** cuadro, actualice los valores de parámetro:</span><span class="sxs-lookup"><span data-stu-id="02956-181">In the **Command** box, update the parameter values:</span></span>  
  
    1.  <span data-ttu-id="02956-182">**@DaysToKeep**: Valor predeterminado es **14 días**.</span><span class="sxs-lookup"><span data-stu-id="02956-182">**@DaysToKeep**: Default value is **14 days**.</span></span> <span data-ttu-id="02956-183">Determina cuánto tiempo se conserva el historial de copia de seguridad el `Adm_BackupHistory` tabla.</span><span class="sxs-lookup"><span data-stu-id="02956-183">Determines how long the backup history is kept in the `Adm_BackupHistory` table.</span></span> <span data-ttu-id="02956-184">Borrar periódicamente el historial de copia de seguridad ayuda a mantener la `Adm_BackupHistory` tabla con un tamaño adecuado.</span><span class="sxs-lookup"><span data-stu-id="02956-184">Periodically clearing the backup history helps maintain the `Adm_BackupHistory` table to an appropriate size.</span></span> 
    
    2.  <span data-ttu-id="02956-185">Opcional.</span><span class="sxs-lookup"><span data-stu-id="02956-185">Optional.</span></span> <span data-ttu-id="02956-186">**@UseLocalTime**: Indica el procedimiento para usar la hora local.</span><span class="sxs-lookup"><span data-stu-id="02956-186">**@UseLocalTime**: Tells the procedure to use local time.</span></span> <span data-ttu-id="02956-187">El valor predeterminado es 0.</span><span class="sxs-lookup"><span data-stu-id="02956-187">The default value is 0.</span></span> <span data-ttu-id="02956-188">Usa 01:34:11.933 de 2007-05-04 de – GETUTCDATE(): hora UTC actual.</span><span class="sxs-lookup"><span data-stu-id="02956-188">It uses current UTC time – GETUTCDATE() – 2007-05-04 01:34:11.933.</span></span> <span data-ttu-id="02956-189">Si se establece en 1, a continuación, utiliza hora local: GETDATE() – 2007-05-03 18:34:11.933</span><span class="sxs-lookup"><span data-stu-id="02956-189">If set to 1, then it uses local time – GETDATE() – 2007-05-03 18:34:11.933</span></span>
  
    ```  
    exec [dbo].[sp_DeleteBackupHistory] @DaysToKeep=14, @UseLocalTime =1 
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="02956-190">Este paso **no** eliminar archivos de copia de seguridad de la ruta de acceso de destino.</span><span class="sxs-lookup"><span data-stu-id="02956-190">This step **does not** delete backup files from the destination path.</span></span>  
    
     <span data-ttu-id="02956-191">Seleccione **Aceptar** y cierre todas las ventanas de propiedad.</span><span class="sxs-lookup"><span data-stu-id="02956-191">Select **OK** and close all property windows.</span></span>  
  
8.  <span data-ttu-id="02956-192">Opcional.</span><span class="sxs-lookup"><span data-stu-id="02956-192">Optional.</span></span> <span data-ttu-id="02956-193">Cambiar la programación de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="02956-193">Change the backup schedule.</span></span> <span data-ttu-id="02956-194">Vea [cómo programar el trabajo de copia de seguridad de BizTalk Server](../core/how-to-schedule-the-backup-biztalk-server-job.md).</span><span class="sxs-lookup"><span data-stu-id="02956-194">See [How to Schedule the Backup BizTalk Server Job](../core/how-to-schedule-the-backup-biztalk-server-job.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="02956-195">El trabajo de copia de seguridad de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] se ejecuta la primera vez que lo configura.</span><span class="sxs-lookup"><span data-stu-id="02956-195">The Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job runs the first time you configure it.</span></span> <span data-ttu-id="02956-196">De forma predeterminada, en las ejecuciones posteriores, la copia de seguridad [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] trabajo se complete una copia de seguridad completa una vez al día y complete las copias de seguridad de registros cada 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="02956-196">By default, on subsequent runs, the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job completes a full backup once a day, and completes log backups every 15 minutes.</span></span>  
  
9. <span data-ttu-id="02956-197">Haga clic en el **copia de seguridad de BizTalk Server** de trabajo y seleccione **habilitar**.</span><span class="sxs-lookup"><span data-stu-id="02956-197">Right-click the **Backup BizTalk Server** job, and select **Enable**.</span></span> <span data-ttu-id="02956-198">El estado debería cambiar a **correcto**.</span><span class="sxs-lookup"><span data-stu-id="02956-198">The status should change to **Success**.</span></span>  
  
## <a name="spforcefullbackup-stored-procedure"></a><span data-ttu-id="02956-199">procedimiento almacenado sp_ForceFullBackup</span><span class="sxs-lookup"><span data-stu-id="02956-199">sp_ForceFullBackup stored procedure</span></span>  
  
<span data-ttu-id="02956-200">El **sp_ForceFullBackup** procedimiento almacenado en el **BizTalkMgmtDb** base de datos puede utilizarse para ejecutar un "ad-hoc" copia de seguridad completa de los archivos de datos y de registro.</span><span class="sxs-lookup"><span data-stu-id="02956-200">The **sp_ForceFullBackup** stored procedure in the **BizTalkMgmtDb** database can be used to run an ad-hoc full backup of the data and log files.</span></span> <span data-ttu-id="02956-201">El procedimiento almacenado actualiza la tabla adm_ForceFullBackup con un valor de 1.</span><span class="sxs-lookup"><span data-stu-id="02956-201">The stored procedure updates the adm_ForceFullBackup table with a value 1.</span></span> <span data-ttu-id="02956-202">La próxima vez que se ejecute el trabajo [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] de copia de seguridad, se creará un conjunto completo de copias de seguridad de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="02956-202">The next time the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job is ran, a full database backup set is created.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="02956-203">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="02956-203">Next Steps</span></span>  
 <span data-ttu-id="02956-204">[Cómo configurar el sistema de destino de trasvase de registros](../core/how-to-configure-the-destination-system-for-log-shipping.md) </span><span class="sxs-lookup"><span data-stu-id="02956-204">[How to Configure the Destination System for Log Shipping](../core/how-to-configure-the-destination-system-for-log-shipping.md) </span></span>  
 [<span data-ttu-id="02956-205">Cómo programar el trabajo de copia de seguridad de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="02956-205">How to Schedule the Backup BizTalk Server Job</span></span>](../core/how-to-schedule-the-backup-biztalk-server-job.md)
