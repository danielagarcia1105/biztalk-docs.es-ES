---
title: La base de datos de cuadro de mensajes | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- messages, MessageBox database
- messages, suspended messages
- MessageBox database, messages
- MessageBox database, about MessageBox database
- MessageBox database, suspended messages
- suspended messages
- MessageBox database
- suspended messages, MessageBox database
ms.assetid: f89eb02c-1b83-4127-8a91-e78fb4a1f96e
caps.latest.revision: 15
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cec97829d96aa81403a4f4457cb1aebf9c3d9522
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36966381"
---
# <a name="the-messagebox-database"></a><span data-ttu-id="e6c83-102">La base de datos de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="e6c83-102">The MessageBox Database</span></span>
<span data-ttu-id="e6c83-103">El núcleo del motor de suscripción o publicación de Microsoft BizTalk Server es la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-103">The heart of the publish/subscribe engine in Microsoft BizTalk Server is the MessageBox database.</span></span> <span data-ttu-id="e6c83-104">El cuadro de mensajes está formado por dos componentes: una o varias bases de datos de Microsoft SQL Server y el agente de mensajería.</span><span class="sxs-lookup"><span data-stu-id="e6c83-104">The MessageBox is made up of two components: one or more Microsoft SQL Server databases and the Messaging Agent.</span></span> <span data-ttu-id="e6c83-105">La base de datos de SQL Server proporciona el almacén de persistencia para numerosos componentes, entre los que se incluyen, entre otros, mensajes, partes de mensaje, propiedades de mensaje, suscripciones, estados de orquestación, datos de seguimiento y colas de host para el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="e6c83-105">The SQL Server database provides the persistence store for many things including messages, message parts, message properties, subscriptions, orchestration state, tracking data, host queues for routing, and others.</span></span> <span data-ttu-id="e6c83-106">El grupo de BizTalk Server puede poseer una o varias bases de datos de cuadro de mensajes, en las que se van a publicar mensajes y desde las que los suscriptores de esos mensajes extraerán mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-106">The BizTalk Server group may have one or more MessageBox databases into which it publishes messages and from which subscribers to those messages extract messages.</span></span>  
  
 <span data-ttu-id="e6c83-107">La base de datos proporciona algunos de los aspectos lógicos relacionados con el enrutamiento de mensajes y la cumplimentación de suscripciones.</span><span class="sxs-lookup"><span data-stu-id="e6c83-107">The database provides some of the logic related to routing messages and fulfilling subscriptions.</span></span> <span data-ttu-id="e6c83-108">No obstante, el agente de mensaje es el componente que encapsula y abstrae el componente de base de datos. Además, constituye la interfaz que BizTalk Server utiliza para interactuar con el cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-108">The Message Agent, however, is the component that encapsulates and abstracts the database component and is the interface used by BizTalk Server to interact with the MessageBox.</span></span> <span data-ttu-id="e6c83-109">El agente de mensaje es un componente COM (Modelo de objetos componentes) que proporciona interfaces para publicar mensajes, suscribirse a los mensajes, recuperarlos, etc.</span><span class="sxs-lookup"><span data-stu-id="e6c83-109">The Message Agent is a Component Object Model (COM) component that provides interfaces for publishing messages, subscribing to messages, retrieving messages, and so on.</span></span> <span data-ttu-id="e6c83-110">Esta interfaz constituye el único mecanismo que utilizan los demás componentes de BizTalk Server, entre los que se incluyen el marco de trabajo de los adaptadores y las orquestaciones, para interactuar con el cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="e6c83-110">This interface is the only mechanism used by other BizTalk Server components, including the adapter framework and orchestrations, to interact with the MessageBox.</span></span>  
  
## <a name="the-messagebox-and-the-message"></a><span data-ttu-id="e6c83-111">El cuadro de mensajes y el mensaje</span><span class="sxs-lookup"><span data-stu-id="e6c83-111">The MessageBox and the Message</span></span>  
 <span data-ttu-id="e6c83-112">Una suscripción de base de datos de cuadro de mensajes es un conjunto formado por información de servicio e información establecida.</span><span class="sxs-lookup"><span data-stu-id="e6c83-112">A MessageBox database subscription is a set of established information and service information.</span></span> <span data-ttu-id="e6c83-113">La información establecida (o predicado) son los criterios que debe cumplir todo mensaje.</span><span class="sxs-lookup"><span data-stu-id="e6c83-113">The established (or predicate) information is the criteria that a message must meet.</span></span> <span data-ttu-id="e6c83-114">La información de servicio es la acción que se emprende con el mensaje que cumple los criterios.</span><span class="sxs-lookup"><span data-stu-id="e6c83-114">The service information is what to do with the message that meets the criteria.</span></span> <span data-ttu-id="e6c83-115">Todos estos datos se almacenan en un conjunto de tablas que llaman al motor de orquestaciones y de mensajería.</span><span class="sxs-lookup"><span data-stu-id="e6c83-115">All of this information is stored in a set of tables that call the messaging and orchestration engine.</span></span>  
  
 <span data-ttu-id="e6c83-116">Cuando BizTalk Server recibe un mensaje, lo procesa en una canalización y lo coloca en la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-116">When BizTalk Server receives a message, it processes the message in a pipeline, and places the message in the MessageBox database.</span></span> <span data-ttu-id="e6c83-117">El mensaje entrante tiene un contexto.</span><span class="sxs-lookup"><span data-stu-id="e6c83-117">The incoming message has a context.</span></span> <span data-ttu-id="e6c83-118">El contexto de mensaje hace referencia a un conjunto de propiedades que se asocian al mensaje.</span><span class="sxs-lookup"><span data-stu-id="e6c83-118">The message context is a set of properties associated with the message.</span></span> <span data-ttu-id="e6c83-119">Los tres tipos de propiedades de contexto de mensaje son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="e6c83-119">The three types of message context properties are:</span></span>  
  
- <span data-ttu-id="e6c83-120">Propiedades escritas simples</span><span class="sxs-lookup"><span data-stu-id="e6c83-120">Simple written properties</span></span>  
  
- <span data-ttu-id="e6c83-121">Propiedades promocionadas</span><span class="sxs-lookup"><span data-stu-id="e6c83-121">Promoted properties</span></span>  
  
- <span data-ttu-id="e6c83-122">Propiedades de predicado</span><span class="sxs-lookup"><span data-stu-id="e6c83-122">Predicate properties</span></span>  
  
  <span data-ttu-id="e6c83-123">Los propiedades de mensaje promocionadas y de predicado reflejan el proceso empresarial que se suscribe a este mensaje. Señala, además, si el proceso empresarial dispone de los permisos necesarios para recibir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="e6c83-123">The promoted and predicate message properties indicate the business process that subscribes to this message, and whether the business process has the permissions necessary to receive the message.</span></span>  
  
  <span data-ttu-id="e6c83-124">Si un proceso empresarial se suscribe al mensaje, la base de datos de cuadro de mensajes envía el mensaje al proceso empresarial.</span><span class="sxs-lookup"><span data-stu-id="e6c83-124">If a business process subscribes to the message, the MessageBox database sends the message to the business process.</span></span> <span data-ttu-id="e6c83-125">Cuando el proceso empresarial recibe el mensaje, lo procesa en una instancia de host disponible.</span><span class="sxs-lookup"><span data-stu-id="e6c83-125">When the business process receives the message, it processes the message on an available host instance.</span></span> <span data-ttu-id="e6c83-126">Después de procesar el mensaje, si el proceso empresarial se suscribe a una canalización o puerto de envío, el proceso empresarial envía un mensaje devuelto a la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-126">After processing the message, if the business process subscribes to a pipeline or send port, the business process sends a return message to the MessageBox database.</span></span>  
  
  <span data-ttu-id="e6c83-127">En cada host de BizTalk, el cuadro de mensajes asociado posee una cola de trabajo y una cola de suspensión.</span><span class="sxs-lookup"><span data-stu-id="e6c83-127">For each BizTalk Host, the associated MessageBox has one work queue and one suspended queue.</span></span> <span data-ttu-id="e6c83-128">Además, todas las bases de datos de cuadro de mensajes contienen un conjunto de tablas para los estados estáticos, estados dinámicos y estados de instancias.</span><span class="sxs-lookup"><span data-stu-id="e6c83-128">Additionally, each MessageBox database contains a set of tables for static states, dynamic states, and instance state.</span></span> <span data-ttu-id="e6c83-129">Para obtener información acerca de los Hosts de BizTalk, consulte [entidades](../core/entities.md).</span><span class="sxs-lookup"><span data-stu-id="e6c83-129">For information about BizTalk Hosts, see [Entities](../core/entities.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="e6c83-130">Si un host pasa a estar no disponible (por ejemplo, la base de datos de cuadro de mensajes que recibe mensajes del host pasa a estar no disponible), todas las bases de datos de cuadro de mensajes se establecen también como no disponibles.</span><span class="sxs-lookup"><span data-stu-id="e6c83-130">If a host becomes unavailable --for example, the MessageBox database that receives messages from that host becomes unavailable, all other MessageBox databases become unavailable.</span></span>  
  
 <span data-ttu-id="e6c83-131">Cree la primera base de datos cuando ejecute el Asistente para configuración.</span><span class="sxs-lookup"><span data-stu-id="e6c83-131">You create the first MessageBox database when you run the Configuration Wizard.</span></span> <span data-ttu-id="e6c83-132">La base de datos de cuadro de mensajes configurada se convierte en la base de datos de cuadro de mensajes principal.</span><span class="sxs-lookup"><span data-stu-id="e6c83-132">The MessageBox database that is configured becomes the master MessageBox database.</span></span> <span data-ttu-id="e6c83-133">La base de datos de cuadro de mensajes principal evalúa y enruta las suscripciones a todas las demás bases de datos de cuadro de mensajes del entorno de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="e6c83-133">The master MessageBox database evaluates and routes subscriptions to all other MessageBox databases in the BizTalk Server environment.</span></span> <span data-ttu-id="e6c83-134">Para obtener información sobre cómo mejorar el rendimiento de la base de datos maestra, vea [administrar bases de datos de cuadro de mensajes](../core/managing-messagebox-databases.md).</span><span class="sxs-lookup"><span data-stu-id="e6c83-134">For information about improving performance for the master MessageBox database, see [Managing MessageBox Databases](../core/managing-messagebox-databases.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="e6c83-135">Debe utilizar la organización por clústeres de SQL Server para proporcionar protección de conmutación por error a las bases de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-135">You must use SQL Server clustering to provide failover protection for MessageBox databases.</span></span>  
  
## <a name="suspended-messages-in-the-messagebox-database"></a><span data-ttu-id="e6c83-136">Mensajes suspendidos de la base de datos de cuadro de mensajes</span><span class="sxs-lookup"><span data-stu-id="e6c83-136">Suspended Messages in the MessageBox Database</span></span>  
 <span data-ttu-id="e6c83-137">BizTalk Server almacena mensajes asociados con canalizaciones suspendidas en la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e6c83-137">BizTalk Server stores messages associated with suspended pipelines in the MessageBox database.</span></span> <span data-ttu-id="e6c83-138">Si se produce un error en la canalización, BizTalk Server suspende la instancia de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="e6c83-138">If a failure occurs in the pipeline, BizTalk Server suspends the instance of a message.</span></span> <span data-ttu-id="e6c83-139">Existen dos tipos de instancias de servicio suspendidas:</span><span class="sxs-lookup"><span data-stu-id="e6c83-139">There are two types of suspended service instances:</span></span>  
  
- <span data-ttu-id="e6c83-140">Instancias suspendidas que se pueden reanudar.</span><span class="sxs-lookup"><span data-stu-id="e6c83-140">Suspended instances that you can resume.</span></span>  
  
- <span data-ttu-id="e6c83-141">Instancias suspendidas que no se pueden reanudar.</span><span class="sxs-lookup"><span data-stu-id="e6c83-141">Suspended instances that you cannot resume.</span></span> <span data-ttu-id="e6c83-142">Por ejemplo, si una instancia está dañada.</span><span class="sxs-lookup"><span data-stu-id="e6c83-142">For example, if an instance is corrupt.</span></span>  
  
  <span data-ttu-id="e6c83-143">En función de la causa de la suspensión, puede que sea posible reanudar servicios suspendidos por BizTalk Server. Por ejemplo, si una orquestación activa una forma Suspender o si un transporte no puede entregar un mensaje, BizTalk Server no quita automáticamente las instancias suspendidas que no se pueden reanudar de la base de datos de cuadro de mensaje.</span><span class="sxs-lookup"><span data-stu-id="e6c83-143">Depending on the cause of the suspension, you may be able to resume services that BizTalk Server suspends -- for example, if an orchestration hits a Suspend shape, or if a transport was unable to deliver a message, BizTalk Server does not automatically remove suspended instances that you cannot resume from the MessageBox database.</span></span> <span data-ttu-id="e6c83-144">Puede guardar una instancia de servicio en disco antes de quitarla de la cola de suspensión.</span><span class="sxs-lookup"><span data-stu-id="e6c83-144">You can choose to save a service instance to disk before removing it from the suspended queue.</span></span>  
  
  <span data-ttu-id="e6c83-145">Para obtener información acerca de seguridad de bases de datos, vea [copia de seguridad y restaurar bases de datos de servidor de BizTalk](../core/backing-up-and-restoring-biztalk-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6c83-145">For information about backing up MessageBox databases, see [Backing Up and Restoring BizTalk Server Databases](../core/backing-up-and-restoring-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e6c83-146">Vea también</span><span class="sxs-lookup"><span data-stu-id="e6c83-146">See Also</span></span>  
 [<span data-ttu-id="e6c83-147">El motor de mensajería</span><span class="sxs-lookup"><span data-stu-id="e6c83-147">The Messaging Engine</span></span>](../core/the-messaging-engine.md)