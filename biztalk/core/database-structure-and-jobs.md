---
title: Estructura y los trabajos de la base de datos | Documentos de Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- PurgeSubscriptionsJob_BizTalkMsgBoxDb job
- MessageBox database, jobs [SQL Server Agent]
- DTA Purge and Archive (BizTalkDTADb) job
- TrackedMessages_Copy_BizTalkMsgBoxDb job
- MessageBox_Message_Cleanup_BizTalkMsgBoxDb job
- MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job
- Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], MessageBox database
- CleanupBTFExpiredEntriesJob_BizTalkMgmtDb job
- databases, structure
- Tracking database, jobs [SQL Server Agent]
- jobs [SQL Server Agent], Management database
- Backup BizTalk Server (BizTalkMgmtDb) job
- databases, SQL Server Agent jobs
- Business Rules Engine, jobs [SQL Server Agent]
- jobs, databases
- Management database, jobs [SQL Server Agent]
- MessageBox_UpdateStats_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], Business Rules Engine
- Rules_Database_Cleanup_BizTalkRuleEngineDb job
- MessageBox_Parts_Cleanup_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], Tracking database
- MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb job
ms.assetid: f5f6b17d-0f5e-4821-a7eb-c345234ffc65
caps.latest.revision: "23"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bf98ef7fe236261fd3ee65ac6f4695455ba8c704
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="database-structure-and-jobs"></a><span data-ttu-id="a0b18-102">Estructura de base de datos y trabajos</span><span class="sxs-lookup"><span data-stu-id="a0b18-102">Database Structure and Jobs</span></span>
<span data-ttu-id="a0b18-103">Este tema describe la estructura de base de datos y los trabajos de la base de datos para [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a0b18-103">This topic discusses the database structure and database jobs for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="database-write-diagram"></a><span data-ttu-id="a0b18-104">Diagrama de escritura de base de datos</span><span class="sxs-lookup"><span data-stu-id="a0b18-104">Database Write Diagram</span></span>  
 <span data-ttu-id="a0b18-105">En la siguiente ilustración se muestran los procesos y entidades que escriben en las bases de datos de servidor BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="a0b18-105">The following figure shows the processes and entities that write to the BizTalk Server databases.</span></span>  
  
 <span data-ttu-id="a0b18-106">![Procesos que se escriben en las bases de datos de BizTalk Server](../core/media/ebiz-ops-backup.gif "ebiz_ops_backup")</span><span class="sxs-lookup"><span data-stu-id="a0b18-106">![Processes that write to BizTalk Server databases](../core/media/ebiz-ops-backup.gif "ebiz_ops_backup")</span></span>  
  
        Database write diagram showing the processes and entities that write to the BizTalk Server databases  
  
## <a name="biztalk-server-database-jobs"></a><span data-ttu-id="a0b18-107">Trabajos de base de datos de servidor BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="a0b18-107">BizTalk Server Database Jobs</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="a0b18-108"> incluye los siguientes trabajos del Agente SQL Server para ayudarle a administrar las bases de datos de BizTalk Server:</span><span class="sxs-lookup"><span data-stu-id="a0b18-108"> includes the following SQL Server Agent jobs to assist you in managing the BizTalk Server databases:</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a0b18-109">Los nombres de los trabajos varían en función de los nombres de base de datos proporcionados durante la configuración.</span><span class="sxs-lookup"><span data-stu-id="a0b18-109">The names of the jobs change depending on the database names given during configuration.</span></span> <span data-ttu-id="a0b18-110">Si ha implementado varias bases de datos de cuadro de mensajes en su entorno, dispondrá de varios trabajos para cada cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="a0b18-110">If you have deployed multiple MessageBox databases in your environment, there will be several jobs for each MessageBox.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="a0b18-111">En la base de datos de administración de BizTalk (BizTalkMgmtDb), hay un procedimiento almacenado denominado **adm_CleanupMgmtDB**.</span><span class="sxs-lookup"><span data-stu-id="a0b18-111">In the BizTalk Management (BizTalkMgmtDb) database, there's a stored procedure named **adm_CleanupMgmtDB**.</span></span> <span data-ttu-id="a0b18-112">**NO EJECUTE ESTE PROCEDIMIENTO ALMACENADO.**</span><span class="sxs-lookup"><span data-stu-id="a0b18-112">**DO NOT RUN THIS STORED PROCEDURE!**</span></span> <span data-ttu-id="a0b18-113">Si lo ejecuta, se eliminarán todas las entradas de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0b18-113">If you do run this stored procedure, all the entries in the database will be deleted.</span></span>  
  
|<span data-ttu-id="a0b18-114">Trabajo</span><span class="sxs-lookup"><span data-stu-id="a0b18-114">Job</span></span>|<span data-ttu-id="a0b18-115">Description</span><span class="sxs-lookup"><span data-stu-id="a0b18-115">Description</span></span>|  
|---------|-----------------|  
|<span data-ttu-id="a0b18-116">Copia de seguridad de BizTalk Server (BizTalkMgmtDb)</span><span class="sxs-lookup"><span data-stu-id="a0b18-116">Backup BizTalk Server (BizTalkMgmtDb)</span></span>|<span data-ttu-id="a0b18-117">Este trabajo lleva a cabo todas las copias de seguridad de registros y bases de datos de las bases de datos de servidor BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="a0b18-117">This job performs full database and log backups of the BizTalk Server databases.</span></span> <span data-ttu-id="a0b18-118">Para obtener más información sobre cómo configurar y ejecutar este trabajo, consulte [copia de seguridad y restaurar bases de datos de servidor de BizTalk](../core/backing-up-and-restoring-biztalk-server-databases.md).</span><span class="sxs-lookup"><span data-stu-id="a0b18-118">For more information about configuring and running this job, see [Backing Up and Restoring BizTalk Server Databases](../core/backing-up-and-restoring-biztalk-server-databases.md).</span></span>|  
|<span data-ttu-id="a0b18-119">CleanupBTFExpiredEntriesJob_BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-119">CleanupBTFExpiredEntriesJob_BizTalkMgmtDb</span></span>|<span data-ttu-id="a0b18-120">Este trabajo limpia las entradas caducadas de BizTalk Framework (BTF) en la base de datos de administración de BizTalk (BizTalkMgmtDb).</span><span class="sxs-lookup"><span data-stu-id="a0b18-120">This job cleans up expired BizTalk Framework (BTF) entries in the BizTalk Management (BizTalkMgmtDb) database.</span></span>|  
|<span data-ttu-id="a0b18-121">DTA Purge and Archive (BizTalkDTADb)</span><span class="sxs-lookup"><span data-stu-id="a0b18-121">DTA Purge and Archive (BizTalkDTADb)</span></span>|<span data-ttu-id="a0b18-122">Este trabajo archiva de forma automática los datos de la base de datos de seguimiento de BizTalk (BizTalkDTADb) y purga los datos que han quedado obsoletos.</span><span class="sxs-lookup"><span data-stu-id="a0b18-122">This job automatically archives data in the BizTalk Tracking (BizTalkDTADb) database and purges obsolete data.</span></span> <span data-ttu-id="a0b18-123">Para obtener más información sobre cómo configurar y ejecutar este trabajo, consulte [archivar y purgar la base de datos de seguimiento de BizTalk](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span><span class="sxs-lookup"><span data-stu-id="a0b18-123">For more information about configuring and running this job, see [Archiving and Purging the BizTalk Tracking Database](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span></span>|  
|<span data-ttu-id="a0b18-124">MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-124">MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-125">Este trabajo detecta cuando una instancia de host de BizTalk Server (servicio NT) se ha detenido y libera todo el trabajo que esta instancia estaba llevando a cabo para que pueda encargarse de él otra instancia de host.</span><span class="sxs-lookup"><span data-stu-id="a0b18-125">This job detects when a BizTalk Server host instance (NT service) has stopped and releases all work that was being done by that host instance so that it can be worked on by another host instance.</span></span>|  
|<span data-ttu-id="a0b18-126">MessageBox_Message_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-126">MessageBox_Message_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-127">Este trabajo quita todos los mensajes a los que ningún suscriptor hace referencia en las tablas de base de datos de cuadro de mensajes de BizTalk (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="a0b18-127">This job removes all messages that are no longer being referenced by any subscribers in the BizTalk MessageBox (BizTalkMsgBoxDb) database tables.</span></span> <span data-ttu-id="a0b18-128">**Precaución:** se trata de un trabajo no programado que se inicia el trabajo MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb.</span><span class="sxs-lookup"><span data-stu-id="a0b18-128">**Caution:**  This is an unscheduled job which is started by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job.</span></span> <span data-ttu-id="a0b18-129">No inicie este trabajo manualmente.</span><span class="sxs-lookup"><span data-stu-id="a0b18-129">Do not manually start this job.</span></span>|  
|<span data-ttu-id="a0b18-130">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-130">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-131">Este trabajo administra los registros de cuenta de referencia de los mensajes y determina si existen mensajes a los que ningún suscriptor hace referencia.</span><span class="sxs-lookup"><span data-stu-id="a0b18-131">This job manages the reference count logs for messages and determines when a message is no longer referenced by any subscriber.</span></span> <span data-ttu-id="a0b18-132">**Nota:** a pesar de este trabajo del Agente SQL Server está programado para ejecutarse una vez por minuto, el procedimiento almacenado que llama a este trabajo contiene la lógica para asegurarse de que el procedimiento almacenado se ejecuta continuamente.</span><span class="sxs-lookup"><span data-stu-id="a0b18-132">**Note:**  Even thought this SQL Server Agent job is scheduled to run once per minute, the stored procedure that is called by this job contains logic to ensure that the stored procedure runs continually.</span></span> <span data-ttu-id="a0b18-133">Este comportamiento se debe al diseño y no debe modificarse.</span><span class="sxs-lookup"><span data-stu-id="a0b18-133">This is by design behavior and should not be modified.</span></span>|  
|<span data-ttu-id="a0b18-134">MessageBox_Parts_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-134">MessageBox_Parts_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-135">Este trabajo quita todas las partes de mensaje a las que ningún mensaje hace referencia en las tablas de base de datos de cuadro de mensajes de BizTalk (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="a0b18-135">This job removes all message parts that are no longer being referenced by any messages in the BizTalk MessageBox (BizTalkMsgBoxDb) database tables.</span></span> <span data-ttu-id="a0b18-136">Todos los mensajes están compuestos por una o varias partes, que incluyen los datos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="a0b18-136">All messages are made up of one or more message parts, which contain the actual message data.</span></span>|  
|<span data-ttu-id="a0b18-137">MessageBox_UpdateStats_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-137">MessageBox_UpdateStats_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-138">Este trabajo actualiza la estadística de la base de datos de cuadro de mensajes de BizTalk (BizTalkMsgBoxDb) de forma manual.</span><span class="sxs-lookup"><span data-stu-id="a0b18-138">This job manually updates the statistics for the BizTalk MessageBox (BizTalkMsgBoxDb) database.</span></span>|  
|<span data-ttu-id="a0b18-139">Supervisar BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="a0b18-139">Monitor BizTalk Server</span></span>|<span data-ttu-id="a0b18-140">Este trabajo busca en las bases de datos BizTalkMgmtDb, BizTalkMsgBoxDb y BizTalkDTADb problemas conocidos como, por ejemplo, instancias huérfanas.</span><span class="sxs-lookup"><span data-stu-id="a0b18-140">This job scans the BizTalkMgmtDb, BizTalkMsgBoxDb and BizTalkDTADb database for any known issues, including orphaned instances.</span></span>|  
|<span data-ttu-id="a0b18-141">Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-141">Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-142">Este trabajo es necesario en varias implementaciones de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="a0b18-142">This job is needed for multiple MessageBox deployments.</span></span> <span data-ttu-id="a0b18-143">Realiza acciones de funcionamiento de forma asíncrona, como, por ejemplo, la finalización masiva en el cuadro de mensajes principal una vez que se han aplicado los cambios al cuadro de mensajes subordinado.</span><span class="sxs-lookup"><span data-stu-id="a0b18-143">It asynchronously performs operational actions such as bulk terminate on the master MessageBox after those changes have been applied to the subordinate MessageBox.</span></span>|  
|<span data-ttu-id="a0b18-144">PurgeSubscriptionsJob_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-144">PurgeSubscriptionsJob_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="a0b18-145">Este trabajo purga los predicados de suscripción no utilizados de la base de datos de cuadro de mensajes de BizTalk Server (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="a0b18-145">This job purges unused subscription predicates from the BizTalk Server MessageBox (BizTalkMsgBoxDb) database.</span></span>|  
|<span data-ttu-id="a0b18-146">Rules_Database_Cleanup_BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="a0b18-146">Rules_Database_Cleanup_BizTalkRuleEngineDb</span></span>|<span data-ttu-id="a0b18-147">Este trabajo purga automáticamente los datos de auditoría antiguos de la base de datos del motor de reglas (BizTalkRuleEngineDb) cada 90 días.</span><span class="sxs-lookup"><span data-stu-id="a0b18-147">This job automatically purges old audit data from the Rule Engine (BizTalkRuleEngineDb) database every 90 days.</span></span> <span data-ttu-id="a0b18-148">Este trabajo también purga los datos de historial antiguos (notificaciones de implementación o de anulación de implementación) de la base de datos del motor de reglas (BizTalkRuleEngineDb) cada 3 días.</span><span class="sxs-lookup"><span data-stu-id="a0b18-148">This job also purges old history data (deploy/undeploy notifications) from the Rule Engine (BizTalkRuleEngineDb) database every 3 days.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a0b18-149">Vea también</span><span class="sxs-lookup"><span data-stu-id="a0b18-149">See Also</span></span>  
 [<span data-ttu-id="a0b18-150">El motor de mensajería</span><span class="sxs-lookup"><span data-stu-id="a0b18-150">The Messaging Engine</span></span>](../core/the-messaging-engine.md)