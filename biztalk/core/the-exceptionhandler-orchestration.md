---
title: La orquestación de ExceptionHandler | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- errors, systems
- errors, applications
- applications, errors
- orchestrations, errors [process management solutions]
- process management solution tutorial, errors
ms.assetid: ac154e76-9dfe-433a-948b-e098df705fe5
caps.latest.revision: 27
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a1b79a1c6d9e6fada206ba0298913fe8f369783c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
ms.locfileid: "22280028"
---
# <a name="the-exceptionhandler-orchestration"></a><span data-ttu-id="6fe37-102">ExceptionHandler (orquestación)</span><span class="sxs-lookup"><span data-stu-id="6fe37-102">The ExceptionHandler Orchestration</span></span>
<span data-ttu-id="6fe37-103">La solución de administración de procesos empresariales utiliza dos tipos de excepciones: excepciones del sistema y las excepciones de aplicación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-103">The Business Process Management solution uses two kinds of exceptions: system exceptions and application exceptions.</span></span> <span data-ttu-id="6fe37-104">Excepciones del sistema incluyen problemas como los errores de recursos: un error, por ejemplo una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="6fe37-104">System exceptions include things like resource errors—a network connection failing, for example.</span></span> <span data-ttu-id="6fe37-105">Es probable que dichos problemas se puedan resolver por sí mismos tras un período y que la solución vuelva a intentar repetir todas las operaciones que provocan excepciones del sistema.</span><span class="sxs-lookup"><span data-stu-id="6fe37-105">There is a chance that such a problem may resolve itself after an interval so that the solution retries all operations that produce system exceptions.</span></span> <span data-ttu-id="6fe37-106">Las excepciones de aplicación surgen por problemas con menos probabilidades de resolverse por sí mismos, como los errores lógicos o algunos tipos de incoherencia.</span><span class="sxs-lookup"><span data-stu-id="6fe37-106">Application exceptions are produced by things less likely to resolve themselves, such as logical errors or some form of inconsistency.</span></span> <span data-ttu-id="6fe37-107">La solución utiliza la **ExceptionHandlerOrch** orquestación para procesar los errores de aplicación y del sistema.</span><span class="sxs-lookup"><span data-stu-id="6fe37-107">The solution uses the **ExceptionHandlerOrch** orchestration to process both system and application errors.</span></span>  
  
 <span data-ttu-id="6fe37-108">Las fases de procesamiento de pedidos (**CableOrder1**, **CableOrder2**) y sus orquestaciones satélite (**activar**, **analizar**,  **Cancelar**, **cambio**, **completar**, **validar**) todo, use **ExceptionHandlerOrch**.</span><span class="sxs-lookup"><span data-stu-id="6fe37-108">The order processing stages (**CableOrder1**, **CableOrder2**) and their satellite orchestrations (**Activate**, **Analyze**, **Cancel**, **Change**, **Complete**, **Validate**) all use **ExceptionHandlerOrch**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6fe37-109">Puede que desee leer esta sección con la **ExceptionHandlerOrch** orquestación abierta en Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6fe37-109">You may want to read this section with the **ExceptionHandlerOrch** orchestration open in Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span></span>  
  
## <a name="application-errors"></a><span data-ttu-id="6fe37-110">Errores de aplicación</span><span class="sxs-lookup"><span data-stu-id="6fe37-110">Application Errors</span></span>  
 <span data-ttu-id="6fe37-111">El controlador de excepciones en primer lugar registra el error mediante una llamada a la **PostError** método de la **ErrorHandler** objeto en el **utilidades** ensamblado.</span><span class="sxs-lookup"><span data-stu-id="6fe37-111">The exception handler first logs the error by calling the **PostError** method of the **ErrorHandler** object in the **Utilities** assembly.</span></span> <span data-ttu-id="6fe37-112">A continuación, comprueba si se trata de un error del sistema o de un error de aplicación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-112">The exception handler then tests whether the error was a system error or an application error.</span></span> <span data-ttu-id="6fe37-113">La siguiente captura de pantalla muestra la rama de la orquestación que procesa las excepciones de aplicación:</span><span class="sxs-lookup"><span data-stu-id="6fe37-113">The following screenshot shows the orchestration branch that processes application exceptions:</span></span>  
  
 <span data-ttu-id="6fe37-114">![Rama de aplicación de la orquestación de ExceptionHandler](../core/media/applicationerrorbranchofexceptionhandler.gif "ApplicationErrorBranchofExceptionHandler")</span><span class="sxs-lookup"><span data-stu-id="6fe37-114">![Application Branch of ExceptionHandler Orchestrati](../core/media/applicationerrorbranchofexceptionhandler.gif "ApplicationErrorBranchofExceptionHandler")</span></span>  
  
 <span data-ttu-id="6fe37-115">Para un error de aplicación, la orquestación construye una cadena que describe el error y llama el **ErrorHandlerOrch** orquestación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-115">For an application error, the orchestration constructs a string describing the error and calls the **ErrorHandlerOrch** orchestration.</span></span> <span data-ttu-id="6fe37-116">Esta orquestación envía el error a operaciones en las que un operador decide si corregir el error o finalizar la operación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-116">This orchestration sends the error to operations where an operator decides whether to fix the error or terminate the operation.</span></span> <span data-ttu-id="6fe37-117">Si el operador corrige el error, la orquestación ErrorHandlerOrch devuelve el mensaje reparado y se vuelve a intentar repetir la operación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-117">If the operator fixes the error, the repaired message comes back from the ErrorHandlerOrch orchestration and the operation is retried.</span></span> <span data-ttu-id="6fe37-118">El controlador de excepciones para ello mediante una llamada a la **Invoke** método de la **Recaller** objeto en el **utilidades** ensamblado.</span><span class="sxs-lookup"><span data-stu-id="6fe37-118">The exception handler does this by calling the **Invoke** method of the **Recaller** object in the **Utilities** assembly.</span></span> <span data-ttu-id="6fe37-119">El **Recaller** objeto usa la reflexión para llamar al código que produjo el error.</span><span class="sxs-lookup"><span data-stu-id="6fe37-119">The **Recaller** object uses reflection to call the code that caused the error.</span></span>  
  
 <span data-ttu-id="6fe37-120">Si la llamada a **Invoke** se realiza correctamente, las salidas del controlador de excepción.</span><span class="sxs-lookup"><span data-stu-id="6fe37-120">If the call to **Invoke** succeeds, the exception handler exits.</span></span> <span data-ttu-id="6fe37-121">En caso contrario, se produce un bucle invertido y se intenta la llamada a **Invoke** nuevo.</span><span class="sxs-lookup"><span data-stu-id="6fe37-121">Otherwise, it loops back and attempts the call to **Invoke** again.</span></span> <span data-ttu-id="6fe37-122">Para obtener más información sobre la **Recaller** de objetos, consulte [el objeto Recaller](../core/the-recaller-object.md).</span><span class="sxs-lookup"><span data-stu-id="6fe37-122">For more information about the **Recaller** object, see [The Recaller Object](../core/the-recaller-object.md).</span></span>  
  
## <a name="system-errors"></a><span data-ttu-id="6fe37-123">Errores del sistema</span><span class="sxs-lookup"><span data-stu-id="6fe37-123">System Errors</span></span>  
 <span data-ttu-id="6fe37-124">El siguiente diagrama muestra la rama de error de sistema de la **ExceptionHandler** orquestación:</span><span class="sxs-lookup"><span data-stu-id="6fe37-124">The following diagram shows the system error branch of the **ExceptionHandler** orchestration:</span></span>  
  
 <span data-ttu-id="6fe37-125">![Error del sistema de orquestación de ExceptionHandler](../core/media/systemerrorbranchofexceptionhandler.gif "SystemErrorBranchofExceptionHandler")</span><span class="sxs-lookup"><span data-stu-id="6fe37-125">![System Error of ExceptionHandler Orchestration](../core/media/systemerrorbranchofexceptionhandler.gif "SystemErrorBranchofExceptionHandler")</span></span>  
  
 <span data-ttu-id="6fe37-126">Para un error del sistema, el controlador de excepciones llama primero la **CheckInterrupt** orquestación y, a continuación, espera un minuto.</span><span class="sxs-lookup"><span data-stu-id="6fe37-126">For a system error, the exception handler first calls the **CheckInterrupt** orchestration and then waits for one minute.</span></span> <span data-ttu-id="6fe37-127">Este tiempo de espera permite que desaparezcan los errores a corto plazo temporales, como los problemas de conexión de red, antes de que se vuelva a intentar la operación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-127">The wait allows for temporary, short-term errors such as network connection problems, to clear before trying again.</span></span> <span data-ttu-id="6fe37-128">Cuando se realizan llamadas remotas, siempre existe la probabilidad de que se produzca un problema de red.</span><span class="sxs-lookup"><span data-stu-id="6fe37-128">When making remote calls there is always the chance of a network problem.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6fe37-129">Como regla general, en un diseño que se puede interrumpir, lo ideal es comprobar si hay interrupciones durante uno de los períodos de espera o justo después de uno de ellos para ver si se ha producido una interrupción.</span><span class="sxs-lookup"><span data-stu-id="6fe37-129">In an interruptible design, as a general rule, you want to test for an interrupt during or immediately after any waiting period to see if an interrupt has occurred.</span></span>  
  
 <span data-ttu-id="6fe37-130">Después de la espera, el controlador utiliza la **Invoke** método de la **Recaller** objeto que se va a ejecutar el código original.</span><span class="sxs-lookup"><span data-stu-id="6fe37-130">After the wait, the handler uses the **Invoke** method of the **Recaller** object to run the original code.</span></span> <span data-ttu-id="6fe37-131">Si la llamada se realiza correctamente, el controlador se cierra.</span><span class="sxs-lookup"><span data-stu-id="6fe37-131">If the call succeeds, the handler exits.</span></span> <span data-ttu-id="6fe37-132">En caso contrario, el controlador intentará ejecutar el código original un par de veces más.</span><span class="sxs-lookup"><span data-stu-id="6fe37-132">Otherwise, the handler will try two more times to run the original code.</span></span> <span data-ttu-id="6fe37-133">Si se produce un error en los tres intentos, el controlador crea una cadena de error y llama el **ErrorHandlerOrch** orquestación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-133">If all three attempts fail, the handler constructs an error string and calls the **ErrorHandlerOrch** orchestration.</span></span>  
  
 <span data-ttu-id="6fe37-134">Si al procesar una excepción del sistema se genera una excepción, un bloque de excepción la captura:</span><span class="sxs-lookup"><span data-stu-id="6fe37-134">If processing a system exception causes an exception, the exception block catches it:</span></span>  
  
 <span data-ttu-id="6fe37-135">![Controlador de excepciones para rama de Error del sistema](../core/media/exceptionhandlerofsystemerrorbranch.gif "ExceptionHandlerofSystemErrorBranch")</span><span class="sxs-lookup"><span data-stu-id="6fe37-135">![Exception Handler for System Error Branch](../core/media/exceptionhandlerofsystemerrorbranch.gif "ExceptionHandlerofSystemErrorBranch")</span></span>  
  
 <span data-ttu-id="6fe37-136">El controlador de la excepción comprueba el tipo de excepción y reduce el contador de reintentos si se trata de una excepción del sistema o establece un indicador para especificar una excepción de aplicación.</span><span class="sxs-lookup"><span data-stu-id="6fe37-136">The exception handler tests the type of the exception and either decrements the retry counter if it's a system exception, or sets a flag to indicate an application exception.</span></span>  
  
## <a name="the-errorhandlerorch-orchestration"></a><span data-ttu-id="6fe37-137">Orquestación ErrorHandlerOrch</span><span class="sxs-lookup"><span data-stu-id="6fe37-137">The ErrorHandlerOrch Orchestration</span></span>  
 <span data-ttu-id="6fe37-138">El siguiente diagrama muestra la primera parte de la **ErrorHandlerOrch** orquestación:</span><span class="sxs-lookup"><span data-stu-id="6fe37-138">The following diagram shows the first part of the **ErrorHandlerOrch** orchestration:</span></span>  
  
 <span data-ttu-id="6fe37-139">![Orquestación de controlador de errores, primera parte](../core/media/errorhandlerfirstpart.gif "ErrorHandlerFirstPart")</span><span class="sxs-lookup"><span data-stu-id="6fe37-139">![Error Handler Orchestration, First Part](../core/media/errorhandlerfirstpart.gif "ErrorHandlerFirstPart")</span></span>  
  
 <span data-ttu-id="6fe37-140">El **ErrorHandlerOrch** orquestación comprueba en primer lugar el **IsBadOrder** parámetro para ver si el error es un pedido incorrecto (**IsBadOrder** es true) o algún otro error.</span><span class="sxs-lookup"><span data-stu-id="6fe37-140">The **ErrorHandlerOrch** orchestration first tests the **IsBadOrder** parameter to see if the error is a bad order (**IsBadOrder** is true) or some other error.</span></span> <span data-ttu-id="6fe37-141">Si el error es de pedido incorrecto, asigna el destino del mensaje desde el remite del pedido original y vuelve a enviar el mensaje al sistema de atención al cliente.</span><span class="sxs-lookup"><span data-stu-id="6fe37-141">If the error is a bad order, it assigns the destination of the message from the original order return address and sends the message back to the customer service system.</span></span> <span data-ttu-id="6fe37-142">Si no se refiere a un pedido incorrecto, la orquestación crea un mensaje de error de pedido y lo envía al sistema de operaciones.</span><span class="sxs-lookup"><span data-stu-id="6fe37-142">If the error is not a bad order, the orchestration creates an order error message and sends it to the operations system.</span></span>  
  
 <span data-ttu-id="6fe37-143">Después de cualquier error, la orquestación escucha si se genera un mensaje de respuesta o de interrupción:</span><span class="sxs-lookup"><span data-stu-id="6fe37-143">After either error, the orchestration then listens for a response message or an interrupt message:</span></span>  
  
 <span data-ttu-id="6fe37-144">![Controlador de errores, segunda parte](../core/media/errorhandlersecondpart.gif "ErrorHandlerSecondPart")</span><span class="sxs-lookup"><span data-stu-id="6fe37-144">![Error Handler Second Part](../core/media/errorhandlersecondpart.gif "ErrorHandlerSecondPart")</span></span>  
  
 <span data-ttu-id="6fe37-145">Si la orquestación recibe una respuesta, vuelve al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="6fe37-145">If the orchestration receives a response, it returns to the caller.</span></span> <span data-ttu-id="6fe37-146">Si la orquestación recibe un mensaje de interrupción, pasa el mensaje a un puerto de interrupción y genera una excepción personalizada **InterruptException**.</span><span class="sxs-lookup"><span data-stu-id="6fe37-146">If the orchestration receives an interrupt message, it passes the message on to an interrupt port and throws a custom **InterruptException**.</span></span>  
  
 <span data-ttu-id="6fe37-147">Para obtener más información acerca de cómo la solución utiliza y controla las interrupciones, consulte [de interrupción de control en la solución de administración de procesos empresariales](../core/interrupt-handling-in-the-business-process-management-solution.md).</span><span class="sxs-lookup"><span data-stu-id="6fe37-147">For more information about how the solution uses and handles interrupts, see [Interrupt Handling in the Business Process Management Solution](../core/interrupt-handling-in-the-business-process-management-solution.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6fe37-148">Vea también</span><span class="sxs-lookup"><span data-stu-id="6fe37-148">See Also</span></span>  
 <span data-ttu-id="6fe37-149">[Control de excepciones en la solución de administración de procesos empresariales](../core/exception-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="6fe37-149">[Exception Handling in the Business Process Management Solution](../core/exception-handling-in-the-business-process-management-solution.md) </span></span>  
 <span data-ttu-id="6fe37-150">[Excepciones personalizadas](../core/custom-exceptions.md) </span><span class="sxs-lookup"><span data-stu-id="6fe37-150">[Custom Exceptions](../core/custom-exceptions.md) </span></span>  
 <span data-ttu-id="6fe37-151">[Control de interrupciones en la solución de administración de procesos empresariales](../core/interrupt-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="6fe37-151">[Interrupt Handling in the Business Process Management Solution](../core/interrupt-handling-in-the-business-process-management-solution.md) </span></span>  
 [<span data-ttu-id="6fe37-152">Objeto Recaller</span><span class="sxs-lookup"><span data-stu-id="6fe37-152">The Recaller Object</span></span>](../core/the-recaller-object.md)