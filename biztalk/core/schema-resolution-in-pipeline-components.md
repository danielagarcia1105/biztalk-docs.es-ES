---
title: "Resolución de esquemas en componentes de canalización | Documentos de Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- pipelines, schema resolution
- pipeline components, schema resolution
- schemas, pipeline components
ms.assetid: 35a79a6f-788b-4ca1-8483-36dcba5ae580
caps.latest.revision: "14"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 897c25ecb64a3038a6992b9c4caf927ba3e2d805
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2017
---
# <a name="schema-resolution-in-pipeline-components"></a><span data-ttu-id="b4452-102">Resolución de esquemas en componentes de canalización</span><span class="sxs-lookup"><span data-stu-id="b4452-102">Schema Resolution in Pipeline Components</span></span>
<span data-ttu-id="b4452-103">Los componentes de canalización de desensamblador y de ensamblador utilizan esquemas XSD para procesar los mensajes.</span><span class="sxs-lookup"><span data-stu-id="b4452-103">Pipeline disassembler and assembler components use XSD schemas to process messages.</span></span> <span data-ttu-id="b4452-104">Los esquemas contienen información, como la lista de propiedades promocionadas, campos distintivos, anotaciones para mensajes de archivo sin formato y anotaciones para sobres XML.</span><span class="sxs-lookup"><span data-stu-id="b4452-104">The schemas contain information such as the list of promoted properties, distinguished fields, annotations for flat file messages, and annotations for XML envelopes.</span></span>  
  
 <span data-ttu-id="b4452-105">Los componentes estándar de desensamblador y de ensamblador admiten la recuperación de esquemas implementados mediante el nombre de tipo de esquema y el tipo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="b4452-105">Standard disassembler and assembler components support retrieval of deployed schemas by using the schema type name and message type.</span></span> <span data-ttu-id="b4452-106">Algunos componentes recuperan utilizando tanto el nombre de tipo de esquema como el tipo de mensaje, mientras que otros (por ejemplo, el desensamblador de archivo sin formato) recuperan únicamente por el tipo de esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-106">Some components retrieve by using both the schema type name and the message type, while others (for example, the Flat File Disassembler) retrieve only by the schema type.</span></span>  
  
 <span data-ttu-id="b4452-107">Los componentes de canalización que reciben mensajes XML determinan el tipo de mensaje examinando el espacio de nombres y el elemento raíz del mensaje.</span><span class="sxs-lookup"><span data-stu-id="b4452-107">Pipeline components that receive XML messages determine the message type by examining the message root element and namespace.</span></span> <span data-ttu-id="b4452-108">Por ejemplo, el tipo de mensaje para el siguiente XML es "http://MyDocument.org#MyDocument".</span><span class="sxs-lookup"><span data-stu-id="b4452-108">For example, the message type for the following XML is "http://MyDocument.org#MyDocument".</span></span>  
  
```  
<ns0:MyDocument xmlns:ns0="http://MyDocument.org">  
  
</ns0:MyDocument>  
```  
  
 <span data-ttu-id="b4452-109">Si un esquema no tiene un espacio de nombres definido para ella, el tipo de mensaje es "\<**rootNode**\>".</span><span class="sxs-lookup"><span data-stu-id="b4452-109">If a schema does not have a namespace defined for it, the message type is "\<**rootNode**\>".</span></span> <span data-ttu-id="b4452-110">Por ejemplo, si el anterior ejemplo XML no tuviera espacio de nombres, el tipo de mensaje sería "MyDocument".</span><span class="sxs-lookup"><span data-stu-id="b4452-110">For example, if the preceding example XML had no namespace, the message type would be "MyDocument".</span></span>  
  
 <span data-ttu-id="b4452-111">Los componentes estándar de canalización utilizan el tipo de mensaje para recuperar el esquema apropiado de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b4452-111">Standard pipeline components use the message type to retrieve the appropriate schema from the database.</span></span> <span data-ttu-id="b4452-112">Las canalizaciones de recepción y de envío XML predeterminadas siempre determinan qué esquema cargar mediante el tipo de mensaje descubierto dinámicamente en tiempo de ejecución a partir del contenido XML del mensaje (a no ser que el componente de canalización esté establecido para permitir mensajes desconocidos).</span><span class="sxs-lookup"><span data-stu-id="b4452-112">Default XML receive and send pipelines always determine which schema to load by using the message type dynamically discovered at runtime from the message XML content (unless the pipeline component is set to allow unrecognized messages).</span></span> <span data-ttu-id="b4452-113">El desensamblador XML puede quitar el sobre del mensaje mediante este mecanismo; sin embargo, el ensamblador XML no puede crear un sobre para un mensaje saliente sin conocer qué esquema de sobres utilizar.</span><span class="sxs-lookup"><span data-stu-id="b4452-113">The XML Disassembler can remove the message envelope by using this mechanism; however, the XML Assembler cannot create an envelope for an outgoing message without knowing what envelope schema to use.</span></span>  
  
 <span data-ttu-id="b4452-114">El esquema de sobres se especifica en las propiedades de configuración para el ensamblador XML en el Diseñador de canalizaciones.</span><span class="sxs-lookup"><span data-stu-id="b4452-114">You specify the envelope schema in the configuration properties for the XML Assembler from within the pipeline designer.</span></span>  
  
## <a name="how-schemas-are-resolved"></a><span data-ttu-id="b4452-115">Cómo se resuelven esquemas</span><span class="sxs-lookup"><span data-stu-id="b4452-115">How Schemas Are Resolved</span></span>  
 <span data-ttu-id="b4452-116">Suponiendo que no está especificando el esquema directamente en el XmlDisassembler, los esquemas se resolverán de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="b4452-116">Assuming you are not specifying the schema directly in the XmlDisassembler, schemas will be resolved in the following manner:</span></span>  
  
1.  <span data-ttu-id="b4452-117">En primer lugar, se realiza una búsqueda no cualificada con el espacio de nombres y el nombre del nodo raíz (por ejemplo http://MyNamespace#MyRoot).</span><span class="sxs-lookup"><span data-stu-id="b4452-117">First, an unqualified search on the deployed schemas is made using the root node name and namespace (for example, http://MyNamespace#MyRoot).</span></span> <span data-ttu-id="b4452-118">Si se encuentra una única coincidencia, se resuelve el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-118">If a unique match is found the schema is resolved.</span></span> <span data-ttu-id="b4452-119">Si se encuentran varias coincidencias que solo difieren en el número de versión y una está activa, se utiliza esa versión y se resuelve el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-119">If multiple matches are found and differ only by version number and only one is active, that version is used and the schema is resolved.</span></span> <span data-ttu-id="b4452-120">Si el mismo esquema está activo en varias aplicaciones, se encontrarán varios esquemas activos y la búsqueda continuará en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="b4452-120">If the same schema is active in multiple applications, multiple active schemas will be found and the search will continue with step 2 below.</span></span>  
  
2.  <span data-ttu-id="b4452-121">Si hay varias coincidencias que el paso 1 no se pueden resolver, el ensamblado que se ejecuta la canalización cualifica la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b4452-121">If there are multiple matches that step 1 cannot resolve, the search is qualified by the assembly the pipeline is executing in.</span></span> <span data-ttu-id="b4452-122">Si se encuentra un esquema único dentro del mismo ensamblado que se ejecuta la canalización, se resuelve el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-122">If a unique schema is found within the same assembly the pipeline is executing in, then the schema is resolved.</span></span>  
  
3.  <span data-ttu-id="b4452-123">Si no hay ninguna coincidencia, se utiliza el editor para resolver el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-123">If there are still no matches, then the publisher is used to resolve the schema.</span></span> <span data-ttu-id="b4452-124">La búsqueda se limita mediante el nodo raíz, el espacio de nombres y el token de clave pública.</span><span class="sxs-lookup"><span data-stu-id="b4452-124">The search is narrowed by using the root node, namespace, and public key token.</span></span> <span data-ttu-id="b4452-125">Si se encuentra un único esquema en esta búsqueda, se resuelve el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-125">If a unique schema is found using this search, the schema is resolved.</span></span>  
  
4.  <span data-ttu-id="b4452-126">No se puede resolver el esquema.</span><span class="sxs-lookup"><span data-stu-id="b4452-126">Schema cannot be resolved.</span></span> <span data-ttu-id="b4452-127">Se devuelve un error que indica que no se encuentra ningún esquema único.</span><span class="sxs-lookup"><span data-stu-id="b4452-127">An error is returned noting that no unique schema can be found.</span></span>  
  
 <span data-ttu-id="b4452-128">Para otras consideraciones, incluido el efecto de intercalación de SQL Server y en minúsculas en resolución de esquemas, vea [administración Namespace](../core/namespace-management.md).</span><span class="sxs-lookup"><span data-stu-id="b4452-128">For other considerations including the effect of SQL Server collation and case-sensitivity on schema resolution, see [Namespace Management](../core/namespace-management.md).</span></span>  
  
 <span data-ttu-id="b4452-129">Para crear un sobre en el ensamblador XML o un encabezado y un finalizador en el ensamblador de archivo sin formato, puede llevar a cabo alguna de las operaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="b4452-129">To create an envelope in the XML Assembler or a header and trailer in the Flat File Assembler, you may do one of the following:</span></span>  
  
-   <span data-ttu-id="b4452-130">Cree una canalización de envío personalizada y especifique los esquemas para el sobre en las propiedades de configuración para el ensamblador XML.</span><span class="sxs-lookup"><span data-stu-id="b4452-130">Create a custom send pipeline and specify the schemas for the envelope in the configuration properties for the XML Assembler.</span></span> <span data-ttu-id="b4452-131">Esto se hace en el Diseñador de canalizaciones.</span><span class="sxs-lookup"><span data-stu-id="b4452-131">This is done from within the pipeline designer.</span></span>  
  
-   <span data-ttu-id="b4452-132">En la consola de administración de servidor BizTalk Server especifique XMLTransmit en un puerto de envío para la propiedad Canalización de envío.</span><span class="sxs-lookup"><span data-stu-id="b4452-132">In the BizTalk Server Administration console specify XMLTransmit for the Send pipeline property on a send port.</span></span> <span data-ttu-id="b4452-133">Haga clic en los puntos suspensivos para configurar las propiedades de canalización y especificar el esquema para el sobre en la propiedad EnvelopeDocSpecNames.</span><span class="sxs-lookup"><span data-stu-id="b4452-133">Click the ellipsis to configure the pipeline properties and specify the schema for the envelope in the EnvelopeDocSpecNames property.</span></span>  
  
 <span data-ttu-id="b4452-134">La resolución de esquemas mediante tipo de mensaje puede no funcionar si se implementan intencionada o accidentalmente varias versiones del mismo esquema en la base de datos (por ejemplo, en una implementación adyacente o si varios escenarios no tienen tipos de mensaje únicos).</span><span class="sxs-lookup"><span data-stu-id="b4452-134">Schema resolution by message type may not work if several versions of the same schema are intentionally or accidentally deployed in the database (for example, in a side-by-side deployment or if multiple scenarios do not have unique message types).</span></span> <span data-ttu-id="b4452-135">Si la resolución de esquemas mediante tipo de mensaje no se lleva cabo correctamente, se agrega un error de "ambigüedad de esquema" al registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="b4452-135">If schema resolution by message type fails, a "schema ambiguity" error is added to the event log.</span></span> <span data-ttu-id="b4452-136">Para asegurarse de que la resolución de esquemas mediante tipo de mensaje funciona correctamente, realice una de las siguientes operaciones:</span><span class="sxs-lookup"><span data-stu-id="b4452-136">To ensure that schema resolution by message type succeeds, do one of the following:</span></span>  
  
-   <span data-ttu-id="b4452-137">Defina los esquemas en el mismo proyecto de BizTalk que la canalización personalizada.</span><span class="sxs-lookup"><span data-stu-id="b4452-137">Define the schemas in the same BizTalk project as your custom pipeline.</span></span>  
  
-   <span data-ttu-id="b4452-138">Firme el ensamblado con los esquemas con la misma clave que el ensamblado que contiene las canalizaciones.</span><span class="sxs-lookup"><span data-stu-id="b4452-138">Sign the assembly with the schemas with the same key as the assembly containing the pipelines.</span></span>  
  
-   <span data-ttu-id="b4452-139">Especifique de manera explícita esquemas en los componentes de canalización (los nombres de tipo de mensaje deben ser únicos en toda la base de datos de administración de BizTalk).</span><span class="sxs-lookup"><span data-stu-id="b4452-139">Explicitly specify schemas in pipeline components (message type names should be unique across the BizTalk Management database).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="b4452-140">Cuando esquemas del mismo ensamblado comparten un tipo de mensaje, no debe incluir los esquemas en el mismo ensamblado de componente de canalización por las limitaciones de resolución de ambigüedad; en vez de eso, haga referencia a los esquemas externos en el ensamblado de componente de canalización.</span><span class="sxs-lookup"><span data-stu-id="b4452-140">When schemas in the same assembly share a message type, you must not include the schemas in the same pipeline component assembly due to the limitations of ambiguity resolution; instead, reference schemas that are external to the pipeline component assembly.</span></span> <span data-ttu-id="b4452-141">La resolución de ambigüedad no funciona cuando los esquemas y los componentes de canalización están en el mismo ensamblado, incluso si los nombres de tipo de esquema se especifican explícitamente en los componentes de canalización en canalizaciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b4452-141">Ambiguity resolution does not work when schemas and pipeline components are in the same assembly, even if schema type names are explicitly specified in pipeline components in custom pipelines.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4452-142">Componentes de canalización personalizados que usan **IPipelineContext** para obtener esquemas implementados debe obtener esquemas mediante tipo de esquema solo si el nombre de tipo de esquema no se especifica para el componente en tiempo de ejecución y obtener esquemas mediante tipo de mensaje solo Si la información de tipo de esquema no está disponible cuando se ejecuta el componente.</span><span class="sxs-lookup"><span data-stu-id="b4452-142">Custom pipeline components that use **IPipelineContext** to obtain deployed schemas should obtain schemas by schema type only if the schema type name is not specified for the component at run time, and obtain schemas by message type only if the schema type information is not available when the component is run.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4452-143">Vea también</span><span class="sxs-lookup"><span data-stu-id="b4452-143">See Also</span></span>  
 [<span data-ttu-id="b4452-144">Componentes de canalización</span><span class="sxs-lookup"><span data-stu-id="b4452-144">Pipeline Components</span></span>](../core/pipeline-components.md)