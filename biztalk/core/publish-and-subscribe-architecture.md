---
title: Publicar y suscribirse arquitectura | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- publish/subscribe architecture, publishers
- architecture, publish/subscribe
- publishing, publish/subscribe architecture
- publish/subscribe architecture, about publish/subscribe architecture
- creating, subscriptions
- publish/subscribe architecture, Messaging Engine
- routing, publishing
- Messaging Engine, publishing
- publish/subscribe architecture, subscribers
- publish/subscribe architecture
- subscriptions, publish/subscribe architecture
- publish/subscribe architecture, creating subscriptions
- subscriptions, creating
- Messaging Engine, subscribing
- publishing, routing
- Messaging Engine, publish/subscribe architecture
- publish/subscribe architecture, events
ms.assetid: 5ed36c1f-077d-468f-a99e-60f97377cef6
caps.latest.revision: 11
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b11ed175fc047eee59761547d8d13ab798ac860c
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2017
ms.locfileid: "25973650"
---
# <a name="publish-and-subscribe-architecture"></a><span data-ttu-id="37136-102">Arquitectura de publicación y suscripción</span><span class="sxs-lookup"><span data-stu-id="37136-102">Publish and Subscribe Architecture</span></span>
<span data-ttu-id="37136-103">En un diseño de publicación y suscripción, hay tres componentes:</span><span class="sxs-lookup"><span data-stu-id="37136-103">In a publish/subscribe design, you have three components:</span></span>  
  
-   <span data-ttu-id="37136-104">Publicadores</span><span class="sxs-lookup"><span data-stu-id="37136-104">Publishers</span></span>  
  
-   <span data-ttu-id="37136-105">Suscriptores</span><span class="sxs-lookup"><span data-stu-id="37136-105">Subscribers</span></span>  
  
-   <span data-ttu-id="37136-106">Eventos</span><span class="sxs-lookup"><span data-stu-id="37136-106">Events</span></span>  
  
 <span data-ttu-id="37136-107">Entre los publicadores, están los puertos de recepción que publican los mensajes que llegan a sus ubicaciones de recepción, las orquestaciones que publican mensajes cuando envían mensajes o inician otra orquestación en modo asincrónico, y los puertos de envío de solicitud-respuesta que publican mensajes cuando reciben una respuesta del transporte o la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="37136-107">Publishers include receive ports that publish messages that arrive in their receive locations, orchestrations that publish messages when sending messages or starting another orchestration asynchronously, and solicit/response send ports that publish messages when they receive a response from the target application or transport.</span></span>  
  
 <span data-ttu-id="37136-108">En BizTalk Server, hay dos tipos principales de suscripciones: activación e instancia.</span><span class="sxs-lookup"><span data-stu-id="37136-108">In BizTalk Server, there are two main types of subscriptions: activation and instance.</span></span> <span data-ttu-id="37136-109">Un *suscripción de activación* es la que especifica que un mensaje que cumple la suscripción debe activar, o crear una nueva instancia del suscriptor cuando se recibe.</span><span class="sxs-lookup"><span data-stu-id="37136-109">An *activation subscription* is one specifying that a message that fulfills the subscription should activate, or create, a new instance of the subscriber when it is received.</span></span> <span data-ttu-id="37136-110">Ejemplos de cosas que crean suscripciones de activación son los puertos de envío con filtros o que están enlazados a orquestaciones, y las formas de recepción de orquestaciones que tienen la propiedad Activar establecida en true.</span><span class="sxs-lookup"><span data-stu-id="37136-110">Examples of things that create activation subscriptions include send ports with filters or send ports that are bound to orchestrations, and orchestration receive shapes that have their Activate property set to true.</span></span> <span data-ttu-id="37136-111">Un *instancia suscripción* indica que se deberían enrutar mensajes que cumplen con la suscripción a una instancia está ya en ejecución del suscriptor.</span><span class="sxs-lookup"><span data-stu-id="37136-111">An *instance subscription* indicates that messages that fulfill the subscription should be routed to an already-running instance of the subscriber.</span></span> <span data-ttu-id="37136-112">Ejemplos de cosas que crean suscripciones de instancia son las orquestaciones con recepciones correlativas y puertos de recepción de solicitud-respuesta que esperan una respuesta de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="37136-112">Examples of things that create instance subscriptions are orchestrations with correlated receives and request/response-style receive ports waiting for a response from BizTalk Server.</span></span>  
  
 <span data-ttu-id="37136-113">La diferencia entre los dos tipos de suscripción en el nivel de información es que una suscripción de instancia incluye el Id. de instancia único, almacenado en la tabla de suscripciones de la base de datos de cuadro de mensajes principal.</span><span class="sxs-lookup"><span data-stu-id="37136-113">The difference between the two types of subscription at the information level is that an instance subscription includes the unique instance ID, stored in the subscription table in the master MessageBox database.</span></span> <span data-ttu-id="37136-114">Cuando una instancia de orquestación o un puerto de recepción finaliza el procesamiento, las suscripciones de instancia se quitan del cuadro de mensajes mientras que las suscripciones de activación permanecen activas mientras esté dada de alta la orquestación o el puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="37136-114">When an orchestration instance or receive port completes processing, instance subscriptions are removed from the MessageBox while activation subscriptions remain active as long as the orchestration or send port is enlisted.</span></span>  
  
## <a name="creating-subscriptions"></a><span data-ttu-id="37136-115">Crear suscripciones</span><span class="sxs-lookup"><span data-stu-id="37136-115">Creating Subscriptions</span></span>  
 <span data-ttu-id="37136-116">Las suscripciones se crean mediante clases de servicio en BizTalk Server, que se enumeran en la tabla adm_ServiceClass de la base de datos de administración de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="37136-116">Subscriptions are created by service classes in BizTalk Server, which are listed in the adm_ServiceClass table in the BizTalk Server Management database.</span></span> <span data-ttu-id="37136-117">Entre estos servicios están el servicio de almacenamiento en caché; la mensajería de tipo En curso y aislada, alojada por el administrador de extremos; orchestrations/XLANG, alojada por el subservicio XLANG.</span><span class="sxs-lookup"><span data-stu-id="37136-117">These services include the caching service; in-process and isolated messaging, hosted by the Endpoint Manager; and orchestrations/XLANG hosted by the XLANG subservice.</span></span> <span data-ttu-id="37136-118">Cada una de estas clases de servicio puede crear suscripciones y recibir mensajes publicados.</span><span class="sxs-lookup"><span data-stu-id="37136-118">Each of these service classes can create subscriptions and receive published messages.</span></span>  
  
 <span data-ttu-id="37136-119">Una suscripción es una colección de instrucciones de comparación, conocidas como predicados, que implican propiedades de contexto de mensajes y los valores específicos de la suscripción.</span><span class="sxs-lookup"><span data-stu-id="37136-119">A subscription is a collection of comparison statements, known as predicates, involving message context properties and the values specific to the subscription.</span></span> <span data-ttu-id="37136-120">Por ejemplo, Tipo de mensaje es una propiedad contextual de mensajes y muchas suscripciones especifican el tipo de mensaje en su suscripción.</span><span class="sxs-lookup"><span data-stu-id="37136-120">For example, Message Type is a context property of messages and many subscriptions specify the message type in their subscription.</span></span> <span data-ttu-id="37136-121">El agente de mensaje inserta información general de la suscripción en la tabla de suscripciones mientras que los predicados específicos van a alguna de las siguientes tablas de predicados, dependiendo del tipo de operación especificada para la suscripción:</span><span class="sxs-lookup"><span data-stu-id="37136-121">General information about the subscription is inserted into the subscriptions table by the Message Agent while the specific predicates go into one of the following predicate tables, depending on the type of operation specified for the subscription:</span></span>  
  
-   <span data-ttu-id="37136-122">BitwiseANDPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-122">BitwiseANDPredicates</span></span>  
  
-   <span data-ttu-id="37136-123">EqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-123">EqualsPredicates</span></span>  
  
-   <span data-ttu-id="37136-124">EqualsPredicates2ndPass</span><span class="sxs-lookup"><span data-stu-id="37136-124">EqualsPredicates2ndPass</span></span>  
  
-   <span data-ttu-id="37136-125">ExistsPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-125">ExistsPredicates</span></span>  
  
-   <span data-ttu-id="37136-126">FirstPassPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-126">FirstPassPredicates</span></span>  
  
-   <span data-ttu-id="37136-127">GreaterThanOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-127">GreaterThanOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="37136-128">GreaterThanPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-128">GreaterThanPredicates</span></span>  
  
-   <span data-ttu-id="37136-129">LessThenOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-129">LessThenOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="37136-130">LessThenPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-130">LessThenPredicates</span></span>  
  
-   <span data-ttu-id="37136-131">NotEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="37136-131">NotEqualsPredicates</span></span>  
  
 <span data-ttu-id="37136-132">Todo esto se logra mediante una llamada a la Bts_CreateSubscription_\<nombre de la aplicación\> y Bts_InsertPredicate_\<nombre de la aplicación\> where de base de datos de los procedimientos almacenados en el cuadro de mensajes \< nombre de la aplicación\> es el nombre del host de BizTalk que está creando la suscripción.</span><span class="sxs-lookup"><span data-stu-id="37136-132">All of this is accomplished by calling the Bts_CreateSubscription_\<application name\> and Bts_InsertPredicate_\<application name\> stored procedures in the MessageBox database where \<application name\> is the name of the BizTalk host that is creating the subscription.</span></span>  
  
 <span data-ttu-id="37136-133">Cuando se da de alta un puerto de envío, el puerto crea, en un mínimo, una suscripción para cualquier mensaje con el Id. de transporte de ese puerto de envío en el contexto.</span><span class="sxs-lookup"><span data-stu-id="37136-133">When a send port is enlisted, the port creates, at a minimum, a subscription for any message with that send port's transport ID in the context.</span></span> <span data-ttu-id="37136-134">Esto permite que el puerto de envío reciba siempre los mensajes dirigidos específicamente a él.</span><span class="sxs-lookup"><span data-stu-id="37136-134">This allows the send port to always receive messages intended specifically for it.</span></span> <span data-ttu-id="37136-135">Cuando se enlaza un puerto de orquestación a un puerto de envío concreto, la información acerca de ese enlace se almacena en la base de datos de administración de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="37136-135">When an orchestration port is bound to a particular send port, the information about that binding is stored in the BizTalk Management database.</span></span> <span data-ttu-id="37136-136">Cuando se envían mensajes desde la orquestación a través del puerto enlazado al puerto de envío físico, se incluye el Id. de transporte en el contexto de forma que el mensaje se enruta hacia ese puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="37136-136">When messages are sent from the orchestration through the port bound to the physical send port, the Transport ID is included in the context so that the message gets routed to that send port.</span></span> <span data-ttu-id="37136-137">Sin embargo, es importante tener en cuenta que este puerto de envío no es el único puerto de envío que puede recibir mensajes enviados desde la orquestación.</span><span class="sxs-lookup"><span data-stu-id="37136-137">However, it is important to note that this send port is not the only send port that can receive messages sent from the orchestration.</span></span> <span data-ttu-id="37136-138">Cuando una orquestación envía un mensaje, ese mensaje se publica en el cuadro de mensajes con todas las propiedades promocionadas relevantes.</span><span class="sxs-lookup"><span data-stu-id="37136-138">When an orchestration sends a message, that message is published to the MessageBox with all of the relevant promoted properties.</span></span> <span data-ttu-id="37136-139">El puerto de envío enlazado tiene garantizada la recepción de una copia del mensaje porque el Id. de transporte está en el contexto, pero cualquier otro puerto de envío, u orquestación, puede tener una suscripción que también coincide con las propiedades del mensaje.</span><span class="sxs-lookup"><span data-stu-id="37136-139">The bound send port is guaranteed to receive a copy of the message because the transport ID is in the context, but any other send port, or orchestration, can have a subscription that also matches the message properties.</span></span> <span data-ttu-id="37136-140">Es muy importante tener claro que siempre que se publica un mensaje directamente en el cuadro de mensajes, todos los suscriptores con suscripciones coincidentes recibirán una copia del mensaje.</span><span class="sxs-lookup"><span data-stu-id="37136-140">It is very important to understand that any time a message is published directly to the MessageBox, all subscribers with matching subscriptions will receive a copy of the message.</span></span>  
  
## <a name="publishing-and-routing"></a><span data-ttu-id="37136-141">Publicar y enrutar</span><span class="sxs-lookup"><span data-stu-id="37136-141">Publishing and Routing</span></span>  
 <span data-ttu-id="37136-142">Una vez creada y habilitada una suscripción, se debe publicar un mensaje antes de que se lleve a cabo el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="37136-142">After a subscription is created and enabled, a message must be published before any processing takes place.</span></span> <span data-ttu-id="37136-143">Los mensajes se publican cuando se reciben en BizTalk Server desde uno de los servicios mencionados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="37136-143">Messages are published when they are received into BizTalk Server from one of the services mentioned previously.</span></span> <span data-ttu-id="37136-144">Para este tema sobre enrutamiento, nos centraremos en los mensajes recibidos en BizTalk Server a través de un adaptador.</span><span class="sxs-lookup"><span data-stu-id="37136-144">For this discussion of routing, we will focus on messages received into BizTalk Server through an adapter.</span></span>  
  
 <span data-ttu-id="37136-145">Cuando se procesan los mensajes en la canalización de recepción, se promocionan las propiedades en el contexto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="37136-145">When messages go through the receive pipeline processing, properties are promoted into the message context.</span></span> <span data-ttu-id="37136-146">Una vez que un mensaje está listo para publicarlo en el cuadro de mensajes después de haberlo procesado el adaptador y la canalización de recepción, lo primero que ocurre es que el agente de mensaje inserta los valores de las propiedades promocionadas y los valores de predicado del contexto del mensaje en la base de datos de SQL Server de cuadro de mensajes principal.</span><span class="sxs-lookup"><span data-stu-id="37136-146">After a message is ready to be published into the MessageBox after being processed by the receive adapter and pipeline, the first thing that happens is the Message Agent inserts the property values for the promoted properties and predicate values from the message context into the master MessageBox SQL Server database.</span></span> <span data-ttu-id="37136-147">Tener estos valores en la base de datos habilita al agente de mensaje para tomar decisiones de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="37136-147">Having these values in the database enables the Message Agent to make routing decisions.</span></span>  
  
 <span data-ttu-id="37136-148">El siguiente paso es para que el agente de mensaje pida a la base de datos de cuadro de mensajes principal que busque suscripciones para el lote de mensajes actual que se va a publicar.</span><span class="sxs-lookup"><span data-stu-id="37136-148">The next step is for the Message Agent to ask the master MessageBox database to find subscriptions for the current batch of messages being published.</span></span> <span data-ttu-id="37136-149">Tenga en cuenta que los mensajes no se han escrito aún en la base de datos, solo las propiedades del contexto.</span><span class="sxs-lookup"><span data-stu-id="37136-149">Keep in mind that the messages have not yet been written to the database, only the properties from the context.</span></span> <span data-ttu-id="37136-150">El procedimiento almacenado bts_FindSubscriptions del cuadro de mensajes consulta las tablas de suscripciones y predicados identificadas anteriormente y las vincula a las propiedades de mensaje almacenadas para el lote de mensajes actual.</span><span class="sxs-lookup"><span data-stu-id="37136-150">The bts_FindSubscriptions stored procedure in the MessageBox queries the subscription and predicate tables identified above, linking them to the message properties stored for the current batch of messages.</span></span>  
  
 <span data-ttu-id="37136-151">Con esta información, el agente de mensaje inserta el mensaje una vez en cada base de datos de cuadro de mensajes que tiene una suscripción llamando al procedimiento almacenado bts_InsertMessage.</span><span class="sxs-lookup"><span data-stu-id="37136-151">With this information, the Message Agent inserts the message once into each MessageBox database that has a subscription by calling the bts_InsertMessage stored procedure.</span></span> <span data-ttu-id="37136-152">El procedimiento almacenado bts_InsertMessage se llama por primera vez con un identificador de suscripción.</span><span class="sxs-lookup"><span data-stu-id="37136-152">The bts_InsertMessage stored procedure is first called with a subscription ID.</span></span> <span data-ttu-id="37136-153">En este primer paso, las llamadas de procedimiento almacenado la int_EvaluateSubscriptions procedimiento almacenan del que es responsable de buscar la información de detalles de suscripción, comprobar que el mensaje cumple los requisitos de seguridad para la aplicación mediante la comprobación de que mensaje de predicados coinciden con propiedades de la aplicación para el host y la inserción de una referencia al mensaje en la cola específica de la aplicación o la cola de suspensión específica de aplicación según el estado.</span><span class="sxs-lookup"><span data-stu-id="37136-153">On this first pass, the stored procedure calls the int_EvaluateSubscriptions stored procedure which is responsible for looking up the subscription detail information, verifying that the message meets security requirements for the application by checking that message predicates match application properties for the host, and inserting a reference to the message in the application specific queue or application specific suspended queue depending on the state.</span></span> <span data-ttu-id="37136-154">El Id. de mensaje, el Id. de suscripción, el Id. de servicio y otra información de suscripción se insertan en la tabla de la cola específica de la aplicación para cada suscripción que se encuentra para esta aplicación.</span><span class="sxs-lookup"><span data-stu-id="37136-154">The message ID, subscription ID, service ID, and other subscription information are inserted into the application specific queue table for each subscription that was found for this application.</span></span> <span data-ttu-id="37136-155">Tras insertar los mensajes, las propiedades de mensaje y las tablas de propiedades de mensaje se borran de los valores relacionados con el lote.</span><span class="sxs-lookup"><span data-stu-id="37136-155">After the messages are inserted, the message properties and message predicates tables are cleared of the batch related values.</span></span>  
  
 <span data-ttu-id="37136-156">El procedimiento almacenado bts_InsertMessage se llama después para cada parte del mensaje.</span><span class="sxs-lookup"><span data-stu-id="37136-156">The bts_InsertMessage stored procedure is called subsequently for each part in the message.</span></span> <span data-ttu-id="37136-157">En la primera llamada, se pasa el contexto del mensaje y, a continuación, se inserta en la tabla SPOOL junto con los metadatos sobre el mensaje, como el número de partes, el nombre de parte del cuerpo y el identificador.</span><span class="sxs-lookup"><span data-stu-id="37136-157">On the first call, the message context is passed and is then inserted into the SPOOL table along with metadata about the message such as the number of parts, the body part name and ID.</span></span> <span data-ttu-id="37136-158">Además, la parte del cuerpo del mensaje se inserta en la tabla PARTS mediante el procedimiento almacenado int_InsertPart.</span><span class="sxs-lookup"><span data-stu-id="37136-158">In addition the message body part is inserted into the PARTS table using the int_InsertPart stored procedure.</span></span> <span data-ttu-id="37136-159">A continuación, se llama al procedimiento almacenado bts_InsertMessage para cada parte restante del mensaje, donde solo se pasan al procedimiento almacenado int_InsertPart para que las guarde en la tabla PARTS.</span><span class="sxs-lookup"><span data-stu-id="37136-159">The bts_InsertMessage stored procedure is then called for each of the remaining message parts where they are simply passed to the int_InsertPart stored procedure to be persisted in the PARTS table.</span></span>  
  
 <span data-ttu-id="37136-160">Cuando se enrutan los mensajes, se agregan referencias para cada servicio que recibe la instancia específica del mensaje y sus partes insertando registros en las tablas siguientes:</span><span class="sxs-lookup"><span data-stu-id="37136-160">When messages are routed, references are added for each service that receives the specific instance of the message and its parts by inserting records into the following tables:</span></span>  
  
-   <span data-ttu-id="37136-161">MessageRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="37136-161">MessageRefCountLog1</span></span>  
  
-   <span data-ttu-id="37136-162">MessageRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="37136-162">MessageRefCountLog2</span></span>  
  
-   <span data-ttu-id="37136-163">PartRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="37136-163">PartRefCountLog1</span></span>  
  
-   <span data-ttu-id="37136-164">PartRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="37136-164">PartRefCountLog2</span></span>  
  
 <span data-ttu-id="37136-165">Estas referencias evitan que los mensajes y sus partes se eliminen con trabajos de limpieza que se ejecutan periódicamente para impedir que el cuadro de mensajes se llene con datos de mensajes que ya no están en el sistema.</span><span class="sxs-lookup"><span data-stu-id="37136-165">These references keep the messages and parts from being deleted by cleanup jobs that run periodically to keep the MessageBox from getting full with message data for messages that are no longer in the system.</span></span> <span data-ttu-id="37136-166">Se usan dos tablas para reducir los problemas de contención y bloqueo.</span><span class="sxs-lookup"><span data-stu-id="37136-166">Two tables are used to reduce contention and locking issues.</span></span>  
  
 <span data-ttu-id="37136-167">Ahora que el mensaje se ha enrutado hacia la cola correcta, se ha almacenado en las tablas de cola de impresión y partes, y se hace referencia a él en las colas específicas de la aplicación, las instancias de la aplicación deben extraer los mensajes de las colas.</span><span class="sxs-lookup"><span data-stu-id="37136-167">Now that the message has been routed to the right queue, stored in the Spool and Parts tables, and referenced in the application specific queues, the messages must be pulled off the queues by the application instances.</span></span> <span data-ttu-id="37136-168">Cada instancia de host tiene una serie de subprocesos de extracción de la cola que sondean continuamente la base de datos en un intervalo configurado en la tabla adm_ServiceClass de la base de datos de administración de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="37136-168">Each host instance has a number of dequeuing threads that continuously poll the database on an interval that is configured in the adm_ServiceClass table in the BizTalk Management database.</span></span> <span data-ttu-id="37136-169">Esta misma tabla tiene una columna para indicar el número de subprocesos de extracción de la cola que se usarán.</span><span class="sxs-lookup"><span data-stu-id="37136-169">This same table has a column to indicate the number of dequeuing threads to be used.</span></span> <span data-ttu-id="37136-170">Cada subproceso llama a la base de datos de cuadro de mensajes y llama a la bts_DequeueMessages_\<nombre de la aplicación\> procedimiento apropiado para la aplicación host se está ejecutando en almacenado.</span><span class="sxs-lookup"><span data-stu-id="37136-170">Each thread calls into the MessageBox database and calls the bts_DequeueMessages_\<application name\> stored procedure appropriate for the host application it is running in.</span></span> <span data-ttu-id="37136-171">Este procedimiento almacenado utiliza semántica de bloqueo para asegurarse de que solo una instancia y un subproceso de extracción pueden funcionar en un mensaje en la cola en un momento dado.</span><span class="sxs-lookup"><span data-stu-id="37136-171">This stored procedure uses locking semantics to make sure that only one instance and one dequeuing thread are able to operate on a message in the queue at a given time.</span></span> <span data-ttu-id="37136-172">La instancia de host que obtiene el bloqueo obtiene el mensaje y es responsable de entregarlo al subservicio al que está dirigido.</span><span class="sxs-lookup"><span data-stu-id="37136-172">The host instance that gets the lock gets the message, and is then responsible for handing the message to the subservice for which it is intended.</span></span>  
  
 <span data-ttu-id="37136-173">Si el servicio que recibe el mensaje es el administrador de extremos, se llama al puerto de envío (o la parte de respuesta de un puerto de recepción de solicitud-respuesta) y, si es el subservicio XLANG/s, se crea o se ubica una orquestación para servir la suscripción en función de si hay un Id. de instancia en la suscripción.</span><span class="sxs-lookup"><span data-stu-id="37136-173">If the service receiving the message is the Endpoint Manager, then the send port is invoked (or the response portion of a request/response receive port) and if it is the XLANG/s subservice, an orchestration is either created, or located to service the subscription depending on whether there is an instance ID in the subscription.</span></span> <span data-ttu-id="37136-174">El servicio entrega después la referencia al mensaje y su parte de manera que, si no hay más servicios con referencias, los datos del mensaje se pueden eliminar.</span><span class="sxs-lookup"><span data-stu-id="37136-174">The service then releases the reference to the message and its part so that if no other services have references, the message data can be deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37136-175">Vea también</span><span class="sxs-lookup"><span data-stu-id="37136-175">See Also</span></span>  
 [<span data-ttu-id="37136-176">El motor de mensajería</span><span class="sxs-lookup"><span data-stu-id="37136-176">The Messaging Engine </span></span>](../core/the-messaging-engine.md)