---
title: 'Paso 7 (de forma local): Crear una orquestación | Documentos de Microsoft'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 7c0b6d0e-cf00-4eee-9b89-28210bad46f4
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b92a641252a76f4668cdf4c96c8df442c43d4719
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
ms.locfileid: "22280228"
---
# <a name="step-7-on-premises-create-an-orchestration"></a><span data-ttu-id="94cc7-102">Paso 7 (de forma local): Crear una orquestación</span><span class="sxs-lookup"><span data-stu-id="94cc7-102">Step 7 (On Premises): Create an Orchestration</span></span>
<span data-ttu-id="94cc7-103">Según el escenario empresarial, después [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] recibe el mensaje de pedido de ventas de la cola de Bus de servicio, debe comprobar si la cantidad pedida en el mensaje es mayor que 100.</span><span class="sxs-lookup"><span data-stu-id="94cc7-103">According to the business scenario, after [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives the sales order message from the Service Bus Queue, it needs to check whether the quantity ordered in the message is greater than 100.</span></span> <span data-ttu-id="94cc7-104">Si la cantidad es mayor que 100, el mensaje se inserta en la **SalesOrder** tabla.</span><span class="sxs-lookup"><span data-stu-id="94cc7-104">If the quantity is greater than 100, the message is inserted into the **SalesOrder** table.</span></span> <span data-ttu-id="94cc7-105">En caso contrario, el mensaje se envía a una ubicación de archivos compartidos.</span><span class="sxs-lookup"><span data-stu-id="94cc7-105">Otherwise, the message is sent to a shared file location.</span></span> <span data-ttu-id="94cc7-106">Northwind consigue su lógica de negocios creando una orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-106">Northwind achieves this business logic by creating an orchestration.</span></span> <span data-ttu-id="94cc7-107">Este tema proporciona instrucciones paso a paso sobre cómo crear la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-107">This topic provides step-by-step guidance on how to create the orchestration.</span></span>  
  
### <a name="to-add-an-orchestration-to-the-includebtsbiztalkservernoversionincludesbtsbiztalkservernoversion-mdmd-project"></a><span data-ttu-id="94cc7-108">Para crear una orquestación en el proyecto de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="94cc7-108">To add an orchestration to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] project</span></span>  
  
1.  <span data-ttu-id="94cc7-109">En el [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ya ha creado, haga clic en el proyecto y seleccione **agregar**y, a continuación, haga clic en **nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-109">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] you already created, right-click the project, point to **Add**, and then click **New Item**.</span></span>  
  
2.  <span data-ttu-id="94cc7-110">En el **nuevo elemento** cuadro de diálogo, seleccione **orquestación de BizTalk**, escriba el nombre de asignación `OrderProcessing.odx`y, a continuación, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-110">In the **New Item** dialog box, select **BizTalk Orchestration**, enter the map name as `OrderProcessing.odx`, and then click **Add**.</span></span>  
  
## <a name="create-messages-for-the-orchestration"></a><span data-ttu-id="94cc7-111">Crear mensajes para la orquestación</span><span class="sxs-lookup"><span data-stu-id="94cc7-111">Create Messages for the Orchestration</span></span>  
 <span data-ttu-id="94cc7-112">El esquema que ha generado anteriormente describe los "tipos" necesarios para los mensajes de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-112">The schema that you generated earlier describes the “types” required for the messages in the orchestration.</span></span> <span data-ttu-id="94cc7-113">Normalmente, un mensaje es una variable cuyo tipo está definido por el esquema correspondiente.</span><span class="sxs-lookup"><span data-stu-id="94cc7-113">A message is typically a variable, the type for which defined by the corresponding schema.</span></span> <span data-ttu-id="94cc7-114">Ahora debe crear mensajes para la orquestación y vincularlos a los esquemas que ha generado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="94cc7-114">You must now create messages for the orchestration and link them to schemas you generated earlier.</span></span> <span data-ttu-id="94cc7-115">Necesita crear los tres mensajes siguientes:</span><span class="sxs-lookup"><span data-stu-id="94cc7-115">You need to create following three messages:</span></span>  
  
|<span data-ttu-id="94cc7-116">Nombre del mensaje</span><span class="sxs-lookup"><span data-stu-id="94cc7-116">Message Name</span></span>|<span data-ttu-id="94cc7-117">Corresponde al esquema</span><span class="sxs-lookup"><span data-stu-id="94cc7-117">Corresponds to schema</span></span>|  
|------------------|---------------------------|  
|<span data-ttu-id="94cc7-118">Message1_SO_Inbound</span><span class="sxs-lookup"><span data-stu-id="94cc7-118">Message1_SO_Inbound</span></span>|<span data-ttu-id="94cc7-119">Este mensaje es una instancia de la **ECommerceSalesOrder.xsd** esquema.</span><span class="sxs-lookup"><span data-stu-id="94cc7-119">This message is an instance of the **ECommerceSalesOrder.xsd** schema.</span></span>|  
|<span data-ttu-id="94cc7-120">Message2_SO_Inbound</span><span class="sxs-lookup"><span data-stu-id="94cc7-120">Message2_SO_Inbound</span></span>|<span data-ttu-id="94cc7-121">Este mensaje es una copia de la **Message1_SO_Inbound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-121">This message is a copy of the **Message1_SO_Inbound**.</span></span> <span data-ttu-id="94cc7-122">Como práctica recomendada, debe crear una copia del mensaje, modificar después el nuevo mensaje y dejar el mensaje original intacto.</span><span class="sxs-lookup"><span data-stu-id="94cc7-122">As a best practice, you must create a copy of the message and then modify the new message, leaving the original message intact.</span></span> <span data-ttu-id="94cc7-123">Para obtener más información, consulte [el mensaje de BizTalk Server](http://msdn.microsoft.com/library/aa560436).</span><span class="sxs-lookup"><span data-stu-id="94cc7-123">For more information, see [The BizTalk Server Message](http://msdn.microsoft.com/library/aa560436).</span></span>|  
|<span data-ttu-id="94cc7-124">Message1_SO_Outbound</span><span class="sxs-lookup"><span data-stu-id="94cc7-124">Message1_SO_Outbound</span></span>|<span data-ttu-id="94cc7-125">Este mensaje es una instancia de la **TableOperations.dbo.SalesOrder (inserción)** esquema.</span><span class="sxs-lookup"><span data-stu-id="94cc7-125">This message is an instance of the **TableOperations.dbo.SalesOrder (Insert)** schema.</span></span>|  
  
#### <a name="to-create-the-messages"></a><span data-ttu-id="94cc7-126">Para crear mensajes</span><span class="sxs-lookup"><span data-stu-id="94cc7-126">To create the messages</span></span>  
  
1.  <span data-ttu-id="94cc7-127">Abra la **Vista orquestación** ventana del proyecto de BizTalk, si no está ya abierto.</span><span class="sxs-lookup"><span data-stu-id="94cc7-127">Open the **Orchestration View** window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="94cc7-128">Para ello, haga clic en **vista**, seleccione **otras ventanas**y, a continuación, haga clic en **Vista orquestación**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-128">To do so, click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
2.  <span data-ttu-id="94cc7-129">En Vista orquestación, haga clic en **mensajes**y, a continuación, haga clic en **nuevo mensaje**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-129">In Orchestration View, right-click **Messages**, and then click **New Message**.</span></span>  
  
3.  <span data-ttu-id="94cc7-130">Haga clic en el mensaje recién creado y, a continuación, seleccione **ventana propiedades**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-130">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
4.  <span data-ttu-id="94cc7-131">En el **propiedades** panel para la **Message_1**, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="94cc7-131">In the **Properties** pane for the **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="94cc7-132">Nombre de la propiedad</span><span class="sxs-lookup"><span data-stu-id="94cc7-132">Property name</span></span>|<span data-ttu-id="94cc7-133">Realizar acción</span><span class="sxs-lookup"><span data-stu-id="94cc7-133">Perform action</span></span>|  
    |-------------------|--------------------|  
    |<span data-ttu-id="94cc7-134">Identificador</span><span class="sxs-lookup"><span data-stu-id="94cc7-134">Identifier</span></span>|<span data-ttu-id="94cc7-135">Escriba`Message1_SO_Inbound`</span><span class="sxs-lookup"><span data-stu-id="94cc7-135">Enter `Message1_SO_Inbound`</span></span>|  
    |<span data-ttu-id="94cc7-136">Tipo de mensaje</span><span class="sxs-lookup"><span data-stu-id="94cc7-136">Message Type</span></span>|<span data-ttu-id="94cc7-137">En la lista desplegable, expanda **esquemas**y, a continuación, seleccione *OrderProcessingDemo.ECommerceSalesOrder*, donde *OrderProcessingDemo* es el nombre de su BizTalk proyecto.</span><span class="sxs-lookup"><span data-stu-id="94cc7-137">From the drop-down list, expand **Schemas**, and then select *OrderProcessingDemo.ECommerceSalesOrder*, where *OrderProcessingDemo* is the name of your BizTalk project.</span></span> <span data-ttu-id="94cc7-138">*ECommerceSalesOrder* es el esquema para el mensaje de pedido de ventas recibido desde la cola de Bus de servicio.</span><span class="sxs-lookup"><span data-stu-id="94cc7-138">*ECommerceSalesOrder* is the schema for the sales order message received from the Service Bus Queue.</span></span>|  
  
5.  <span data-ttu-id="94cc7-139">Repita los pasos para crear los mensajes con los siguientes detalles:</span><span class="sxs-lookup"><span data-stu-id="94cc7-139">Repeat the steps to create the messages with following details:</span></span>  
  
    |<span data-ttu-id="94cc7-140">Nombre del mensaje</span><span class="sxs-lookup"><span data-stu-id="94cc7-140">Message name</span></span>||  
    |------------------|-|  
    |<span data-ttu-id="94cc7-141">Message2_SO_Inbound</span><span class="sxs-lookup"><span data-stu-id="94cc7-141">Message2_SO_Inbound</span></span>|<span data-ttu-id="94cc7-142">-Establecer **identificador** a`Message2_SO_Inbound`</span><span class="sxs-lookup"><span data-stu-id="94cc7-142">-   Set **Identifier** to `Message2_SO_Inbound`</span></span><br /><span data-ttu-id="94cc7-143">-Establecer **tipo de mensaje** a *OrderProcessingDemo.ECommerceSalesOrder*</span><span class="sxs-lookup"><span data-stu-id="94cc7-143">-   Set **Message Type** to *OrderProcessingDemo.ECommerceSalesOrder*</span></span>|  
    |<span data-ttu-id="94cc7-144">Message1_SO_Outbound</span><span class="sxs-lookup"><span data-stu-id="94cc7-144">Message1_SO_Outbound</span></span>|<span data-ttu-id="94cc7-145">-Establecer **identificador** a`Message1_SO_Outound`</span><span class="sxs-lookup"><span data-stu-id="94cc7-145">-   Set **Identifier** to `Message1_SO_Outound`</span></span><br /><span data-ttu-id="94cc7-146">-Establecer **tipo de mensaje** a *OrderProcessingDemo.TableOperation_dbo_SalesOrder.Insert*</span><span class="sxs-lookup"><span data-stu-id="94cc7-146">-   Set **Message Type** to *OrderProcessingDemo.TableOperation_dbo_SalesOrder.Insert*</span></span>|  
  
## <a name="add-shapes-to-the-orchestration"></a><span data-ttu-id="94cc7-147">Agregar formas a la orquestación</span><span class="sxs-lookup"><span data-stu-id="94cc7-147">Add Shapes to the Orchestration</span></span>  
 <span data-ttu-id="94cc7-148">Las formas de la orquestación definen el flujo de una aplicación de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="94cc7-148">Orchestration shapes define the flow of a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application.</span></span> <span data-ttu-id="94cc7-149">En esta sección, se agregan las formas necesarias a la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-149">In this section, you add the required shapes to the orchestration.</span></span>  
  
#### <a name="to-add-shapes-to-the-orchestration"></a><span data-ttu-id="94cc7-150">Para agregar formas a la orquestación</span><span class="sxs-lookup"><span data-stu-id="94cc7-150">To add shapes to the orchestration</span></span>  
  
1.  <span data-ttu-id="94cc7-151">Para empezar, debe agregar una **recepción** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-151">To start with, you must add a **Receive** shape.</span></span> <span data-ttu-id="94cc7-152">Esta forma recibe el mensaje del pedido de ventas entrante desde la cola del Service Bus.</span><span class="sxs-lookup"><span data-stu-id="94cc7-152">This shape receives the incoming sales order message from the Service Bus Queue.</span></span> <span data-ttu-id="94cc7-153">Establezca las siguientes propiedades en la forma de recepción.</span><span class="sxs-lookup"><span data-stu-id="94cc7-153">Set the following properties on the receive shape.</span></span>  
  
    1.  <span data-ttu-id="94cc7-154">Establecer **activar** a **True**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-154">Set **Activate** to **True**.</span></span>  
  
    2.  <span data-ttu-id="94cc7-155">Establecer **mensaje** a **Message1_SO_Inbound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-155">Set **Message** to **Message1_SO_Inbound**.</span></span>  
  
    3.  <span data-ttu-id="94cc7-156">Establecer **nombre** a **ReceiveOrder**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-156">Set **Name** to **ReceiveOrder**.</span></span>  
  
2.  <span data-ttu-id="94cc7-157">Como se ha mencionado anteriormente, debe crear una copia del mensaje del pedido de ventas original que se recibe en la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-157">As mentioned earlier, you must create a copy of the original sales order message that is received into the orchestration.</span></span>  
  
    1.  <span data-ttu-id="94cc7-158">Arrastrar y colocar un **construir mensaje** forma bajo la **ReceiveOrder** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-158">Drag-and-drop a **Construct Message** shape under the **ReceiveOrder** shape.</span></span> <span data-ttu-id="94cc7-159">Dado que esta forma se usa para construir un mensaje de tipo Message2_SO_Inbound, establezca el **mensajes construidos** propiedad **Message2_SO_Inbound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-159">Because you use this shape to construct a message of type Message2_SO_Inbound, set the **Messages Constructed** property to **Message2_SO_Inbound**.</span></span>  
  
    2.  <span data-ttu-id="94cc7-160">Agregar un **asignación de mensajes** forma dentro de la **construir mensaje** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-160">Add a **Message Assignment** shape within the **Construct Message** shape.</span></span> <span data-ttu-id="94cc7-161">Haga doble clic en la forma para abrir el Editor de expresiones y agregue lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="94cc7-161">Double-click the shape to open the Expression Editor, and add the following:</span></span>  
  
        ```  
        Message2_SO_Inbound = Message1_SO_Inbound; //copy the message  
        Message2_SO_Inbound(*) = Message1_SO_Inbound(*); //copy the context properties on the message  
        ```  
  
         <span data-ttu-id="94cc7-162">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-162">Click **OK**.</span></span>  
  
3.  <span data-ttu-id="94cc7-163">Según el escenario de negocio, el mensaje se debe enviar a distintos destinos en función de la cantidad de elementos pedidos.</span><span class="sxs-lookup"><span data-stu-id="94cc7-163">According to the business scenario, the message must be sent to different destinations based on the quantity of ordered items.</span></span> <span data-ttu-id="94cc7-164">Por lo tanto, ahora debe extraer el valor de cantidad del mensaje del pedido de ventas entrante.</span><span class="sxs-lookup"><span data-stu-id="94cc7-164">So, you must now extract the quantity value from the incoming sales order message.</span></span>  
  
    1.  <span data-ttu-id="94cc7-165">El **cantidad** elemento en el mensaje entrante (ECommerceSalesOrder.xsd) contiene el valor de la cantidad pedida.</span><span class="sxs-lookup"><span data-stu-id="94cc7-165">The **Quantity** element in the inbound message (ECommerceSalesOrder.xsd) contains the value of the ordered quantity.</span></span> <span data-ttu-id="94cc7-166">Debe promocionar esta propiedad para que el elemento se pueda usar en las expresiones de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-166">You must promote that property so that the element can be used within the expressions in the orchestration.</span></span> <span data-ttu-id="94cc7-167">Para promover la propiedad, abra el **ECommerceSalesOrder.xsd** esquema, haga clic en **cantidad**, seleccione **promover**y, a continuación, haga clic en **promoción rápida** .</span><span class="sxs-lookup"><span data-stu-id="94cc7-167">To promote the property, open the **ECommerceSalesOrder.xsd** schema, right-click **Quantity**, point to **Promote**, and then click **Quick Promotions**.</span></span>  
  
    2.  <span data-ttu-id="94cc7-168">Cree una variable para almacenar el valor de la cantidad.</span><span class="sxs-lookup"><span data-stu-id="94cc7-168">Create a variable to store the quantity value.</span></span> <span data-ttu-id="94cc7-169">Para crear una variable, desde el **Vista orquestación**, haga clic en **Variables**y, a continuación, haga clic en **nueva Variable**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-169">To create a variable, from the **Orchestration View**, right-click **Variables**, and then click **New Variable**.</span></span> <span data-ttu-id="94cc7-170">Establezca las siguientes propiedades de la variable:</span><span class="sxs-lookup"><span data-stu-id="94cc7-170">Set the following properties for the variable:</span></span>  
  
        |<span data-ttu-id="94cc7-171">Nombre de la propiedad</span><span class="sxs-lookup"><span data-stu-id="94cc7-171">Property name</span></span>|<span data-ttu-id="94cc7-172">Valor</span><span class="sxs-lookup"><span data-stu-id="94cc7-172">Value</span></span>|  
        |-------------------|-----------|  
        |<span data-ttu-id="94cc7-173">Identificador</span><span class="sxs-lookup"><span data-stu-id="94cc7-173">Identifier</span></span>|<span data-ttu-id="94cc7-174">Escriba`quantityOrdered`</span><span class="sxs-lookup"><span data-stu-id="94cc7-174">Enter `quantityOrdered`</span></span>|  
        |<span data-ttu-id="94cc7-175">Tipo</span><span class="sxs-lookup"><span data-stu-id="94cc7-175">Type</span></span>|<span data-ttu-id="94cc7-176">Seleccione **Int32**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-176">Select **Int32**.</span></span>|  
  
    3.  <span data-ttu-id="94cc7-177">Ahora debe asignar el valor de la **cantidad** elemento a la **quantityOrdered** variable.</span><span class="sxs-lookup"><span data-stu-id="94cc7-177">You must now assign the value in the **Quantity** element to the **quantityOrdered** variable.</span></span> <span data-ttu-id="94cc7-178">Arrastrar y colocar un **Editor de expresiones** después de la **construir mensaje** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-178">Drag-and-drop an **Expression Editor** after the **Construct Message** shape.</span></span> <span data-ttu-id="94cc7-179">Abra el editor y escriba la siguiente expresión.</span><span class="sxs-lookup"><span data-stu-id="94cc7-179">Open the editor and enter the following expression:</span></span>  
  
        ```  
        quantityOrdered = Message2_SO_Inbound.Quantity;  
        ```  
  
         <span data-ttu-id="94cc7-180">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-180">Click **OK**.</span></span>  
  
4.  <span data-ttu-id="94cc7-181">Después de extraer la cantidad del pedido, ahora necesita crear un bloque de decisiones donde distribuir las dos rutas separadas que toma el flujo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="94cc7-181">After extracting the order quantity, you now need to create a decision block where you layout two separate paths the message flow takes.</span></span> <span data-ttu-id="94cc7-182">Crear el bloque de decisiones en una orquestación mediante la adición de un **decidir** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-182">You create the decision block in an orchestration by adding a **Decide** shape.</span></span>  
  
    1.  <span data-ttu-id="94cc7-183">Arrastre y coloque una **decidir** forma después de la **Editor de expresiones** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-183">Drag and drop a **Decide** shape after the **Expression Editor** shape.</span></span>  
  
    2.  <span data-ttu-id="94cc7-184">Seleccione el **Rule_1** forma y en el **propiedades** ventana, especifique lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="94cc7-184">Select the **Rule_1** shape and in the **Properties** window, specify the following:</span></span>  
  
        |<span data-ttu-id="94cc7-185">Nombre de la propiedad</span><span class="sxs-lookup"><span data-stu-id="94cc7-185">Property name</span></span>|<span data-ttu-id="94cc7-186">Valor</span><span class="sxs-lookup"><span data-stu-id="94cc7-186">Value</span></span>|  
        |-------------------|-----------|  
        |<span data-ttu-id="94cc7-187">Identificador</span><span class="sxs-lookup"><span data-stu-id="94cc7-187">Identifier</span></span>|<span data-ttu-id="94cc7-188">Escriba `Yes`.</span><span class="sxs-lookup"><span data-stu-id="94cc7-188">Enter `Yes`.</span></span> <span data-ttu-id="94cc7-189">**Nota:** es la otra ruta predeterminada denominada **Else**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-189">**Note:**  The other route is by default named **Else**.</span></span>|  
        |<span data-ttu-id="94cc7-190">Expresión</span><span class="sxs-lookup"><span data-stu-id="94cc7-190">Expression</span></span>|<span data-ttu-id="94cc7-191">Escriba `quantityOrdered > 100`.</span><span class="sxs-lookup"><span data-stu-id="94cc7-191">Enter `quantityOrdered > 100`.</span></span>|  
  
         <span data-ttu-id="94cc7-192">Ahora las dos rutas están disponibles.</span><span class="sxs-lookup"><span data-stu-id="94cc7-192">You now have two routes available.</span></span> <span data-ttu-id="94cc7-193">Si el valor de la **quantityOrdered** variable es mayor que 100, el mensaje tiene el **Sí** ruta.</span><span class="sxs-lookup"><span data-stu-id="94cc7-193">If the value in the **quantityOrdered** variable is greater than 100, the message takes the **Yes** route.</span></span> <span data-ttu-id="94cc7-194">De lo contrario, mantiene la **Else** ruta.</span><span class="sxs-lookup"><span data-stu-id="94cc7-194">Otherwise, it takes the **Else** route.</span></span> <span data-ttu-id="94cc7-195">Ahora hay que definir las acciones que se realizarán en cada ruta.</span><span class="sxs-lookup"><span data-stu-id="94cc7-195">You must now define the actions to be performed within each route.</span></span>  
  
5.  <span data-ttu-id="94cc7-196">Según el escenario de negocio, si la cantidad del pedido es superior a 100, el mensaje se debe insertar en la tabla SalesOrder.</span><span class="sxs-lookup"><span data-stu-id="94cc7-196">According to the business scenario, if the order quantity is greater than 100, the message must be inserted into the SalesOrder table.</span></span> <span data-ttu-id="94cc7-197">Por lo tanto, en la **Sí** ruta, debe transformar el esquema ECommerceSalesOrder.xsd en el esquema TableOperations.SalesOrder.Insert.</span><span class="sxs-lookup"><span data-stu-id="94cc7-197">So, in the **Yes** route, you must transform the ECommerceSalesOrder.xsd schema to the TableOperations.SalesOrder.Insert schema.</span></span> <span data-ttu-id="94cc7-198">Ha creado el esquema de inserción en el tema [(local) del paso 5: generar el esquema para insertar un mensaje en la tabla SalesOrder](../core/step-5-generate-the-schema-for-inserting-a-message-into-salesorder-table.md).</span><span class="sxs-lookup"><span data-stu-id="94cc7-198">You created the Insert schema in the topic [Step 5 (On Premises): Generate the Schema for Inserting a Message inito SalesOrder Table](../core/step-5-generate-the-schema-for-inserting-a-message-into-salesorder-table.md).</span></span> <span data-ttu-id="94cc7-199">Después de transformar el esquema, debe enviar el mensaje fuera a la tabla de base de datos de SQL Server. </span><span class="sxs-lookup"><span data-stu-id="94cc7-199">After transforming the schema, you must send the message to the message out to the SQL Server database table.</span></span>  
  
    1.  <span data-ttu-id="94cc7-200">En el **Sí** de ruta, arrastre y coloque una **construir mensaje** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-200">Within the **Yes** route, drag and drop a **Construct Message** shape.</span></span> <span data-ttu-id="94cc7-201">Establecer el **mensajes construidos** propiedad para la forma en **Message1_SO_Outbound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-201">Set the **Messages Constructed** property for the shape to **Message1_SO_Outbound**.</span></span>  
  
    2.  <span data-ttu-id="94cc7-202">En el **construir mensaje** agregar de forma un **transformar** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-202">Within the **Construct Message** shape add a **Transform** shape.</span></span> <span data-ttu-id="94cc7-203">Haga doble clic en la forma para abrir el **configuración de transformación** cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="94cc7-203">Double-click the shape to open the **Transform Configuration** dialog box.</span></span> <span data-ttu-id="94cc7-204">Realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="94cc7-204">Do the following:</span></span>  
  
        1.  <span data-ttu-id="94cc7-205">Seleccione el **mapa existente** opción.</span><span class="sxs-lookup"><span data-stu-id="94cc7-205">Select the **Existing Map** option.</span></span>  
  
        2.  <span data-ttu-id="94cc7-206">Desde el **nombre completo de asignación** lista desplegable, seleccione **OrderProcessingDemo.SalesOrder_SQL**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-206">From the **Fully Qualified Map Name** drop-down, select **OrderProcessingDemo.SalesOrder_SQL**.</span></span>  
  
        3.  <span data-ttu-id="94cc7-207">Para **origen**, seleccione **Message2_SO_Inbound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-207">For **Source**, select **Message2_SO_Inbound**.</span></span>  
  
        4.  <span data-ttu-id="94cc7-208">Para **destino**, seleccione **Message1_SO_Outound**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-208">For **Destination**, select **Message1_SO_Outound**.</span></span>  
  
    3.  <span data-ttu-id="94cc7-209">Después de la **construir mensaje** forma, arrastre y coloque una **enviar** forma y establezca el **mensaje** propiedad para la forma en `Message1_SO_Outbound`.</span><span class="sxs-lookup"><span data-stu-id="94cc7-209">After the **Construct Message** shape, drag and drop a **Send** shape and set the **Message** property for the shape to `Message1_SO_Outbound`.</span></span>  
  
6.  <span data-ttu-id="94cc7-210">Según el escenario de negocio, si la cantidad del pedido es inferior a 100, el mensaje se debe enviar a una ubicación de archivos compartidos.</span><span class="sxs-lookup"><span data-stu-id="94cc7-210">According to the business scenario, if the order quantity is less than 100, the message must be sent to a shared file location.</span></span> <span data-ttu-id="94cc7-211">Por lo tanto, en la **Else** ruta debe agregar una forma de envío.</span><span class="sxs-lookup"><span data-stu-id="94cc7-211">So, in the **Else** route you must add a send shape.</span></span>  
  
    1.  <span data-ttu-id="94cc7-212">En el **Else** de ruta, arrastre y coloque una **enviar** forma y establezca el **mensaje** propiedad para la forma en `Message2_SO_Inbound`.</span><span class="sxs-lookup"><span data-stu-id="94cc7-212">Within the **Else** route, drag and drop a **Send** shape, and set the **Message** property for the shape to `Message2_SO_Inbound`.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="94cc7-213">Se establece el mensaje en Message2_SO_Inbound porque el mismo mensaje que se recibe de la cola del Service Bus se envía a la ubicación de archivos sin procesamiento.</span><span class="sxs-lookup"><span data-stu-id="94cc7-213">You set the Message to Message2_SO_Inbound because the same message that is received from the Service Bus Queue is sent to the file location, without any processing.</span></span> <span data-ttu-id="94cc7-214">Message2_SO_Inbound representa el mensaje que recibe la cola del Service Bus.</span><span class="sxs-lookup"><span data-stu-id="94cc7-214">Message2_SO_Inbound represents the message that is received by the Service Bus Queue.</span></span>  
  
## <a name="add-ports-to-the-orchestration"></a><span data-ttu-id="94cc7-215">Agregar puertos a la orquestación</span><span class="sxs-lookup"><span data-stu-id="94cc7-215">Add Ports to the Orchestration</span></span>  
 <span data-ttu-id="94cc7-216">Los puertos representan los medios de entrada y de salida del mensaje con respecto a una orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-216">Ports represent the input and output mediums of the message with respect to an orchestration.</span></span> <span data-ttu-id="94cc7-217">Los mensajes son consumidos por la orquestación usando un puerto de recepción y se envían usando un puerto de envío. </span><span class="sxs-lookup"><span data-stu-id="94cc7-217">Messages are consumed by an orchestration using a receive port and are sent out using a send port.</span></span> <span data-ttu-id="94cc7-218">En el escenario de negocio, un mensaje se recibe de un medio (cola del Service Bus) y se envía a dos ubicaciones distintas (base de datos de SQL Server o ubicación de recurso compartido de archivos) según el procesamiento del mensaje.</span><span class="sxs-lookup"><span data-stu-id="94cc7-218">In the business scenario, a message is received from one medium (Service Bus Queue) and then sent out to two different locations (SQL Server database or a file share location) based on message processing.</span></span> <span data-ttu-id="94cc7-219">Por lo tanto, debe crear un puerto de recepción y dos puertos de envío como parte de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-219">So, you must create one receive port and two send ports as part of the orchestration.</span></span>  
  
#### <a name="to-add-ports"></a><span data-ttu-id="94cc7-220">Para agregar puertos</span><span class="sxs-lookup"><span data-stu-id="94cc7-220">To add ports</span></span>  
  
1.  <span data-ttu-id="94cc7-221">Arrastre y coloque un **puerto** dar forma a la **superficie para el puerto** panel de la **Diseñador de orquestaciones** para iniciar el **Asistente para configuración de puerto**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-221">Drag and drop a **Port** shape to the **Port Surface** pane of the **Orchestration Designer** to launch the **Port Configuration Wizard**.</span></span> <span data-ttu-id="94cc7-222">En el **bienvenida** página, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-222">On the **Welcome** page, click **Next**.</span></span>  
  
2.  <span data-ttu-id="94cc7-223">En el **propiedades de puerto** página, asigne nombre al puerto de `ReceiveSO` y, a continuación, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-223">In the **Port Properties** page, name the port as `ReceiveSO` and then click **Next**.</span></span>  
  
3.  <span data-ttu-id="94cc7-224">En el **seleccionar un tipo de puerto** , seleccione **crear un nuevo tipo de puerto** opción, seleccione la **unidireccional** comunicación de patrón, deje el valor predeterminado para las restricciones de acceso y, a continuación, Haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-224">In the **Select a Port Type** page, select **Create a new port type** option, select the **One-Way** communication pattern, leave the default for access restrictions, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="94cc7-225">En el **enlace de puerto** página, para la dirección de puerto, seleccione **siempre recibiré los mensajes en este puerto**, deje el enlace del puerto en el valor predeterminado y, a continuación, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-225">In the **Port Binding** page, for the port direction, select **I’ll always be receiving messages on this port**, leave the port biding to the default value, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="94cc7-226">En la última página, haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="94cc7-226">On the last page, click **Finish**.</span></span>  
  
6.  <span data-ttu-id="94cc7-227">Repita los pasos para crear los dos puertos de envío.</span><span class="sxs-lookup"><span data-stu-id="94cc7-227">Repeat the steps to create the two send ports.</span></span> <span data-ttu-id="94cc7-228">Especifique los siguientes valores cuando cree los puertos.</span><span class="sxs-lookup"><span data-stu-id="94cc7-228">Specify the following values while creating the ports.</span></span>  
  
    |<span data-ttu-id="94cc7-229">Nombre de puerto</span><span class="sxs-lookup"><span data-stu-id="94cc7-229">Port Name</span></span>|<span data-ttu-id="94cc7-230">Propiedades</span><span class="sxs-lookup"><span data-stu-id="94cc7-230">Properties</span></span>|  
    |---------------|----------------|  
    |<span data-ttu-id="94cc7-231">SendToSQL</span><span class="sxs-lookup"><span data-stu-id="94cc7-231">SendToSQL</span></span>|<span data-ttu-id="94cc7-232">-Establecer **nombre** a **SendToSQL**</span><span class="sxs-lookup"><span data-stu-id="94cc7-232">-   Set **Name** to **SendToSQL**</span></span><br /><span data-ttu-id="94cc7-233">-Seleccione **crear un nuevo tipo de puerto**</span><span class="sxs-lookup"><span data-stu-id="94cc7-233">-   Select **Create a new port type**</span></span><br /><span data-ttu-id="94cc7-234">: Patrón de comunicación conjunto a **unidireccional**</span><span class="sxs-lookup"><span data-stu-id="94cc7-234">-   Set communication pattern to **One-way**</span></span><br /><span data-ttu-id="94cc7-235">: Establecer la dirección de puerto en **siempre enviaré los mensajes en este puerto**</span><span class="sxs-lookup"><span data-stu-id="94cc7-235">-   Set port direction to **I’ll always be sending messages on this port**</span></span>|  
    |<span data-ttu-id="94cc7-236">SendToFile</span><span class="sxs-lookup"><span data-stu-id="94cc7-236">SendToFile</span></span>|<span data-ttu-id="94cc7-237">-Establecer **nombre** a **SendToFile**</span><span class="sxs-lookup"><span data-stu-id="94cc7-237">-   Set **Name** to **SendToFile**</span></span><br /><span data-ttu-id="94cc7-238">-Seleccione **crear un nuevo tipo de puerto**</span><span class="sxs-lookup"><span data-stu-id="94cc7-238">-   Select **Create a new port type**</span></span><br /><span data-ttu-id="94cc7-239">: Patrón de comunicación conjunto a **unidireccional**</span><span class="sxs-lookup"><span data-stu-id="94cc7-239">-   Set communication pattern to **One-way**</span></span><br /><span data-ttu-id="94cc7-240">: Establecer la dirección de puerto en **siempre enviaré los mensajes en este puerto**</span><span class="sxs-lookup"><span data-stu-id="94cc7-240">-   Set port direction to **I’ll always be sending messages on this port**</span></span>|  
  
## <a name="connect-ports-and-message-shapes"></a><span data-ttu-id="94cc7-241">Conectar puertos y formas de mensaje</span><span class="sxs-lookup"><span data-stu-id="94cc7-241">Connect Ports and Message Shapes</span></span>  
 <span data-ttu-id="94cc7-242">Ahora debe conectar los puertos y las formas de mensaje para completar la orquestación.</span><span class="sxs-lookup"><span data-stu-id="94cc7-242">You must now connect the ports and the message shapes to complete the orchestration.</span></span> <span data-ttu-id="94cc7-243">La orquestación se inicia cuando se recibe el mensaje por la **ReceiveOrder** forma y finaliza cuando se envía el mensaje de las dos formas de envío.</span><span class="sxs-lookup"><span data-stu-id="94cc7-243">The orchestration starts when the message is received by the **ReceiveOrder** shape and the orchestration exits when the message is sent out by the two Send shapes.</span></span> <span data-ttu-id="94cc7-244">Debe usar este criterio para conectar los puertos y las formas del mensaje.</span><span class="sxs-lookup"><span data-stu-id="94cc7-244">You must use this criterion to connect the ports and the message shapes</span></span>  
  
#### <a name="to-connect-ports-with-message-shapes"></a><span data-ttu-id="94cc7-245">Para conectar puertos a las formas de mensaje</span><span class="sxs-lookup"><span data-stu-id="94cc7-245">To connect ports with message shapes</span></span>  
  
1.  <span data-ttu-id="94cc7-246">Conectar el **ReceiveSO** puerto de recepción para el **ReceiveOrder** forma.</span><span class="sxs-lookup"><span data-stu-id="94cc7-246">Connect the **ReceiveSO** receive port to the **ReceiveOrder** shape.</span></span>  
  
2.  <span data-ttu-id="94cc7-247">Conecte la forma envío bajo la **Sí** enrutar a la **SendToSQL** puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="94cc7-247">Connect the Send shape under the **Yes** route to the **SendToSQL** send port.</span></span> <span data-ttu-id="94cc7-248">Esto denota que si un mensaje especifica esta ruta (**quantityOrdered** > 100), se enviará a la **SalesOrder** tabla en la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="94cc7-248">This denotes that if a message enters this route (**quantityOrdered** > 100), it’ll be sent to the **SalesOrder** table in the SQL Server database.</span></span>  
  
3.  <span data-ttu-id="94cc7-249">Conecte la forma envío bajo la **Else** enrutar a la **SendToFile** puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="94cc7-249">Connect the Send shape under the **Else** route to the **SendToFile** send port.</span></span> <span data-ttu-id="94cc7-250">Esto denota que si un mensaje especifica esta ruta (**quantityOrdered** < = 100), se enviará a una ubicación de archivo especificado.</span><span class="sxs-lookup"><span data-stu-id="94cc7-250">This denotes that if a message enters this route (**quantityOrdered** <= 100), it’ll be sent to a specified file location.</span></span>  
  
     <span data-ttu-id="94cc7-251">La orquestación debe tener el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="94cc7-251">The orchestration must resemble the following:</span></span>  
  
     <span data-ttu-id="94cc7-252">![Orquestación](../core/media/bts2010r2-tut1-orch.jpg "BTS2010R2_Tut1_Orch")</span><span class="sxs-lookup"><span data-stu-id="94cc7-252">![Orchestration](../core/media/bts2010r2-tut1-orch.jpg "BTS2010R2_Tut1_Orch")</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="94cc7-253">Vea también</span><span class="sxs-lookup"><span data-stu-id="94cc7-253">See Also</span></span>  
 [<span data-ttu-id="94cc7-254">Tutorial 4: Crear una aplicación híbrida mediante BizTalk Server 2013</span><span class="sxs-lookup"><span data-stu-id="94cc7-254">Tutorial 4: Creating a Hybrid Application Using BizTalk Server 2013</span></span>](../core/tutorial-4-creating-a-hybrid-application-using-biztalk-server-2013.md)