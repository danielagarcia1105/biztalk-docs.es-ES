---
title: Excepciones personalizadas | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- process management solution tutorial, compensation blocks
- compensation blocks, process management solutions
- process management solution tutorial, custom exceptions
- Terminate shape [Orchestration Designer], called orchestrations
- process management solution tutorial, errors
ms.assetid: 0c923303-82ad-4a20-9c7c-5e38c477993a
caps.latest.revision: 14
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bfead2aadc237d27e0fb8ed28a776dd1e4f5c6f6
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
ms.locfileid: "22240140"
---
# <a name="custom-exceptions"></a><span data-ttu-id="fd8a1-102">Excepciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="fd8a1-102">Custom Exceptions</span></span>
<span data-ttu-id="fd8a1-103">En situaciones donde hay un error irrecuperable, la solución Administración de procesos empresariales utiliza una combinación de controladores de excepción y de excepciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-103">For situations where there is an unrecoverable error, the Business Process Management solution uses a combination of exception handlers and custom exceptions.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="fd8a1-104">Control de excepciones</span><span class="sxs-lookup"><span data-stu-id="fd8a1-104">Handling Exceptions</span></span>  
 <span data-ttu-id="fd8a1-105">En lugar de usar **Terminate** formas en orquestaciones solicitadas se puede usar el patrón de producir excepciones controladas por la orquestación raíz.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-105">Rather than using **Terminate** shapes in called orchestrations you can use the pattern of throwing exceptions that are handled by the root orchestration.</span></span> <span data-ttu-id="fd8a1-106">Esto permite a la orquestación tomar la decisión de controlar la excepción teniendo el mayor conocimiento posible del contexto.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-106">This allows the orchestration with the widest knowledge of context to make the decision about handling the exception.</span></span> <span data-ttu-id="fd8a1-107">Cuando las orquestaciones subordinadas inician excepciones personalizadas, es posible comunicar más información específica a la orquestación raíz.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-107">Having the subordinate orchestrations throw custom exceptions enables you to communicate more specific information to the root orchestration.</span></span>  
  
 <span data-ttu-id="fd8a1-108">La solución Administración de procesos empresariales sigue este patrón.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-108">The business process management solution follows this pattern.</span></span> <span data-ttu-id="fd8a1-109">Hay cuatro raíz, o, las orquestaciones de la solución: **OrderBroker**, **OrderManager**, **CableOrder1**, y **CableOrder2**.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-109">There are four root, or uncalled, orchestrations in the solution: **OrderBroker**, **OrderManager**, **CableOrder1**, and **CableOrder2**.</span></span> <span data-ttu-id="fd8a1-110">Tres de las orquestaciones raíz reciben y controlan excepciones personalizadas: **OrderManager**, **CableOrder1**, y **CableOrder2**.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-110">Three of the root orchestrations receive and handle custom exceptions: **OrderManager**, **CableOrder1**, and **CableOrder2**.</span></span>  
  
 <span data-ttu-id="fd8a1-111">Tenga en cuenta que algunas de las orquestaciones raíz utilizan la **Terminate** forma y que la **Terminate** forma aparece justo antes del punto final normal de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-111">Note that some of the root orchestrations use the **Terminate** shape and that the **Terminate** shape appears just before the normal end point of the orchestration.</span></span> <span data-ttu-id="fd8a1-112">La orquestación también utiliza el **Terminate** forma si se produce un error para que la orquestación se registre como finalizada, en lugar de como completada, pero con un mensaje de error.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-112">The orchestration still uses the **Terminate** shape in case of an error so that the orchestration is recorded as terminated, rather than as completed but with an error message.</span></span> <span data-ttu-id="fd8a1-113">Esto permite que la solución haga fácilmente un seguimiento de instancias erróneas además de registrar el error.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-113">This allows the solution to track failed instances easily in addition to recording the error.</span></span>  
  
 <span data-ttu-id="fd8a1-114">Para obtener más información sobre la **Terminate** forma, consulte [cómo configurar la forma finalizar](../core/how-to-configure-the-terminate-shape.md).</span><span class="sxs-lookup"><span data-stu-id="fd8a1-114">For more information about the **Terminate** shape, see [How to Configure the Terminate Shape](../core/how-to-configure-the-terminate-shape.md).</span></span> <span data-ttu-id="fd8a1-115">Para obtener más información sobre la **ThrowException** forma, consulte [cómo configurar la forma de excepción Throw](../core/how-to-configure-the-throw-exception-shape.md).</span><span class="sxs-lookup"><span data-stu-id="fd8a1-115">For more information about the **ThrowException** shape, see [How to Configure the Throw Exception Shape](../core/how-to-configure-the-throw-exception-shape.md).</span></span>  
  
## <a name="the-custom-exceptions"></a><span data-ttu-id="fd8a1-116">Excepciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="fd8a1-116">The Custom Exceptions</span></span>  
 <span data-ttu-id="fd8a1-117">Cada una de las siguientes tres excepciones personalizadas tienen el mismo patrón.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-117">Each of the following three custom exceptions follows the same pattern.</span></span> <span data-ttu-id="fd8a1-118">Disponer de tipos diferenciados permite que el código distinga excepciones diferentes.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-118">Having distinct types allows the code to distinguish different exceptions.</span></span>  
  
|<span data-ttu-id="fd8a1-119">Exception</span><span class="sxs-lookup"><span data-stu-id="fd8a1-119">Exception</span></span>|<span data-ttu-id="fd8a1-120">Iniciada por (orquestación)</span><span class="sxs-lookup"><span data-stu-id="fd8a1-120">Thrown By (Orchestration)</span></span>|  
|---------------|---------------------------------|  
|<span data-ttu-id="fd8a1-121">**ActivateException**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-121">**ActivateException**</span></span>|<span data-ttu-id="fd8a1-122">**Cambio**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-122">**Change**</span></span>|  
|<span data-ttu-id="fd8a1-123">**CableOrderException**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-123">**CableOrderException**</span></span>|<span data-ttu-id="fd8a1-124">**Activar**, **CableOrder1**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-124">**Activate**, **CableOrder1**</span></span>|  
|<span data-ttu-id="fd8a1-125">**InterruptException**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-125">**InterruptException**</span></span>|<span data-ttu-id="fd8a1-126">**CableOrder1**, **CheckInterrupt**, **ErrorHandlerOrch**</span><span class="sxs-lookup"><span data-stu-id="fd8a1-126">**CableOrder1**, **CheckInterrupt**, **ErrorHandlerOrch**</span></span>|  
  
 <span data-ttu-id="fd8a1-127">Todas las excepciones personalizadas están definidas en el **utilidades** ensamblado.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-127">All of the custom exceptions are defined in the **Utilities** assembly.</span></span> <span data-ttu-id="fd8a1-128">Todas las excepciones personalizadas son clases .NET.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-128">The custom exceptions are all .NET classes.</span></span> <span data-ttu-id="fd8a1-129">Todas las clases de excepción personalizada de heredan de .NET **ApplicationException** clase que a su vez hereda de la **System.Exception** clase.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-129">All of the custom exception classes inherit from the .NET **ApplicationException** class which in turn inherits from the **System.Exception** class.</span></span> <span data-ttu-id="fd8a1-130">Dado que existe una posibilidad de que la excepción pueda estar deshidratada (serializada y almacenada en la base de datos), las excepciones deben implementar un constructor de deserialización.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-130">Because there is a possibility that the exception may be dehydrated (serialized and stored in the database), the exceptions must implement a deserialization constructor.</span></span> <span data-ttu-id="fd8a1-131">Un constructor de deserialización es un constructor que toma dos argumentos: un objeto SerializationInfo y un objeto StreamingContext.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-131">A deserialization constructor is a constructor that takes two arguments: a SerializationInfo object, and a StreamingContext object.</span></span> <span data-ttu-id="fd8a1-132">Se utilizará el constructor de deserialización durante la rehidratación de la excepción.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-132">The deserialization constructor will be used during rehydration of the exception.</span></span> <span data-ttu-id="fd8a1-133">Dado que la **ApplicationException** clase ya implementa un constructor de deserialización, el constructor para la excepción personalizada invoca simplemente al constructor de deserialización base (ApplicationException).</span><span class="sxs-lookup"><span data-stu-id="fd8a1-133">Because the **ApplicationException** class already implements a deserialization constructor, the constructor for the custom exception simply invokes the base (ApplicationException) deserialization constructor.</span></span> <span data-ttu-id="fd8a1-134">Por ejemplo, el **InterruptException** incluye el siguiente constructor:</span><span class="sxs-lookup"><span data-stu-id="fd8a1-134">For example, the **InterruptException** includes the following constructor:</span></span>  
  
```  
// "info" is the object holding the serialized object data.  
// "context" is the contextual information about the source  
// or destination.  
public InterruptException(SerializationInfo info,  
                  StreamingContext context) : base(info, context) { }  
```  
  
 <span data-ttu-id="fd8a1-135">Para obtener información más detallada acerca de la serialización personalizada, consulte Serialización personalizada en la Guía del programador de [!INCLUDE[btsDotNetFramework](../includes/btsdotnetframework-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fd8a1-135">For more detailed information about custom serialization, see Custom Serialization in the [!INCLUDE[btsDotNetFramework](../includes/btsdotnetframework-md.md)] Developer's Guide.</span></span>  
  
## <a name="nested-exception-handlers-and-compensation-blocks"></a><span data-ttu-id="fd8a1-136">Bloques de compensación y controladores de excepción anidados</span><span class="sxs-lookup"><span data-stu-id="fd8a1-136">Nested Exception Handlers and Compensation Blocks</span></span>  
 <span data-ttu-id="fd8a1-137">Además de servir como excepciones especializadas, las excepciones personalizadas también sirven en varios lugares como un indicador de ordenación.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-137">In addition to serving as specialized exceptions, the custom exceptions in several places also serve as a sort flag.</span></span> <span data-ttu-id="fd8a1-138">En el **cambio** orquestación, hay dos lugares en que se debe deshacer la operación de cancelación.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-138">In the **Change** orchestration, there are two places that the Cancel operation must be rolled back.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="fd8a1-139">Puede que desee leer esta sección con la **cambio** orquestación abierta en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-139">You may want to read this section with the **Change** orchestration open in Visual Studio.</span></span>  
  
 <span data-ttu-id="fd8a1-140">En la parte superior de la orquestación, si la llamada a la **cancelar** orquestación se produce un error, el **CancelCompensation** bloque se ejecuta y deshace la **cancelar** transacciones.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-140">At the top of the orchestration, if the call to the **Cancel** orchestration fails, the **CancelCompensation** block executes and rolls back the **Cancel** transaction.</span></span> <span data-ttu-id="fd8a1-141">Si todo funciona correctamente, la orquestación, a continuación, llama a la **activar** orquestación.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-141">If all goes well, the orchestration then calls the **Activate** orchestration.</span></span>  
  
 <span data-ttu-id="fd8a1-142">Si el **activar** se produce un error de operación, el **cancelar** transacciones también se deben deshacer.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-142">If the **Activate** operation fails, the **Cancel** transaction must also be rolled back.</span></span> <span data-ttu-id="fd8a1-143">Sin embargo, el controlador de excepciones de la llamada a **activar** no sabe nada sobre la **cancelar** transacciones.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-143">However, the exception handler for the call to **Activate** knows nothing about the **Cancel** transaction.</span></span> <span data-ttu-id="fd8a1-144">Para controlar esto, existe un controlador de excepción para toda la orquestación.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-144">To handle this, there is an exception handler for the entire orchestration.</span></span> <span data-ttu-id="fd8a1-145">Este controlador, porque contiene la **cancelar** ámbito, conozca la **cancelar** transacciones.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-145">This handler, because it contains the **Cancel** scope, knows about the **Cancel** transaction.</span></span> <span data-ttu-id="fd8a1-146">El controlador detecta la excepción iniciada en el **activar** ámbito (el **ActivateException**), se revierte el **cancelar** transacciones y, a continuación, inicia la excepción de nuevo para que la orquestación que llamó la **cambio** orquestación puede realizar cualquier procesamiento adicional.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-146">The handler catches the exception thrown from the **Activate** scope (the **ActivateException**), rolls back the **Cancel** transaction, and then throws the exception again so that the orchestration that called the **Change** orchestration can perform any additional processing.</span></span>  
  
 <span data-ttu-id="fd8a1-147">Tenga en cuenta que este diseño sólo compensa el **cancelar** si la **activar** se produce un error.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-147">Notice that this design only compensates the **Cancel** if the **Activate** fails.</span></span> <span data-ttu-id="fd8a1-148">Si el **cancelar** se produce un error y produce una excepción, el **cancelar** nunca habrá tenido lugar y no se debería compensar.</span><span class="sxs-lookup"><span data-stu-id="fd8a1-148">If the **Cancel** fails and throws an exception, the **Cancel** never took place and should not be compensated.</span></span>  
  
 <span data-ttu-id="fd8a1-149">Para obtener más información acerca de los bloques de compensación y la **compensar** forma, consulte [cómo configurar la forma compensar](../core/how-to-configure-the-compensate-shape.md).</span><span class="sxs-lookup"><span data-stu-id="fd8a1-149">For more information about compensation blocks and the **Compensate** shape, see [How to Configure the Compensate Shape](../core/how-to-configure-the-compensate-shape.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fd8a1-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="fd8a1-150">See Also</span></span>  
 <span data-ttu-id="fd8a1-151">[Control de excepciones en la solución de administración de procesos empresariales](../core/exception-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="fd8a1-151">[Exception Handling in the Business Process Management Solution](../core/exception-handling-in-the-business-process-management-solution.md) </span></span>  
 [<span data-ttu-id="fd8a1-152">La orquestación de ExceptionHandler</span><span class="sxs-lookup"><span data-stu-id="fd8a1-152">The ExceptionHandler Orchestration</span></span>](../core/the-exceptionhandler-orchestration.md)