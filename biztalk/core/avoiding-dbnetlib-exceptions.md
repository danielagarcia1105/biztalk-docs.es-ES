---
title: Evitar excepciones DBNETLIB | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 5fbee0cf-d249-4d98-8d16-168ded32f9f1
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: decd258c5f4c965c79d9821c82671c6997ac9e3d
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
ms.locfileid: "22231916"
---
# <a name="avoiding-dbnetlib-exceptions"></a><span data-ttu-id="2c656-102">Evitar excepciones DBNETLIB</span><span class="sxs-lookup"><span data-stu-id="2c656-102">Avoiding DBNETLIB Exceptions</span></span>
<span data-ttu-id="2c656-103">Se producen errores de DBNetLib (Biblioteca de red de bases de datos) cuando el tiempo de ejecución de BizTalk Server no se puede comunicar con las bases de datos de cuadro de mensajes o de administración.</span><span class="sxs-lookup"><span data-stu-id="2c656-103">DBNetLib (Database Network Library) errors occur when the BizTalk Server runtime is unable to communicate with either the MessageBox or Management databases.</span></span> <span data-ttu-id="2c656-104">Cuando esto sucede, la instancia de BizTalk Server en tiempo de ejecución que detecta la excepción se apaga y a continuación, se desplaza cada minuto para comprobar si la base de datos está disponible.</span><span class="sxs-lookup"><span data-stu-id="2c656-104">When this occurs, the BizTalk Server runtime instance that catches the exception shuts down and then cycles every minute to check to see if the database is available.</span></span>  
  
 <span data-ttu-id="2c656-105">La causa más común de un error de DBNetLib es cuando uno de los (posiblemente muchos) servidores de bases de datos de cuadros de mensajes está muy ocupado y los repetidos intentos para establecer comunicación dan como resultado un tiempo de espera que provoca una excepción de DBNetLib.</span><span class="sxs-lookup"><span data-stu-id="2c656-105">The most common cause of a DBNetLib error is when one of the (possibly many) MessageBox database servers becomes extremely busy and further attempts to communicate with it result in a timeout, which causes a DBNetLib exception.</span></span>  
  
 <span data-ttu-id="2c656-106">Además del caso en el que la base de datos de cuadro de mensajes simplemente está muy ocupada, el error de DBNetLib puede producirse en un entorno de producción cuando servidores de bases de datos de BizTalk que hospedan una o varias bases de datos de cuadro de mensajes se enlazan en las E/S (Entradas/Salidas).</span><span class="sxs-lookup"><span data-stu-id="2c656-106">In addition to the case where the MessageBox database is simply very busy, the DBNetLib error can occur in a production environment when BizTalk database servers hosting one of more MessageBox databases become I/O (Input/Output) bound.</span></span>  
  
 <span data-ttu-id="2c656-107">En este tema se describen las condiciones que pueden conducir a errores DBNetLib y las recomendaciones para evitar que se produzcan.</span><span class="sxs-lookup"><span data-stu-id="2c656-107">This topic describes conditions that can lead to DBNetLib errors and recommendations for avoiding these errors.</span></span>  
  
## <a name="cause-and-resolution-for-the-dbnetlib-error"></a><span data-ttu-id="2c656-108">Causa y solución para el error de DBNetLib</span><span class="sxs-lookup"><span data-stu-id="2c656-108">Cause and Resolution for the DBNetLib error</span></span>  
  
### <a name="symptoms-of-a-dbnetlib-error"></a><span data-ttu-id="2c656-109">Síntomas de un error de DBNetLib</span><span class="sxs-lookup"><span data-stu-id="2c656-109">Symptoms of a DBNetLib error</span></span>  
 <span data-ttu-id="2c656-110">Una instancia de host de Microsoft BizTalk Server finaliza, se reinicia y se escriben errores similares a los que se incluyen a continuación en el registro de aplicaciones de BizTalk Server:</span><span class="sxs-lookup"><span data-stu-id="2c656-110">A Microsoft BizTalk Server host instance terminates and then restarts itself, and errors that are similar to the following are written to the BizTalk Server Application log:</span></span>  
  
```  
Event Type:Warning  
Event Source:BizTalk Server <version>  
Event Category:BizTalk Server <version>   
Event ID:5410  
Computer:BIZTALKSERVER  
Description:  
An error occurred that requires the BizTalk service to terminate. The most common causes are the following:  
 1) An unexpected out of memory error.  
 OR  
 2) An inability to connect or a loss of connectivity to one of the BizTalk databases.   
 The service will shutdown and auto-restart in 1 minute. If the problematic database remains unavailable, this cycle will repeat.  
  
 Error message: [DBNETLIB][ConnectionWrite (send()).]General network error. Check your network documentation.  
 Error source:    
  
 BizTalk host name: BizTalkHost  
 Windows service name: BTSSvc$BizTalkHost   
  
---------------------------------------------------------  
Event Type:Error  
Event Source:BizTalk Server <version>  
Event Category:BizTalk Server <version>   
Event ID:6913  
Computer:BIZTALKSERVER  
Description:  
An attempt to connect to "BizTalkMsgBoxDb" SQL Server database on server "SQLSERVER " failed.  
 Error: "[DBNETLIB][ConnectionWrite (send()).]General network error. Check your network documentation."  
```  
  
### <a name="biztalk-database-servers-hosting-messagebox-databases-becoming-io-bound"></a><span data-ttu-id="2c656-111">Enlace de E/S de servidores de bases de datos de BizTalk que alojan bases de datos de cuadros de mensajes</span><span class="sxs-lookup"><span data-stu-id="2c656-111">BizTalk database servers hosting MessageBox databases becoming I/O bound</span></span>  
 <span data-ttu-id="2c656-112">Los servidores de BizTalk se comunican y actúan directamente con los servidores de bases de datos que alojan bases de datos de cuadros de mensajes.</span><span class="sxs-lookup"><span data-stu-id="2c656-112">BizTalk servers communicate and act directly with the database servers hosting the MessageBox databases.</span></span> <span data-ttu-id="2c656-113">Si cualquiera de los servidores de bases de datos que alojan las bases de datos de cuadros de mensajes se consume demasiado y entra en una situación de enlace de E/S (Entrada/Salida), es posible que no responda.</span><span class="sxs-lookup"><span data-stu-id="2c656-113">If any of the database servers hosting the MessageBox databases get too consumed and gets into an I/O (Input/Output) bound situation, then it might become unresponsive.</span></span> <span data-ttu-id="2c656-114">Uno de los servidores de BizTalk podría perder la conectividad con uno de aquellos servidores de bases de datos, y producirse un error de DBNetLib.</span><span class="sxs-lookup"><span data-stu-id="2c656-114">One of the BizTalk servers might in turn lose connectivity with one of those database servers, and a DBNetLib error will occur.</span></span>  
  
 <span data-ttu-id="2c656-115">Nuestras pruebas muestran que las E/S de un servidor de bases de datos muy consumido se enlazan cuando el valor "% de tiempo de inactividad" de su disco físico continúa cayendo por debajo del 10 %.</span><span class="sxs-lookup"><span data-stu-id="2c656-115">Our tests show that a highly consumed database server becomes I/O bound when its physical disk’s "%Idle time" continues to drop and reaches below 10%.</span></span> <span data-ttu-id="2c656-116">Si el valor “% de tiempo de inactividad” continúa cayendo por debajo de ese nivel, es muy probable que el servidor de bases de datos deje de responder.</span><span class="sxs-lookup"><span data-stu-id="2c656-116">If the “%Idle time” continues to drop below that level, then this is an indication that your database server is likely to become unresponsive.</span></span>  
  
#### <a name="cause"></a><span data-ttu-id="2c656-117">Causa</span><span class="sxs-lookup"><span data-stu-id="2c656-117">Cause</span></span>  
 <span data-ttu-id="2c656-118">Hay varias razones que pueden provocar que las entradas de E/S de los servidores de base de datos que alojan las bases de datos de cuadros de mensajes se enlacen, como por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="2c656-118">There are several reasons that can cause the database servers hosting the MessageBox databases to become I/O bound, some of these are the following:</span></span>  
  
-   <span data-ttu-id="2c656-119">Si el equipo de base de datos que hospeda la base de datos de cuadro de mensajes tiene especificaciones de hardware insuficientes como: poca memoria, número y velocidad de procesadores reducidos, etc.</span><span class="sxs-lookup"><span data-stu-id="2c656-119">If the database machine hosting the MessageBox database is bound by low hardware specifications such as: low memory, number and speed of processors etc.</span></span>  
  
-   <span data-ttu-id="2c656-120">Si el disco físico del equipo de base de datos que aloja una base de datos de cuadros de mensajes está siendo compartido por otras bases de datos muy consumidas.</span><span class="sxs-lookup"><span data-stu-id="2c656-120">If the physical disk on the database machine hosting a MessageBox database is being shared by other highly consumed databases.</span></span> <span data-ttu-id="2c656-121">En casos en los que varias bases de datos, incluido el cuadro de mensajes, se están consumiendo al mismo tiempo, las E/S del disco físico pueden enlazarse.</span><span class="sxs-lookup"><span data-stu-id="2c656-121">In cases when several databases (including the MessageBox) are being highly consumed at the same time, the physical disk can get into an I/O bound situation.</span></span>  
  
     <span data-ttu-id="2c656-122">A continuación, se incluye un ejemplo de esa situación:</span><span class="sxs-lookup"><span data-stu-id="2c656-122">An example of such a situation is the following:</span></span>  
  
     <span data-ttu-id="2c656-123">Nuestras pruebas muestran que el servidor de bases de datos que aloja las bases de datos de BizTalkDTADb o BAM suele consumir altos porcentajes de los %Tiempos de lectura y escritura de disco de un disco físico.</span><span class="sxs-lookup"><span data-stu-id="2c656-123">Our tests show that the database server hosting the BizTalkDTADb and/or BAM databases sometimes consume high percentages of a physical disk’s %Disk Read and Write Times.</span></span> <span data-ttu-id="2c656-124">Cuando el disco del servidor de bases de datos que aloja una base de datos de cuadros de mensajes está siendo compartido por otra base de datos muy consumida, como BizTalkDTADb o BAM, y si las dos bases de datos se consumen al mismo tiempo, puede suceder que las E/S del disco físico del servidor de bases de datos se enlacen y dejen de responder.</span><span class="sxs-lookup"><span data-stu-id="2c656-124">When the database server disk that hosts a MessageBox database is being shared by another highly consumed database such as BizTalkDTADb or BAM, and if both databases are highly consumed simultaneously, they might cause the database server physical disk to become I/O bound and then unresponsive.</span></span>  
  
-   <span data-ttu-id="2c656-125">Si BizTalkDTADb y una o más bases de datos de cuadros de mensajes están compartiendo el mismo disco físico en el servidor de bases de datos y los procesos de archivado y purga no se están ejecutando con frecuencia, las E/S del disco pueden enlazarse.</span><span class="sxs-lookup"><span data-stu-id="2c656-125">If BizTalkDTADb and one or more of the MessageBox databases are sharing the same physical disk on the database server, if archiving and purging is not being run frequently, the disk might become I/O bound.</span></span>  
  
#### <a name="resolution"></a><span data-ttu-id="2c656-126">Solución</span><span class="sxs-lookup"><span data-stu-id="2c656-126">Resolution</span></span>  
 <span data-ttu-id="2c656-127">Asegúrese de que el servidor de bases de datos que hospeda el cuadro de mensajes de BizTalk no llegue nunca a una situación de alto consumo que pueda provocar que deje de responder.</span><span class="sxs-lookup"><span data-stu-id="2c656-127">Ensure the database server(s) hosting the BizTalk MessageBox(s) do not get into a situation where they become highly consumed and possibly unresponsive.</span></span>  
  
 <span data-ttu-id="2c656-128">A continuación, se indican algunas de las causas principales por las que el disco de un servidor puede verse muy consumido, junto con recomendaciones para mitigar este problema.</span><span class="sxs-lookup"><span data-stu-id="2c656-128">Some of the primary causes of a server disk becoming highly consumed are listed below along with recommendations on how to mitigate this problem.</span></span>  
  
##### <a name="low-hardware-specs"></a><span data-ttu-id="2c656-129">Especificaciones de hardware bajas</span><span class="sxs-lookup"><span data-stu-id="2c656-129">Low Hardware Specs</span></span>  
 <span data-ttu-id="2c656-130">Nuestras pruebas muestran que el servidor comienza a consumirse más cuando las especificaciones de hardware no se actualizan al mismo ritmo que la carga que está intentando procesar.</span><span class="sxs-lookup"><span data-stu-id="2c656-130">Our tests show that the server starts getting more consumed when its hardware specifications cannot keep up with the amount of load it’s trying to process.</span></span> <span data-ttu-id="2c656-131">Cuanto más bajas sean las especificaciones de hardware, el sistema se sobrecarga con más rapidez por la cantidad de actividades que se producen en las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="2c656-131">With lower hardware specs, the system gets overwhelmed quickly by the amount of activities happening on the databases.</span></span> <span data-ttu-id="2c656-132">Esto podría provocar que los %Tiempos de lectura y escritura de disco del servidor siguieran aumentando sin llegar a estabilizarse y el %de tiempo de inactividad siguiera descendiendo y llegara a ser inferior al 10%, por lo que podría provocar que el servidor de bases de datos dejara de responder.</span><span class="sxs-lookup"><span data-stu-id="2c656-132">This might cause the server’s %Disk Read and Write Times to continue increasing without stabilizing, also the disk’s %Idle time to continue to decrease and become lower than 10%, and this might cause your database server to become unresponsive.</span></span>  
  
 <span data-ttu-id="2c656-133">En función de la cantidad de actividades y la carga de la implementación de BizTalk, si detecta que los servidores de bases de datos dejan de responder con las cargas altas, debería considerar la posibilidad de actualizar las piezas de los servidores de bases de datos que se indican a continuación: número de CPU, memoria y conexión con un SAN.</span><span class="sxs-lookup"><span data-stu-id="2c656-133">Depending on the amount of activities and load you have on your BizTalk deployment, if you find that you are getting unresponsive database servers during to high loads, you should consider upgrading the following parts in your database servers: number of CPUs, memory, and connecting to a SAN.</span></span> <span data-ttu-id="2c656-134">Por supuesto, debería recibir el diagnóstico adecuado para calcular qué parte (memoria, número de CPU etc.) es el cuello de botella que necesita actualizarse en su hardware.</span><span class="sxs-lookup"><span data-stu-id="2c656-134">Of course, you should do the proper diagnosis to figure out which part (memory, number of CPUs etc.) is the bottleneck that needs to be upgraded in your hardware.</span></span>  
  
##### <a name="sharing-one-server-or-disk-for-more-than-one-group-of-biztalk-databases"></a><span data-ttu-id="2c656-135">Compartir un servidor o disco para más de un grupo de bases de datos de BizTalk</span><span class="sxs-lookup"><span data-stu-id="2c656-135">Sharing one server or disk for more than one group of BizTalk databases</span></span>  
 <span data-ttu-id="2c656-136">Como se ha mencionado anteriormente, las bases de datos que no sean las de cuadros de mensajes, como la base de datos de seguimiento de BizTalk (BizTalkDTADb) y las bases de datos de BAM podrían consumir altos ciclos en el disco físico de un servidor.</span><span class="sxs-lookup"><span data-stu-id="2c656-136">As mentioned previously, databases other than MessageBoxes, such as the BizTalk Tracking (BizTalkDTADb) database and BAM databases, might consume high cycles on a server’s physical disk.</span></span> <span data-ttu-id="2c656-137">Por tanto, si dichas bases de datos comparten el mismo disco físico con las bases de datos de cuadros de mensajes, podrían saturar el disco y hacer que dejara de responder, lo que podría provocar de nuevo que los servidores BizTalk Server perdieran la conectividad con las bases de datos de cuadro de mensajes y se produjeran errores DBNetLib.</span><span class="sxs-lookup"><span data-stu-id="2c656-137">So, if those databases happen to share the same physical disk with the MessageBox databases, then they might choke the disk and make it unresponsive, which again might cause BizTalk servers to loose connectivity with the MessageBox databases and thus hit DBNetLib.</span></span>  
  
 <span data-ttu-id="2c656-138">Si esto se produce, recomendamos que separe las bases de datos que espera que tengan más consumo del disco físico del servidor desde el cuadro de mensajes de BizTalk, de modo que compartan discos físicos distintos (o separarlas en servidores distintos).</span><span class="sxs-lookup"><span data-stu-id="2c656-138">It is highly recommended that you separate any database expected to have high consumption of the server’s physical disk from the BizTalk MessageBox(s), so they share different physical disks (or separate them on different servers).</span></span> <span data-ttu-id="2c656-139">Se recomienda colocar las bases de datos de BizTalkDTADb y BAM en unidades/servidores distintos desde el cuadro de mensajes; además, se recomienda tener cada base de datos de cuadros de mensajes (en el caso de que haya más de una) en su propio disco.</span><span class="sxs-lookup"><span data-stu-id="2c656-139">It is recommended that you separate the BizTalkDTADb and BAM databases on their own separate drives/servers from the MessageBox(s), and it is also recommended to have each MessageBox database (in the case there is more than one) on it’s own disk.</span></span>  
  
##### <a name="archiving-and-purging"></a><span data-ttu-id="2c656-140">Archivar y purgar</span><span class="sxs-lookup"><span data-stu-id="2c656-140">Archiving and Purging</span></span>  
 <span data-ttu-id="2c656-141">Si las bases de datos de BizTalkDTADb y cuadros de mensajes comparten el mismo disco en el mismo servidor, deberá archivar y purgar las bases de datos de BizTalkDTADb con regularidad; de lo contrario aumentarán de tamaño indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="2c656-141">In the case when you have BizTalkDTADb and MessageBox databases sharing the same disk on the same server, you must archive and purge your BizTalkDTADb databases regularly, otherwise they will grow indefinitely.</span></span>  
  
 <span data-ttu-id="2c656-142">Las pruebas indican que resulta una práctica recomendable archivar y purgar las bases de datos con regularidad, pero que si se producen cargas más altas de lo normal, debería considerar la posibilidad de llevar a cabo los procesos de archivado y purga con más frecuencia.</span><span class="sxs-lookup"><span data-stu-id="2c656-142">Testing indicates that it is good practice to archive and purge periodically, but if you run under higher loads than normal then you might want to consider archiving and purging more frequently.</span></span> <span data-ttu-id="2c656-143">Si no se realiza un mantenimiento del crecimiento de las bases de datos de BizTalkDTADb, cuando se produzcan estas situaciones, es posible que le lleve más tiempo y consuma más recursos de los disponibles en el servidor de bases de datos mientras se ejecutan.</span><span class="sxs-lookup"><span data-stu-id="2c656-143">If the BizTalkDTADb database growth is not maintained regularly, then when these actions are finally performed they may take considerable time and consume most of the available database server resources while they are running.</span></span>