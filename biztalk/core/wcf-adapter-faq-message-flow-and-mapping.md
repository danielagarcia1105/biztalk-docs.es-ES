---
title: "P+F del adaptador de WCF: Flujo de mensajes y asignación | Documentos de Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 907e5c6a-a095-4b3a-9362-506832b6bc8c
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e58b11cff00d4b235a5c14e75663fdf7e581f782
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="wcf-adapter-faq-message-flow-and-mapping"></a><span data-ttu-id="94390-102">P+F del adaptador de WCF: Flujo de mensajes y asignación</span><span class="sxs-lookup"><span data-stu-id="94390-102">WCF Adapter FAQ: Message Flow and Mapping</span></span>
## <a name="what-is-the-message-flow-within-the-wcf-and-biztalk-systems"></a><span data-ttu-id="94390-103">¿Cómo es el flujo de mensajes en los sistemas WCF y BizTalk?</span><span class="sxs-lookup"><span data-stu-id="94390-103">What is the message flow within the WCF and BizTalk systems?</span></span>  
 <span data-ttu-id="94390-104">A continuación se proporciona una descripción del flujo de un mensaje entrante de WCF hacia BizTalk Server:</span><span class="sxs-lookup"><span data-stu-id="94390-104">Here is a description of the flow of an incoming WCF message to BizTalk Server:</span></span>  
  
1.  <span data-ttu-id="94390-105">Llega un mensaje de WCF a una ubicación de recepción y BizTalk Server crea una instancia de un Servicio WCF hospedado.</span><span class="sxs-lookup"><span data-stu-id="94390-105">A WCF message arrives at a receive location, and BizTalk Server instantiates a hosted WCF service.</span></span>  
  
2.  <span data-ttu-id="94390-106">El tiempo de ejecución de WCF crea una instancia pila de canales del servicio y de sus agentes de escucha del canal.</span><span class="sxs-lookup"><span data-stu-id="94390-106">The WCF runtime instantiates the service’s channel stack and its channel listeners.</span></span> <span data-ttu-id="94390-107">Una pila de canales es una secuencia de etapas que controlan diferentes tareas de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="94390-107">A channel stack is a sequence of stages that handle differing processing tasks.</span></span> <span data-ttu-id="94390-108">Cada pila de canales consta de al menos un canal de transporte, con frecuencia un codificador de mensajes, y cero o más canales de protocolo.</span><span class="sxs-lookup"><span data-stu-id="94390-108">Each channel stack consists of at least a transport channel, most often a message encoder, and zero or more protocol channels.</span></span> <span data-ttu-id="94390-109">El canal de transporte lee la secuencia de mensajes entrantes a su llegada.</span><span class="sxs-lookup"><span data-stu-id="94390-109">The transport channel reads the incoming message stream upon arrival.</span></span> <span data-ttu-id="94390-110">Invoca un codificador para interpretar el mensaje y para producir un objeto de mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-110">It invokes an encoder to interpret the message and to produce a WCF Message object.</span></span> <span data-ttu-id="94390-111">En este momento, cada canal de protocolo podrá funcionar en el mensaje de WCF en orden.</span><span class="sxs-lookup"><span data-stu-id="94390-111">At this point each protocol channel will have an opportunity to operate on the WCF message in order.</span></span>  
  
3.  <span data-ttu-id="94390-112">Un agente de escucha recibe el mensaje de WCF, lo reenvía a través de la pila de canales WCF configurado y lo distribuye a la instancia de servicio adecuada.</span><span class="sxs-lookup"><span data-stu-id="94390-112">The WCF message is received by a listener that forwards it through the configured WCF channel stack and dispatches it to the proper service instance.</span></span> <span data-ttu-id="94390-113">En este momento, el mensaje de WCF se convierte (asigna) en un mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-113">At this point the WCF message is converted (mapped) to a BizTalk message.</span></span> <span data-ttu-id="94390-114">En pocas palabras, los encabezados de los mensajes de WCF se escriben en el contexto del mensaje de BizTalk y el cuerpo del mensaje de WCF se escribe en la parte del cuerpo del mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-114">Briefly stated, the WCF message headers are written into the BizTalk message context, and the WCF message body is written into the  BizTalk message body part.</span></span> <span data-ttu-id="94390-115">La asignación controla qué parte del mensaje de WCF se convierte en el cuerpo del mensaje de BizTalk: sobres, cuerpo o un subelemento.</span><span class="sxs-lookup"><span data-stu-id="94390-115">Mapping controls what part of the WCF message becomes the BizTalk message body: Envelope, body, or sub-element.</span></span>  
  
4.  <span data-ttu-id="94390-116">Los componentes de canalización configurados en la ubicación de recepción procesan el mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-116">Any pipeline components configured in the receive location processes the BizTalk message.</span></span>  
  
5.  <span data-ttu-id="94390-117">El mensaje de BizTalk se almacena en la base de datos de cuadro de mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-117">The BizTalk message is stored in the MessageBox database.</span></span>  
  
 <span data-ttu-id="94390-118">A continuación se proporciona una descripción del flujo de un mensaje saliente de WCF desde BizTalk Server:</span><span class="sxs-lookup"><span data-stu-id="94390-118">Here is a description of the flow of an outgoing WCF message from BizTalk Server:</span></span>  
  
1.  <span data-ttu-id="94390-119">Un puerto de envío recibe un mensaje de BizTalk de acuerdo con su suscripción.</span><span class="sxs-lookup"><span data-stu-id="94390-119">A BizTalk message is received by a send port according to its subscription.</span></span>  
  
2.  <span data-ttu-id="94390-120">Los componentes de canalización configurados en el puerto de envío procesan el mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-120">Any pipeline components configured in the send port process the BizTalk message.</span></span>  
  
3.  <span data-ttu-id="94390-121">Se crea una instancia de una pila de canales de WCF y el mensaje de BizTalk se convierte (asigna) en un mensaje de WCF según el contrato visible externo del servicio.</span><span class="sxs-lookup"><span data-stu-id="94390-121">A WCF channel stack is instantiated, and the BizTalk message is converted (mapped) into a WCF message based upon the service’s external visible contract.</span></span>  
  
4.  <span data-ttu-id="94390-122">La pila de canales de WCF transmite el mensaje de WCF al servicio de WCF externo.</span><span class="sxs-lookup"><span data-stu-id="94390-122">The WCF channel stack transmits the WCF message to the external WCF service.</span></span>  
  
## <a name="how-is-a-wcf-message-converted-mapped-into-a-biztalk-message"></a><span data-ttu-id="94390-123">¿Cómo se convierte (asigna) un mensaje de WCF en un mensaje de BizTalk?</span><span class="sxs-lookup"><span data-stu-id="94390-123">How is a WCF message converted (mapped) into a BizTalk message?</span></span>  
 <span data-ttu-id="94390-124">Para comprender la asignación, se debe considerar la estructura de un mensaje de WCF y un mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-124">In order to understand the mapping, we need to look at the structure of a WCF message and a BizTalk message.</span></span>  
  
 <span data-ttu-id="94390-125">Un mensaje de WCF se modela en la estructura de mensajes de SOAP y consta de propiedades, encabezados y un único cuerpo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-125">A WCF message is modeled on the SOAP message structure and consists of message properties, message headers, and a single message body.</span></span>  
  
-   <span data-ttu-id="94390-126">El **propiedades de mensaje** son objetos de Common Language Runtime (CLR) que se adjuntan al objeto de mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-126">The **message properties** are Common Language Runtime (CLR) objects that are attached to the Message object.</span></span> <span data-ttu-id="94390-127">Las propiedades son internas para la pila de WCF y la aplicación del usuario en cada extremo de la comunicación.</span><span class="sxs-lookup"><span data-stu-id="94390-127">Properties are internal to the WCF stack and the user’s application at each end of the communication.</span></span> <span data-ttu-id="94390-128">Nunca se transfieren directamente entre cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="94390-128">They are never directly transferred between client and server.</span></span>  
  
-   <span data-ttu-id="94390-129">**Encabezados de mensaje**, sin embargo, se transfieren entre cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="94390-129">**Message headers**, however, are transferred between client and server.</span></span> <span data-ttu-id="94390-130">Puede haber numerosos encabezados en un mensaje, pero solo hay un cuerpo del mensaje y, a diferencia de los encabezados, el cuerpo del mensaje se transmite por secuencias.</span><span class="sxs-lookup"><span data-stu-id="94390-130">There can be many headers on a message, but there is only one message body, and unlike the headers the message body is streamed.</span></span> <span data-ttu-id="94390-131">Tanto los encabezados como el cuerpo del mensaje se definen como un conjunto de información XML.</span><span class="sxs-lookup"><span data-stu-id="94390-131">Both the message headers and the message body are defined as an XML Infoset.</span></span>  
  
-   <span data-ttu-id="94390-132">El **cuerpo** de WCF mensaje es el contenido principal del mensaje para que las propiedades y los encabezados proporcionan más información.</span><span class="sxs-lookup"><span data-stu-id="94390-132">The **body** of a WCF message is the main content of the message for which the properties and headers provide more information.</span></span>  
  
 <span data-ttu-id="94390-133">Los mensajes de BizTalk presentan una estructura diferente.</span><span class="sxs-lookup"><span data-stu-id="94390-133">A BizTalk message has a different structure.</span></span>  
  
-   <span data-ttu-id="94390-134">Hay un único conjunto de propiedades de contexto en cada mensaje</span><span class="sxs-lookup"><span data-stu-id="94390-134">There is a single set of context properties on each message.</span></span> <span data-ttu-id="94390-135">y propiedad de contexto está formada por un par de nombre de espacio de nombres y valor.</span><span class="sxs-lookup"><span data-stu-id="94390-135">Each context property consists of a namespace name/value pair.</span></span> <span data-ttu-id="94390-136">Las propiedades de contexto se pueden promover o escribir.</span><span class="sxs-lookup"><span data-stu-id="94390-136">Context properties can be either promoted or written.</span></span> <span data-ttu-id="94390-137">Si se promueven, pueden formar parte de las reglas de enrutamiento que se ejecutan en BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="94390-137">If they are promoted, they can take part in the routing rules that execute within BizTalk Server.</span></span>  
  
-   <span data-ttu-id="94390-138">Los datos de un mensaje en BizTalk Server pueden constar de varias secuencias.</span><span class="sxs-lookup"><span data-stu-id="94390-138">The data of a message in BizTalk Server can consist of multiple streams.</span></span> <span data-ttu-id="94390-139">Los mensajes de BizTalk son de varias partes, ya que cada secuencia se puede leer de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="94390-139">A BizTalk message is multipart because each stream can be read independently.</span></span> <span data-ttu-id="94390-140">Una de las partes del mensaje es especial y se conoce como la parte del cuerpo.</span><span class="sxs-lookup"><span data-stu-id="94390-140">One of the message parts is special and it is referred to as the body part.</span></span>  
  
 <span data-ttu-id="94390-141">Debido a que la comunicación puede ser en ocasiones bidireccional, el adaptador de WCF permite configurar la conversión o asignación particular para las direcciones tanto de entrada como de salida en el intercambio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="94390-141">Because the communication can sometimes be two-way, the WCF adapter allows the particular translation or mapping to be configured for both inbound and outbound directions of message exchange.</span></span> <span data-ttu-id="94390-142">Esto se puede realizar tanto para las ubicaciones de recepción como para los puertos de envío en BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="94390-142">This can be done for both the receive locations and send ports within BizTalk Server.</span></span>  
  
 <span data-ttu-id="94390-143">Los adaptadores de WCF de BizTalk admiten varias permutaciones de conversiones en tiempo de ejecución entre estas dos estructuras de mensajes.</span><span class="sxs-lookup"><span data-stu-id="94390-143">The BizTalk WCF adapters support a number of permutations of translating at run time between these two message structures.</span></span> <span data-ttu-id="94390-144">Asignación se controla mediante la **mensajes** pestaña en el **propiedades de transporte** cuadro de diálogo para un adaptador de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-144">Mapping is controlled through the **Messages** tab in the **Transport Properties** dialog box for a WCF adapter.</span></span> <span data-ttu-id="94390-145">Por ejemplo, la conversión más obvia, y la predeterminada, se da cuando el cuerpo de un mensaje de WCF entrante se convierte en el cuerpo del mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-145">For example, the most obvious translation, and the default, is when the body of an inbound WCF message becomes the body of the BizTalk message.</span></span> <span data-ttu-id="94390-146">Para obtener más información acerca de los modos de asignación, consulte [http://go.microsoft.com/fwlink/?LinkID=119792](http://go.microsoft.com/fwlink/?LinkID=119792).</span><span class="sxs-lookup"><span data-stu-id="94390-146">For more information about mapping modes, see [http://go.microsoft.com/fwlink/?LinkID=119792](http://go.microsoft.com/fwlink/?LinkID=119792).</span></span>  
  
## <a name="how-can-you-preserve-the-complete-incoming-wcf-message-inside-the-biztalk-message"></a><span data-ttu-id="94390-147">¿Cómo se puede conservar el mensaje de WCF entrante completo dentro del mensaje de BizTalk?</span><span class="sxs-lookup"><span data-stu-id="94390-147">How can you preserve the complete incoming WCF message inside the BizTalk message?</span></span>  
 <span data-ttu-id="94390-148">Una de las opciones de cuerpo de mensaje de BizTalk entrantes es la **sobres** opción.</span><span class="sxs-lookup"><span data-stu-id="94390-148">One of the inbound BizTalk message body options is the **Envelope** option.</span></span> <span data-ttu-id="94390-149">Al elegir esta opción, todo el mensaje de SOAP incluido en el elemento soap:Envelope se convierte en el cuerpo del mensaje de BizTalk entrante.</span><span class="sxs-lookup"><span data-stu-id="94390-149">Choosing this option takes the entire SOAP message contained within the soap:Envelope element into the incoming BizTalk message body.</span></span> <span data-ttu-id="94390-150">El mensaje de BizTalk resultante contiene las etiquetas Sobre, todos los encabezados y el cuerpo.</span><span class="sxs-lookup"><span data-stu-id="94390-150">The resulting BizTalk message contains the Envelope tags, all the headers, and the body.</span></span>  
  
## <a name="how-can-you-extract-specific-elements-of-the-incoming-wcf-message-into-a-biztalk-message-or-map-elements-of-an-outgoing-biztalk-message-to-an-outgoing-wcf-message"></a><span data-ttu-id="94390-151">¿Cómo se pueden extraer elementos específicos del mensaje de WCF entrante en un mensaje de BizTalk o asignar elementos de un mensaje de BizTalk saliente a un mensaje de WCF saliente?</span><span class="sxs-lookup"><span data-stu-id="94390-151">How can you extract specific elements of the incoming WCF message into a BizTalk message, or map elements of an outgoing BizTalk message to an outgoing WCF message?</span></span>  
 <span data-ttu-id="94390-152">Para asignar una sección de un cuerpo de mensaje de WCF o BizTalk, use la opción Ruta o Plantilla.</span><span class="sxs-lookup"><span data-stu-id="94390-152">To map a section of a WCF or BizTalk message body, use the Path or Template option.</span></span> <span data-ttu-id="94390-153">De este modo, podrá especificar una expresión XPath para extraer partes específicas del cuerpo del mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-153">This allows you to enter an XPath expression to extract specific parts of the message body.</span></span> <span data-ttu-id="94390-154">En esta situación, la sintaxis completa de XPath no se admite, ya que la extracción se transmite por secuencias y, por tanto, el lector deberá ir siempre hacia adelante.</span><span class="sxs-lookup"><span data-stu-id="94390-154">Full XPath syntax is not supported in this situation as the extraction is streamed and the reader must therefore always walk forward.</span></span> <span data-ttu-id="94390-155">Se trata de motivo, en la **mensajes** ficha se denomina "Ruta – contenido ubicado por la ruta de cuerpo" en lugar de "XPath – contenido ubicado por la ruta de cuerpo".</span><span class="sxs-lookup"><span data-stu-id="94390-155">This is why in the **Messages** tab it is called “Path – content located by body path” instead of “XPath – content located by body path.”</span></span>  
  
 <span data-ttu-id="94390-156">En el lado de recepción, use una expresión Ruta que indique cómo deben leerse los datos desde el mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-156">On the receive side, use a Path expression that dictates how data is to be read from the WCF message.</span></span> <span data-ttu-id="94390-157">Para un mensaje entrante, el elemento específico que extrae la declaración Ruta se sustituye por el contenido del mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-157">For an inbound message, the specific element extracted by the Path statement gets substituted for the content of the BizTalk message.</span></span> <span data-ttu-id="94390-158">El adaptador usa esta expresión Ruta para localizar y extraer los datos deseados para el mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-158">The adapter uses this Path expression to locate and extract the desired data for the BizTalk message.</span></span>  
  
 <span data-ttu-id="94390-159">En el lado de envío, use una plantilla para crear un mensaje de WCF a partir del mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-159">On the send side, use a template to create a WCF message from the BizTalk message.</span></span> <span data-ttu-id="94390-160">La opción de plantilla para los mensajes salientes está diseñada para permitir el contrario exacto de la opción XPath.</span><span class="sxs-lookup"><span data-stu-id="94390-160">The template option for outbound messages is designed to allow the exact opposite of the XPath option.</span></span> <span data-ttu-id="94390-161">En la configuración del adaptador de WCF, el fragmento de XML se usa como base para la estructura del mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="94390-161">In the WCF adapter configuration, the snippet of XML is used as the basis for the structure of the outbound message.</span></span> <span data-ttu-id="94390-162">El contenido del mensaje de BizTalk se inserta en tiempo de ejecución dentro de esta estructura.</span><span class="sxs-lookup"><span data-stu-id="94390-162">The content of the BizTalk message is inserted at run time into this structure.</span></span>  
  
 <span data-ttu-id="94390-163">Para un mensaje saliente, también debe elegir el tipo de elemento escrito mediante la opción Codificación de nodo de XML, Base64, Cadena o Hexadecimal.</span><span class="sxs-lookup"><span data-stu-id="94390-163">For an outgoing message, you must also choose the type of the element written by using the Node Encoding setting from XML, Base64, String, or Hexadecimal.</span></span> <span data-ttu-id="94390-164">Esta opción resulta muy útil para extraer una secuencia de datos binarios incluida en un mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-164">This option is very useful when you want to extract a binary data stream contained in a WCF message.</span></span> <span data-ttu-id="94390-165">El uso de esta función indica al adaptador de WCF que debe usar las llamadas ReadContextAsBase64 en el lector del cuerpo del mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-165">Using this feature instructs the WCF Adapter to use the ReadContextAsBase64 calls on the body Reader of the WCF Message.</span></span> <span data-ttu-id="94390-166">Esta llamada permite que los datos binarios se lean directamente a través de la API de XmlReader, por lo que el uso de estos datos binarios de funciones puede moverse directamente desde el transporte de WCF a la base de datos de cuadro de mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-166">This call allows binary data to be read directly through the XmlReader API, so using this feature binary data can be moved directly from the WCF Transport into the BizTalk MessageBox database.</span></span> <span data-ttu-id="94390-167">Al escribir una ruta en el nodo que contiene los datos binarios, puede extraer éstos y colocarlos en el mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-167">By writing a path to the node containing the binary data you can pull it out and place it into the BizTalk message.</span></span>  
  
## <a name="how-do-you-access-wcf-message-properties-within-an-incoming-wcf-message"></a><span data-ttu-id="94390-168">¿Cómo se obtiene acceso a las propiedades de mensaje de WCF dentro de un mensaje de WCF entrante?</span><span class="sxs-lookup"><span data-stu-id="94390-168">How do you access WCF message properties within an incoming WCF message?</span></span>  
 <span data-ttu-id="94390-169">Para obtener acceso a un mensaje de WCF entrante antes de que se transforme en un mensaje de BizTalk, puede usar un componente de canal de WCF personalizado o un punto de extensibilidad de modelo de servicio con un comportamiento de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-169">To access properties within an incoming WCF message before it is transformed into a BizTalk message, you can use a custom WCF channel component or a service model extensibility point with a WCF behavior.</span></span> <span data-ttu-id="94390-170">Por ejemplo, un **IDispatchMessageInspector** objeto.</span><span class="sxs-lookup"><span data-stu-id="94390-170">For example, an **IDispatchMessageInspector** object.</span></span> <span data-ttu-id="94390-171">Los adaptadores de BizTalk WCF-Custom y WCF-CustomIsolated proporcionan una manera sencilla para la aplicación para que se conecte a la capacidad de los comportamientos WCF mediante el **comportamiento** pestaña en el **propiedades de transporte** cuadro de diálogo dichos adaptadores.</span><span class="sxs-lookup"><span data-stu-id="94390-171">The BizTalk WCF-Custom and WCF-CustomIsolated adapters provide a simple way for your application to plug into the power of WCF behaviors using the **Behavior** tab in the **Transport Properties** dialog for those adapters.</span></span>  
  
 <span data-ttu-id="94390-172">Para permitir que las propiedades de un mensaje de WCF estén disponibles para el adaptador de WCF, es necesario que dichas propiedades se escriban primero en el cuerpo o encabezado del mensaje como contenido.</span><span class="sxs-lookup"><span data-stu-id="94390-172">To allow the properties of a WCF message to be available to the WCF adapter, those properties first have to be written into the message body or header as content.</span></span> <span data-ttu-id="94390-173">Los encabezados se copian automáticamente en el contexto de mensaje de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-173">The headers are copied into the BizTalk message context automatically for you.</span></span> <span data-ttu-id="94390-174">Si desea que un valor de propiedad promocionado, puede usar un componente de canalización de BizTalk personalizado para promover la propiedad de mensaje WCF en el contexto de mensaje de BizTalk desde el **IComponent: ejecutar** método.</span><span class="sxs-lookup"><span data-stu-id="94390-174">If you want a property value promoted, you can use a custom BizTalk pipeline component to promote the WCF message property into the BizTalk message context from within the **IComponent:Execute** method.</span></span> <span data-ttu-id="94390-175">El uso de los comportamientos de WCF personalizados con los adaptadores personalizados de WCF permite aprovechar la extensibilidad tanto de WCF como de BizTalk para mejorar la eficacia y la flexibilidad de la solución.</span><span class="sxs-lookup"><span data-stu-id="94390-175">Using custom WCF behaviors with the WCF custom adapters allows you to take advantage of both WCF and BizTalk extensibility to make your solution more powerful and flexible.</span></span> <span data-ttu-id="94390-176">El adaptador de WCF permite combinar las extensibilidades existentes de BizTalk y WCF para solucionar el problema.</span><span class="sxs-lookup"><span data-stu-id="94390-176">The WCF adapter allows you to combine existing BizTalk and WCF extensibilities to solve your problem.</span></span>  
  
 <span data-ttu-id="94390-177">Afortunadamente, existe un atajo en el adaptador de WCF para este caso de propiedad común.</span><span class="sxs-lookup"><span data-stu-id="94390-177">The good news is that there is a shortcut in the WCF adapter for this common property case.</span></span> <span data-ttu-id="94390-178">En lugar de tener que escribir en ambas historias de extensibilidad, puede hacer simplemente que la extensión de WCF cree una nueva propiedad “bien conocida” que comprenda el adaptador de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-178">Rather than writing to both extensibility stories, you can simply have the WCF extension create a new “well known” property that is understood by the WCF adapter.</span></span>  
  
 <span data-ttu-id="94390-179">Para escribir o promover los valores del encabezado SOAP en el contexto del mensaje de BizTalk, el mensaje de WCF debe contener una colección de parejas de valores que se componen de nombres de propiedad y espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="94390-179">In order to write or promote SOAP header values into the BizTalk message context, the WCF message must contain a collection of value pairs that consist of property names and namespaces.</span></span> <span data-ttu-id="94390-180">De este modo, los adaptadores de WCF reconocerán que los valores de encabezado se deben escribir o promover.</span><span class="sxs-lookup"><span data-stu-id="94390-180">This allows the WCF adapters to recognize that the header values are to be written or promoted.</span></span>  
  
 <span data-ttu-id="94390-181">Un adaptador de WCF espera las siguientes propiedades del mensaje en los mensajes de WCF para escribir o promover los valores del encabezado SOAP en el contexto del mensaje de BizTalk:</span><span class="sxs-lookup"><span data-stu-id="94390-181">A WCF adapter expects the following message properties in the WCF messages for writing or promoting SOAP header values to the BizTalk message context:</span></span>  
  
-   <span data-ttu-id="94390-182">Para promover los valores del encabezado SOAP en el contexto de mensaje de BizTalk, los adaptadores de WCF se buscan la pareja de clave **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/Promote** y el valor **lista < KeyValuePair\<XmlQualifiedName, objeto >>**.</span><span class="sxs-lookup"><span data-stu-id="94390-182">To promote the SOAP header values to the BizTalk message context, WCF adapters are looking for the pair of key **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/Promote** and value **List<KeyValuePair\<XmlQualifiedName, object>>**.</span></span> <span data-ttu-id="94390-183">Con esta pareja, adaptadores de WCF toman el espacio de nombres, el nombre y el valor de la **XmlQualifiedName** objeto y usarlos para la promoción de los valores de encabezado.</span><span class="sxs-lookup"><span data-stu-id="94390-183">Using this pair, WCF adapters take the namespace, name, and value from the **XmlQualifiedName** object and use them for promoting the header values.</span></span>  
  
-   <span data-ttu-id="94390-184">Para escribir pero no promover los valores del encabezado SOAP en el contexto de mensaje de BizTalk, adaptadores de WCF se buscan la pareja de clave **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/WriteToContext** y valor **Lista < KeyValuePair\<XmlQualifiedName, objeto >>.**</span><span class="sxs-lookup"><span data-stu-id="94390-184">To write, but not promote, the SOAP header values into the BizTalk message context, WCF adapters are looking for the pair of key **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/WriteToContext** and value **List<KeyValuePair\<XmlQualifiedName, object>>.**</span></span> <span data-ttu-id="94390-185">Con esta pareja, los adaptadores de WCF escriben los valores en el contexto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-185">Using this pair, WCF adapters write the values to the message context.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="94390-186">Las propiedades promovidas también deben especificarse en el esquema de propiedades de BizTalk para que lo pueda aceptar el tiempo de ejecución de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-186">Promoted properties must also be specified in a BizTalk property schema in order to be accepted by the BizTalk runtime.</span></span>  
  
## <a name="you-have-an-existing-orchestration-or-send-port-etc-that-expects-a-biztalk-multipart-message-how-can-you-get-a-multipart-message-in-the-wcf-scenario"></a><span data-ttu-id="94390-187">Tiene una orquestación (o puerto de envío, etc.) existente que espera un mensaje de varias partes de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="94390-187">You have an existing orchestration (or send port, etc.) that expects a BizTalk multipart message.</span></span> <span data-ttu-id="94390-188">¿Cómo se puede obtener un mensaje de varias partes en el escenario de WCF?</span><span class="sxs-lookup"><span data-stu-id="94390-188">How can you get a multipart message in the WCF scenario?</span></span>  
 <span data-ttu-id="94390-189">Un mensaje de varias partes de BizTalk se compone de una o más partes de mensaje.</span><span class="sxs-lookup"><span data-stu-id="94390-189">A BizTalk multipart message is composed of one or more message parts.</span></span> <span data-ttu-id="94390-190">Sin embargo, WCF no tiene el concepto de mensaje de varias partes.</span><span class="sxs-lookup"><span data-stu-id="94390-190">However, WCF has no concept of a multipart message.</span></span> <span data-ttu-id="94390-191">Dado que WCF no usa mensajes de varias partes, los adaptadores de WCF de BizTalk WCF tampoco los usan.</span><span class="sxs-lookup"><span data-stu-id="94390-191">Because WCF does not use multipart messages, the BizTalk WCF adapters also do not use them.</span></span> <span data-ttu-id="94390-192">El problema es que puede que tenga una orquestación o canalización de BizTalk ya existente escrita para producir o consumir mensajes de varias partes.</span><span class="sxs-lookup"><span data-stu-id="94390-192">The problem is that you may have an existing BizTalk orchestration or pipeline that is written to produce or consume multipart messages.</span></span>  
  
 <span data-ttu-id="94390-193">Si tiene que llevar un mensaje de varias partes a BizTalk Server mediante un mensaje de WCF entrante y los adaptadores de WCF, presente los datos de varias partes como XML en el mensaje de WCF.</span><span class="sxs-lookup"><span data-stu-id="94390-193">If you need to get a multipart message into BizTalk Server by using an incoming WCF message and the WCF adapters, render your multipart data as XML in your WCF message.</span></span> <span data-ttu-id="94390-194">Desarrolle un componente de canalización de BizTalk personalizado para procesar la secuencia de XML entrante (mensaje de WCF) y cree el mensaje de varias partes de BizTalk adecuado para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="94390-194">Develop a custom BizTalk pipeline component to process the incoming XML stream (WCF message) and create the appropriate BizTalk multipart message for your application.</span></span> <span data-ttu-id="94390-195">Estos pasos se pueden realizar en orden inverso para el lado de envío, si fuera necesario.</span><span class="sxs-lookup"><span data-stu-id="94390-195">These steps can be done in reverse for the Send side if required.</span></span>