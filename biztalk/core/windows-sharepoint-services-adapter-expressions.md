---
title: Expresiones del adaptador de Windows SharePoint Services | Documentos de Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: "22"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bf777931837f036f7228c4a359eef77faa9e97e7
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="c9795-102">Expresiones del adaptador de Windows SharePoint Services</span><span class="sxs-lookup"><span data-stu-id="c9795-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="c9795-103">Este tema describe el formato y el significado de las cadenas que se pueden especificar como valores para la **archivo NameProperty origen** propiedades del adaptador de Windows SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="c9795-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="c9795-104">También se describen las propiedades de contexto relacionadas, **WSS. Nombre de archivo** y **WSS. ConfigPropertiesXml**.</span><span class="sxs-lookup"><span data-stu-id="c9795-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="c9795-105">Estas expresiones permiten definir con facilidad el valor del nombre de archivo o el valor de columna de Windows SharePoint Services personalizado, basado en literales y valores extraídos del mensaje o del sistema de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="c9795-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="c9795-106">Las expresiones pueden contener literales y macros.</span><span class="sxs-lookup"><span data-stu-id="c9795-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="c9795-107">Los literales se mostrarán en el nombre de archivo exactamente como se escribieron.</span><span class="sxs-lookup"><span data-stu-id="c9795-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="c9795-108">Las macros deben colocarse entre caracteres '%'.</span><span class="sxs-lookup"><span data-stu-id="c9795-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="c9795-109">Un ejemplo de macro es `%MessageID%` que, en tiempo de ejecución, se reemplazará con el GUID del mensaje.</span><span class="sxs-lookup"><span data-stu-id="c9795-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9795-110">Cuando el carácter % se utiliza como un literal o dentro de una expresión XPATH, deben convertirse así \\%.</span><span class="sxs-lookup"><span data-stu-id="c9795-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="c9795-111">Un solo carácter % se considerará un delimitador de macro, donde un \\% se reemplazará en tiempo de ejecución por un solo carácter %.</span><span class="sxs-lookup"><span data-stu-id="c9795-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="c9795-112">El \ caracteres deben convertirse así \\ \\.</span><span class="sxs-lookup"><span data-stu-id="c9795-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="c9795-113">Ejemplos de expresiones</span><span class="sxs-lookup"><span data-stu-id="c9795-113">Expression examples</span></span>  
  
|<span data-ttu-id="c9795-114">Valor en tiempo de diseño</span><span class="sxs-lookup"><span data-stu-id="c9795-114">Design time value</span></span>|<span data-ttu-id="c9795-115">Valor en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="c9795-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="c9795-116">XYZ</span><span class="sxs-lookup"><span data-stu-id="c9795-116">XYZ</span></span>|<span data-ttu-id="c9795-117">XYZ</span><span class="sxs-lookup"><span data-stu-id="c9795-117">XYZ</span></span>|  
|<span data-ttu-id="c9795-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="c9795-118">PurchaseOrder</span></span>|<span data-ttu-id="c9795-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="c9795-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="c9795-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="c9795-120">%MessageID%</span></span>|<span data-ttu-id="c9795-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="c9795-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="c9795-122">PurchaseOrder - %MessageID%</span><span class="sxs-lookup"><span data-stu-id="c9795-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="c9795-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="c9795-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="c9795-124">Descuento \\% 10</span><span class="sxs-lookup"><span data-stu-id="c9795-124">Discount \\%10</span></span>|<span data-ttu-id="c9795-125">Descuento %10</span><span class="sxs-lookup"><span data-stu-id="c9795-125">Discount %10</span></span>|  
|<span data-ttu-id="c9795-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="c9795-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="c9795-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="c9795-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="c9795-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="c9795-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="c9795-129">PurchaseOrder – Contoso-10001</span><span class="sxs-lookup"><span data-stu-id="c9795-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="c9795-130">Macros admitidas</span><span class="sxs-lookup"><span data-stu-id="c9795-130">Supported macros</span></span>  
  
|<span data-ttu-id="c9795-131">Valor en tiempo de diseño</span><span class="sxs-lookup"><span data-stu-id="c9795-131">Design time value</span></span>|<span data-ttu-id="c9795-132">Valor en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="c9795-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="c9795-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="c9795-133">%MessageID%</span></span>|<span data-ttu-id="c9795-134">Identificador del mensaje de BizTalk que constituye un GUID único.</span><span class="sxs-lookup"><span data-stu-id="c9795-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="c9795-135">%SendingOrchestrationID%</span><span class="sxs-lookup"><span data-stu-id="c9795-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="c9795-136">Identificador de BizTalk de la instancia de orquestación en la que se originó el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c9795-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="c9795-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="c9795-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="c9795-138">Nombre de tipo de la orquestación en la que se originó el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c9795-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="c9795-139">% XPATH =\<xpath > %</span><span class="sxs-lookup"><span data-stu-id="c9795-139">%XPATH=\<xpath>%</span></span>|<span data-ttu-id="c9795-140">Permite especificar un elemento XPATH para que se utilice para extraer el valor del mensaje.</span><span class="sxs-lookup"><span data-stu-id="c9795-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="c9795-141">"\<xpath >" debe sustituirse por una expresión XPATH válida.</span><span class="sxs-lookup"><span data-stu-id="c9795-141">“\<xpath>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="c9795-142">**Nota:** el alias de espacio de nombres debe definirse fuera de la expresión en el 'Alias Namespace' o WSS. Campo ConfigNamespaceAliases.</span><span class="sxs-lookup"><span data-stu-id="c9795-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="c9795-143">%Filename%</span><span class="sxs-lookup"><span data-stu-id="c9795-143">%Filename%</span></span>|<span data-ttu-id="c9795-144">Se reemplaza con el valor de nombre de archivo extraído de la propiedad de contexto del mensaje WSS.Filename.</span><span class="sxs-lookup"><span data-stu-id="c9795-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="c9795-145">Los mensajes recibidos de SharePoint tienen el valor de la propiedad de contexto de mensaje WSS.Filename establecida en el nombre del archivo SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c9795-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="c9795-146">El valor devuelto se preprocesa utilizando Path.GetFilenameWithoutExtension.</span><span class="sxs-lookup"><span data-stu-id="c9795-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="c9795-147">**Nota:** no se puede usar esta macro en WSS. Propiedades de contexto de configuración * (desde la orquestación).</span><span class="sxs-lookup"><span data-stu-id="c9795-147">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="c9795-148">%Extension%</span><span class="sxs-lookup"><span data-stu-id="c9795-148">%Extension%</span></span>|<span data-ttu-id="c9795-149">Se reemplaza con el valor de la extensión de archivo extraído de la propiedad de contexto del mensaje WSS.Filename.</span><span class="sxs-lookup"><span data-stu-id="c9795-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="c9795-150">Los mensajes recibidos de SharePoint tienen el valor de la propiedad de contexto de mensaje WSS.Filename establecida en el nombre del archivo SharePoint.</span><span class="sxs-lookup"><span data-stu-id="c9795-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="c9795-151">El valor devuelto se preprocesa utilizando Path.GetExtension.</span><span class="sxs-lookup"><span data-stu-id="c9795-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="c9795-152">El valor devuelto no contendrá ".".</span><span class="sxs-lookup"><span data-stu-id="c9795-152">The returned value will not contain ".".</span></span> <span data-ttu-id="c9795-153">**Nota:** no se puede usar esta macro en WSS. Propiedades de contexto de configuración * (desde la orquestación).</span><span class="sxs-lookup"><span data-stu-id="c9795-153">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="c9795-154">Toda expresión válida que admita la promoción de propiedades es un nombre de archivo de tiempo de diseño válido.</span><span class="sxs-lookup"><span data-stu-id="c9795-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="c9795-155">El nombre de archivo de tiempo de diseño se ampliará en tiempo de ejecución a los nombres de archivo de Windows SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="c9795-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="c9795-156">Este nombre de archivo de Windows SharePoint Services tiene algunas limitaciones adicionales que se describen del modo siguiente:</span><span class="sxs-lookup"><span data-stu-id="c9795-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="c9795-157">Los nombres de archivo de Windows válidos pueden contener caracteres Unicode, con las siguientes excepciones: /  \  :  *  ?</span><span class="sxs-lookup"><span data-stu-id="c9795-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  *  ?</span></span>  <span data-ttu-id="c9795-158">\<> &#124;  "# {} % & ~ o caracteres de tabulación y varios puntos.</span><span class="sxs-lookup"><span data-stu-id="c9795-158">\<  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="c9795-159">El nombre de archivo no puede tener más de 256 caracteres y la longitud total de la dirección URL debe ser, a lo sumo, de 256 caracteres.</span><span class="sxs-lookup"><span data-stu-id="c9795-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="c9795-160">Si el nombre de archivo de Windows SharePoint Services expandido contiene caracteres no válidos, o si la dirección URL o el nombre de archivo expandido es demasiado largo, se registrará un error en el registro de eventos de la aplicación y el mensaje se suspenderá.</span><span class="sxs-lookup"><span data-stu-id="c9795-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="c9795-161">El estado de mensaje y el error también estarán visibles en la página Concentrador de grupo mediante el seguimiento de instancias de servicios y eventos de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c9795-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c9795-162">Vea también</span><span class="sxs-lookup"><span data-stu-id="c9795-162">See Also</span></span>  
 <span data-ttu-id="c9795-163">[Cómo configurar Windows SharePoint Services ubicación de recepción](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="c9795-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="c9795-164">[Cómo configurar un controlador de envío de Windows SharePoint Services](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="c9795-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="c9795-165">[Cómo configurar un puerto de envío de Windows SharePoint Services](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="c9795-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="c9795-166">[Referencia de propiedades de adaptador de Windows SharePoint Services](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="c9795-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="c9795-167">Admite los tipos de columna de Windows SharePoint Services</span><span class="sxs-lookup"><span data-stu-id="c9795-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)