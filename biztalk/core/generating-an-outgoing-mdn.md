---
title: Generar un MDN saliente | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 12d7da1c-0d3c-42d4-9388-29f499353d13
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b9fdd5b5d52d5d741b71ec46be276b4926528a67
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36984477"
---
# <a name="generating-an-outgoing-mdn"></a><span data-ttu-id="c8b89-102">Generar un MDN saliente</span><span class="sxs-lookup"><span data-stu-id="c8b89-102">Generating an Outgoing MDN</span></span>
<span data-ttu-id="c8b89-103">Las canalizaciones de recepción AS2 generan una respuesta MDN (Message Disposition Notification) para un mensaje entrante.</span><span class="sxs-lookup"><span data-stu-id="c8b89-103">The AS2 receive pipelines generate an MDN (Message Disposition Notification) response for an incoming message.</span></span> <span data-ttu-id="c8b89-104">Esto lo realiza el componente de la canalización del desensamblador EDI en la canalización de recepción AS2EReceive (en respuesta a un mensaje cifrado de EDI) o el componente de canalización del desensamblador AS2 en la canalización de recepción AS2Receive (en respuesta a un mensaje cifrado que no sea EDI).</span><span class="sxs-lookup"><span data-stu-id="c8b89-104">This is performed by the EDI Disassembler pipeline component in the AS2EDIReceive receive pipeline (in response to an EDI-encoded message) or the AS2 Disassembler pipeline component in the AS2Receive receive pipeline (in response to a non-EDI-encoded message).</span></span>  
  
## <a name="when-and-how-an-mdn-is-generated"></a><span data-ttu-id="c8b89-105">Cuándo y cómo se genera un MDN</span><span class="sxs-lookup"><span data-stu-id="c8b89-105">When and How an MDN is Generated</span></span>  
 <span data-ttu-id="c8b89-106">Un MDN se genera normalmente según los encabezados AS2 en el mensaje AS2 original, del siguiente modo:</span><span class="sxs-lookup"><span data-stu-id="c8b89-106">An MDN is normally generated based upon the AS2 headers in the original AS2 message, as follows:</span></span>  
  
- <span data-ttu-id="c8b89-107">Se enviará un MDN si el encabezado Disposition-Notification-To está presente en el mensaje AS2.</span><span class="sxs-lookup"><span data-stu-id="c8b89-107">An MDN will be sent if the Disposition-Notification-To header is present in the AS2 message.</span></span>  
  
- <span data-ttu-id="c8b89-108">Si los encabezados Disposition-Notification-To y Receipt-Delivery-Option están presentes en el mensaje, el MDN se enviará de forma asíncrona.</span><span class="sxs-lookup"><span data-stu-id="c8b89-108">If the Disposition-Notification-To header and the Receipt-Delivery-Option header are present in the message, the MDN will be sent asynchronously.</span></span> <span data-ttu-id="c8b89-109">Se enviará a la URL en el encabezado Receipt-Delivery-Option, a través de una conexión distinta del mensaje original.</span><span class="sxs-lookup"><span data-stu-id="c8b89-109">It will be sent to the URL in the Receipt-Delivery-Option header, over a different connection than the original message.</span></span>  
  
- <span data-ttu-id="c8b89-110">Si el encabezado Disposition-Notification-To está presente en el mensaje pero el encabezado Receipt-Delivery-Option no lo está, se enviará el MDN de forma sincrónica a través de la misma conexión que el mensaje original.</span><span class="sxs-lookup"><span data-stu-id="c8b89-110">If the Disposition-Notification-To header is present in the message, but the Receipt-Delivery-Option header is not present in the message, the MDN will be sent synchronously over the same connection as the original message.</span></span>  
  
  <span data-ttu-id="c8b89-111">El desensamblador crea el encabezado AS2-From en el MDN a partir del encabezado AS2-To en el mensaje AS2 recibido y cree el encabezado AS2-To en el MDN a partir del encabezado AS2-From en el mensaje AS2 recibido.</span><span class="sxs-lookup"><span data-stu-id="c8b89-111">The Disassembler creates the AS2-From header in the MDN from the AS2-To header in the received AS2 message, and it creates the AS2-To header in the MDN from the AS2-From header in the received AS2 message.</span></span>  
  
  [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="c8b89-112"> le permite anular estos valores, especificando si se generará un MDN y cómo se generará según las propiedades de acuerdo AS2 de una entidad.</span><span class="sxs-lookup"><span data-stu-id="c8b89-112"> enables you to override these settings, specifying whether an MDN will be generated and how it will be generated based upon a party's AS2 agreement properties.</span></span> <span data-ttu-id="c8b89-113">Invalidar la configuración del encabezado AS2 en el mensaje mediante la **usar la configuración de acuerdo para validación y MDN en lugar del encabezado de mensaje** propiedad en la ficha de acuerdo AS2 unidireccional del **las propiedades del acuerdo**cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="c8b89-113">You override the AS2 header settings in the message using the **Use agreement settings for validation and MDN instead of message header** property in the one-way AS2 agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="c8b89-114">Esta propiedad le permite enviar un MDN aunque el encabezado AS2 no llame a ninguno, o enviar el MDN de forma asíncrona aunque el encabezado AS2 especifique una conexión sincrónica.</span><span class="sxs-lookup"><span data-stu-id="c8b89-114">This property enables you to send an MDN even if the AS2 header does not call for one, or to send the MDN asynchronously when the AS2 header specifies a synchronous connection.</span></span>  
  
  <span data-ttu-id="c8b89-115">Si establece la **usar la configuración de acuerdo para validación y MDN en lugar del encabezado de mensaje** propiedad, los valores de la **solicitar MDN** sección de la **configuración de MDN de remitente** página en la ficha de acuerdo AS2 unidireccional del **las propiedades del acuerdo** cuadro de diálogo se usará para el MDN, como sigue:</span><span class="sxs-lookup"><span data-stu-id="c8b89-115">If you set the **Use agreement settings for validation and MDN instead of message header** property, the values in the **Request MDN** section of the **Sender MDN Settings** page in the one-way AS2 agreement tab of the **Agreement Properties** dialog box will be used for the MDN, as follows:</span></span>  
  
- <span data-ttu-id="c8b89-116">Se enviará un MDN si la **solicitar MDN** propiedad está seleccionada.</span><span class="sxs-lookup"><span data-stu-id="c8b89-116">An MDN will be sent if the **Request MDN** property is selected.</span></span>  
  
- <span data-ttu-id="c8b89-117">Si el **solicitar MDN** propiedad está seleccionada y el **solicitar MDN asíncrono** propiedad está activada, el MDN se enviará de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="c8b89-117">If the **Request MDN** property is selected, and the **Request asynchronous MDN** property is selected, the MDN will be sent asynchronously.</span></span> <span data-ttu-id="c8b89-118">El MDN se enviará a la dirección URL que el **Receipt-Delivery-Option (URL)** propiedad está establecida en, a través de una conexión distinta del mensaje original.</span><span class="sxs-lookup"><span data-stu-id="c8b89-118">The MDN will be sent to the URL that the **Receipt-Delivery-Option (URL)** property is set to, over a different connection than the original message.</span></span>  
  
- <span data-ttu-id="c8b89-119">Si el **solicitar MDN** propiedad está seleccionada, pero el **solicitar MDN asíncrono** propiedad no está activada, el MDN se enviará de forma sincrónica a través de la misma conexión que el mensaje original.</span><span class="sxs-lookup"><span data-stu-id="c8b89-119">If the **Request MDN** property is selected, but the **Request asynchronous MDN** property is not selected, the MDN will be sent synchronously over the same connection as the original message.</span></span>  
  
  <span data-ttu-id="c8b89-120">Si el **usar la configuración de acuerdo para validación y MDN en lugar del encabezado de mensaje** propiedad está establecida, AS2-de propiedad en el mensaje de encabezado se usará en la generación del MDN pero AS2-a se tomará de las propiedades del acuerdo, y la canalización firmará el MDN según la **solicitar MDN firmado** propiedad.</span><span class="sxs-lookup"><span data-stu-id="c8b89-120">If the **Use agreement settings for validation and MDN instead of message header** property is set, the AS2-From property in the message header will be used in generating the MDN, but AS2-To will be taken from the agreement properties, and the pipeline will sign the MDN according to the **Request Signed MDN** property.</span></span> <span data-ttu-id="c8b89-121">Los encabezados AS2 corresponden a las propiedades de acuerdo como se muestran a continuación:</span><span class="sxs-lookup"><span data-stu-id="c8b89-121">The AS2 headers correspond to the agreement properties as follows:</span></span>  
  
|<span data-ttu-id="c8b89-122">Propiedad de acuerdo</span><span class="sxs-lookup"><span data-stu-id="c8b89-122">Agreement Property</span></span>|<span data-ttu-id="c8b89-123">Encabezado AS2 en el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c8b89-123">AS2 Header in the Message</span></span>|  
|------------------------|-------------------------------|  
|<span data-ttu-id="c8b89-124">Generar MDN</span><span class="sxs-lookup"><span data-stu-id="c8b89-124">Generate MDN</span></span>|<span data-ttu-id="c8b89-125">Disposition-Notification-To</span><span class="sxs-lookup"><span data-stu-id="c8b89-125">Disposition-Notification-To</span></span>|  
|<span data-ttu-id="c8b89-126">Firmar MDN</span><span class="sxs-lookup"><span data-stu-id="c8b89-126">Sign MDN</span></span>|<span data-ttu-id="c8b89-127">Signed-Receipt-Protocol</span><span class="sxs-lookup"><span data-stu-id="c8b89-127">Signed-Receipt-Protocol</span></span>|  
|<span data-ttu-id="c8b89-128">Receipt-Delivery-Option</span><span class="sxs-lookup"><span data-stu-id="c8b89-128">Receipt-Delivery-Option</span></span>|<span data-ttu-id="c8b89-129">Receipt-Delivery-Option</span><span class="sxs-lookup"><span data-stu-id="c8b89-129">Receipt-Delivery-Option</span></span>|  
  
 <span data-ttu-id="c8b89-130">Si se habilita un MDN, la canalización de recepción promocionará las siguientes propiedades de contexto:</span><span class="sxs-lookup"><span data-stu-id="c8b89-130">If an MDN is enabled, the receive pipeline will promote the following context properties:</span></span>  
  
- `EdiIntAS.DispositionMode`  
  
- `EdiIntAS.DispositionType`  
  
  <span data-ttu-id="c8b89-131">Estas propiedades de contexto deben estar promocionadas para que el MDN se genere.</span><span class="sxs-lookup"><span data-stu-id="c8b89-131">Both of these context properties must be promoted in order for the MDN to be generated.</span></span> <span data-ttu-id="c8b89-132">Para obtener más información acerca de estas propiedades de contexto, vea [propiedades de contexto AS2](../core/as2-context-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c8b89-132">For more information about these context properties, see [AS2 Context Properties](../core/as2-context-properties.md).</span></span>  
  
  <span data-ttu-id="c8b89-133">Si los parámetros de configuración y los encabezados en el mensaje entrante son incoherentes, la canalización generará un MDN negativo.</span><span class="sxs-lookup"><span data-stu-id="c8b89-133">If the configuration settings and the headers in the incoming message are inconsistent, the pipeline will generate a negative MDN.</span></span>  
  
  <span data-ttu-id="c8b89-134">Si se solicita el MDN en las propiedades de acuerdo, la canalización de recepción intentará enviar un MDN incluso si se produce un error en el procesamiento AS2.</span><span class="sxs-lookup"><span data-stu-id="c8b89-134">If the MDN is requested in the agreement properties, the receive pipeline will attempt to send an MDN even if an error occurs in AS2 processing.</span></span>  
  
## <a name="how-the-receive-pipeline-processes-a-generated-mdn"></a><span data-ttu-id="c8b89-135">Cómo la canalización de recepción procesa un MDN generado</span><span class="sxs-lookup"><span data-stu-id="c8b89-135">How the Receive Pipeline Processes a Generated MDN</span></span>  
 <span data-ttu-id="c8b89-136">Si un MDN se genera de acuerdo con las reglas anteriores, la canalización de recepción AS2EDIReceive o AS2Receive procesará el MDN de la siguiente forma:</span><span class="sxs-lookup"><span data-stu-id="c8b89-136">If an MDN is generated according to the above rules, the AS2EDIReceive or AS2Receive receive pipeline will process the MDN as follows:</span></span>  
  
-   <span data-ttu-id="c8b89-137">Realiza una copia del MDN (en formato de mensaje) y la almacena en la base de datos sin repudio, si esta opción está habilitada en las propiedades de acuerdo AS2 unidireccional.</span><span class="sxs-lookup"><span data-stu-id="c8b89-137">Makes a copy of the MDN (in wire format), and stores it in the non-repudiation database, if enabled in the one-way AS2 agreement properties.</span></span>  
  
-   <span data-ttu-id="c8b89-138">Realiza un procesamiento MIME, incluida la aplicación de una firma digital, si esta opción está habilitada en las propiedades del acuerdo de AS2 unidireccional.</span><span class="sxs-lookup"><span data-stu-id="c8b89-138">Performs MIME processing, including applying a digital signature, if enabled in the one-way AS2 agreement properties.</span></span>  
  
-   <span data-ttu-id="c8b89-139">Calcula la MIC (Message Integrity Check) para la carga del mensaje AS2 y la anexa al campo de extensión Received-content-MIC del MDN.</span><span class="sxs-lookup"><span data-stu-id="c8b89-139">Calculates the MIC (Message Integrity Check) for the AS2 message payload and appends it to the Received-content-MIC extension field of the MDN.</span></span> <span data-ttu-id="c8b89-140">El algoritmo que se aplicará para el MIC se determina mediante el encabezado signed-receipt-micalg del mensaje entrante o el **algoritmo de firma** propiedad en el **configuración de MDN de remitente** página de la unidireccional pestaña del acuerdo de la **las propiedades del acuerdo** cuadro de diálogo (cuando se invalidan las propiedades del mensaje entrante).</span><span class="sxs-lookup"><span data-stu-id="c8b89-140">The algorithm to be applied for the MIC is determined by the signed-receipt-micalg header of the incoming message or the **Signing Algorithm** property on the **Sender MDN Settings** page of the one-way agreement tab of the **Agreement Properties** dialog box (when the inbound message properties are overridden).</span></span> <span data-ttu-id="c8b89-141">Puede ser SHA1 o MD5.</span><span class="sxs-lookup"><span data-stu-id="c8b89-141">It can be either SHA1 or MD5.</span></span> <span data-ttu-id="c8b89-142">El valor del algoritmo también se incluye en el MDN.</span><span class="sxs-lookup"><span data-stu-id="c8b89-142">The value of the algorithm is also included in the MDN.</span></span>  
  
-   <span data-ttu-id="c8b89-143">Realiza entradas de correlación en la base de datos sin repudio.</span><span class="sxs-lookup"><span data-stu-id="c8b89-143">Makes correlation entries in the non-repudiation database.</span></span>  
  
-   <span data-ttu-id="c8b89-144">Realiza una copia del mensaje MDN.</span><span class="sxs-lookup"><span data-stu-id="c8b89-144">Makes a copy of the MDN message.</span></span>  
  
-   <span data-ttu-id="c8b89-145">Si se va a transmitir el MDN de forma sincrónica, la canalización establece la propiedad `EdiIntAS.IsAS2AsynchronousMDN` en False; si se va a transmitir de forma asíncrona, establece la propiedad en True.</span><span class="sxs-lookup"><span data-stu-id="c8b89-145">If the MDN is to be transmitted synchronously, the pipeline sets the `EdiIntAS.IsAS2AsynchronousMDN` property to False; if asynchronously, it sets the property to True.</span></span>  
  
-   <span data-ttu-id="c8b89-146">Si el MDN se va a transmitir de forma sincrónica, la canalización de envío AS2Send asociada al puerto de recepción bidireccional recogerá el MDN que se base en la propiedad `EdiIntAS.IsAS2AsynchronousMDN` (establecida en False) y los token de correlación.</span><span class="sxs-lookup"><span data-stu-id="c8b89-146">If the MDN is to be transmitted synchronously, the AS2Send send pipeline associated with the two-way receive port will pick up the MDN based upon the `EdiIntAS.IsAS2AsynchronousMDN` property (set to False) and the correlation tokens.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="c8b89-147">También puede establecer un puerto de envío que se suscribe al MDN sincrónico saliente.</span><span class="sxs-lookup"><span data-stu-id="c8b89-147">You can also set up a send port that subscribes to the outgoing synchronous MDN.</span></span> <span data-ttu-id="c8b89-148">Para hacerlo, establezca el filtro de puerto de envío en `EdiIntAS.IsAS2MdnResponseMessage==True`.</span><span class="sxs-lookup"><span data-stu-id="c8b89-148">To do so, set the send port filter to `EdiIntAS.IsAS2MdnResponseMessage==True`.</span></span>  
  
-   <span data-ttu-id="c8b89-149">Si se va a transmitir el MDN de forma asíncrona, la canalización de recepción enruta el MDN en el cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c8b89-149">If the MDN is to be transmitted asynchronously, the receive pipeline routes the MDN to the MessageBox.</span></span> <span data-ttu-id="c8b89-150">Debe establecer un puerto de envío para subscribirse al MDN, estableciendo el puerto de envío en `IsAS2AsynchronousMdn==True`.</span><span class="sxs-lookup"><span data-stu-id="c8b89-150">You must set up a send port to subscribe to the MDN, setting the send port filter to `IsAS2AsynchronousMdn==True`.</span></span> <span data-ttu-id="c8b89-151">La canalización de envío AS2Send recoge el mensaje que se basa en esta propiedad y los token de correlación.</span><span class="sxs-lookup"><span data-stu-id="c8b89-151">The AS2Send send pipeline picks up the message based upon that property and the correlation tokens.</span></span> <span data-ttu-id="c8b89-152">Si el puerto de envío es dinámico, enrutará el MDN que se basa en la dirección en la línea Receipt-Delivery-Notification en el encabezado del mensaje.</span><span class="sxs-lookup"><span data-stu-id="c8b89-152">If the send port is dynamic, it will route the MDN based to the address in the Receipt-Delivery-Notification line in the header of the message.</span></span> <span data-ttu-id="c8b89-153">Si el puerto de envío es estático, enrutará el mensaje en función de la propiedad Transporte URI del puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="c8b89-153">If the send port is static, it will route the message based upon Transport URI property of the send port.</span></span>  
  
## <a name="mdn-generation-rules"></a><span data-ttu-id="c8b89-154">Reglas de generación MDN</span><span class="sxs-lookup"><span data-stu-id="c8b89-154">MDN Generation Rules</span></span>  
 <span data-ttu-id="c8b89-155">Las siguientes reglas se aplican a la generación de MDN:</span><span class="sxs-lookup"><span data-stu-id="c8b89-155">The following rules apply to MDN generation:</span></span>  
  
-   <span data-ttu-id="c8b89-156">Cuando un remitente del mensaje solicita de forma específica una recepción firmada pero hay un error en el procesamiento de los contenidos del mensaje, el remitente del mensaje debe devolver una recepción firmada incluso si la transacción no es válida.</span><span class="sxs-lookup"><span data-stu-id="c8b89-156">When a message sender specifically requests a signed receipt, but there is error in processing the contents of the message, the message receiver must still return a signed receipt, even though the transaction itself may not be valid.</span></span> <span data-ttu-id="c8b89-157">El motivo del error en el procesamiento de los contenidos del mensaje debe establecerse en “disposition-field”.</span><span class="sxs-lookup"><span data-stu-id="c8b89-157">The reason for the error in processing the contents of the message must be set in the "disposition-field".</span></span>  
  
-   <span data-ttu-id="c8b89-158">Cuando la solicitud para la recepción MDN especifica de forma explícita que la recepción se va a firmar pero el receptor del mensaje original no puede satisfacer el formato de protocolo solicitado o el algoritmo MIC solicitado, se devolverá una recepción firmada o sin firmar.</span><span class="sxs-lookup"><span data-stu-id="c8b89-158">When the request for the MDN receipt explicitly specifies that the receipt be signed, but the receiver of the original message cannot support either the requested protocol format or the requested MIC algorithm, then either a signed or unsigned receipt should be returned.</span></span>  
  
-   <span data-ttu-id="c8b89-159">Cuando una firma no se solicita de forma explícita, o si el acuerdo de la entidad de recepción no reconoce el parámetro de solicitud de recepción firmada, la entidad de recepción puede devolver una recepción sin firmar, sin firmar o no enviarla.</span><span class="sxs-lookup"><span data-stu-id="c8b89-159">When a signature is not explicitly requested, or if the signed receipt request parameter is not recognized by the agreement for the receiving party, then the receiving party may return an unsigned receipt, a signed receipt, or no receipt.</span></span>  
  
## <a name="mic-generation"></a><span data-ttu-id="c8b89-160">Generación de MIC</span><span class="sxs-lookup"><span data-stu-id="c8b89-160">MIC Generation</span></span>  
 <span data-ttu-id="c8b89-161">Cuando es necesario un MDN, el receptor del mensaje original genera una MIC (Message Integrity Check) y la agrega al MDN.</span><span class="sxs-lookup"><span data-stu-id="c8b89-161">When an MDN is required, the receiver of the original message generates an MIC (Message Integrity Check) and adds it to the MDN.</span></span> <span data-ttu-id="c8b89-162">Cuando el intercambio EDI forma parte de un tipo de contenido MIME de varias partes, la MIC debe calcularse a través del contenido de varias partes completo, incluido el intercambio EDI y los encabezados MIME.</span><span class="sxs-lookup"><span data-stu-id="c8b89-162">When the EDI interchange is part of a multi-part MIME content-type, the MIC must be calculated across the entire multi-part content, including the EDI interchange and the MIME headers.</span></span> <span data-ttu-id="c8b89-163">Para los mensajes sin firmar y cifrados, el MIC que se va a devolver se calcula en el encabezado MIME descifrado y el contenido.</span><span class="sxs-lookup"><span data-stu-id="c8b89-163">For encrypted, unsigned messages, the MIC to be returned is calculated on the decrypted MIME header and content.</span></span> <span data-ttu-id="c8b89-164">Para los mensajes sin cifrar y sin firmar, debe calcularse la MIC a través de los contenidos de mensaje sin los encabezados MIME.</span><span class="sxs-lookup"><span data-stu-id="c8b89-164">For unsigned, unencrypted messages, the MIC must be calculated over the message contents without the MIME headers.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8b89-165">Vea también</span><span class="sxs-lookup"><span data-stu-id="c8b89-165">See Also</span></span>  
 [<span data-ttu-id="c8b89-166">Cómo recibe BizTalk Server los mensajes AS2</span><span class="sxs-lookup"><span data-stu-id="c8b89-166">How BizTalk Server Receives AS2 Messages</span></span>](../core/how-biztalk-server-receives-as2-messages.md)