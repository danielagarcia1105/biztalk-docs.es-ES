---
title: Resolución de acuerdos y determinación de esquemas para mensajes EDI salientes | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e37aeb9d-1e95-464d-bb71-73653c1d4674
caps.latest.revision: 24
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a718f386686b8a23bc8c97108b94b5fba717ee90
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36992029"
---
# <a name="agreement-resolution-and-schema-determination-for-outgoing-edi-messages"></a><span data-ttu-id="574fb-102">Resolución de acuerdos y determinación de esquemas para los mensajes EDI salientes</span><span class="sxs-lookup"><span data-stu-id="574fb-102">Agreement Resolution and Schema Determination for Outgoing EDI Messages</span></span>
<span data-ttu-id="574fb-103">Para generar un mensaje EDI a un socio comercial, la canalización de envío EDI debe efectuar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="574fb-103">To generate an EDI message to a trading partner, the EDI send pipeline must do the following:</span></span>  
  
-   <span data-ttu-id="574fb-104">Determinar el acuerdo en el que se resuelve el mensaje</span><span class="sxs-lookup"><span data-stu-id="574fb-104">Determine the agreement that the message resolves to</span></span>  
  
-   <span data-ttu-id="574fb-105">Determinar el esquema que se va a usar para validar el mensaje</span><span class="sxs-lookup"><span data-stu-id="574fb-105">Determine the schema to use to validate the message</span></span>  
  
## <a name="agreement-resolution"></a><span data-ttu-id="574fb-106">Resolución de acuerdos</span><span class="sxs-lookup"><span data-stu-id="574fb-106">Agreement Resolution</span></span>  
 <span data-ttu-id="574fb-107">La canalización de envío EDI lleva a cabo la búsqueda de acuerdos mediante la realización de una serie de pasos para determinar si hay una coincidencia entre el intercambio saliente y las propiedades de un acuerdo.</span><span class="sxs-lookup"><span data-stu-id="574fb-107">The EDI send pipeline performs agreement lookup by performing a series of steps to determine whether there is a match between the outgoing interchange and the properties of an agreement.</span></span> <span data-ttu-id="574fb-108">Una vez que [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ha determinado el acuerdo, determina el esquema del documento que se aplica al intercambio (véase a continuación).</span><span class="sxs-lookup"><span data-stu-id="574fb-108">Once [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement, it determines the document schema that applies to the interchange (see below).</span></span> <span data-ttu-id="574fb-109">Usa las propiedades asociadas al acuerdo coincidente y el esquema correspondiente para generar y validar el mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="574fb-109">It uses the properties associated with the matching agreement and the relevant schema to generate and validate the outgoing message.</span></span>  
  
 <span data-ttu-id="574fb-110">Para llevar a cabo la resolución de acuerdos, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] realiza los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="574fb-110">To perform agreement resolution, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proceeds as follows:</span></span>  
  
1. <span data-ttu-id="574fb-111">Resuelve el acuerdo al hacer coincidir la propiedad de contexto AgreementPartIDForSend con el identificador del acuerdo unidireccional.</span><span class="sxs-lookup"><span data-stu-id="574fb-111">Resolves the agreement by matching the AgreementPartIDForSend context property with the ID of the one-way agreement.</span></span> <span data-ttu-id="574fb-112">Esta propiedad debe ser de tipo entero y se puede establecer en un componente personalizado; no la establece [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="574fb-112">This property should be an integer type, it can be set in a custom component; it is not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
2. <span data-ttu-id="574fb-113">Si el paso 1 no funciona, resuelve el acuerdo haciendo coincidir la tres propiedades de contexto siguientes con las propiedades del acuerdo: AgreementNameForSend, SenderPartyNameForSend y ReceiverPartyNameForSend.</span><span class="sxs-lookup"><span data-stu-id="574fb-113">If step 1 does not succeed, resolves the agreement by matching all the following three context properties with the agreement properties: AgreementNameForSend, SenderPartyNameForSend, ReceiverPartyNameForSend.</span></span> <span data-ttu-id="574fb-114">Tenga en cuenta que las tres propiedades deben estar configuradas para que se puedan resolver correctamente en un acuerdo.</span><span class="sxs-lookup"><span data-stu-id="574fb-114">Note that all the three properties must be set in order to successfully resolve to an agreement.</span></span> <span data-ttu-id="574fb-115">Estas propiedades se pueden configurar en un componente personalizado; no las configura [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="574fb-115">These properties can be set in a custom component; it is not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
3. <span data-ttu-id="574fb-116">Si el paso 2 no funciona, resuelve el acuerdo haciendo coincidir el nombre de la entidad en las propiedades de contexto de mensaje con la propiedad DestinationPartyName, que se ha establecido como resolución de acuerdo adicional en el **identificadores** ficha de propiedades del acuerdo.</span><span class="sxs-lookup"><span data-stu-id="574fb-116">If step 2 does not succeed, resolves the agreement by matching the party name in the message context properties with the DestinationPartyName property, which is set as additional agreement resolver in the **Identifiers** tab of agreement properties.</span></span>  
  
4. <span data-ttu-id="574fb-117">Si el paso 3 no funciona, resuelve el acuerdo haciendo coincidir las propiedades siguientes del contexto de un mensaje con las de las propiedades del acuerdo: DestinationPartySenderIdentifier, DestinationPartySenderQualifier, DestinationPartyReceiverIdentifier y DestinationPartyReceiverQualifier.</span><span class="sxs-lookup"><span data-stu-id="574fb-117">If step 3 does not succeed, resolves the agreement by matching the following properties in the context of a message with those in agreement properties: DestinationPartySenderIdentifier, DestinationPartySenderQualifier, DestinationPartyReceiverIdentifier, and DestinationPartyReceiverQualifier.</span></span> <span data-ttu-id="574fb-118">Tenga en cuenta que las cuatro propiedades deben estar configuradas para que se puedan resolver correctamente en un acuerdo.</span><span class="sxs-lookup"><span data-stu-id="574fb-118">Note that all the four properties must be set in order to successfully resolve to an agreement.</span></span> <span data-ttu-id="574fb-119">Estas propiedades pueden establecerse en un componente personalizado; no se establecen [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="574fb-119">These properties can be set in a custom component; they are not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="574fb-120">Para obtener más información, vea la información que aparece abajo.</span><span class="sxs-lookup"><span data-stu-id="574fb-120">For more information, see below.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="574fb-121">Si algunos de los anteriores conjuntos de propiedades de contexto se promocionan y [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] no encuentra un acuerdo asociado con estas propiedades de contexto, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] suspende el mensaje.</span><span class="sxs-lookup"><span data-stu-id="574fb-121">If any of the above sets of context properties are promoted and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is unable to find an agreement associated with those context properties, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] suspends the message.</span></span>  
   > 
   >  <span data-ttu-id="574fb-122">Si el usuario escribe intencionadamente un conjunto de propiedades de contexto para la resolución del acuerdo y la resolución no puede identificar el acuerdo unidireccional, el mensaje se suspende.</span><span class="sxs-lookup"><span data-stu-id="574fb-122">If the user intentionally writes a set of context properties for agreement resolution, and if the resolver fails to identify the OnewayAgreement, then the message is suspended.</span></span> <span data-ttu-id="574fb-123">Si un acuerdo no se puede resolver según un conjunto de propiedades de contexto, se lanza el correspondiente mensaje de advertencia en el registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="574fb-123">On failure to resolve to an agreement based on a set of context properties, a corresponding warning message is thrown in the EventLog.</span></span>  
  
5. <span data-ttu-id="574fb-124">Si el paso 4 no funciona o no se promociona ninguna de las anteriores propiedades de contexto, el mensaje EDI se resuelve en un acuerdo mediante la coincidencia del puerto de envío que se ha suscrito al mensaje con el puerto de envío asociado a un acuerdo.</span><span class="sxs-lookup"><span data-stu-id="574fb-124">If step 4 does not succeed or none of the above context properties are promoted, then the EDI message is resolved to an agreement by matching the send port that subscribed to the message with the send port associated with an agreement.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="574fb-125">Si el mismo puerto de envío está asociado a varios acuerdos, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] generará un error.</span><span class="sxs-lookup"><span data-stu-id="574fb-125">If the same send port is associated with multiple agreements, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will generate an error.</span></span>  
  
6. <span data-ttu-id="574fb-126">Si no se encuentra ningún acuerdo en los pasos 1, 2, 3 o 4, la canalización de envío usa la configuración del acuerdo de reserva para generar el mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="574fb-126">If no agreement is found in steps 1, 2, 3, or 4, the send pipeline uses the fallback agreement settings to generate the outgoing message.</span></span>  
  
   <span data-ttu-id="574fb-127">**Resolución del acuerdo haciendo coincidir las propiedades de contexto de receptor y remitente**</span><span class="sxs-lookup"><span data-stu-id="574fb-127">**Agreement Resolution by Matching Sender and Receiver Context Properties**</span></span>  
  
   <span data-ttu-id="574fb-128">En el segundo paso anterior, las cuatro propiedades de contexto usadas en la coincidencia son EDI.DestinationPartySenderIdentifier, EDI.DestinationPartySenderQualifier, EDI.DestinationPartyReceiverIdentifier y EDI.DestinationPartyReceiverQualifier.</span><span class="sxs-lookup"><span data-stu-id="574fb-128">In the second step above, the four context properties used in the match are EDI.DestinationPartySenderIdentifier, EDI.DestinationPartySenderQualifier, EDI.DestinationPartyReceiverIdentifier, and EDI.DestinationPartyReceiverQualifier.</span></span> <span data-ttu-id="574fb-129">El espacio de nombres para estas propiedades de contexto es `http://schemas.microsoft.com/Edi/PropertySchema`.</span><span class="sxs-lookup"><span data-stu-id="574fb-129">The namespace for these context properties is `http://schemas.microsoft.com/Edi/PropertySchema`.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="574fb-130"> intenta hacer coincidir estos valores con el remitente y los identificadores del receptor y calificadores en las propiedades del acuerdo unidireccional.</span><span class="sxs-lookup"><span data-stu-id="574fb-130"> attempts to match these values with the related sender and receiver identifiers and qualifiers in the one-way agreement properties.</span></span> <span data-ttu-id="574fb-131">Para X12, estos campos son ISA05, ISA06, ISA07 e ISA08 en el **identificadores** página de la ficha de acuerdo unidireccional en el **las propiedades del acuerdo** cuadro de diálogo; para EDIFACT, estos campos son UNB2.1, UNB2.2, UNB3.1 y UNB3.2 en la **identificadores** página de la ficha de acuerdo unidireccional en el **las propiedades del acuerdo** cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="574fb-131">For X12, these fields are ISA05, ISA06, ISA07, and ISA08 in the **Identifiers** page of the one-way agreement tab in the **Agreement Properties** dialog box; for EDIFACT, these fields are UNB2.1, UNB2.2, UNB3.1, and UNB3.2 in the **Identifiers** page of the one-way agreement tab in the **Agreement Properties** dialog box.</span></span>  
  
   <span data-ttu-id="574fb-132">Para habilitar la resolución del acuerdo en el lado del envío mediante los cuatro calificadores e identificadores de remitente y receptor, deberá establecer las cuatro propiedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="574fb-132">To enable send-side agreement resolution using all four sender and receiver identifiers and qualifiers, you will have to set all four context properties.</span></span> <span data-ttu-id="574fb-133">De este modo, se identifica el acuerdo de forma exclusiva.</span><span class="sxs-lookup"><span data-stu-id="574fb-133">Doing so uniquely identifies the agreement.</span></span> <span data-ttu-id="574fb-134">Con este método de búsqueda de acuerdo conseguirá mayor flexibilidad en el procesamiento de envío.</span><span class="sxs-lookup"><span data-stu-id="574fb-134">Using this method of agreement lookup gives you more flexibility in send-side processing.</span></span> <span data-ttu-id="574fb-135">Por ejemplo, mediante este método podría evitar la creación de varios puertos de envío en algunas circunstancias, así como filtros de puerto de envío complicados.</span><span class="sxs-lookup"><span data-stu-id="574fb-135">For example, this method may enable you to avoid creating multiple send ports in some circumstances, and to avoid complicated send port filters.</span></span> <span data-ttu-id="574fb-136">También permite evitar establecer la propiedad OneWayAgreementId, si así lo desea.</span><span class="sxs-lookup"><span data-stu-id="574fb-136">It also enables you to avoid setting the OneWayAgreementId property, if desired.</span></span>  
  
   <span data-ttu-id="574fb-137">Si las cuatro propiedades de contexto se han establecido para un mensaje y no se ha encontrado ninguna coincidencia entre las propiedades de contexto y las de propiedad, el mensaje se suspende.</span><span class="sxs-lookup"><span data-stu-id="574fb-137">If all four context properties have been set for a message, and no match is found between those context properties and the property properties, the message is suspended.</span></span> <span data-ttu-id="574fb-138">El acuerdo se resolverá mediante el puerto de envío asociado con un acuerdo únicamente si no se han establecido las cuatro propiedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="574fb-138">The agreement will be resolved using the send port associated with an agreement only if all four context properties have not been set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="574fb-139">Un mensaje en la canalización EDI va al paso siguiente en la resolución del acuerdo hasta que el mensaje se resuelva con el paso que tiene el acuerdo en estado habilitado.</span><span class="sxs-lookup"><span data-stu-id="574fb-139">A message in the EDI pipeline goes to the succeeding step in Agreement Resolution till the message gets resolved with the step having Agreement in enable state.</span></span> <span data-ttu-id="574fb-140">Por ejemplo, si el mensaje se resuelve en el primer paso de resolución del acuerdo, pero el acuerdo se encuentra en estado deshabilitado, el mensaje va al paso siguiente para su resolución.</span><span class="sxs-lookup"><span data-stu-id="574fb-140">For example, if the message gets resolved in the first step of Agreement Resolution but the Agreement is in a disabled state then the message goes to the succeeding step for resolution.</span></span>  
  
## <a name="schema-determination"></a><span data-ttu-id="574fb-141">Determinar el esquema</span><span class="sxs-lookup"><span data-stu-id="574fb-141">Schema Determination</span></span>  
 <span data-ttu-id="574fb-142">La canalización de envío EDI determina el esquema que se aplica al mensaje desde el nombre de esquema y el espacio de nombres de esquema que se incluyen en el archivo XML intermediario para cada conjunto de transacciones (como información de tipo de documento o en el nodo raíz).</span><span class="sxs-lookup"><span data-stu-id="574fb-142">The EDI send pipeline determines the schema that applies to the message from the schema name and schema namespace contained in the intermediate XML file for each transaction set (either as doc type information or in the root node).</span></span>  
  
 <span data-ttu-id="574fb-143">Para un intercambio que se ha conservado, la canalización de envío usa la información de tipo de documento en los conjuntos de transacciones individuales del archivo XML intermediario para el intercambio completo.</span><span class="sxs-lookup"><span data-stu-id="574fb-143">For an interchange that has been preserved, the send pipeline uses the doc type information in the individual transaction sets of the intermediate XML file for the complete interchange.</span></span> <span data-ttu-id="574fb-144">Usa los esquemas de segmento de control para procesar los segmentos de sobre.</span><span class="sxs-lookup"><span data-stu-id="574fb-144">It uses the control segment schemas for processing the envelope segments.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="574fb-145">Vea también</span><span class="sxs-lookup"><span data-stu-id="574fb-145">See Also</span></span>  
 [<span data-ttu-id="574fb-146">Cómo envía BizTalk Server los mensajes EDI</span><span class="sxs-lookup"><span data-stu-id="574fb-146">How BizTalk Server Sends EDI Messages</span></span>](../core/how-biztalk-server-sends-edi-messages.md)