---
title: Arquitectura del marco de trabajo de reglas de negocios | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Business Rules Framework, caching
- Business Rules Framework, Rule Engine Update service
- rule store [Business Rules Framework]
- Policy class [Business Rules Engine]
- Business Rules Framework, architecture
- Business Rules Framework, RuleEngine class
- Business Rules Framework, Policy class
- Business Rules Framework, authoring tools
- RuleEngine class [Business Rules Engine]
- caching, Business Rules Framework
- Business Rules Framework, fact retrievers
- architecture, Business Rules Framework
- Business Rules Framework, rule store
ms.assetid: f5570cca-7664-4180-af9c-64ef90a0022b
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f55c624f8eaac517d11774ec2c542bf4ddbe0351
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36971845"
---
# <a name="business-rules-framework-architecture"></a><span data-ttu-id="6a695-102">Arquitectura del marco de trabajo de reglas de negocios</span><span class="sxs-lookup"><span data-stu-id="6a695-102">Business Rules Framework Architecture</span></span>
<span data-ttu-id="6a695-103">En la siguiente ilustración se muestra la arquitectura de componentes del marco de trabajo de reglas de negocios.</span><span class="sxs-lookup"><span data-stu-id="6a695-103">The following figure shows the component architecture of the Business Rules Framework.</span></span>  
  
 <span data-ttu-id="6a695-104">![Arquitectura de componentes de marco de reglas de negocio](../core/media/ebiz-rulesarch-new.gif "ebiz_rulesarch_new")</span><span class="sxs-lookup"><span data-stu-id="6a695-104">![Business Rules Framework component architecture](../core/media/ebiz-rulesarch-new.gif "ebiz_rulesarch_new")</span></span>  
<span data-ttu-id="6a695-105">Arquitectura del marco de trabajo de reglas de negocios de Microsoft</span><span class="sxs-lookup"><span data-stu-id="6a695-105">Microsoft Business Rules Framework Architecture</span></span>  
  
 <span data-ttu-id="6a695-106">En los párrafos siguientes se describen algunos de los componentes del marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="6a695-106">Some of the components of the framework are described in the following paragraphs.</span></span>  
  
## <a name="policy-class"></a><span data-ttu-id="6a695-107">Clase Directiva</span><span class="sxs-lookup"><span data-stu-id="6a695-107">Policy Class</span></span>  
 <span data-ttu-id="6a695-108">Un **directiva** objeto es una instancia única de una directiva empresarial y proporciona la interfaz que usa las aplicaciones basadas en reglas.</span><span class="sxs-lookup"><span data-stu-id="6a695-108">A **Policy** object is a single instance of a business policy, and provides the interface that is used by rule-based applications.</span></span> <span data-ttu-id="6a695-109">Proporciona una abstracción que libera de preocupaciones al programador de aplicaciones respecto a la ubicación del almacén de reglas, pues extrae los conjuntos de reglas del almacén de reglas, crea instancias a partir de instancias del motor de reglas subyacentes y garantiza que los hechos a largo plazo se imponen en el motor.</span><span class="sxs-lookup"><span data-stu-id="6a695-109">It provides an abstraction that frees the application developer from concern about the location of the rule store, extracting rule sets from the rule store, instantiating instances of the underlying rule engine, and ensuring that long-term facts are asserted into the engine.</span></span> <span data-ttu-id="6a695-110">En muchos escenarios, una aplicación basada en reglas utiliza instancias simultáneas de la **directiva** objeto.</span><span class="sxs-lookup"><span data-stu-id="6a695-110">In many scenarios, a rule-based application uses concurrent instances of the **Policy** object.</span></span> <span data-ttu-id="6a695-111">Estas instancias simultáneas pueden representar la misma directiva, distintas versiones de la misma directiva o versiones diferentes de directivas dispares.</span><span class="sxs-lookup"><span data-stu-id="6a695-111">These concurrent instances can represent the same policy, different versions of the same policy, or different versions of different policies.</span></span>  
  
## <a name="ruleengine-class"></a><span data-ttu-id="6a695-112">Clase RuleEngine</span><span class="sxs-lookup"><span data-stu-id="6a695-112">RuleEngine Class</span></span>  
 <span data-ttu-id="6a695-113">El **RuleEngine** objeto actúa como el motor de ejecución para las directivas empresariales.</span><span class="sxs-lookup"><span data-stu-id="6a695-113">The **RuleEngine** object serves as the execution engine for business policies.</span></span> <span data-ttu-id="6a695-114">Usa tres componentes complementarios (traductor, motor de inferencia e interceptor de seguimiento) para la implementación.</span><span class="sxs-lookup"><span data-stu-id="6a695-114">It uses three plug-in components (translator, inference engine, and tracking interceptor) for implementation.</span></span> <span data-ttu-id="6a695-115">Un **RuleEngine** objeto toma un **RuleSet** objeto que representa una directiva empresarial como entrada y usa el traductor, motor de inferencia y el interceptor de seguimiento configurado para el conjunto de reglas para implementar la establece la directiva empresarial definida por la regla.</span><span class="sxs-lookup"><span data-stu-id="6a695-115">A **RuleEngine** object takes a **RuleSet** object representing a business policy as input and uses the translator, inference engine, and tracking interceptor configured for the rule set to implement the business policy defined by the rule set.</span></span>  
  
## <a name="fact-retriever"></a><span data-ttu-id="6a695-116">Almacenes de datos</span><span class="sxs-lookup"><span data-stu-id="6a695-116">Fact Retriever</span></span>  
 <span data-ttu-id="6a695-117">Un administrador de almacenes de datos es un componente complementario opcional y definido por el usuario que se encarga de recopilar hechos a largo plazo para utilizarlos en directivas empresariales.</span><span class="sxs-lookup"><span data-stu-id="6a695-117">A fact retriever is an optional, user-defined, plug-in component that is responsible for gathering long-term facts for use by business policies.</span></span> <span data-ttu-id="6a695-118">Para obtener más información, consulte [cómo crear un administrador de almacenes](../core/how-to-create-a-fact-retriever.md).</span><span class="sxs-lookup"><span data-stu-id="6a695-118">For more information, see [How to Create a Fact Retriever](../core/how-to-create-a-fact-retriever.md).</span></span>  
  
 <span data-ttu-id="6a695-119">Antes de la ejecución, un **directiva** instancia de objeto proporciona su **RuleEngine** memoria de trabajo de la instancia para el Administrador de almacenes, dándole la oportunidad de actualizar el conjunto de hechos en el motor de reglas.</span><span class="sxs-lookup"><span data-stu-id="6a695-119">Before execution, a **Policy** object instance provides its **RuleEngine** instance to the fact retriever, giving it the opportunity to update the set of facts in the rule engine's working memory.</span></span> <span data-ttu-id="6a695-120">Para obtener más información, consulte [frente a hechos a corto plazo. Hechos a largo plazo](../core/short-term-facts-vs-long-term-facts.md).</span><span class="sxs-lookup"><span data-stu-id="6a695-120">For more information, see [Short-Term Facts vs. Long-Term Facts](../core/short-term-facts-vs-long-term-facts.md).</span></span>  
  
## <a name="rule-engine-update-service"></a><span data-ttu-id="6a695-121">Servicio de actualización de motor de reglas</span><span class="sxs-lookup"><span data-stu-id="6a695-121">Rule Engine Update Service</span></span>  
 <span data-ttu-id="6a695-122">El Servicio de actualización de motor de reglas proporciona actualizaciones dinámicas de directivas empresariales en un entorno distribuido.</span><span class="sxs-lookup"><span data-stu-id="6a695-122">The Rule Engine Update service provides dynamic business policy updates in a distributed environment.</span></span> <span data-ttu-id="6a695-123">Una aplicación de servicio de Microsoft Windows NT de inicio automático se encarga de realizar suscripciones a los eventos de implementación y de anulación de implementación que se producen tras el cambio de directivas empresariales.</span><span class="sxs-lookup"><span data-stu-id="6a695-123">An autostart Microsoft Windows NT service application is responsible for subscribing to policy deployment and undeployment events that occur when business policies are changed.</span></span>  
  
 <span data-ttu-id="6a695-124">En un escenario empresarial común, las directivas empresariales se implementan tras actualizarse, probarse y realizarse versiones de ellas.</span><span class="sxs-lookup"><span data-stu-id="6a695-124">In a typical enterprise scenario, business policies are deployed after being updated, tested, and versioned.</span></span> <span data-ttu-id="6a695-125">La implementación consiste en agregar la directiva actualizada a un almacén de reglas seguro y persistente. Además, en ciertos casos se ejecuta una lógica en el almacén para publicar la información acerca de la directiva actualizada en todas las entidades implicadas (tenga en cuenta que es la información de la directiva lo que se publica, y no la directiva en sí).</span><span class="sxs-lookup"><span data-stu-id="6a695-125">Deployment consists of adding the updated policy to a secure, persistent rule store and optionally executing logic on the store to publish information about the updated policy to all interested parties (note that information about the policy is published and not the policy itself).</span></span>  
  
 <span data-ttu-id="6a695-126">El Servicio de actualización de motor de reglas, que se ejecuta en un servidor que aloja aplicaciones basadas en reglas, recibe la notificación de actualización de directivas y almacena la información en caché para usos posteriores.</span><span class="sxs-lookup"><span data-stu-id="6a695-126">The Rule Engine Update service, running on a server hosting rule-based applications, receives the policy update notification and caches the information for subsequent use.</span></span> <span data-ttu-id="6a695-127">El empleo de un modelo de publicación y suscripción (pub/sub) en las actualizaciones de directivas le permite cambiar directivas empresariales casi en tiempo real sin que se produzcan interrupciones ni tiempos de inactividad en el servicio.</span><span class="sxs-lookup"><span data-stu-id="6a695-127">The use of a pub/sub model for policy updates enables you to change business policies in near real time without service downtime or interruption.</span></span>  
  
## <a name="policyvocabulary-authoring-tools"></a><span data-ttu-id="6a695-128">Herramientas de creación de directivas y vocabularios</span><span class="sxs-lookup"><span data-stu-id="6a695-128">Policy/Vocabulary Authoring Tools</span></span>  
 <span data-ttu-id="6a695-129">El Compositor de reglas de negocio en Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proporciona directivas y vocabularios funciones a los usuarios finales y a los desarrolladores de creación.</span><span class="sxs-lookup"><span data-stu-id="6a695-129">The Business Rule Composer in Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provides policy and vocabulary authoring capabilities to both end users and developers.</span></span>  
  
## <a name="rule-store"></a><span data-ttu-id="6a695-130">Almacén de reglas</span><span class="sxs-lookup"><span data-stu-id="6a695-130">Rule Store</span></span>  
 <span data-ttu-id="6a695-131">Un *almacén de reglas* es un repositorio de vocabularios y directivas empresariales.</span><span class="sxs-lookup"><span data-stu-id="6a695-131">A *rule store* is a repository for business policies and vocabularies.</span></span> <span data-ttu-id="6a695-132">El repositorio puede ser un archivo simple o una base de datos confiable, persistente, escalable y segura como, por ejemplo, Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6a695-132">The repository can be a simple file or a secure, scalable, persistent, and reliable database such as Microsoft SQL Server.</span></span> <span data-ttu-id="6a695-133">(SQL Server se utiliza en el marco de trabajo como el almacén de reglas predeterminado).</span><span class="sxs-lookup"><span data-stu-id="6a695-133">(SQL Server is used as the default rule store for the framework).</span></span>  
  
## <a name="caching"></a><span data-ttu-id="6a695-134">Almacenamiento en memoria caché</span><span class="sxs-lookup"><span data-stu-id="6a695-134">Caching</span></span>  
 <span data-ttu-id="6a695-135">El marco de motor de reglas de negocios proporciona un mecanismo de almacenamiento en caché para **RuleEngine** instancias.</span><span class="sxs-lookup"><span data-stu-id="6a695-135">The Business Rules Engine Framework provides a caching mechanism for **RuleEngine** instances.</span></span> <span data-ttu-id="6a695-136">Cada **RuleEngine** instancia contiene una representación en memoria de una versión de directiva específica.</span><span class="sxs-lookup"><span data-stu-id="6a695-136">Each **RuleEngine** instance contains an in-memory representation of a specific policy version.</span></span>  
  
 <span data-ttu-id="6a695-137">Los pasos siguientes describen el proceso cuando un nuevo **directiva** se crea una instancia de instancia (ya sea con una llamada a la API o la ejecución de la **reglas de llamada** forma):</span><span class="sxs-lookup"><span data-stu-id="6a695-137">The following steps describe the process when a new **Policy** instance is instantiated (either with a call on the API or execution of the **Call Rules** shape):</span></span>  
  
1. <span data-ttu-id="6a695-138">El **directiva** objeto solicitudes un **RuleEngine** instancia desde la caché del motor de reglas.</span><span class="sxs-lookup"><span data-stu-id="6a695-138">The **Policy** object requests a **RuleEngine** instance from the rule engine cache.</span></span>  
  
2. <span data-ttu-id="6a695-139">Si un **RuleEngine** instancia por la versión de directiva que exista en la memoria caché, el **RuleEngine** instancia se devuelve a la **directiva** objeto.</span><span class="sxs-lookup"><span data-stu-id="6a695-139">If a **RuleEngine** instance for the policy version exists in the cache, the **RuleEngine** instance is returned to the **Policy** object.</span></span> <span data-ttu-id="6a695-140">Si un **RuleEngine** instancia no está disponible, la memoria caché crea una nueva instancia.</span><span class="sxs-lookup"><span data-stu-id="6a695-140">If a **RuleEngine** instance is not available, the cache creates a new instance.</span></span> <span data-ttu-id="6a695-141">Cuando un **RuleEngine** se crea una instancia de instancia, lo hace, a su vez, cree una nueva instancia de almacenes de datos de hechos, si hay uno configurado para la versión de directiva.</span><span class="sxs-lookup"><span data-stu-id="6a695-141">When a **RuleEngine** instance is instantiated, it does, in turn, create a new fact retriever instance if one is configured for the policy version.</span></span>  
  
   <span data-ttu-id="6a695-142">Cuando el **Execute** se llama al método en el **directiva** de objeto, se producen los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="6a695-142">When the **Execute** method is called on the **Policy** object, the following steps occur:</span></span>  
  
3. <span data-ttu-id="6a695-143">El objeto de directiva llama a la **UpdateFacts**método en la instancia de almacenes de datos de hecho, si existe un administrador de almacenes.</span><span class="sxs-lookup"><span data-stu-id="6a695-143">The Policy object calls the **UpdateFacts**method on the fact retriever instance if a fact retriever exists.</span></span> <span data-ttu-id="6a695-144">Implementación de almacenes del método puede imponer hechos a largo plazo en la memoria de trabajo de la **RuleEngine**.</span><span class="sxs-lookup"><span data-stu-id="6a695-144">The fact retriever's implementation of the method may assert long term facts into the working memory of the **RuleEngine**.</span></span>  
  
4. <span data-ttu-id="6a695-145">El **directiva** objeto impone los hechos a corto plazo incluidos en el **matriz** que se pasó el **Execute** llamar.</span><span class="sxs-lookup"><span data-stu-id="6a695-145">The **Policy** object asserts the short term facts contained in the **Array** that was passed in the **Execute** call.</span></span>  
  
5. <span data-ttu-id="6a695-146">El **directiva** de objeto llama **Execute** en el **RuleEngine**.</span><span class="sxs-lookup"><span data-stu-id="6a695-146">The **Policy** object calls **Execute** on the **RuleEngine**.</span></span>  
  
6. <span data-ttu-id="6a695-147">El **RuleEngine** completa la ejecución y devuelve el control a la **directiva**objeto.</span><span class="sxs-lookup"><span data-stu-id="6a695-147">The **RuleEngine** completes execution and returns control to the **Policy**object.</span></span>  
  
7. <span data-ttu-id="6a695-148">El**directiva**objeto retira los hechos a corto plazo la **RuleEngine**.</span><span class="sxs-lookup"><span data-stu-id="6a695-148">The**Policy**object retracts the short term facts from the **RuleEngine**.</span></span> <span data-ttu-id="6a695-149">Los hechos a largo plazo impuestos por el administrador de almacenes de datos permanecerán en la memoria de trabajo del motor de reglas.</span><span class="sxs-lookup"><span data-stu-id="6a695-149">The long term facts asserted by the fact retriever will remain in the working memory of the rule engine.</span></span>  
  
   <span data-ttu-id="6a695-150">Después de la **Dispose** se llama al método en el **directiva** objeto, el **RuleEngine** se libera la instancia a la caché del motor de reglas.</span><span class="sxs-lookup"><span data-stu-id="6a695-150">After the **Dispose** method is called on the **Policy** object, the **RuleEngine** instance is released back to the rule engine cache.</span></span>  
  
   <span data-ttu-id="6a695-151">La memoria caché del motor de reglas dispondrá de varias instancias del motor de reglas para una versión de directiva determinada si la carga lo requiere, y cada instancia del motor de reglas contará con su propia instancia del administrador de almacenes de datos.</span><span class="sxs-lookup"><span data-stu-id="6a695-151">The rule engine cache will have multiple rule engine instances for a given policy version if the load requires it, and each rule engine instance has its own fact retriever instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a695-152">Vea también</span><span class="sxs-lookup"><span data-stu-id="6a695-152">See Also</span></span>  
 [<span data-ttu-id="6a695-153">Motor de reglas de negocio</span><span class="sxs-lookup"><span data-stu-id="6a695-153">Business Rules Engine</span></span>](../core/business-rules-engine.md)