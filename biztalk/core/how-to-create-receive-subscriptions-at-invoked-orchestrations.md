---
title: "Cómo crear suscripciones de recepción en Orquestaciones invocadas | Documentos de Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3423309a-cb5a-40a5-9582-6ee3ac82b538
caps.latest.revision: "9"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c419101aa16c23f5fd8a644c0fe33f269d06d6ba
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-create-receive-subscriptions-at-invoked-orchestrations"></a><span data-ttu-id="1cfe1-102">Cómo crear suscripciones de recepción en orquestaciones invocadas</span><span class="sxs-lookup"><span data-stu-id="1cfe1-102">How to Create Receive Subscriptions at Invoked Orchestrations</span></span>
<span data-ttu-id="1cfe1-103">Aunque puede pasar mensajes como parámetros a través de la **Iniciar orquestación** forma cuando se inicia una orquestación, en algunos casos puede que desee para enviar mensajes desde la orquestación del autor a la orquestación invocada después de la invocación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-103">Although you can pass messages as parameters through the **Start Orchestration** shape when you start an orchestration, in some scenarios you may want to send messages from the caller orchestration to the invoked orchestration after the invocation.</span></span> <span data-ttu-id="1cfe1-104">Por ejemplo, es posible que no sepa qué mensajes quiere pasar en el momento de la llamada o que otras orquestaciones necesiten enviar mensajes a la orquestación invocada de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-104">For example, you may not know what messages you want to pass at the time of invocation, or other orchestrations may need to send messages to the invoked orchestration dynamically.</span></span>  
  
 <span data-ttu-id="1cfe1-105">La manera de enviar un mensaje a una orquestación invocada consiste en pasar una correlación de modo que la orquestación invocada pueda crear la suscripción que la correlación ayuda a definir y, después, pueda recibir el mensaje mediante esa suscripción.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-105">The way to send a message to an invoked orchestration is to pass in a correlation so that the invoked orchestration can create the subscription that the correlation helps define and then receive the message by using that subscription.</span></span> <span data-ttu-id="1cfe1-106">Sin embargo, no es suficiente con pasar una correlación y esperar que la orquestación invocada cree la suscripción basada en la correlación y reciba un mensaje mediante esa suscripción.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-106">However, you cannot simply pass in a correlation and expect the invoked orchestration to create the subscription based on the correlation and receive a message on the subscription.</span></span> <span data-ttu-id="1cfe1-107">Si lo hace así, los mensajes que envíe desde la orquestación del autor de llamada a la orquestación invocada producirá el error, "No se pudo enrutar el mensaje publicado. No se encontraron suscriptores.".</span><span class="sxs-lookup"><span data-stu-id="1cfe1-107">If you use that approach, the messages you send from the caller orchestration to the invoked orchestration will result in the error, "The published message could not be routed because no subscribers were found."</span></span> <span data-ttu-id="1cfe1-108">Esto se debe a los siguientes motivos:</span><span class="sxs-lookup"><span data-stu-id="1cfe1-108">This is because of the following:</span></span>  
  
-   <span data-ttu-id="1cfe1-109">Hay una condición de anticipación en la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-109">There is a race condition in the invoked orchestration.</span></span>  
  
-   <span data-ttu-id="1cfe1-110">No hay ningún punto de confirmación para que la orquestación invocada envíe la suscripción a la base de datos de cuadro de mensajes para el enrutamiento de modo que pueda recibir los mensajes.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-110">There is no commit point for the invoked orchestration to send the subscription to the MessageBox database for routing so that it can receive the messages.</span></span>  
  
 <span data-ttu-id="1cfe1-111">Para solucionar este problema, realice los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="1cfe1-111">A way to resolve this problem is to perform the following steps:</span></span>  
  
1.  <span data-ttu-id="1cfe1-112">En la orquestación del autor de la llamada, tiene una recepción de activación para recibir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-112">In the caller orchestration, you have an activate receive to receive the message.</span></span> <span data-ttu-id="1cfe1-113">Después de recibir el mensaje en la orquestación del autor, inicializar el conjunto de correlaciones y, a continuación, pasa el conjunto de correlaciones y puerto de enlace directo a través de recepción de un autocorrelación la **Iniciar orquestación** forma.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-113">After you receive the message in the caller orchestration, initialize the correlation set, and then pass the correlation set and a self-correlating receive direct-bound port through the **Start Orchestration** shape.</span></span> <span data-ttu-id="1cfe1-114">El puerto que pase se convierte en un puerto de envío en la orquestación invocada y se usará para devolver el mensaje para sincronizar con la orquestación del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-114">The port that you pass in becomes a send port in the invoked orchestration, and you will use it to send the message back to synchronize with the caller orchestration.</span></span>  
  
2.  <span data-ttu-id="1cfe1-115">En la orquestación invocada, devuelva un mensaje a la orquestación del autor de la llamada a través del puerto de autocorrelación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-115">In the invoked orchestration, send a message back to the caller orchestration through the self-correlating port.</span></span> <span data-ttu-id="1cfe1-116">Se sincroniza con la orquestación del autor de la llamada para evitar condiciones de anticipación y para proporcionar un punto de confirmación mientras se crea la suscripción de recepción en el cuadro de mensajes con el fin de enrutar la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-116">This synchronizes with the caller orchestration to prevent race conditions and to provide a commit point while creating the receive subscription to the MessageBox for routing in the invoked orchestration.</span></span>  
  
3.  <span data-ttu-id="1cfe1-117">La orquestación del autor de la llamada recibe el mensaje a través del puerto de autocorrelación y se sincroniza con la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-117">The caller orchestration receives the message through the self-correlating port and synchronizes with the invoked orchestration.</span></span> <span data-ttu-id="1cfe1-118">Tenga en cuenta que las recepciones del puerto de autocorrelación no necesitan seguidores de correlación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-118">Note that self-correlating port receives do not need correlation followers.</span></span> <span data-ttu-id="1cfe1-119">Ahora puede enviar mensajes de forma segura desde la orquestación del autor de la llamada a la orquestación invocada y ésta recibirá los mensajes en función de la correlación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-119">You can now safely send messages from the caller orchestration to the invoked orchestration, and the invoked orchestration will receive the messages based upon the correlation.</span></span>  
  
 <span data-ttu-id="1cfe1-120">Aunque con el enfoque descrito anteriormente se puede conseguir el objetivo establecido, es mejor pasar el mensaje que inicia la correlación en la que quiere recibirlo.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-120">Although the preceding approach can achieve the goal, a better approach is to pass in the message that initializes the correlation on which you want to receive upon.</span></span> <span data-ttu-id="1cfe1-121">Al sincronizar una orquestación de autor de llamada con una orquestación invocada a través de un puerto de autocorrelación, se recomienda que siempre pase el mensaje que necesita para iniciar las correlaciones.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-121">When you are synchronizing a caller orchestration with an invoked orchestration through a self-correlating port, we recommend that you always pass in the message that you need for initializing the correlations.</span></span> <span data-ttu-id="1cfe1-122">Los pasos siguientes constituyen el enfoque más confiable y de mejor rendimiento y de mayor fiabilidad:</span><span class="sxs-lookup"><span data-stu-id="1cfe1-122">The following steps provide the most reliable and highest-performance approach:</span></span>  
  
1.  <span data-ttu-id="1cfe1-123">En la orquestación del autor de la llamada, tiene una recepción de activación para recibir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-123">In the caller orchestration, you have an activate receive to receive the message.</span></span> <span data-ttu-id="1cfe1-124">Después de recibir el mensaje, pasa un mensaje y puerto de enlace directo a través de recepción de un autocorrelación la **Iniciar orquestación** forma.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-124">After you receive the message, pass a message and a self-correlating receive direct-bound port through the **Start Orchestration** shape.</span></span> <span data-ttu-id="1cfe1-125">El mensaje que pase se usará para iniciar la correlación en la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-125">The message you pass in will be used to initialize the correlation in the invoked orchestration.</span></span> <span data-ttu-id="1cfe1-126">El puerto que pase se convierte en un puerto de envío en la orquestación invocada y se usará para devolver el mensaje para sincronizar con la orquestación del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-126">The port that you pass in becomes a send port in the invoked orchestration, and you will use it to send the message back to synchronize with the caller orchestration.</span></span>  
  
2.  <span data-ttu-id="1cfe1-127">En la orquestación invocada, inicie la correlación y devuelva un mensaje a la orquestación del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-127">In the invoked orchestration, initialize the correlation and send a message back to the caller orchestration.</span></span> <span data-ttu-id="1cfe1-128">Se sincroniza con la orquestación del autor de la llamada para evitar condiciones de anticipación y para proporcionar un punto de confirmación mientras se crea la suscripción de recepción en el cuadro de mensajes con el fin de enrutar la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-128">This synchronizes with the caller orchestration to prevent race conditions and to provide a commit point while creating the receive subscription to the MessageBox for routing in the invoked orchestration.</span></span>  
  
3.  <span data-ttu-id="1cfe1-129">La orquestación del autor de la llamada recibe el mensaje a través del puerto de autocorrelación y se sincroniza con la orquestación invocada.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-129">The caller orchestration receives the message through the self-correlating port and synchronizes with the invoked orchestration.</span></span> <span data-ttu-id="1cfe1-130">Tenga en cuenta que recibe el puerto de autocorrelación no necesitan seguidores de correlación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-130">Note that the self-correlating port receives do not need correlation followers.</span></span> <span data-ttu-id="1cfe1-131">Ahora puede enviar mensajes de forma segura desde la orquestación del autor de la llamada a la orquestación invocada y ésta recibirá los mensajes en función de la correlación.</span><span class="sxs-lookup"><span data-stu-id="1cfe1-131">You can now safely send messages from the caller orchestration to the invoked orchestration, and the invoked orchestration will receive the messages based upon the correlation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cfe1-132">Vea también</span><span class="sxs-lookup"><span data-stu-id="1cfe1-132">See Also</span></span>  
 <span data-ttu-id="1cfe1-133">[Usar correlaciones en orquestaciones](../core/using-correlations-in-orchestrations.md) </span><span class="sxs-lookup"><span data-stu-id="1cfe1-133">[Using Correlations in Orchestrations](../core/using-correlations-in-orchestrations.md) </span></span>  
 [<span data-ttu-id="1cfe1-134">Puertos de enlace de uso directo de autocorrelación</span><span class="sxs-lookup"><span data-stu-id="1cfe1-134">How to Use Self-Correlating Direct Bound Ports</span></span>](../core/how-to-use-self-correlating-direct-bound-ports.md)