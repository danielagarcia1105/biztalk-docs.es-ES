---
title: Cómo crear una tarea de análisis personalizado | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- BAM, DTS tasks
- DTS tasks
- DTS packages, tasks
- BAM, processing
ms.assetid: 6046c113-fb58-4e72-8f48-5470e52be9a8
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b3566e40deaa05886ead701e1871634cf6fb94e2
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2017
ms.locfileid: "25969234"
---
# <a name="how-to-create-a-custom-analysis-task"></a><span data-ttu-id="0bbce-102">Cómo crear una tarea de análisis personalizada</span><span class="sxs-lookup"><span data-stu-id="0bbce-102">How to Create a Custom Analysis Task</span></span>
<span data-ttu-id="0bbce-103">La manera más sencilla de crear una tarea DTS personalizada para procesar datos de BAM consiste en empezar por el paquete generado por BAM de forma automática y sustituir todo el procesamiento real de datos.</span><span class="sxs-lookup"><span data-stu-id="0bbce-103">The easiest way to create a custom DTS task for processing BAM data is to start from the package that is auto-generated by BAM and replace all the actual data processing.</span></span>  
  
### <a name="to-create-a-custom-dts-task"></a><span data-ttu-id="0bbce-104">Para crear una tarea DTS personalizada</span><span class="sxs-lookup"><span data-stu-id="0bbce-104">To create a custom DTS task</span></span>  
  
1.  <span data-ttu-id="0bbce-105">Cree una definición de BAM que requiera un cubo OLAP.</span><span class="sxs-lookup"><span data-stu-id="0bbce-105">Create a BAM Definition that requires an OLAP cube.</span></span> <span data-ttu-id="0bbce-106">Por ejemplo, utilice los asistentes de Excel y deje un informe de tabla dinámica® como vista no ATR.</span><span class="sxs-lookup"><span data-stu-id="0bbce-106">For example use the Excel wizards, and leave one PivotTable® report as non-RTA view.</span></span>  
  
2.  <span data-ttu-id="0bbce-107">Abra el paquete DTS de procesamiento de cubos creado por BAM.</span><span class="sxs-lookup"><span data-stu-id="0bbce-107">Open the DTS package for cube processing that BAM creates.</span></span> <span data-ttu-id="0bbce-108">BAM crea un paquete de este tipo para cada vista, conocido como BAM_AN_\<*nombre de la vista*\>.</span><span class="sxs-lookup"><span data-stu-id="0bbce-108">BAM creates one such package for each view, known as BAM_AN_\<*View Name*\>.</span></span>  
  
3.  <span data-ttu-id="0bbce-109">Abra el paquete en el Diseñador DTS y quite todos los pasos, excepto los dos primeros y el último.</span><span class="sxs-lookup"><span data-stu-id="0bbce-109">Open the Package in the DTS Designer and remove all steps except the first two steps and the last step.</span></span> <span data-ttu-id="0bbce-110">Puede que desee conservar también la conexión a la base de datos de importación principal.</span><span class="sxs-lookup"><span data-stu-id="0bbce-110">You may also want to keep the connection to the Primary Import database.</span></span>  
  
4.  <span data-ttu-id="0bbce-111">Edite las propiedades de la primera tarea ActiveX®.</span><span class="sxs-lookup"><span data-stu-id="0bbce-111">Edit the properties of the first ActiveX® task.</span></span> <span data-ttu-id="0bbce-112">Quite todas las líneas que contengan DTSGlobalVariables.Parent.Steps, ya que se refieren a los pasos eliminados.</span><span class="sxs-lookup"><span data-stu-id="0bbce-112">Remove all lines that contain DTSGlobalVariables.Parent.Steps, because they refer to the deleted steps.</span></span> <span data-ttu-id="0bbce-113">La secuencia de comandos empieza con:</span><span class="sxs-lookup"><span data-stu-id="0bbce-113">The script begins with:</span></span>  
  
    ```  
    serverName = "<your server here>"   
    databaseName = "<your analysis database here>"  
    cubeName = "<your cube name here>"  
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="0bbce-114">La tarea "Comenzar análisis de datos" (la segunda tarea del paquete) es muy importante, puesto que aporta al paquete lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0bbce-114">The task "Begin Data Analysis" (the second task in the package) is very important because it gives your package:</span></span>  
    >   
    >  -   <span data-ttu-id="0bbce-115">Una ventana móvil para el procesamiento incremental de las actividades finalizadas [la vista SQL dinámica denominada bam_(BamView)_View(Activity)_CompletedInstancesWindow]</span><span class="sxs-lookup"><span data-stu-id="0bbce-115">A moving window for incremental processing of the completed Activities (the dynamic SQL view named  bam_(BamView)_View(Activity)_CompletedInstancesWindow</span></span>  
    > -   <span data-ttu-id="0bbce-116">Una instantánea de las actividades que están en curso: una tabla denominada bam\_(BamView) _View (Activity) _ActiveInstancesSnapshot.</span><span class="sxs-lookup"><span data-stu-id="0bbce-116">A Snapshot of the Activities that are in progress - a table named  bam\_(BamView)_View(Activity)_ActiveInstancesSnapshot.</span></span>  
  
5.  <span data-ttu-id="0bbce-117">Obtenga la vista y la tabla en una transacción breve, durante la cual no debe insertar datos, de modo que los datos representen una instantánea real e inmediata de la base de datos de importación principal.</span><span class="sxs-lookup"><span data-stu-id="0bbce-117">Obtain the view and table in a short transaction, during which you insert no data, so that the data represents a real instantaneous snapshot of the Primary Import database.</span></span> <span data-ttu-id="0bbce-118">Implemente uno o varios pasos para realizar las transformaciones de datos reales, basándose en la vista y en la tabla como datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="0bbce-118">Implement one or more steps to do the actual data transformations based on the view and table as input data.</span></span> <span data-ttu-id="0bbce-119">Si la tarea de análisis tiene una finalidad distinta a la de rellenar un cubo OLAP, recuerde conservar una marca de fecha y hora del momento en que se confirmó el trabajo por última vez, y de sustituir la primera tarea ActiveX por el código que asigna esta marca de fecha y hora a la variable global “CompletedCubeLastProcessTime”.</span><span class="sxs-lookup"><span data-stu-id="0bbce-119">If the purpose of your analysis task is something other than filling an OLAP cube, remember to keep a timestamp of when your job committed for the last time and replace the first ActiveX task with code that assigns this timestamp to the global variable "CompletedCubeLastProcessTime".</span></span> <span data-ttu-id="0bbce-120">La segunda tarea utiliza esta variable para asegurarse de que no se han perdido datos, y de que no hay datos que se hayan procesado dos veces en caso de un error y del posterior reinicio del paquete DTS.</span><span class="sxs-lookup"><span data-stu-id="0bbce-120">The second task uses this variable to make sure that there is no missed data and that no data processes twice in case of a crash and restart of the DTS package.</span></span>  
  
6.  <span data-ttu-id="0bbce-121">Por último, debe llamar a la última tarea, que es “Finalizar análisis de datos”.</span><span class="sxs-lookup"><span data-stu-id="0bbce-121">Finally, you must call the last task, which is "end data analysis".</span></span> <span data-ttu-id="0bbce-122">Esta tarea libera las actividades finalizadas que se han procesado, de modo que puedan archivarse y quitarse de la base de datos de importación principal una vez que estén fuera de la ventana en línea.</span><span class="sxs-lookup"><span data-stu-id="0bbce-122">This task releases the completed activities that were processed, so that they can be archived and removed from the primary import once they are outside of the online window.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0bbce-123">Vea también</span><span class="sxs-lookup"><span data-stu-id="0bbce-123">See Also</span></span>  
 [<span data-ttu-id="0bbce-124">Uso de la actividad económica de supervisión</span><span class="sxs-lookup"><span data-stu-id="0bbce-124">Using Business Activity Monitoring</span></span>](../core/using-business-activity-monitoring.md)