---
title: Cómo evitar la limitación de mensajes correlacionados | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: bfe47747-01e7-4e2f-bbd5-d5055cea001a
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 755622a55f7b0216399cfe33842994ff0f70a259
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36994437"
---
# <a name="how-to-avoid-throttling-correlated-messages"></a><span data-ttu-id="e8b34-102">Cómo evitar la limitación de mensajes correlacionados</span><span class="sxs-lookup"><span data-stu-id="e8b34-102">How to Avoid Throttling Correlated Messages</span></span>
<span data-ttu-id="e8b34-103">Los mensajes que están en cola en BizTalk Server, por ejemplo, a través de una ubicación de recepción o mediante orquestaciones, se pueden procesar en uno de los siguientes modos:</span><span class="sxs-lookup"><span data-stu-id="e8b34-103">Messages that are en-queued into BizTalk Server, for example through a receive location or by orchestrations, can be processed in one of the following ways:</span></span>  
  
- <span data-ttu-id="e8b34-104">Pueden activar instancias nuevas de suscriptores (es decir, orquestaciones o puertos de envío)</span><span class="sxs-lookup"><span data-stu-id="e8b34-104">They can activate new instances of subscribers (that is, orchestrations or send ports)</span></span>  
  
- <span data-ttu-id="e8b34-105">Se pueden enrutar a una instancia de suscriptor existente a través de la correlación.</span><span class="sxs-lookup"><span data-stu-id="e8b34-105">They can be routed to an existing subscriber instance via correlation.</span></span> <span data-ttu-id="e8b34-106">Para obtener más información sobre la correlación, vea [utilizando las correlaciones en orquestaciones](../core/using-correlations-in-orchestrations.md).</span><span class="sxs-lookup"><span data-stu-id="e8b34-106">For more information about correlation, see [Using Correlations in Orchestrations](../core/using-correlations-in-orchestrations.md).</span></span>  
  
  <span data-ttu-id="e8b34-107">Numerosos programadores piensan en las ubicaciones de recepción para integrar una solución cuando se reciben mensajes de activación y correlacionados para obtener la solución a través del mismo puerto.</span><span class="sxs-lookup"><span data-stu-id="e8b34-107">A lot of developers think about the receive locations for a solution as receiving both activation and correlated messages for the solution through the same port.</span></span> <span data-ttu-id="e8b34-108">Esto es natural, puesto que minimiza el número de direcciones a las que los remitentes del mensaje deben realizar el seguimiento.</span><span class="sxs-lookup"><span data-stu-id="e8b34-108">This is natural as it minimizes the number of addresses that message senders need to keep track of.</span></span> <span data-ttu-id="e8b34-109">Sin embargo, con la limitación en [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], pueden haber ventajas al pensar sobre la secuencia de mensajes de activación y la secuencia de mensajes correlacionados por separado en cuanto se refiere a la limitación.</span><span class="sxs-lookup"><span data-stu-id="e8b34-109">However, with throttling in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], there can be advantages to thinking about the stream of activation messages and the stream of correlated messages separately when it comes to throttling.</span></span>  
  
  <span data-ttu-id="e8b34-110">Cuando los mensajes de correlación y de activación llegan a través de la misma ubicación de recepción, están sujetos al mismo estado de limitación debido a que la limitación se aplica en el nivel de host.</span><span class="sxs-lookup"><span data-stu-id="e8b34-110">When both activation and correlation messages arrive through the same receive location, they are subject to the same throttling state because throttling is applied at the host level.</span></span> <span data-ttu-id="e8b34-111">Por tanto, todos los mensajes que llegan a las ubicaciones de recepción del host se limitarán como unidad.</span><span class="sxs-lookup"><span data-stu-id="e8b34-111">As a result, all messages arriving at receive locations in the host will be throttled as a unit.</span></span> <span data-ttu-id="e8b34-112">Esto no supone un problema para muchos escenarios, aunque hay casos en los que la limitación de correlaciones con activaciones puede dar lugar a un tipo de interbloqueo del sistema.</span><span class="sxs-lookup"><span data-stu-id="e8b34-112">This is not an issue for many scenarios, but there are cases where throttling correlations with activations can result in a type of system deadlock.</span></span>  
  
## <a name="example"></a><span data-ttu-id="e8b34-113">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="e8b34-113">Example</span></span>  
 <span data-ttu-id="e8b34-114">Por ejemplo, supongamos que tiene un escenario con una orquestación que recibe una activación, se usa para inicializar un conjunto de correlaciones y, a continuación, recibe un convoy de 10 mensajes más que siguen el conjunto de correlaciones.</span><span class="sxs-lookup"><span data-stu-id="e8b34-114">For example, let's assume you have a scenario containing an orchestration that receives one activation, uses it to initialize a correlation set, then receives a convoy of 10 additional messages that follow the correlation set.</span></span> <span data-ttu-id="e8b34-115">Además, se supone que, en cuanto a la carga, se acumula un registro en la cola de impresión cuando llega la combinación de mensajes de correlación y de activación, lo que da lugar a una limitación de la cantidad de mensajes que se pueden recibir.</span><span class="sxs-lookup"><span data-stu-id="e8b34-115">In addition, assume that, under load, a backlog builds up in the spool as the mix of activation and correlation messages arrive that results in throttling the amount of messages that can be received.</span></span> <span data-ttu-id="e8b34-116">Desafortunadamente, los mensajes de correlación se limitan junto con las activaciones, lo que ralentiza la finalización de las orquestaciones y da a lugar a un registro posterior y a una limitación adicional.</span><span class="sxs-lookup"><span data-stu-id="e8b34-116">Unfortunately, the correlation messages are throttled along with the activations, which slows down the completion of orchestrations, causing further backlog and additional throttling.</span></span> <span data-ttu-id="e8b34-117">En el caso de que puedan continuar, esto daría lugar a una limitación del sistema a un rendimiento cercano a cero.</span><span class="sxs-lookup"><span data-stu-id="e8b34-117">Allowed to continue, this would result in throttling the system down to near zero throughput.</span></span>  
  
 <span data-ttu-id="e8b34-118">Al dividir la única ubicación de recepción en dos – una para las activaciones y otra para las correlaciones – y configurar las ubicaciones en hosts individuales, el umbral de limitación del tamaño de base de datos para las activaciones se puede mantener más bajo que el de las correlaciones, que resultará en un rendimiento general de registro reducido y mantendrá el flujo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="e8b34-118">By splitting the single receive location into two -- one for activations and one for correlations -- and configuring the locations in separate hosts, the database size throttling threshold for the activations can be kept lower than that for correlations, which will result in reduced backlog overall, and keep the messages flowing.</span></span>  
  
 <span data-ttu-id="e8b34-119">Por lo tanto, puede que se pregunte: "¿por qué no puedo aumentar el umbral de tamaño de base de datos para mi única ubicación de recepción para solucionar el problema?"</span><span class="sxs-lookup"><span data-stu-id="e8b34-119">So, you might be asking: "why can’t I just raise the database size threshold for my single receive location to fix the problem?"</span></span> <span data-ttu-id="e8b34-120">La respuesta es que puede, pero no siempre dará lugar al comportamiento deseado.</span><span class="sxs-lookup"><span data-stu-id="e8b34-120">The answer is, you can, but it won’t always result in the desired behavior.</span></span> <span data-ttu-id="e8b34-121">La limitación se realiza principalmente para proteger al sistema de la sobrecarga.</span><span class="sxs-lookup"><span data-stu-id="e8b34-121">Throttling is there primarily to protect the system from becoming overloaded.</span></span> <span data-ttu-id="e8b34-122">Si aumenta lo suficiente la altura de los umbrales o los desactiva completamente, eliminará esta protección.</span><span class="sxs-lookup"><span data-stu-id="e8b34-122">If you raise the thresholds high enough, or turn them off altogether, you will eliminate this protection.</span></span>  
  
## <a name="recommendation"></a><span data-ttu-id="e8b34-123">Recomendación</span><span class="sxs-lookup"><span data-stu-id="e8b34-123">Recommendation</span></span>  
 <span data-ttu-id="e8b34-124">La práctica recomendada para escenarios, como los que se describen anteriormente que son sensibles a la limitación de mensajes de correlación, es separar las ubicaciones de recepción en hosts individuales que se pueden limitar de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="e8b34-124">The best practice for scenarios such as the one described above that are sensitive to throttling correlation messages, is to separate the receive locations into separate hosts which can be throttled independently.</span></span>  
  
 <span data-ttu-id="e8b34-125">Cuando se configuran los hosts individuales para las ubicaciones de recepción, establezca el umbral de limitación del tamaño de base de datos para el host usado por las ubicaciones de recepción como un valor inferior al del umbral de limitación del tamaño de base de datos para el host usado por las orquestaciones o correlaciones.</span><span class="sxs-lookup"><span data-stu-id="e8b34-125">When separate hosts are configured for receive locations, set the database size throttling threshold for the host used by the receive locations to a lower value than the database size throttling threshold for hosts used by orchestrations or correlations.</span></span>  
  
 <span data-ttu-id="e8b34-126">Si sabe que la carga nunca será superior al del rendimiento sostenible máximo (MST) del sistema o que los rendimientos máximos se pueden recuperar entre los eventos de rendimiento, el aumento de los umbrales de limitación también funcionará, aunque puede que un rendimiento no se mantenga tan alto como cuando se usan hosts independientes para activaciones y correlaciones.</span><span class="sxs-lookup"><span data-stu-id="e8b34-126">If you know that your load will never be higher than the maximum sustainable throughput (MST) for the system, or that throughput peaks are recoverable between peak events, then raising the throttling thresholds will also work, but may not sustain as high a throughput as using separate hosts for activations and correlations.</span></span>