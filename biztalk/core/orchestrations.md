---
title: Orquestaciones | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- orchestrations
- correlations, orchestrations
- orchestrations, correlations
- orchestrations, deploying
- deploying, orchestrations
- orchestrations, about orchestrations
ms.assetid: fb01f78a-b805-46be-a7d9-2b7597daab96
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f0ef446e5cc04e7fc7b4d151d0f034ab0dee695c
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36991127"
---
# <a name="orchestrations"></a><span data-ttu-id="809c7-102">Orquestaciones</span><span class="sxs-lookup"><span data-stu-id="809c7-102">Orchestrations</span></span>
<span data-ttu-id="809c7-103">*Orquestaciones* son procesos empresariales ejecutables que se pueden suscribir para recibir y publicar (enviar) mensajes a través de la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-103">*Orchestrations* are executable business processes that can subscribe to (receive) and publish (send) messages through the MessageBox database.</span></span> <span data-ttu-id="809c7-104">Además, las orquestaciones pueden construir nuevos mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-104">In addition, orchestrations can construct new messages.</span></span> <span data-ttu-id="809c7-105">Los mensajes se reciben mediante la suscripción y la infraestructura de enrutamiento, descrito en [ciclo de vida de un mensaje](../core/lifecycle-of-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="809c7-105">Messages are received using the subscription and routing infrastructure discussed in [Lifecycle of a Message](../core/lifecycle-of-a-message.md).</span></span> <span data-ttu-id="809c7-106">Cuando se completan las suscripciones para las orquestaciones, se activa una nueva instancia y el mensaje se entrega, o, en caso de que se trate de suscripciones de instancia, la instancia vuelve a hidratarse si es necesario y el mensaje se entrega.</span><span class="sxs-lookup"><span data-stu-id="809c7-106">When subscriptions are filled for orchestrations, a new instance is activated and the message is delivered, or in the case of instance subscriptions, the instance is rehydrated if necessary and the message is then delivered.</span></span> <span data-ttu-id="809c7-107">Cuando los mensajes se envían desde una orquestación, éstos se publican en el cuadro de mensajes de la misma forma en que un mensaje que llega a la ubicación de recepción con las propiedades adecuadas se inserta en la base de datos para su enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="809c7-107">When messages are sent from an orchestration, they are published to the MessageBox in the same manner as a message arriving on a receive location with the appropriate properties getting inserted into the database for use in routing.</span></span>  
  
 <span data-ttu-id="809c7-108">Los mensajes que se construyen en una orquestación deben colocarse en la base de datos de cuadro de mensajes y servir de referencia para la instancia de orquestación. Sin embargo, no es aconsejable publicar mensajes, pues aún no se han enviado.</span><span class="sxs-lookup"><span data-stu-id="809c7-108">Messages that are constructed in an orchestration must be placed in the MessageBox database and referenced by the orchestration instance, but they should not be published because they have not yet been sent.</span></span> <span data-ttu-id="809c7-109">El subservicio XLANG/s realiza llamadas a la API del agente de mensaje para insertar los mensajes de forma directa.</span><span class="sxs-lookup"><span data-stu-id="809c7-109">The XLANG/s subservice makes calls to the Message Agent API to insert messages directly.</span></span> <span data-ttu-id="809c7-110">Así se permite al motor de orquestaciones insertar el cuerpo del mensaje en el cuadro de mensajes y asociarlo directamente a la instancia de orquestación que se encuentra en ejecución.</span><span class="sxs-lookup"><span data-stu-id="809c7-110">This allows the orchestration engine to insert the message body into the MessageBox and have it directly associated with the running orchestration instance.</span></span> <span data-ttu-id="809c7-111">La persistencia del mensaje construido en la base de datos de cuadro de mensajes está coordinada con los puntos de persistencia de la orquestación como una optimización adicional de las operaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="809c7-111">The persistence of the constructed message in the MessageBox database is coordinated with persistence points in the orchestration as an additional optimization of database operations.</span></span>  
  
 <span data-ttu-id="809c7-112">El elemento de las orquestaciones que hace que la publicación y la suscripción parezcan acciones diferentes es el enlace.</span><span class="sxs-lookup"><span data-stu-id="809c7-112">The concept in orchestrations that makes the publish and subscribe seem to act differently is binding.</span></span> <span data-ttu-id="809c7-113">Los puertos de orquestación son puertos lógicos que describen una interacción.</span><span class="sxs-lookup"><span data-stu-id="809c7-113">Orchestration ports are logical ports that describe an interaction.</span></span> <span data-ttu-id="809c7-114">Debe enlazar estos puertos lógicos a un puerto físico para que se lleve a cabo la entrega de los mensajes, aunque este proceso de enlace no sea otra cosa que configurar suscripciones para el enrutamiento de mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-114">You must bind these logical ports to a physical port so that messages are delivered, but this binding process is nothing more than configuring subscriptions for message routing.</span></span>  
  
 <span data-ttu-id="809c7-115">Existen cuatro opciones básicas a la hora de enlazar estos puertos:</span><span class="sxs-lookup"><span data-stu-id="809c7-115">There are four basic options for binding these ports:</span></span>  
  
-   <span data-ttu-id="809c7-116">Especificar ahora (especificación directa de los puertos en la orquestación).</span><span class="sxs-lookup"><span data-stu-id="809c7-116">Specify Now (specifying ports directly in the orchestration)</span></span>  
  
-   <span data-ttu-id="809c7-117">Especificar más tarde (la especificación se realiza durante la implementación).</span><span class="sxs-lookup"><span data-stu-id="809c7-117">Specify Later (specifying ports at deployment time)</span></span>  
  
-   <span data-ttu-id="809c7-118">Mediante un puerto de envío dinámico en el que la dirección está configurada en el código de orquestación.</span><span class="sxs-lookup"><span data-stu-id="809c7-118">Using a dynamic send port where the address is set in the orchestration code</span></span>  
  
-   <span data-ttu-id="809c7-119">Mediante la creación de un enlace directo desde la orquestación hasta la base de datos de cuadro de mensajes o hasta otra orquestación</span><span class="sxs-lookup"><span data-stu-id="809c7-119">Creating a direct binding from the orchestration to either the MessageBox database or to another orchestration</span></span>  
  
## <a name="deploying-orchestrations"></a><span data-ttu-id="809c7-120">Implementar orquestaciones</span><span class="sxs-lookup"><span data-stu-id="809c7-120">Deploying Orchestrations</span></span>  
 <span data-ttu-id="809c7-121">Cuando se especifica un enlace en tiempo de diseño, el puerto físico que coincide con los parámetros configurados en la orquestación se crea durante la implementación de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="809c7-121">When a binding is specified at design time, the physical port that matches the parameters configured in the orchestration is created when the orchestration is deployed.</span></span> <span data-ttu-id="809c7-122">Cuando el enlace se configura durante la implementación, los puertos que cumplan los requisitos del puerto lógico se pueden enlazar al puerto de orquestación.</span><span class="sxs-lookup"><span data-stu-id="809c7-122">When the binding is configured at deployment time, any port that matches the requirements of the logical port can be bound to the orchestration port.</span></span> <span data-ttu-id="809c7-123">En el enlace dinámico, un puerto físico se crea simplemente de forma similar a la opción Especificar ahora, pero el puerto es un puerto de envío dinámico en el que no se ha configurado la información de dirección.</span><span class="sxs-lookup"><span data-stu-id="809c7-123">For dynamic binding, a physical port is created just as with the Specify Now option, but the port is a dynamic send port that has no address information configured.</span></span>  
  
 <span data-ttu-id="809c7-124">Un concepto que confunde a menudo es el hecho de que, aunque un puerto de envío de una orquestación se enlaza a un puerto de envío físico, éste no impide que el mensaje se entregue a otros suscriptores</span><span class="sxs-lookup"><span data-stu-id="809c7-124">A confusing concept is that while a send port in an orchestration is bound to a physical send port, this does not preclude that message from getting delivered to other subscribers.</span></span> <span data-ttu-id="809c7-125">Es decir, si otro puerto de envío posee una suscripción a través de sus filtros para el mensaje que se envía al puerto enlazado, los dos puertos de envío reciben el mensaje.</span><span class="sxs-lookup"><span data-stu-id="809c7-125">That is, if another send port happens to have a subscription, through its filters, for the message being sent to the bound port, both send ports receive the message.</span></span> <span data-ttu-id="809c7-126">El enlace tan solo crea la suscripción de forma que el mensaje enviado desde la orquestación cumpla siempre los criterios del puerto de envío enlazado.</span><span class="sxs-lookup"><span data-stu-id="809c7-126">Binding simply creates the subscription such that the message sent from the orchestration always matches the criteria for the bound send port.</span></span> <span data-ttu-id="809c7-127">Del mismo modo, el puerto de orquestación enlazado a un puerto de recepción crea la suscripción adecuada según el identificador del mensaje recepción y tipo de puerto.</span><span class="sxs-lookup"><span data-stu-id="809c7-127">Likewise, the orchestration port bound to a receive port creates the appropriate subscription based on message type and receive port ID.</span></span> <span data-ttu-id="809c7-128">Las suscripciones garantizan que los mensajes que entran y salen de la orquestación se entreguen a los puertos enlazados, pero los mensajes aún pasar por el mismo publicar y suscripción mecanismo descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="809c7-128">The subscriptions guarantee that the messages going in and out of the orchestration get delivered to the bound ports, but the messages still go through the same publish and subscribe mechanism described earlier.</span></span>  
  
 <span data-ttu-id="809c7-129">Probablemente, la opción de enlace de empleo inadecuado y menos frecuente, y que provoca mayores malentendidos, es la opción de Enlace directo.</span><span class="sxs-lookup"><span data-stu-id="809c7-129">Probably the most misunderstood, and misused or underused binding option is the Direct binding option.</span></span> <span data-ttu-id="809c7-130">El enlace directo permite a una orquestación publicar mensajes en la base de datos de cuadro de mensajes con propiedades de enrutamiento variables, tal y como ocurre con los mensajes publicados por ubicaciones de recepción.</span><span class="sxs-lookup"><span data-stu-id="809c7-130">Direct binding allows an orchestration to publish messages to the MessageBox database with varying routing properties much like messages are published by receive locations.</span></span> <span data-ttu-id="809c7-131">En la mensajería directa sencilla, el mensaje se publica en el cuadro de mensajes con sus propiedades promocionadas para el enrutamiento, como cualquier otro mensaje publicado que se recibe en BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="809c7-131">In simple direct messaging, the message is published to the MessageBox with its promoted properties to be routed like any other published message received into BizTalk Server.</span></span> <span data-ttu-id="809c7-132">Esto permite a los suscriptores recibir este mensaje, pero, al mismo tiempo, requiere que exista al menos un suscriptor, pues en caso contrario la orquestación recibirá un error en el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="809c7-132">This enables any subscriber to receive this message, but requires that at least one subscriber exist or the orchestration will receive a routing failure error.</span></span>  
  
 <span data-ttu-id="809c7-133">Otra opción para el enlace directo consiste en utilizar puertos que se autocorrelacionan.</span><span class="sxs-lookup"><span data-stu-id="809c7-133">Another option for direct binding is to use self-correlating ports.</span></span> <span data-ttu-id="809c7-134">Los puertos que se autocorrelacionan son puertos que crean un token de correlación único para utilizarlo en la correlación de mensajes entre instancias.</span><span class="sxs-lookup"><span data-stu-id="809c7-134">Self-correlating ports are ports that create a unique correlation token and use that token alone in correlating messages between instances.</span></span> <span data-ttu-id="809c7-135">El empleo más habitual de los puertos que se autocorrelacionan consiste en la llamada o el inicio de una orquestación adecuada para un parámetro de puerto.</span><span class="sxs-lookup"><span data-stu-id="809c7-135">The most common use of a self-correlating port is to call or start an orchestration passing in a port parameter.</span></span> <span data-ttu-id="809c7-136">En la orquestación llamada, puede utilizarse el puerto para enviar un mensaje, mientras que en la orquestación que realiza la llamada el mismo puerto puede emplearse para recibirlo.</span><span class="sxs-lookup"><span data-stu-id="809c7-136">In the called orchestration, the port can be used to send a message, while in the calling orchestration the same port can be used to receive a message.</span></span> <span data-ttu-id="809c7-137">Dado que el puerto posee un token de correlación único, el mensaje se enruta de vuelta a la orquestación de llamada.</span><span class="sxs-lookup"><span data-stu-id="809c7-137">Because the port has a unique correlation token, the message is routed back to the calling orchestration.</span></span> <span data-ttu-id="809c7-138">Los puertos que se autocorrelacionan actúan como canales privados de comunicación entre las instancias de orquestación.</span><span class="sxs-lookup"><span data-stu-id="809c7-138">Self-correlation ports act as private communication channels between orchestration instances.</span></span>  
  
 <span data-ttu-id="809c7-139">La última opción consiste en utilizar una orquestación de socio comercial, en la que en ambas orquestaciones el puerto esté configurado con el mismo tipo de puerto compartido y esté seleccionado el mismo puerto en la configuración del puerto.</span><span class="sxs-lookup"><span data-stu-id="809c7-139">The final option is to use a partner orchestration in which, in both the calling orchestration and the called orchestration, the port is configured using the same shared port type and in the port configuration, the same port is selected.</span></span> <span data-ttu-id="809c7-140">Por ejemplo, en Orch1 y en Orch2 se selecciona Orch2.MyDirectPort.</span><span class="sxs-lookup"><span data-stu-id="809c7-140">For example, in both Orch1 and Orch2, Orch2.MyDirectPort is selected.</span></span> <span data-ttu-id="809c7-141">Este tipo de enlace configura una suscripción para la orquestación de recepción, en función del tipo de orquestación de envío, el nombre de puerto y el nombre de operación.</span><span class="sxs-lookup"><span data-stu-id="809c7-141">This type of binding sets up a subscription for the receiving orchestration based on the sending orchestration type, the port name, and the operation name.</span></span> <span data-ttu-id="809c7-142">De nuevo, esto garantiza que los mensajes se enruten a la instancia correcta.</span><span class="sxs-lookup"><span data-stu-id="809c7-142">This again ensures that the messages get routed to the correct instance.</span></span>  
  
 <span data-ttu-id="809c7-143">Todas las opciones de mensajería directa utilizan la publicación subyacente y el modelo de suscripción.</span><span class="sxs-lookup"><span data-stu-id="809c7-143">All of the direct messaging options use the underlying publish and subscribe model.</span></span> <span data-ttu-id="809c7-144">La diferencia entre ellas radica en las propiedades que se utilizan en la creación de suscripciones y en el enrutamiento, así como en los casos de uso que ayuden a resolver.</span><span class="sxs-lookup"><span data-stu-id="809c7-144">The difference between these options is in the properties that are used for creating subscriptions and routing, and in the use cases they help solve.</span></span>  
  
 <span data-ttu-id="809c7-145">Un problema habitual del empleo de puertos de enlace directo se produce cuando la orquestación publica un mensaje al que también está suscrita.</span><span class="sxs-lookup"><span data-stu-id="809c7-145">One common problem encountered when using direct bound ports in orchestrations is that an orchestration may publish a message that it is also subscribed to.</span></span> <span data-ttu-id="809c7-146">Por ejemplo, una orquestación se configura para que se active con un mensaje PurchaseOrder.</span><span class="sxs-lookup"><span data-stu-id="809c7-146">For example, an orchestration is configured to be activated by a PurchaseOrder message.</span></span> <span data-ttu-id="809c7-147">Esta orquestación utiliza un puerto directo para publicar el mensaje PurchaseOrder en el cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-147">This orchestration uses a direct port to publish the PurchaseOrder message to the MessageBox.</span></span> <span data-ttu-id="809c7-148">No obstante, además de recibir el mensaje como se esperaba, se inicia otra instancia de una orquestación, dado que también poseía una suscripción para mensajes PurchaseOrder.</span><span class="sxs-lookup"><span data-stu-id="809c7-148">However, in addition to receiving the message as expected, another instance of an orchestration is started because it too had a subscription for PurchaseOrder messages.</span></span> <span data-ttu-id="809c7-149">El procesamiento entra en un bucle infinito y el programador puede tardar cierto tiempo en averiguar lo que ocurre.</span><span class="sxs-lookup"><span data-stu-id="809c7-149">The processing gets into an endless loop and it may take some time for a developer to figure out what has happened.</span></span>  
  
## <a name="correlation"></a><span data-ttu-id="809c7-150">Correlation</span><span class="sxs-lookup"><span data-stu-id="809c7-150">Correlation</span></span>  
 <span data-ttu-id="809c7-151">*Correlación* en las orquestaciones es el mecanismo para recibir mensajes relacionados en la misma instancia de orquestación de ejecución.</span><span class="sxs-lookup"><span data-stu-id="809c7-151">*Correlation* in orchestrations is the mechanism for receiving related messages into the same running orchestration instance.</span></span> <span data-ttu-id="809c7-152">En el Diseñador de orquestaciones, un programador sigue estos pasos generales para utilizar una correlación:</span><span class="sxs-lookup"><span data-stu-id="809c7-152">In the Orchestration Designer a developer follows these general steps to use a correlation:</span></span>  
  
- <span data-ttu-id="809c7-153">Define un tipo de correlación que incluye las propiedades promocionadas utilizadas para relacionar mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-153">Defines a correlation type that includes the promoted properties that are used to relate messages.</span></span>  
  
- <span data-ttu-id="809c7-154">Define un conjunto de correlaciones que representa una instancia del tipo de correlación que se acaba de definir.</span><span class="sxs-lookup"><span data-stu-id="809c7-154">Defines a correlation set that is an instance of the correlation type just defined.</span></span>  
  
- <span data-ttu-id="809c7-155">En los puertos de envío y recepción, especifica si inician o siguen un conjunto de correlaciones determinado.</span><span class="sxs-lookup"><span data-stu-id="809c7-155">For the send and receive ports, specifies whether they initiate or follow a given correlation set.</span></span>  
  
  <span data-ttu-id="809c7-156">Las suscripciones de instancia entran en juego cuando se inicia un conjunto de correlaciones, pues esto ocurre cuando se crean suscripciones para todos los puertos que siguen este conjunto de correlaciones para recibir mensajes.</span><span class="sxs-lookup"><span data-stu-id="809c7-156">Instance subscriptions come into play when a correlation set is initiated, as this is when subscriptions are created for all of those ports that follow this correlation set to receive messages.</span></span> <span data-ttu-id="809c7-157">Puesto que el tipo de correlación define las propiedades que se van a utilizar en la correlación, el motor de orquestaciones puede extraer estas propiedades del mensaje que la acción de iniciación está enviando o recibiendo.</span><span class="sxs-lookup"><span data-stu-id="809c7-157">Because the correlation type defines the properties to be used for correlation, the orchestration engine can extract these properties from the message being sent or received by the initiating action.</span></span> <span data-ttu-id="809c7-158">Estos valores se utilizan para definir suscripciones para el resto de las acciones restantes que siguen este conjunto de correlaciones.</span><span class="sxs-lookup"><span data-stu-id="809c7-158">These values are then used to define subscriptions for all of the remaining actions which follow this correlation set.</span></span>  
  
  <span data-ttu-id="809c7-159">Es importante que los mensajes que se reciben en BizTalk Server y que pretenden utilizarse en una correlación tengan las propiedades promocionadas correctamente definidas y promocionadas en el contexto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="809c7-159">It is important that messages received into BizTalk Server and intended for use in a correlation have their promoted properties correctly defined and promoted to the message context.</span></span> <span data-ttu-id="809c7-160">La mayoría de las propiedades se promocionan cuando un componente de desensamblador de una canalización extrae los valores al recibirse el mensaje en un primer momento.</span><span class="sxs-lookup"><span data-stu-id="809c7-160">Most properties get promoted when a disassembler component in a pipeline extracts the values when the message is initially received.</span></span> <span data-ttu-id="809c7-161">Por esta razón no existe posibilidad alguna de utilizar la canalización de recepción PassThrough para recibir mensajes que deben correlacionarse con una instancia de orquestación en ejecución.</span><span class="sxs-lookup"><span data-stu-id="809c7-161">For this reason, it is not possible to use the PassThrough receive pipeline to receive messages that must be correlated to a running instance of an orchestration.</span></span> <span data-ttu-id="809c7-162">Este problema surge cuando se utiliza el adaptador de recepción SOAP para recibir mensajes correlacionados, puesto que la canalización PassThrough es el valor predeterminado para la canalización de recepción al utilizar el Asistente para publicación de servicios Web.</span><span class="sxs-lookup"><span data-stu-id="809c7-162">This issue arises when you use the SOAP receive adapter to receive correlated messages, because the PassThrough pipeline is the default value for the receive pipeline when using the Web Services Publishing Wizard.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="809c7-163">Vea también</span><span class="sxs-lookup"><span data-stu-id="809c7-163">See Also</span></span>  
 <span data-ttu-id="809c7-164">[Artefactos](../core/artifacts.md) </span><span class="sxs-lookup"><span data-stu-id="809c7-164">[Artifacts](../core/artifacts.md) </span></span>  
 [<span data-ttu-id="809c7-165">Creación de orquestaciones mediante el Diseñador de orquestaciones</span><span class="sxs-lookup"><span data-stu-id="809c7-165">Creating Orchestrations Using Orchestration Designer</span></span>](../core/creating-orchestrations-using-orchestration-designer.md)