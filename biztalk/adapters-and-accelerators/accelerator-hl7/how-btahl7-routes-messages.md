---
title: "Cómo enruta los mensajes BTAHL7 | Documentos de Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- routing, about routing
- routing, messages
- messages, routing
- BTAHL7, message routing
ms.assetid: 555696c7-6023-44eb-b13d-cf7527bbc92f
caps.latest.revision: "7"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 61dd223a014ae8ea7de35d8d73f1a7cf7ef35449
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/20/2017
---
# <a name="how-btahl7-routes-messages"></a><span data-ttu-id="3df61-102">¿Cómo BTAHL7 enruta los mensajes</span><span class="sxs-lookup"><span data-stu-id="3df61-102">How BTAHL7 Routes Messages</span></span>
[!INCLUDE[btsCoName](../../includes/btsconame-md.md)]<span data-ttu-id="3df61-103">Acelerador de BizTalk para HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) aprovecha el capacidades de procesamiento de mensajes [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], pero también se extiende en varias formas que son específicas de los requisitos de mensajería de HL7.</span><span class="sxs-lookup"><span data-stu-id="3df61-103"> BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) leverages the message processing capabilities of [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], but also extends it in several ways that are specific to HL7 messaging requirements.</span></span>  

## <a name="routing-overview"></a><span data-ttu-id="3df61-104">Introducción al enrutamiento</span><span class="sxs-lookup"><span data-stu-id="3df61-104">Routing overview</span></span>

<span data-ttu-id="3df61-105">HL7 recibe mensajes desde un sistema de línea de negocio (LOB) y puede recibirlos mediante el adaptador MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-105">HL7 receives messages from a Line of Business (LOB) system, and may receive them using the MLLP adapter.</span></span> <span data-ttu-id="3df61-106">El sistema de LOB se conecta al adaptador MLLP en [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] a través de un puerto TCP y, a continuación, envía los mensajes para el adaptador MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-106">The LOB system connects to MLLP adapter on [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] over a TCP port, and then sends messages to the MLLP adapter.</span></span>

<span data-ttu-id="3df61-107">En  **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] y versiones anteriores**, la MLLP HL7 recepción esperas de adaptador de transporte para el sistema LOB remoto para conectarse a MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-107">In **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] and older versions**, the HL7 MLLP receive transport adapter waits for the remote LOB system to connect to MLLP.</span></span> <span data-ttu-id="3df61-108">Una vez que se conecta el sistema LOB remoto, el sistema de LOB envía los mensajes con MLLP a la [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df61-108">Once the remote LOB system connects, the LOB system sends the messages using MLLP to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="3df61-109">Concretamente:</span><span class="sxs-lookup"><span data-stu-id="3df61-109">Specifically:</span></span> 

1. <span data-ttu-id="3df61-110">El sistema LOB remoto se conecta al adaptador MLLP en la variable local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] con un puerto TCP</span><span class="sxs-lookup"><span data-stu-id="3df61-110">The remote LOB system connects to the MLLP adapter on the local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] using a TCP port</span></span> 
2. <span data-ttu-id="3df61-111">La BTA4HL7 ubicación de recepción con adaptador MLLP acepta la conexión</span><span class="sxs-lookup"><span data-stu-id="3df61-111">The BTA4HL7 receive location with MLLP Adapter accepts the connection</span></span> 
3. <span data-ttu-id="3df61-112">El sistema LOB remoto envía mensajes de uno o más</span><span class="sxs-lookup"><span data-stu-id="3df61-112">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="3df61-113">El sistema LOB remoto se desconecta</span><span class="sxs-lookup"><span data-stu-id="3df61-113">The remote LOB system disconnects</span></span>

<span data-ttu-id="3df61-114">En  **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] y versiones más recientes**, se inicia la conexión al sistema de LOB por el adaptador MLLP y, a continuación, reciban los mensajes de inserciones de sistema LOB para la MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-114">In **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] and newer versions**, the connection to the LOB system is initiated by the MLLP adapter, and then the LOB system pushes messages to the MLLP receive.</span></span> <span data-ttu-id="3df61-115">En otras palabras, espera a que el sistema LOB remoto para la conexión antes de enviar messagings MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-115">In other words, the remote LOB system waits for the connection before sending messagings to MLLP.</span></span> <span data-ttu-id="3df61-116">Concretamente:</span><span class="sxs-lookup"><span data-stu-id="3df61-116">Specifically:</span></span> 

1. <span data-ttu-id="3df61-117">La variable local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] se conecta al sistema LOB remoto utilizando un puerto TCP</span><span class="sxs-lookup"><span data-stu-id="3df61-117">The local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] connects to the remote LOB system using a TCP port</span></span> 
2. <span data-ttu-id="3df61-118">La BTA4HL7 ubicación de recepción con MLLP adaptador inicia la conexión</span><span class="sxs-lookup"><span data-stu-id="3df61-118">The BTA4HL7 receive location with MLLP adapter initiates the connection</span></span> 
3. <span data-ttu-id="3df61-119">El sistema LOB remoto envía mensajes de uno o más</span><span class="sxs-lookup"><span data-stu-id="3df61-119">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="3df61-120">El sistema LOB remoto se desconecta</span><span class="sxs-lookup"><span data-stu-id="3df61-120">The remote LOB system disconnects</span></span> 

<span data-ttu-id="3df61-121">Para mantener la compatibilidad, puede usar el comportamiento predeterminado original en el sistema LOB remoto inicia las conexiones.</span><span class="sxs-lookup"><span data-stu-id="3df61-121">For backwards-compatibility, you can use the original default behavior where the remote LOB system initiates the connections.</span></span> <span data-ttu-id="3df61-122">Esta opción es configurable en el MLLP propiedades de la ubicación de recepción.</span><span class="sxs-lookup"><span data-stu-id="3df61-122">This option is configurable in the MLLP receive location properties.</span></span> 
 
<span data-ttu-id="3df61-123">Una vez que se recibe el mensaje HL7, a continuación, se envía a un HL7 canalización de recepción.</span><span class="sxs-lookup"><span data-stu-id="3df61-123">Once the HL7 message is received, it is then submitted to an HL7 receive pipeline.</span></span> <span data-ttu-id="3df61-124">En esta canalización, el Desensamblador HL7 analizará el mensaje y validará el mensaje según la configuración de definición y validación de esquema adecuado.</span><span class="sxs-lookup"><span data-stu-id="3df61-124">Within this pipeline, the HL7 disassembler will parse the message, and will validate the message according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="3df61-125">En este momento, se genera un mensaje de confirmación puede ser de HL7 (éxito o error), según la validez del mensaje y la configuración de confirmación pertinentes.</span><span class="sxs-lookup"><span data-stu-id="3df61-125">At this point, an HL7 acknowledgment message may be generated (success or error), according to the validity of the message and the relevant acknowledgment configuration.</span></span> <span data-ttu-id="3df61-126">Desde aquí, enviará a la canalización de la instancia de mensaje y la confirmación opcional para la base de datos de cuadro de mensajes para el procesamiento adicional y enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="3df61-126">From here, the pipeline will submit the message instance and optional acknowledgment to the MessageBox database for further processing and routing.</span></span>  
  
 <span data-ttu-id="3df61-127">Una vez que una instancia de mensaje llega en la base de datos de cuadro de mensajes, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] comprueba suscripciones basadas en filtro y enruta el mensaje a uno o varios puertos de envío (posiblemente puertos MLLP) a través de una canalización de envío HL7.</span><span class="sxs-lookup"><span data-stu-id="3df61-127">Once a message instance arrives in the MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] checks filter-based subscriptions and routes the message to one or more send ports (possibly MLLP ports) through an HL7 send pipeline.</span></span> <span data-ttu-id="3df61-128">La canalización de envío puede validar las instancias de mensaje según la configuración de definición y validación de esquema adecuado.</span><span class="sxs-lookup"><span data-stu-id="3df61-128">The send pipeline may validate the message instances according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="3df61-129">Además de la validación, es posible invalidar ciertos valores de campo en el segmento de MSH del mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="3df61-129">In addition to validation, it is possible to override certain field values in the MSH segment of the outgoing message.</span></span> <span data-ttu-id="3df61-130">Esta capacidad de invalidación es especialmente útil si varios puertos han suscrito a un mensaje y cada aplicación receptora tiene expectativas únicas dentro de los valores de segmento de MSH.</span><span class="sxs-lookup"><span data-stu-id="3df61-130">This override ability is especially useful if multiple ports have subscribed to a message and each receiving application has unique expectations within the MSH segment values.</span></span>  
  
 <span data-ttu-id="3df61-131">Por supuesto, todas las demás [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] enviar y recibir puerto funcionalidades estarán disponibles para los mensajes HL7, junto con algunas funcionalidades que pueden ser exclusivos para el tipo de puerto seleccionado, como los parámetros de puerto de envío MLLP.</span><span class="sxs-lookup"><span data-stu-id="3df61-131">Of course, all of the other [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] send and receive port capabilities will be available to HL7 messages, along with some capabilities that may be unique to the selected port type, such as MLLP send-port parameters.</span></span> <span data-ttu-id="3df61-132">Un ejemplo de lo relevante [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capacidades sería la capacidad de aplicar una asignación de transformación a un mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="3df61-132">An example of the relevant [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capabilities would be the ability to apply a transformation map to an outbound message.</span></span>  
  
## <a name="how-routing-works"></a><span data-ttu-id="3df61-133">Cómo funciona el enrutamiento</span><span class="sxs-lookup"><span data-stu-id="3df61-133">How Routing Works</span></span>

<span data-ttu-id="3df61-134">El [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] rutas HL7 mensaje instancias según las suscripciones que administra la base de datos de cuadro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="3df61-134">The [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] routes HL7 message instances according to subscriptions that the MessageBox database manages.</span></span> <span data-ttu-id="3df61-135">Estas suscripciones utilizar filtros que definen para cada puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="3df61-135">These subscriptions use filters that you define for each send port.</span></span> <span data-ttu-id="3df61-136">Filtros de ejemplo podrían incluir enrutamiento basado en tipo de mensaje de Id. o HL7 de puerto de recepción (ADT ^ A03, por ejemplo) y/o el envío de la aplicación (valor MSH3.1).</span><span class="sxs-lookup"><span data-stu-id="3df61-136">Example filters might include routing based on receive port ID and/or HL7 message type (ADT^A03, for example) and/or sending application (MSH3.1 value).</span></span>  
  
 <span data-ttu-id="3df61-137">Además de configurar [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] suscripciones, debe configurar algunas opciones específicas de HL7 mensajería que afectarán a instancias de mensajes HL7 como [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] enruta.</span><span class="sxs-lookup"><span data-stu-id="3df61-137">In addition to setting up [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] subscriptions, you need to perform some HL7-specific messaging configuration that will affect HL7 message instances as [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes them.</span></span> <span data-ttu-id="3df61-138">Esta configuración adicional permite aplicar reglas de validación de HL7 únicas, la generación automática de las confirmaciones y la capacidad de invalidar valores de MSH.</span><span class="sxs-lookup"><span data-stu-id="3df61-138">This additional configuration enables you to apply unique HL7 validation rules, automatic generation of acknowledgments, and the ability to override MSH values.</span></span> [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]<span data-ttu-id="3df61-139">se aplica esta configuración en el nivel de entidad.</span><span class="sxs-lookup"><span data-stu-id="3df61-139"> applies this configuration at the party level.</span></span> <span data-ttu-id="3df61-140">Debe definir las partes en el Explorador de BizTalk y realizar la configuración de HL7 relacionada dentro de [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] el Explorador de configuración.</span><span class="sxs-lookup"><span data-stu-id="3df61-140">You need to define parties within BizTalk Explorer and perform the related HL7 configuration within [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Configuration Explorer.</span></span>  
  
 <span data-ttu-id="3df61-141">Para aplicar la única configuración de mensajería de HL7 (por ejemplo, validación o las invalidaciones de MSH) a varios puertos de envío que se suscriben a un mensaje, debe crear asociaciones entre entidades y puertos de envío.</span><span class="sxs-lookup"><span data-stu-id="3df61-141">To apply unique HL7 messaging configuration (for example, validation or MSH overrides) to multiple send ports that subscribe to a message, you need to create associations between parties and send ports.</span></span> <span data-ttu-id="3df61-142">Configurar las asociaciones de puerto de envío de entidad como propiedades de la entidad en el Explorador de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="3df61-142">You configure party-to-send port associations as party properties within BizTalk Explorer.</span></span>  
  
 <span data-ttu-id="3df61-143">Si no se necesita para HL7 de enrutar mensajes a varios puertos de envío o aplicar la configuración de procesamiento de HL7 único a varios puertos de envío, puede eliminar el paso de asociar usuarios a los puertos de envío.</span><span class="sxs-lookup"><span data-stu-id="3df61-143">If you do not need to route HL7 messages to multiple send ports, or apply unique HL7 processing configuration to multiple send ports, you can eliminate the step of associating parties with send ports.</span></span> <span data-ttu-id="3df61-144">En este caso, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] asocia la entidad con su configuración de mensajería HL7 a través del campo de aplicación receptora del mensaje HL7 (MSH 3.1).</span><span class="sxs-lookup"><span data-stu-id="3df61-144">In this case, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associates the party with its HL7 messaging configuration through the receiving application field in the HL7 message (MSH 3.1).</span></span> <span data-ttu-id="3df61-145">Esta situación es más probable que se produzca en un interrogative HL7 (solicitud-respuesta) intercambio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="3df61-145">This situation is most likely to occur in an HL7 interrogative (request/response) message exchange.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3df61-146">Vea también</span><span class="sxs-lookup"><span data-stu-id="3df61-146">See Also</span></span>  
 [<span data-ttu-id="3df61-147">Validación del mensaje</span><span class="sxs-lookup"><span data-stu-id="3df61-147">Message Validation</span></span>](../../adapters-and-accelerators/accelerator-hl7/message-validation.md)