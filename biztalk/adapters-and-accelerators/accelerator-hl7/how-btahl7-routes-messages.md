---
title: Cómo los mensajes en Btahl7 | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- routing, about routing
- routing, messages
- messages, routing
- BTAHL7, message routing
ms.assetid: 555696c7-6023-44eb-b13d-cf7527bbc92f
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7c64cd0620dacf835d3765510ea74c2a8cc80c4a
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36999293"
---
# <a name="how-btahl7-routes-messages"></a><span data-ttu-id="fa08a-102">Cómo los mensajes en Btahl7</span><span class="sxs-lookup"><span data-stu-id="fa08a-102">How BTAHL7 Routes Messages</span></span>
<span data-ttu-id="fa08a-103">Acelerador de Microsoft BizTalk para HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) aprovecha las capacidades de Microsoft de procesamiento de mensajes [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], pero también se extiende en varias formas que son específicas de los requisitos de mensajería de HL7.</span><span class="sxs-lookup"><span data-stu-id="fa08a-103">Microsoft BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) leverages the message processing capabilities of Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], but also extends it in several ways that are specific to HL7 messaging requirements.</span></span>  

## <a name="routing-overview"></a><span data-ttu-id="fa08a-104">Introducción al enrutamiento</span><span class="sxs-lookup"><span data-stu-id="fa08a-104">Routing overview</span></span>

<span data-ttu-id="fa08a-105">HL7 recibe mensajes desde un sistema de línea de negocio (LOB) y puede recibirlos mediante el adaptador de MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-105">HL7 receives messages from a Line of Business (LOB) system, and may receive them using the MLLP adapter.</span></span> <span data-ttu-id="fa08a-106">El sistema de LOB se conecta al adaptador MLLP en [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] a través de un puerto TCP y, a continuación, envía mensajes al adaptador de MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-106">The LOB system connects to MLLP adapter on [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] over a TCP port, and then sends messages to the MLLP adapter.</span></span>

<span data-ttu-id="fa08a-107">En  **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] y versiones anteriores**, el HL7 MLLP recibir esperas del adaptador de transporte para el sistema LOB remoto para conectarse a MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-107">In **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] and older versions**, the HL7 MLLP receive transport adapter waits for the remote LOB system to connect to MLLP.</span></span> <span data-ttu-id="fa08a-108">Una vez que se conecta el sistema LOB remoto, el sistema de LOB envía los mensajes mediante MLLP a la [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fa08a-108">Once the remote LOB system connects, the LOB system sends the messages using MLLP to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="fa08a-109">Concretamente:</span><span class="sxs-lookup"><span data-stu-id="fa08a-109">Specifically:</span></span> 

1. <span data-ttu-id="fa08a-110">El sistema LOB remoto se conecta al adaptador de MLLP local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] con un puerto TCP</span><span class="sxs-lookup"><span data-stu-id="fa08a-110">The remote LOB system connects to the MLLP adapter on the local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] using a TCP port</span></span> 
2. <span data-ttu-id="fa08a-111">El BTA4HL7 ubicación de recepción con el adaptador de MLLP acepta la conexión</span><span class="sxs-lookup"><span data-stu-id="fa08a-111">The BTA4HL7 receive location with MLLP Adapter accepts the connection</span></span> 
3. <span data-ttu-id="fa08a-112">El sistema LOB remoto proporciona uno o más mensajes</span><span class="sxs-lookup"><span data-stu-id="fa08a-112">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="fa08a-113">Desconecta el sistema LOB remoto</span><span class="sxs-lookup"><span data-stu-id="fa08a-113">The remote LOB system disconnects</span></span>

<span data-ttu-id="fa08a-114">En  **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] y las versiones más recientes**, se inicia la conexión al sistema de LOB mediante el adaptador de MLLP y, a continuación, reciben los mensajes de inserciones del sistema LOB para el MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-114">In **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] and newer versions**, the connection to the LOB system is initiated by the MLLP adapter, and then the LOB system pushes messages to the MLLP receive.</span></span> <span data-ttu-id="fa08a-115">En otras palabras, el sistema LOB remoto espera para la conexión antes de enviar messagings MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-115">In other words, the remote LOB system waits for the connection before sending messagings to MLLP.</span></span> <span data-ttu-id="fa08a-116">Concretamente:</span><span class="sxs-lookup"><span data-stu-id="fa08a-116">Specifically:</span></span> 

1. <span data-ttu-id="fa08a-117">Local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] se conecta al sistema de LOB remoto usa un puerto TCP</span><span class="sxs-lookup"><span data-stu-id="fa08a-117">The local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] connects to the remote LOB system using a TCP port</span></span> 
2. <span data-ttu-id="fa08a-118">El BTA4HL7 ubicación de recepción con MLLP adaptador inicia la conexión</span><span class="sxs-lookup"><span data-stu-id="fa08a-118">The BTA4HL7 receive location with MLLP adapter initiates the connection</span></span> 
3. <span data-ttu-id="fa08a-119">El sistema LOB remoto proporciona uno o más mensajes</span><span class="sxs-lookup"><span data-stu-id="fa08a-119">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="fa08a-120">Desconecta el sistema LOB remoto</span><span class="sxs-lookup"><span data-stu-id="fa08a-120">The remote LOB system disconnects</span></span> 

<span data-ttu-id="fa08a-121">Para mantener la compatibilidad, puede usar el comportamiento predeterminado original donde el sistema LOB remoto inicia las conexiones.</span><span class="sxs-lookup"><span data-stu-id="fa08a-121">For backwards-compatibility, you can use the original default behavior where the remote LOB system initiates the connections.</span></span> <span data-ttu-id="fa08a-122">Esta opción es configurable en lo MLLP propiedades de la ubicación de recepción.</span><span class="sxs-lookup"><span data-stu-id="fa08a-122">This option is configurable in the MLLP receive location properties.</span></span> 
 
<span data-ttu-id="fa08a-123">Una vez que se recibe el mensaje de HL7, a continuación, se envía a un HL7 canalización de recepción.</span><span class="sxs-lookup"><span data-stu-id="fa08a-123">Once the HL7 message is received, it is then submitted to an HL7 receive pipeline.</span></span> <span data-ttu-id="fa08a-124">Dentro de esta canalización, el Desensamblador HL7 analizará el mensaje y validará el mensaje según la configuración de definición y la validación de esquema adecuado.</span><span class="sxs-lookup"><span data-stu-id="fa08a-124">Within this pipeline, the HL7 disassembler will parse the message, and will validate the message according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="fa08a-125">En este momento, se genera un mensaje de confirmación puede ser de HL7 (éxito o error), según la validez del mensaje y la configuración de la confirmación pertinente.</span><span class="sxs-lookup"><span data-stu-id="fa08a-125">At this point, an HL7 acknowledgment message may be generated (success or error), according to the validity of the message and the relevant acknowledgment configuration.</span></span> <span data-ttu-id="fa08a-126">Desde aquí, la canalización enviará la instancia de mensaje y la confirmación opcional para la base de datos de cuadro de mensajes para el procesamiento adicional y enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="fa08a-126">From here, the pipeline will submit the message instance and optional acknowledgment to the MessageBox database for further processing and routing.</span></span>  
  
 <span data-ttu-id="fa08a-127">Una vez que llega a una instancia de mensaje de la base de datos de cuadro de mensajes, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] comprueba las suscripciones basadas en filtro y enruta el mensaje a uno o más puertos de envío (posiblemente puertos MLLP) a través de una canalización de envío de HL7.</span><span class="sxs-lookup"><span data-stu-id="fa08a-127">Once a message instance arrives in the MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] checks filter-based subscriptions and routes the message to one or more send ports (possibly MLLP ports) through an HL7 send pipeline.</span></span> <span data-ttu-id="fa08a-128">La canalización de envío puede validar las instancias de mensaje según la configuración de definición y la validación de esquema adecuado.</span><span class="sxs-lookup"><span data-stu-id="fa08a-128">The send pipeline may validate the message instances according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="fa08a-129">Además de la validación, es posible invalidar determinados valores de campo en el segmento de MSH del mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="fa08a-129">In addition to validation, it is possible to override certain field values in the MSH segment of the outgoing message.</span></span> <span data-ttu-id="fa08a-130">Esta capacidad de invalidación es especialmente útil si varios puertos han suscrito a un mensaje y cada aplicación receptora tiene expectativas únicas dentro de los valores de segmento de MSH.</span><span class="sxs-lookup"><span data-stu-id="fa08a-130">This override ability is especially useful if multiple ports have subscribed to a message and each receiving application has unique expectations within the MSH segment values.</span></span>  
  
 <span data-ttu-id="fa08a-131">Por supuesto, todas las demás [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] de envío y puerto de recepción capacidades estarán disponibles para los mensajes de HL7, junto con algunas funcionalidades que pueden ser únicos para el tipo de puerto seleccionado, como los parámetros de puerto de envío MLLP.</span><span class="sxs-lookup"><span data-stu-id="fa08a-131">Of course, all of the other [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] send and receive port capabilities will be available to HL7 messages, along with some capabilities that may be unique to the selected port type, such as MLLP send-port parameters.</span></span> <span data-ttu-id="fa08a-132">Un ejemplo de la correspondiente [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capacidades sería la capacidad de aplicar una asignación de transformación a un mensaje saliente.</span><span class="sxs-lookup"><span data-stu-id="fa08a-132">An example of the relevant [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capabilities would be the ability to apply a transformation map to an outbound message.</span></span>  
  
## <a name="how-routing-works"></a><span data-ttu-id="fa08a-133">Cómo funciona el enrutamiento</span><span class="sxs-lookup"><span data-stu-id="fa08a-133">How Routing Works</span></span>

<span data-ttu-id="fa08a-134">El [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] rutas HL7 instancias según las suscripciones que administra la base de datos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="fa08a-134">The [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] routes HL7 message instances according to subscriptions that the MessageBox database manages.</span></span> <span data-ttu-id="fa08a-135">Estas suscripciones utilizar filtros que defina para cada puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="fa08a-135">These subscriptions use filters that you define for each send port.</span></span> <span data-ttu-id="fa08a-136">Filtros de ejemplo podrían incluir el enrutamiento basado en el tipo de mensaje de identificador o HL7 puerto de recepción (ADT ^ A03, por ejemplo) o el envío de aplicación (valor MSH3.1).</span><span class="sxs-lookup"><span data-stu-id="fa08a-136">Example filters might include routing based on receive port ID and/or HL7 message type (ADT^A03, for example) and/or sending application (MSH3.1 value).</span></span>  
  
 <span data-ttu-id="fa08a-137">Además de configurar [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] suscripciones, deberá configurar algunas opciones de mensajería de HL7 específicas que afectan a las instancias de mensajes de HL7 como [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] enruta.</span><span class="sxs-lookup"><span data-stu-id="fa08a-137">In addition to setting up [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] subscriptions, you need to perform some HL7-specific messaging configuration that will affect HL7 message instances as [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes them.</span></span> <span data-ttu-id="fa08a-138">Esta configuración adicional le permite aplicar reglas de validación de HL7 únicas, la generación automática de las confirmaciones y la capacidad de invalidar los valores de MSH.</span><span class="sxs-lookup"><span data-stu-id="fa08a-138">This additional configuration enables you to apply unique HL7 validation rules, automatic generation of acknowledgments, and the ability to override MSH values.</span></span> [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]<span data-ttu-id="fa08a-139"> se aplica esta configuración en el nivel de entidad.</span><span class="sxs-lookup"><span data-stu-id="fa08a-139"> applies this configuration at the party level.</span></span> <span data-ttu-id="fa08a-140">Debe definir las partes en el Explorador de BizTalk y realizar la configuración de HL7 relacionada dentro de [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Explorador de configuración.</span><span class="sxs-lookup"><span data-stu-id="fa08a-140">You need to define parties within BizTalk Explorer and perform the related HL7 configuration within [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Configuration Explorer.</span></span>  
  
 <span data-ttu-id="fa08a-141">Para aplicar la única configuración de mensajería de HL7 (por ejemplo, validación o las invalidaciones de MSH) a varios puertos de envío que se suscriben a un mensaje, deberá crear asociaciones entre entidades y puertos de envío.</span><span class="sxs-lookup"><span data-stu-id="fa08a-141">To apply unique HL7 messaging configuration (for example, validation or MSH overrides) to multiple send ports that subscribe to a message, you need to create associations between parties and send ports.</span></span> <span data-ttu-id="fa08a-142">Configurar las asociaciones de puerto de envío de entidad como propiedades de entidad en el Explorador de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="fa08a-142">You configure party-to-send port associations as party properties within BizTalk Explorer.</span></span>  
  
 <span data-ttu-id="fa08a-143">Si no necesita HL7 de enrutar mensajes a varios puertos de envío, o aplicar la configuración de procesamiento de HL7 único a varios puertos de envío, puede eliminar el paso de asociar entidades a puertos de envío.</span><span class="sxs-lookup"><span data-stu-id="fa08a-143">If you do not need to route HL7 messages to multiple send ports, or apply unique HL7 processing configuration to multiple send ports, you can eliminate the step of associating parties with send ports.</span></span> <span data-ttu-id="fa08a-144">En este caso, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] asocia la entidad con su configuración de mensajería de HL7 a través del campo de aplicación receptora del mensaje de HL7 (MSH 3.1).</span><span class="sxs-lookup"><span data-stu-id="fa08a-144">In this case, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associates the party with its HL7 messaging configuration through the receiving application field in the HL7 message (MSH 3.1).</span></span> <span data-ttu-id="fa08a-145">Esta situación es más probable que se produzca en un interrogative HL7 (solicitud/respuesta) intercambio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="fa08a-145">This situation is most likely to occur in an HL7 interrogative (request/response) message exchange.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fa08a-146">Vea también</span><span class="sxs-lookup"><span data-stu-id="fa08a-146">See Also</span></span>  
 [<span data-ttu-id="fa08a-147">Validación de mensajes</span><span class="sxs-lookup"><span data-stu-id="fa08a-147">Message Validation</span></span>](../../adapters-and-accelerators/accelerator-hl7/message-validation.md)