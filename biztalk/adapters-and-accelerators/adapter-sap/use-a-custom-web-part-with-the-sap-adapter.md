---
title: Utilizar el elemento Web personalizado con el adaptador SAP | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3b7fecd2-a385-4b2d-a01b-3bfd65ecff3a
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8dce6bef0cecf847d10bee1897f417e63922659e
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "36980037"
---
# <a name="use-a-custom-web-part-with-the-sap-adapter"></a><span data-ttu-id="bcc2c-102">Utilizar el elemento Web personalizado con el adaptador SAP</span><span class="sxs-lookup"><span data-stu-id="bcc2c-102">Use a Custom Web Part with the SAP adapter</span></span>
<span data-ttu-id="bcc2c-103">Esta sección proporciona información sobre el uso de un elemento Web personalizado con Microsoft Office SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-103">This section provides information about using a custom Web Part with Microsoft Office SharePoint Server.</span></span> <span data-ttu-id="bcc2c-104">Para usar un elemento Web personalizado, debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-104">To use a custom Web Part, you must do the following:</span></span>  
  
1.  <span data-ttu-id="bcc2c-105">Crear un elemento Web personalizado</span><span class="sxs-lookup"><span data-stu-id="bcc2c-105">Create a custom Web Part</span></span>  
  
2.  <span data-ttu-id="bcc2c-106">Implementar el elemento Web personalizado en un portal de SharePoint</span><span class="sxs-lookup"><span data-stu-id="bcc2c-106">Deploy the custom Web Part to a SharePoint portal</span></span>  
  
3.  <span data-ttu-id="bcc2c-107">Configurar el portal de SharePoint para usar el elemento Web personalizado</span><span class="sxs-lookup"><span data-stu-id="bcc2c-107">Configure the SharePoint portal to use the custom Web Part</span></span>  
  
## <a name="before-you-begin"></a><span data-ttu-id="bcc2c-108">Antes de comenzar</span><span class="sxs-lookup"><span data-stu-id="bcc2c-108">Before You Begin</span></span>  
 <span data-ttu-id="bcc2c-109">Antes de crear un elemento Web personalizado:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-109">Before you create a custom Web Part:</span></span>  
  
-   <span data-ttu-id="bcc2c-110">Publicar los artefactos SAP como un servicio WCF.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-110">Publish the SAP artifacts as a  WCF service.</span></span> <span data-ttu-id="bcc2c-111">Para obtener más información, consulte [paso 1: publicar los artefactos SAP como un servicio WCF](../../adapters-and-accelerators/adapter-sap/step-1-publish-the-sap-artifacts-as-a-wcf-service.md) en [Tutorial 1: presentación de datos desde un sistema SAP en un sitio de SharePoint](../../adapters-and-accelerators/adapter-sap/tutorial-1-presenting-data-from-an-sap-system-on-a-sharepoint-site.md).</span><span class="sxs-lookup"><span data-stu-id="bcc2c-111">For more information, see [Step 1: Publish the SAP Artifacts as a WCF Service](../../adapters-and-accelerators/adapter-sap/step-1-publish-the-sap-artifacts-as-a-wcf-service.md) in [Tutorial 1: Presenting Data from an SAP System on a SharePoint Site](../../adapters-and-accelerators/adapter-sap/tutorial-1-presenting-data-from-an-sap-system-on-a-sharepoint-site.md).</span></span>  
  
-   <span data-ttu-id="bcc2c-112">Cree un archivo de definición de aplicación para los artefactos SAP mediante el catálogo de datos empresariales en Microsoft Office SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-112">Create an application definition file for the SAP artifacts using the Business Data Catalog in Microsoft Office SharePoint Server.</span></span> <span data-ttu-id="bcc2c-113">Para obtener más información, consulte [paso 2: crear un archivo de definición de aplicación para los artefactos de SAP](../../adapters-and-accelerators/adapter-sap/step-2-create-an-application-definition-file-for-the-sap-artifacts.md) en [Tutorial 1: presentación de datos desde un sistema SAP en un sitio de SharePoint](../../adapters-and-accelerators/adapter-sap/tutorial-1-presenting-data-from-an-sap-system-on-a-sharepoint-site.md).</span><span class="sxs-lookup"><span data-stu-id="bcc2c-113">For more information, see [Step 2: Create an Application Definition File for the SAP Artifacts](../../adapters-and-accelerators/adapter-sap/step-2-create-an-application-definition-file-for-the-sap-artifacts.md) in [Tutorial 1: Presenting Data from an SAP System on a SharePoint Site](../../adapters-and-accelerators/adapter-sap/tutorial-1-presenting-data-from-an-sap-system-on-a-sharepoint-site.md).</span></span>  
  
##  <a name="Create_a_Custom_Web_Part"></a> <span data-ttu-id="bcc2c-114">Paso 1: Crear un elemento Web personalizado</span><span class="sxs-lookup"><span data-stu-id="bcc2c-114">Step 1: Create a custom Web Part</span></span>  
 <span data-ttu-id="bcc2c-115">Para crear un elemento Web personalizado con Visual Studio, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-115">To create a custom Web Part using Visual Studio, do the following:</span></span>  
  
1.  <span data-ttu-id="bcc2c-116">Inicie Visual Studio y, a continuación, cree un proyecto.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-116">Start Visual Studio, and then create a project.</span></span>  
  
2.  <span data-ttu-id="bcc2c-117">En el **nuevo proyecto** cuadro de diálogo desde el **tipos de proyecto** panel, seleccione **Visual C#**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-117">In the **New Project** dialog box, from the **Project types** pane, select **Visual C#**.</span></span> <span data-ttu-id="bcc2c-118">Desde el **plantillas** panel, seleccione **biblioteca de clases**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-118">From the **Templates** pane, select **Class Library**.</span></span>  
  
3.  <span data-ttu-id="bcc2c-119">Especifique un nombre y ubicación de la solución.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-119">Specify a name and location for the solution.</span></span> <span data-ttu-id="bcc2c-120">Este tema, especifique `CustomWebPart` en el **nombre** y **nombre de la solución** cuadros.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-120">For this topic, specify `CustomWebPart` in the **Name** and **Solution Name** boxes.</span></span> <span data-ttu-id="bcc2c-121">Especifique una ubicación y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-121">Specify a location, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="bcc2c-122">Agregue una referencia al componente System.Web en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-122">Add a reference to the System.Web component into the project.</span></span> <span data-ttu-id="bcc2c-123">Haga clic en el nombre del proyecto en **el Explorador de soluciones**y, a continuación, haga clic en **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-123">Right-click the project name in **Solution Explorer**, and then click **Add Reference**.</span></span> <span data-ttu-id="bcc2c-124">En el **Agregar referencia** cuadro de diálogo, seleccione **System.Web** en el **.NET** pestaña y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-124">In the **Add Reference** dialog box, select **System.Web** in the **.NET** tab, and then click **OK**.</span></span> <span data-ttu-id="bcc2c-125">El componente de System.Web contiene el espacio de nombres necesario de System.Web.UI.WebControls.WebParts.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-125">The System.Web component contains the required namespace of System.Web.UI.WebControls.WebParts.</span></span>  
  
5.  <span data-ttu-id="bcc2c-126">Agregue el código necesario en función de su problema en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-126">Add the required code based on your issue in the project.</span></span> <span data-ttu-id="bcc2c-127">Para el ejemplo de código que es relevante para un determinado problema, vea "Problemas que implican elementos Web personalizados" en [consideraciones al usar el adaptador de SAP con SharePoint](../../adapters-and-accelerators/adapter-sap/considerations-when-using-the-sap-adapter-with-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="bcc2c-127">For the code sample that is relevant to a certain issue, see “Issues Involving Custom Web Parts” in [Considerations when using the SAP adapter with SharePoint](../../adapters-and-accelerators/adapter-sap/considerations-when-using-the-sap-adapter-with-sharepoint.md).</span></span>  
  
6.  <span data-ttu-id="bcc2c-128">Generar el proyecto.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-128">Build the project.</span></span> <span data-ttu-id="bcc2c-129">La compilación del proyecto es correcta, se generará un archivo .dll, CustomWebPart.dll, en el \<carpeta del proyecto \> /bin/Debug carpeta.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-129">On successful build of the project, a .dll file, CustomWebPart.dll, will be generated in the \<project folder\>/bin/Debug folder.</span></span>  
  
7.  <span data-ttu-id="bcc2c-130">**Solo para el equipo de 64 bits**: firmar el archivo de CustomWebPart.dll con un nombre seguro antes de realizar los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-130">**Only for 64-bit computer**: Sign the CustomWebPart.dll file with a strong name before performing the following steps.</span></span> <span data-ttu-id="bcc2c-131">En caso contrario, no podrá importar y, por lo tanto, use el CustomWebPart.dll en el portal de SharePoint en "paso 3: configurar el SharePoint Portal para usar el elemento Web personalizado."</span><span class="sxs-lookup"><span data-stu-id="bcc2c-131">Otherwise, you will not be able to import, and hence use the CustomWebPart.dll in the SharePoint portal in “Step 3: Configure the SharePoint Portal to use the custom Web Part.”</span></span> <span data-ttu-id="bcc2c-132">Consulte [Cómo: firmar un ensamblado con un nombre seguro](https://msdn.microsoft.com/library/xc31ft41.aspx).</span><span class="sxs-lookup"><span data-stu-id="bcc2c-132">See [How to: Sign an Assembly with a Strong Name](https://msdn.microsoft.com/library/xc31ft41.aspx).</span></span>
  
## <a name="step-2-deploy-the-custom-web-part-to-a-sharepoint-portal"></a><span data-ttu-id="bcc2c-133">Paso 2: Implementar el elemento Web personalizado en un Portal de SharePoint</span><span class="sxs-lookup"><span data-stu-id="bcc2c-133">Step 2: Deploy the custom Web Part to a SharePoint Portal</span></span>  
 <span data-ttu-id="bcc2c-134">Debe hacer lo siguiente para hacer que el archivo CustomWebPart.dll (elemento Web personalizado) que se crea en "paso 1: crear un elemento Web personalizado" de este tema puede usar en el portal de SharePoint:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-134">You must do the following to make the CustomWebPart.dll file (custom Web Part) that is created in “Step 1: Create a custom Web Part” of this topic usable on the SharePoint portal:</span></span>  
  
- <span data-ttu-id="bcc2c-135">**Copie el archivo CustomWebPart.dll en la carpeta bin de SharePoint Portal**: Microsoft Office SharePoint Server crea portales bajo el \<raíz unidad\>: \Inetpub\wwwroot\wss\VirtualDirectories carpeta.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-135">**Copy the CustomWebPart.dll file to the bin folder of the SharePoint Portal**: Microsoft Office SharePoint Server creates portals under the \<root drive\>:\Inetpub\wwwroot\wss\VirtualDirectories folder.</span></span> <span data-ttu-id="bcc2c-136">Una carpeta se crea para cada portal y puede identificarse con el número de puerto.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-136">A folder is created for each portal, and can be identified with the port number.</span></span> <span data-ttu-id="bcc2c-137">Debe copiar el archivo CustomWebPart.dll creado en "paso 1: crear un elemento Web personalizado" de este tema para el \<raíz unidad\>: \Inetpub\wwwroot\wss\VirtualDirectories\\< número_puerto\>carpeta \bin.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-137">You must copy the CustomWebPart.dll file created in “Step 1: Create a custom Web Part” of this topic to the \<root drive\>:\Inetpub\wwwroot\wss\VirtualDirectories\\<Port_Number\>\bin folder.</span></span> <span data-ttu-id="bcc2c-138">Por ejemplo, si el número de puerto de su portal de SharePoint es 13614, debe copiar el archivo CustomWebPart.dll a la \<raíz unidad\>: carpeta \Inetpub\wwwroot\wss\VirtualDirectories\13614\bin.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-138">For example, if the port number of your SharePoint portal is 13614, you must copy the CustomWebPart.dll file to the \<root drive\>:\Inetpub\wwwroot\wss\VirtualDirectories\13614\bin folder.</span></span>  
  
  > [!TIP]
  >  <span data-ttu-id="bcc2c-139">Es otra manera de encontrar la ubicación de carpeta de su portal de SharePoint mediante el **Internet Information Services (IIS) Manager** ventana (**iniciar** > **ejecutar**  >  **inetmgr**).</span><span class="sxs-lookup"><span data-stu-id="bcc2c-139">Another way to find the folder location of your SharePoint portal is by using the **Internet Information Services (IIS) Manager** window (**Start** > **Run** > **inetmgr**).</span></span> <span data-ttu-id="bcc2c-140">Busque su portal de SharePoint en el **Internet Information Services (IIS) Manager** ventana ([NombreDeEquipo] > sitios Web > [nombre-Portal]), con el botón secundario y, a continuación, haga clic en **propiedades** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-140">Locate your SharePoint portal in the **Internet Information Services (IIS) Manager** window ([computer_name] > Web Sites > [Portal-Name]), right-click, and then click **Properties** in the shortcut menu.</span></span> <span data-ttu-id="bcc2c-141">En el cuadro de diálogo Propiedades de SharePoint portal, haga clic en el **Home Directory** pestaña y, a continuación, seleccione el **ruta de acceso Local** cuadro.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-141">In the properties dialog box of the SharePoint portal, click the **Home Directory** tab, and then select the **Local path** box.</span></span>  
  
- <span data-ttu-id="bcc2c-142">**Agregue la entrada de Control seguro en el archivo web.config**: dado que el archivo CustomWebPart.dll se utilizará en equipos diferentes y por varios usuarios, debe declarar el archivo como "seguro".</span><span class="sxs-lookup"><span data-stu-id="bcc2c-142">**Add the Safe Control Entry in the web.config File**: Because the CustomWebPart.dll file will be used on different computers and by multiple users, you must declare the file as “safe.”</span></span> <span data-ttu-id="bcc2c-143">Para ello, abra el archivo web.config ubicado en la carpeta de SharePoint portal en \<raíz unidad\>: \Inetpub\wwwroot\wss\VirtualDirectories\\< número_puerto\>.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-143">To do so, open the web.config file located in the SharePoint portal folder at \<root drive\>:\Inetpub\wwwroot\wss\VirtualDirectories\\<Port_Number\>.</span></span> <span data-ttu-id="bcc2c-144">En la `<SafeControls>` sección del archivo web.config, agregue la siguiente entrada de control segura:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-144">Under the `<SafeControls>` section of the web.config file, add the following safe control entry:</span></span>  
  
  - <span data-ttu-id="bcc2c-145">**En el equipo de 32 bits:**</span><span class="sxs-lookup"><span data-stu-id="bcc2c-145">**On 32-bit computer:**</span></span>  
  
    ```  
    <SafeControl Assembly="CustomWebPart" Namespace="CustomWebPart" TypeName="*" Safe="True" />  
    ```  
  
  - <span data-ttu-id="bcc2c-146">**En el equipo de 64 bits:**</span><span class="sxs-lookup"><span data-stu-id="bcc2c-146">**On 64-bit computer:**</span></span>  
  
    ```  
    <SafeControl Assembly="CustomWebPart, Version=1.0.0.0, Culture=neutral, PublicKeyToken=<PUBLICKKEYTOKEN_OF_CustomWebPart.dll>" Namespace="CustomWebPart" TypeName="*" Safe="True" />  
    ```  
  
    <span data-ttu-id="bcc2c-147">Guarde el archivo web.config y, a continuación, ciérrelo.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-147">Save the web.config file, and then close it.</span></span>  
  
## <a name="step-3-configure-the-sharepoint-portal-to-use-the-custom-web-part"></a><span data-ttu-id="bcc2c-148">Paso 3: Configurar el portal de SharePoint para usar el elemento Web personalizado</span><span class="sxs-lookup"><span data-stu-id="bcc2c-148">Step 3: Configure the SharePoint portal to use the custom Web Part</span></span>  
 <span data-ttu-id="bcc2c-149">Deberá agregar el elemento Web personalizado para Microsoft Office SharePoint Server Web Part Gallery, por lo que se puede usar en el portal de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-149">You need to add the custom Web Part to the Microsoft Office SharePoint Server Web Part Gallery, so that you can use it on your SharePoint portal.</span></span> <span data-ttu-id="bcc2c-150">Para ello:</span><span class="sxs-lookup"><span data-stu-id="bcc2c-150">To do so:</span></span>  
  
1. <span data-ttu-id="bcc2c-151">Inicie Administración Central de SharePoint 3.0.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-151">Start SharePoint 3.0 Central Administration.</span></span> <span data-ttu-id="bcc2c-152">Haga clic en **iniciar**, apunte a **todos los programas**, apunte a **Microsoft Office Server**y, a continuación, haga clic en **SharePoint 3.0 Central Administration**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-152">Click **Start**, point to **All Programs**, point to **Microsoft Office Server**, and then click **SharePoint 3.0 Central Administration**.</span></span>  
  
2. <span data-ttu-id="bcc2c-153">En el panel de navegación izquierdo, haga clic en el nombre del servicio de proveedor compartidos (SSP) al que desea agregar el elemento Web personalizado.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-153">In the left navigation pane, click the name of the Shared Service Provider (SSP) to which you want to add the custom Web Part.</span></span>  
  
3. <span data-ttu-id="bcc2c-154">En la página de administración de servicios compartidos, en la esquina superior derecha, haga clic en **acciones del sitio**y, a continuación, haga clic en **crear**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-154">On the Shared Services Administration page, in the upper-right corner, click **Site Actions**, and then click **Create**.</span></span>  
  
4. <span data-ttu-id="bcc2c-155">En la página Configuración del sitio, haga clic en **elementos Web** bajo el **galerías** columna.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-155">On the Site Settings page, click **Web Parts** under the **Galleries** column.</span></span>  
  
5. <span data-ttu-id="bcc2c-156">En la página Galería de elementos Web, para agregar el elemento Web personalizado a la galería, haga clic en **New**.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-156">On the Web Part Gallery page, to add the custom Web Part to the gallery,  click **New**.</span></span> <span data-ttu-id="bcc2c-157">En este momento, el elemento Web personalizado no está disponible en la página Galería de elementos Web.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-157">At this point the custom Web Part is not available in the Web Part Gallery page.</span></span>  
  
6. <span data-ttu-id="bcc2c-158">En la página nuevos elementos Web, busque **CustomWebPart** (nombre del elemento Web personalizado) en la lista, seleccione la casilla situada a la izquierda y, a continuación, haga clic en **rellenar galería** en la parte superior de la página.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-158">On the New Web Parts page, locate **CustomWebPart** (name of the custom Web Part) in the list, select the check box on the left, and then click **Populate Gallery** on the top of the page.</span></span> <span data-ttu-id="bcc2c-159">Esto agregará la **CustomWebPart** entrada en la página Galería de elementos Web.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-159">This will add the **CustomWebPart** entry in the Web Part Gallery page.</span></span>  
  
   <span data-ttu-id="bcc2c-160">Ahora puede usar el elemento Web personalizado (**CustomWebPart**) para crear elementos Web en el portal de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-160">Now you can use the custom Web Part (**CustomWebPart**) to create Web Parts in your SharePoint portal.</span></span> <span data-ttu-id="bcc2c-161">El elemento Web personalizado (**CustomWebPart**) aparecerá bajo la **varios** sección en la página Agregar elementos Web.</span><span class="sxs-lookup"><span data-stu-id="bcc2c-161">The custom Web Part (**CustomWebPart**) will appear under the **Miscellaneous** section in the Add Web Parts page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bcc2c-162">Vea también</span><span class="sxs-lookup"><span data-stu-id="bcc2c-162">See Also</span></span>  
[<span data-ttu-id="bcc2c-163">Usar el adaptador de SAP con SharePoint</span><span class="sxs-lookup"><span data-stu-id="bcc2c-163">Use the SAP adapter with SharePoint</span></span>](../../adapters-and-accelerators/adapter-sap/use-the-sap-adapter-with-sharepoint.md)