---
title: Consideraciones para recibir las notificaciones de consulta mediante el adaptador de SQL | Documentos de Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 0142f385-3d55-41a7-a50e-dda94b96d0a4
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 02d7aa9eadc5e639e56cc526bfd5763abc432a4f
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2017
ms.locfileid: "25963010"
---
# <a name="considerations-for-receiving-query-notifications-using-the-sql-adapter"></a><span data-ttu-id="bfa19-102">Consideraciones para recibir las notificaciones de consulta mediante el adaptador de SQL</span><span class="sxs-lookup"><span data-stu-id="bfa19-102">Considerations for Receiving Query Notifications Using the SQL adapter</span></span>
<span data-ttu-id="bfa19-103">Este tema proporciona algunas consideraciones y recomendaciones para tener en cuenta al usar el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] para recibir las notificaciones de consulta de una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfa19-103">This topic provides some considerations and best practices to keep in mind while using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive query notifications from a SQL Server database.</span></span>  
  
## <a name="considerations-while-using-the-adapter-to-receive-notifications"></a><span data-ttu-id="bfa19-104">Consideraciones al usar el adaptador para recibir notificaciones</span><span class="sxs-lookup"><span data-stu-id="bfa19-104">Considerations While Using the Adapter to Receive Notifications</span></span>  
 <span data-ttu-id="bfa19-105">Debe tener en cuenta lo siguiente al usar el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] para recibir las notificaciones de consulta:</span><span class="sxs-lookup"><span data-stu-id="bfa19-105">You must consider the following while using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive query notifications:</span></span>  
  
-   <span data-ttu-id="bfa19-106">El [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] recibe la notificación de consulta de SQL Server y, a continuación, simplemente pasa la notificación a los clientes de adaptador.</span><span class="sxs-lookup"><span data-stu-id="bfa19-106">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] receives the query notification from SQL Server, and then simply passes on the notification to the adapter clients.</span></span> <span data-ttu-id="bfa19-107">El adaptador no distinguir entre las notificaciones para operaciones diferentes (es decir, el adaptador no tiene ninguna información si una notificación en particular es para una operación de inserción o una operación de actualización).</span><span class="sxs-lookup"><span data-stu-id="bfa19-107">The adapter does not distinguish between the notifications for different operations (i.e., the adapter does not have any information whether a particular notification is for an Insert operation or an Update operation).</span></span>  
  
-   <span data-ttu-id="bfa19-108">El mensaje de notificación para una operación no se ve afectado por el número de registros afectados por esa operación.</span><span class="sxs-lookup"><span data-stu-id="bfa19-108">The notification message for an operation is not affected by the number of records affected by that operation.</span></span> <span data-ttu-id="bfa19-109">Por ejemplo, independientemente del número de registros de insertarlos, actualizarlos o eliminarlos en una tabla de base de datos de SQL Server, el cliente de adaptador recibe un único mensaje de notificación.</span><span class="sxs-lookup"><span data-stu-id="bfa19-109">For example, regardless of the number of records inserted, updated, or deleted in a SQL Server database table, the adapter client receives only one notification message.</span></span>  
  
-   <span data-ttu-id="bfa19-110">Se recomienda que la aplicación de cliente de adaptador contienen la lógica para interpretar el tipo de notificación recibido de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfa19-110">We recommend that the adapter client application contain the logic to interpret the type of notification received from SQL Server.</span></span> <span data-ttu-id="bfa19-111">El tipo de notificación se puede determinar mediante la extracción de la información de la  **\<información\>**  elemento del mensaje se recibió una notificación.</span><span class="sxs-lookup"><span data-stu-id="bfa19-111">The notification type can be determined by extracting the information from, the **\<Info\>** element of the received notification message.</span></span> <span data-ttu-id="bfa19-112">Este es un ejemplo de un mensaje de notificación recibido para una operación de inserción:</span><span class="sxs-lookup"><span data-stu-id="bfa19-112">Here’s an example of a notification message received for an Insert operation:</span></span>  
  
    ```  
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Insert</Info>  
      <Source>Data</Source>  
      <Type>Change</Type>  
    </Notification>  
    ```  
  
     <span data-ttu-id="bfa19-113">Tenga en cuenta el valor dentro de la  **\<información\>**  elemento.</span><span class="sxs-lookup"><span data-stu-id="bfa19-113">Notice the value within the **\<Info\>** element.</span></span> <span data-ttu-id="bfa19-114">Este valor proporciona información sobre la operación para la que se recibió el mensaje de notificación.</span><span class="sxs-lookup"><span data-stu-id="bfa19-114">This value provides information on the operation for which the notification message was received.</span></span> <span data-ttu-id="bfa19-115">La aplicación debe tener la funcionalidad para extraer el valor dentro de la  **\<información\>**  elemento y, a continuación, en función del valor, realice las tareas posteriores.</span><span class="sxs-lookup"><span data-stu-id="bfa19-115">Your application should have the functionality to extract the value within the **\<Info\>** element and then based on the value, perform subsequent tasks.</span></span> <span data-ttu-id="bfa19-116">El tema [mensajes de notificación de proceso para completar tareas específicas en SQL con BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md) contiene instrucciones sobre cómo extraer el valor dentro de la  **\<información\>**  elemento .</span><span class="sxs-lookup"><span data-stu-id="bfa19-116">The topic [Process Notification Messages to complete Specific Tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md) has instructions on how to extract the value within the **\<Info\>** element.</span></span> <span data-ttu-id="bfa19-117">Obtener un tutorial detallado que realiza tareas similares también está disponible en [Tutorial 2: empleado: proceso de pedido de compra con el adaptador de SQL](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="bfa19-117">A detailed tutorial that performs similar tasks is also available at [Tutorial 2: Employee - Purchase Order Process using the SQL adapter](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span></span>  
  
-   <span data-ttu-id="bfa19-118">Lo ideal es que, una vez que la aplicación cliente recibe una notificación para un registro específico, dicho registro debe actualizarse para que no se reciben las notificaciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="bfa19-118">Ideally, after the client application receives a notification for a specific record, that record should be updated so that additional notifications are not received.</span></span> <span data-ttu-id="bfa19-119">Por ejemplo, considere un **empleado** tabla que tenga un **estado** columna.</span><span class="sxs-lookup"><span data-stu-id="bfa19-119">For example, consider an **Employee** table that has a **Status** column.</span></span> <span data-ttu-id="bfa19-120">Para todos los registros nuevos que se insertan en la **empleado** de tabla, el valor de la **estado** columna siempre es "0" para la tabla tendrá un aspecto como el siguiente:</span><span class="sxs-lookup"><span data-stu-id="bfa19-120">For all new records inserted into the **Employee** table, the value in the **Status** column is always “0” so the table will look like the following:</span></span>  
  
    |<span data-ttu-id="bfa19-121">Nombre de empleado</span><span class="sxs-lookup"><span data-stu-id="bfa19-121">Employee Name</span></span>|<span data-ttu-id="bfa19-122">Estado</span><span class="sxs-lookup"><span data-stu-id="bfa19-122">Status</span></span>|  
    |-------------------|------------|  
    |<span data-ttu-id="bfa19-123">John</span><span class="sxs-lookup"><span data-stu-id="bfa19-123">John</span></span>|<span data-ttu-id="bfa19-124">0</span><span class="sxs-lookup"><span data-stu-id="bfa19-124">0</span></span>|  
  
     <span data-ttu-id="bfa19-125">Para recibir notificaciones del registro recién insertado, el cliente de adaptador establecerá el **NotificatonStatement** enlaza la propiedad como:</span><span class="sxs-lookup"><span data-stu-id="bfa19-125">To receive notifications for the newly inserted record, the adapter client will set the **NotificatonStatement** binding property as:</span></span>  
  
    ```  
    SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0  
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="bfa19-126">En concreto, debe especificar los nombres de columna en la instrucción tal como se muestra en esta instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="bfa19-126">You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="bfa19-127">Además, siempre debe especificar el nombre de la tabla junto con el nombre del esquema.</span><span class="sxs-lookup"><span data-stu-id="bfa19-127">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="bfa19-128">Por ejemplo, dbo. Empleado.</span><span class="sxs-lookup"><span data-stu-id="bfa19-128">For example, dbo.Employee.</span></span>  
  
     <span data-ttu-id="bfa19-129">Después de recibir la notificación, la aplicación cliente debe restablecer el valor de la **estado** columna a "1" para que la instrucción de notificación no funcionar en el registro nuevo.</span><span class="sxs-lookup"><span data-stu-id="bfa19-129">After receiving the notification, the client application must reset the value of the **Status** column to “1” so that the notification statement does not operate on the record again.</span></span> <span data-ttu-id="bfa19-130">Para lograr esto, la aplicación cliente debe realizar una operación de actualización en el **empleado** tabla.</span><span class="sxs-lookup"><span data-stu-id="bfa19-130">To achieve this, the client application must perform an Update operation on the **Employee** table.</span></span> <span data-ttu-id="bfa19-131">Después de la operación de actualización, el mismo registro en el **empleado** tabla tendrá un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="bfa19-131">After the Update operation, the same record in the **Employee** table will look like the following:</span></span>  
  
    |<span data-ttu-id="bfa19-132">Nombre de empleado</span><span class="sxs-lookup"><span data-stu-id="bfa19-132">Employee Name</span></span>|<span data-ttu-id="bfa19-133">Estado</span><span class="sxs-lookup"><span data-stu-id="bfa19-133">Status</span></span>|  
    |-------------------|------------|  
    |<span data-ttu-id="bfa19-134">John</span><span class="sxs-lookup"><span data-stu-id="bfa19-134">John</span></span>|<span data-ttu-id="bfa19-135">1</span><span class="sxs-lookup"><span data-stu-id="bfa19-135">1</span></span>|  
  
     <span data-ttu-id="bfa19-136">Curiosamente, la operación de actualización nuevo enviará una notificación al cliente de adaptador y todo el proceso se repetirá nuevo, por lo tanto, la aplicación cliente debe tener la lógica necesaria para descartar estas notificaciones no deseadas.</span><span class="sxs-lookup"><span data-stu-id="bfa19-136">Interestingly, the Update operation will again send a notification to the adapter client and the whole process will be repeated again, therefore, the client application must have the required logic to discard such unwanted notifications.</span></span>  
  
-   <span data-ttu-id="bfa19-137">Si el **NotifyOnListenerStart** enlaza la propiedad es true, el cliente de adaptador recibirá un mensaje de notificación cada vez que inicia la ubicación de recepción.</span><span class="sxs-lookup"><span data-stu-id="bfa19-137">If the **NotifyOnListenerStart** binding property is true, the adapter client will receive a notification message every time the receive location starts.</span></span> <span data-ttu-id="bfa19-138">Para obtener más información acerca de cómo utilizar la propiedad de enlace e interpretar el mensaje de notificación, consulte [recibir notificaciones después de unos recibir ubicación interrupción de la consulta en SQL con BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-query-notifications-after-a-sql-receive-location-stops-in-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="bfa19-138">For more information on how to use the binding property and interpret the notification message, see [Receive Query Notifications After a Receive Location Breakdown in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-query-notifications-after-a-sql-receive-location-stops-in-biztalk.md).</span></span>  
  
## <a name="typical-orchestration-for-receiving-notifications"></a><span data-ttu-id="bfa19-139">Orquestación típico para recibir notificaciones</span><span class="sxs-lookup"><span data-stu-id="bfa19-139">Typical Orchestration for Receiving Notifications</span></span>  
 <span data-ttu-id="bfa19-140">En esta sección se describe el flujo típico de orquestación para recibir notificaciones mediante el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bfa19-140">This section outlines the typical orchestration flow for receiving notifications using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span>  
  
1.  <span data-ttu-id="bfa19-141">Lo primero que debe hacer la orquestación consiste en determinar el tipo de notificación recibida, incluyendo:</span><span class="sxs-lookup"><span data-stu-id="bfa19-141">The first thing that the orchestration must do is to determine the type of notification received, including:</span></span>  
  
    -   <span data-ttu-id="bfa19-142">Si ha recibido la notificación cuando se reinicia una ubicación de recepción.</span><span class="sxs-lookup"><span data-stu-id="bfa19-142">Whether the notification was received after a receive location restarts.</span></span>  
  
    -   <span data-ttu-id="bfa19-143">Si se ha recibido la notificación para una operación en una tabla de base de datos, como insertar, actualizar o eliminar.</span><span class="sxs-lookup"><span data-stu-id="bfa19-143">Whether the notification was received for an operation on a database table, such as Insert, Update, or Delete.</span></span>  
  
     <span data-ttu-id="bfa19-144">La orquestación debe incluir un **expresión** forma y dentro de ella, una consulta xpath para decidir qué tipo de mensaje se recibe.</span><span class="sxs-lookup"><span data-stu-id="bfa19-144">The orchestration must include an **Expression** shape, and within that, an xpath query to decide what kind of message is received.</span></span>  
  
2.  <span data-ttu-id="bfa19-145">Después de la notificación de tipo se determina, la orquestación debe incluir un bloque de decisión para llevar a cabo acciones específicas según el tipo de notificación recibida.</span><span class="sxs-lookup"><span data-stu-id="bfa19-145">After the notification type is determined, the orchestration must include a decision block to perform specific actions based on the type of notification received.</span></span> <span data-ttu-id="bfa19-146">Para lograr esto, la orquestación debe incluir un **decidir** forma, que incluye un **regla** bloque y un **Else** bloque:</span><span class="sxs-lookup"><span data-stu-id="bfa19-146">To achieve this, the orchestration must include a **Decide** shape, which includes a **Rule** block and an **Else** block:</span></span>  
  
    -   <span data-ttu-id="bfa19-147">En el **regla** bloque, debe especificar la condición y, a continuación, incluir formas de orquestación para realizar determinadas operaciones si se cumple la condición.</span><span class="sxs-lookup"><span data-stu-id="bfa19-147">Within the **Rule** block, you must specify the condition and then include orchestration shapes to perform certain operations if the condition is met.</span></span>  
  
    -   <span data-ttu-id="bfa19-148">En el **Else** bloque, se deben incluir formas de orquestación para realizar determinadas operaciones si la condición es *no* cumplen.</span><span class="sxs-lookup"><span data-stu-id="bfa19-148">Within the **Else** block, you must include orchestration shapes to perform certain operations if the condition is *not* met.</span></span>  
  
 <span data-ttu-id="bfa19-149">Detalles de los requisitos anteriores se describen en [mensajes de notificación de proceso para completar tareas específicas en SQL con BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="bfa19-149">Details of the preceding requirements are described in [Process Notification Messages to complete Specific Tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span></span> <span data-ttu-id="bfa19-150">Obtener un tutorial detallado también está disponible en [Tutorial 2: empleado: proceso de pedido de compra con el adaptador de SQL](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="bfa19-150">A detailed tutorial is also available in [Tutorial 2: Employee - Purchase Order Process using the SQL adapter](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span></span>