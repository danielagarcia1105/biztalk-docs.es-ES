---
title: Recibir notificaciones de consulta de forma incremental de SQL con BizTalk Server | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a6972e01-80be-47be-986a-c2e4e0fb0cd1
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e278b4e25db6c62127d2aac4ee8d29c3c422e463
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/27/2018
ms.locfileid: "37007765"
---
# <a name="receive-query-notifications-incrementally-from-sql-using-biztalk-server"></a><span data-ttu-id="639a5-102">Recibir notificaciones de consulta de forma incremental de SQL con BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="639a5-102">Receive Query Notifications Incrementally from SQL using BizTalk Server</span></span>
> [!IMPORTANT]
>  <span data-ttu-id="639a5-103">Por brevedad, este tema solo describe cómo recibir notificaciones de forma incremental.</span><span class="sxs-lookup"><span data-stu-id="639a5-103">For the sake of brevity, this topic only describes how to receive notifications incrementally.</span></span> <span data-ttu-id="639a5-104">En escenarios empresariales, la orquestación lo ideal es que debe incluir la lógica para extraer el tipo de mensaje de notificación recibido y, a continuación, realizar las operaciones posteriores.</span><span class="sxs-lookup"><span data-stu-id="639a5-104">In business scenarios, the orchestration must ideally include the logic to extract the kind of notification message received and then perform any subsequent operations.</span></span> <span data-ttu-id="639a5-105">En otras palabras, la orquestación se describe en este tema debe compilarse en la orquestación se describe en la parte superior [procesar mensajes de notificación para completar tareas específicas en SQL con BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-105">In other words, the orchestration described in this topic must be built on top of the orchestration described in [Process notification messages to complete specific tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span></span>  
  
 <span data-ttu-id="639a5-106">En este tema se muestra cómo configurar el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] para recibir mensajes de notificación de consulta incremental de una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-106">This topic demonstrates how to configure the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive incremental query notification messages from a SQL Server database.</span></span> <span data-ttu-id="639a5-107">Para mostrar notificaciones incrementales, considere la posibilidad de una tabla de empleados, con una columna de "Estado".</span><span class="sxs-lookup"><span data-stu-id="639a5-107">To demonstrate incremental notifications, consider a table, Employee, with a “Status” column.</span></span> <span data-ttu-id="639a5-108">Cuando se inserta un nuevo registro a esta tabla, el valor de la columna de estado se establece en 0.</span><span class="sxs-lookup"><span data-stu-id="639a5-108">When a new record is inserted to this table, the value of the Status column is set to 0.</span></span> <span data-ttu-id="639a5-109">Puede configurar el adaptador para recibir notificaciones incrementales haciendo lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-109">You can configure the adapter to receive incremental notifications by doing the following:</span></span>  
  
- <span data-ttu-id="639a5-110">Regístrese para recibir notificaciones mediante una instrucción SQL que recupera todos los registros que tienen la columna de estado como 0.</span><span class="sxs-lookup"><span data-stu-id="639a5-110">Register for notifications using a SQL statement that retrieves all records that have Status column as 0.</span></span> <span data-ttu-id="639a5-111">Puede hacerlo mediante la especificación de la instrucción SQL para la **NotificationStatement** enlaza la propiedad.</span><span class="sxs-lookup"><span data-stu-id="639a5-111">You can do so by specifying the SQL statement for the **NotificationStatement** binding property.</span></span>  
  
- <span data-ttu-id="639a5-112">Las filas para la notificación de que se han recibido mensajes, actualice la columna de estado en 1.</span><span class="sxs-lookup"><span data-stu-id="639a5-112">For rows for which notification messages have been received, update the Status column to 1.</span></span>  
  
  <span data-ttu-id="639a5-113">En este tema se muestra cómo crear una orquestación de BizTalk y configurar una aplicación de BizTalk para lograr esto.</span><span class="sxs-lookup"><span data-stu-id="639a5-113">This topic demonstrates how to create a BizTalk orchestration and configure a BizTalk application to achieve this.</span></span>  
  
## <a name="configuring-notifications-with-the-sql-adapter-binding-properties"></a><span data-ttu-id="639a5-114">Configuración de notificaciones con el adaptador SQL, las propiedades de enlace</span><span class="sxs-lookup"><span data-stu-id="639a5-114">Configuring Notifications with the SQL Adapter Binding Properties</span></span>  
 <span data-ttu-id="639a5-115">La siguiente tabla resume el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] propiedades de enlace que se utiliza para configurar la recepción de notificaciones de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-115">The following table summarizes the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] binding properties that you use to configure receiving notifications from SQL Server.</span></span> <span data-ttu-id="639a5-116">Debe especificar estas propiedades de enlace al configurar el puerto de recepción en el [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] consola de administración.</span><span class="sxs-lookup"><span data-stu-id="639a5-116">You must specify these binding properties while configuring the receive port in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="639a5-117">Puede especificar estas propiedades de enlace al generar el esquema para el **notificación** operación, incluso aunque no es obligatorio.</span><span class="sxs-lookup"><span data-stu-id="639a5-117">You may choose to specify these binding properties when generating the schema for the **Notification** operation, even though it is not mandatory.</span></span> <span data-ttu-id="639a5-118">Si lo hace, el enlace de puerto de archivos que el [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] genera como parte de la generación de metadatos también contiene los valores especificados para las propiedades de enlace.</span><span class="sxs-lookup"><span data-stu-id="639a5-118">If you do so, the port binding file that the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] generates as part of the metadata generation also contains the values you specify for the binding properties.</span></span> <span data-ttu-id="639a5-119">Más adelante puede importar este archivo de enlace en el [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] puerto de recepción de la consola de administración para crear el WCF-custom o WCF-SQL con el enlace de propiedades ya establecidas.</span><span class="sxs-lookup"><span data-stu-id="639a5-119">You can later import this binding file in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to create the WCF-custom or WCF-SQL receive port with the binding properties already set.</span></span> <span data-ttu-id="639a5-120">Para obtener más información acerca de cómo crear un puerto mediante el archivo de enlace, consulte [configurar un enlace de puerto físico mediante un archivo de enlace de puerto para usar el adaptador SQL](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-120">For more information about creating a port using the binding file, see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
|<span data-ttu-id="639a5-121">Propiedad de enlace</span><span class="sxs-lookup"><span data-stu-id="639a5-121">Binding Property</span></span>|<span data-ttu-id="639a5-122">Descripción</span><span class="sxs-lookup"><span data-stu-id="639a5-122">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="639a5-123">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="639a5-123">**InboundOperationType**</span></span>|<span data-ttu-id="639a5-124">Especifica la operación de entrada que desea realizar.</span><span class="sxs-lookup"><span data-stu-id="639a5-124">Specifies the inbound operation that you want to perform.</span></span> <span data-ttu-id="639a5-125">Para recibir mensajes de notificación, establezca esta opción en **notificación**.</span><span class="sxs-lookup"><span data-stu-id="639a5-125">To receive notification messages, set this to **Notification**.</span></span>|  
|<span data-ttu-id="639a5-126">**NotificationStatement**</span><span class="sxs-lookup"><span data-stu-id="639a5-126">**NotificationStatement**</span></span>|<span data-ttu-id="639a5-127">Especifica la instrucción SQL (SELECT o EXEC \<procedimiento almacenado\>) usa para registrar las notificaciones de consulta.</span><span class="sxs-lookup"><span data-stu-id="639a5-127">Specifies the SQL statement (SELECT or EXEC \<stored procedure\>) used to register for query notifications.</span></span> <span data-ttu-id="639a5-128">El adaptador obtiene un mensaje de notificación de SQL Server solo cuando el conjunto de resultados para que los cambios de instrucción SQL especificados.</span><span class="sxs-lookup"><span data-stu-id="639a5-128">The adapter gets a notification message from SQL Server only when the result set for the specified SQL statement changes.</span></span>|  
|<span data-ttu-id="639a5-129">**NotifyOnListenerStart**</span><span class="sxs-lookup"><span data-stu-id="639a5-129">**NotifyOnListenerStart**</span></span>|<span data-ttu-id="639a5-130">Especifica si el adaptador envía una notificación a los clientes del adaptador cuando se inicia el agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="639a5-130">Specifies whether the adapter sends a notification to the adapter clients when the listener is started.</span></span>|  
  
 <span data-ttu-id="639a5-131">Para obtener una descripción más completa de estas propiedades, vea [Obtenga información sobre el adaptador de BizTalk para las propiedades de enlace del adaptador de SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-131">For a more complete description of these properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <span data-ttu-id="639a5-132">Para obtener una descripción completa de cómo usar el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] para recibir notificaciones de SQL Server, siga leyendo.</span><span class="sxs-lookup"><span data-stu-id="639a5-132">For a complete description of how to use the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive notifications from SQL Server, read further.</span></span>  
  
## <a name="how-this-topic-demonstrates-receiving-notification-messages"></a><span data-ttu-id="639a5-133">Cómo se muestra en este tema, recibir mensajes de notificación</span><span class="sxs-lookup"><span data-stu-id="639a5-133">How This Topic Demonstrates Receiving Notification Messages</span></span>  
 <span data-ttu-id="639a5-134">Para demostrar cómo el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] admite la recepción de mensajes de notificación de SQL Server, en este tema se demuestra cómo configurar el adaptador para recibir notificaciones de los cambios a una tabla de empleados.</span><span class="sxs-lookup"><span data-stu-id="639a5-134">To demonstrate how the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving notification messages from SQL Server, this topic will demonstrate how to configure the adapter to receive notifications for changes to an Employee table.</span></span> <span data-ttu-id="639a5-135">Suponga que la tabla Employee tiene columnas IdDeEmpleado, nombre y estado.</span><span class="sxs-lookup"><span data-stu-id="639a5-135">Assume that the Employee table has columns Employee_ID, Name, and Status.</span></span> <span data-ttu-id="639a5-136">Cada vez que se agrega un nuevo empleado, el valor de la columna de estado se establece en 0.</span><span class="sxs-lookup"><span data-stu-id="639a5-136">Whenever a new employee is added, the value of the Status column is set to 0.</span></span>  
  
 <span data-ttu-id="639a5-137">Para demostrar la recepción de notificaciones, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-137">To demonstrate receiving notifications, do the following:</span></span>  
  
-   <span data-ttu-id="639a5-138">Genere el esquema para el **notificación** (operación de entrada), y **seleccione** (operación saliente) en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-138">Generate schema for the **Notification** (inbound operation), and **Select** (outbound operation) on the Employee table.</span></span>  
  
-   <span data-ttu-id="639a5-139">Crear una orquestación que incluye lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-139">Create an orchestration that has the following:</span></span>  
  
    -   <span data-ttu-id="639a5-140">Una ubicación de recepción para recibir mensajes de notificación.</span><span class="sxs-lookup"><span data-stu-id="639a5-140">A receive location to receive notification messages.</span></span> <span data-ttu-id="639a5-141">Puede configurar para la notificación mediante la especificación de la instrucción SELECT como:</span><span class="sxs-lookup"><span data-stu-id="639a5-141">You can configure for notification by specifying the SELECT statement as:</span></span>  
  
        ```  
        SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0  
        ```  
  
        > [!NOTE]
        >  <span data-ttu-id="639a5-142">En concreto, debe especificar los nombres de columna en la instrucción, como se muestra en esta instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="639a5-142">You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="639a5-143">Además, siempre debe especificar el nombre de tabla, junto con el nombre del esquema.</span><span class="sxs-lookup"><span data-stu-id="639a5-143">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="639a5-144">Por ejemplo, `dbo.Employee`.</span><span class="sxs-lookup"><span data-stu-id="639a5-144">For example, `dbo.Employee`.</span></span>  
  
    -   <span data-ttu-id="639a5-145">Un puerto de envío para actualizar las filas que ya se ha enviado notificaciones.</span><span class="sxs-lookup"><span data-stu-id="639a5-145">A send port to update the rows for which notification has already been sent.</span></span> <span data-ttu-id="639a5-146">Hacerlo estableciendo el valor de la columna Status para 1.</span><span class="sxs-lookup"><span data-stu-id="639a5-146">You do so by setting the value in the Status column to 1.</span></span> <span data-ttu-id="639a5-147">Puede hacer esto como parte de la operación de selección mediante el envío el mensaje siguiente al adaptador.</span><span class="sxs-lookup"><span data-stu-id="639a5-147">You can do this as part of the Select operation by sending the following message to the adapter.</span></span>  
  
        ```  
        <Select xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
          <Columns>Employee_ID,Name,Status</Columns>  
          <Query>where Status=0;UPDATE Employee SET Status=1 WHERE Status=0</Query>  
        </Select>  
        ```  
  
         <span data-ttu-id="639a5-148">En este mensaje, como parte de la `<Query>` elemento, especifica la instrucción UPDATE para actualizar la columna de estado.</span><span class="sxs-lookup"><span data-stu-id="639a5-148">In this message, as part of the `<Query>` element, you specify the UPDATE statement to update the Status column.</span></span> <span data-ttu-id="639a5-149">Tenga en cuenta que esta operación debe ejecutarse después de recibir la notificación de mensajes para que se actualicen las filas procesadas.</span><span class="sxs-lookup"><span data-stu-id="639a5-149">Note that this operation must be executed after receiving the notification messages so that the processed rows are updated.</span></span> <span data-ttu-id="639a5-150">Para hacer la distancia con la sobrecarga de espera para obtener la respuesta de notificación y, a continuación, quitar manualmente un mensaje de solicitud para actualizar las filas, generará el mensaje de solicitud para actualizar las filas dentro de la propia orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-150">To do away with the overhead of waiting to get the notification response and then manually dropping a request message to update the rows, you will generate the request message for updating the rows within the orchestration itself.</span></span> <span data-ttu-id="639a5-151">Puede hacerlo mediante el **construir mensaje** forma dentro de una orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-151">You can do so by using the **Construct Message** shape within an orchestration.</span></span>  
  
## <a name="how-to-receive-notification-messages-from-the-sql-server-database"></a><span data-ttu-id="639a5-152">Cómo recibir mensajes de notificación de la base de datos SQL Server</span><span class="sxs-lookup"><span data-stu-id="639a5-152">How to Receive Notification Messages from the SQL Server Database</span></span>  
 <span data-ttu-id="639a5-153">Realizar una operación en la base de datos de SQL Server mediante [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] con [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] conlleva las tareas de procedimientos se describe en [bloques de creación para desarrollar aplicaciones de BizTalk con el adaptador de SQL](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-153">Performing an operation on the SQL Server database using [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves the procedural tasks described in [Building blocks to develop BizTalk applications with the SQL adapter](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md).</span></span> <span data-ttu-id="639a5-154">Para configurar el adaptador para recibir mensajes de notificación, estas tareas son:</span><span class="sxs-lookup"><span data-stu-id="639a5-154">To configure the adapter to receive notification messages, these tasks are:</span></span>  
  
1. <span data-ttu-id="639a5-155">Crear un proyecto de BizTalk y, a continuación, genere el esquema para el **notificación** (operación de entrada) y **seleccione** (operación saliente) en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-155">Create a BizTalk project, and then generate schema for the **Notification** (inbound operation) and **Select** (outbound operation) on the Employee table.</span></span> <span data-ttu-id="639a5-156">Si lo desea, puede especificar valores para el **InboundOperationType** y **NotificationStatement** propiedades de enlace.</span><span class="sxs-lookup"><span data-stu-id="639a5-156">Optionally, you can specify values for the **InboundOperationType** and **NotificationStatement** binding properties.</span></span>  
  
2. <span data-ttu-id="639a5-157">Cree un mensaje en el proyecto de BizTalk para recibir notificaciones de la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-157">Create a message in the BizTalk project for receiving notification from the SQL Server database.</span></span>  
  
3. <span data-ttu-id="639a5-158">Crear mensajes en el proyecto de BizTalk para realizar la información que se seleccione en la base de datos de SQL Server y recibir mensajes de respuesta.</span><span class="sxs-lookup"><span data-stu-id="639a5-158">Create messages in the BizTalk project for performing the Select information on the SQL Server database and receiving response messages.</span></span>  
  
4. <span data-ttu-id="639a5-159">Crear una orquestación que hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-159">Create an orchestration that does the following:</span></span>  
  
   -   <span data-ttu-id="639a5-160">Recibe el mensaje de notificación de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-160">Receives notification message from SQL Server.</span></span>  
  
   -   <span data-ttu-id="639a5-161">Crea un mensaje para seleccionar y actualizar las filas para el que se recibe la notificación.</span><span class="sxs-lookup"><span data-stu-id="639a5-161">Creates a message to select and update the rows for which notification is received.</span></span>  
  
   -   <span data-ttu-id="639a5-162">Envía este mensaje a SQL Server para actualizar las filas y recibe una respuesta.</span><span class="sxs-lookup"><span data-stu-id="639a5-162">Sends this message to the SQL Server to update the rows and receives a response.</span></span>  
  
5. <span data-ttu-id="639a5-163">Compile e implemente el proyecto de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-163">Build and deploy the BizTalk project.</span></span>  
  
6. <span data-ttu-id="639a5-164">Configurar la aplicación mediante la creación física de envío y puertos de recepción de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-164">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="639a5-165">Para las operaciones de entrada, como recibir mensajes de notificación, sólo debe configurar un unidireccional WCF-Custom o puerto de recepción WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="639a5-165">For inbound operations, like receiving notification messages, you must only configure a one-way WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="639a5-166">Puertos de recepción bidireccional WCF-Custom o WCF-SQL no se admiten operaciones de entrada.</span><span class="sxs-lookup"><span data-stu-id="639a5-166">Two-way WCF-Custom or WCF-SQL receive ports are not supported for inbound operations.</span></span>  
  
7. <span data-ttu-id="639a5-167">Inicie la aplicación de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-167">Start the BizTalk application.</span></span>  
  
   <span data-ttu-id="639a5-168">Este tema proporciona instrucciones para realizar estas tareas.</span><span class="sxs-lookup"><span data-stu-id="639a5-168">This topic provides instructions to perform these tasks.</span></span>  
  
## <a name="sample-based-on-this-topic"></a><span data-ttu-id="639a5-169">Ejemplo basado en este tema.</span><span class="sxs-lookup"><span data-stu-id="639a5-169">Sample Based on This Topic</span></span>  
 <span data-ttu-id="639a5-170">Un ejemplo, IncrementalNotification, basado en este tema se proporciona con el [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="639a5-170">A sample, IncrementalNotification, based on this topic is provided with the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="639a5-171">Para obtener más información, consulte [ejemplos del adaptador de SQL](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-171">For more information, see [Samples for the SQL adapter](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md).</span></span>  
  
## <a name="generating-schema"></a><span data-ttu-id="639a5-172">Generar el esquema</span><span class="sxs-lookup"><span data-stu-id="639a5-172">Generating Schema</span></span>  
 <span data-ttu-id="639a5-173">Debe generar el esquema para el **notificación** operación y **seleccione** operación en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-173">You must generate the schema for the **Notification** operation and **Select** operation on Employee table.</span></span> <span data-ttu-id="639a5-174">Consulte [obtener metadatos para operaciones de SQL Server en Visual Studio mediante el adaptador de SQL](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md) para obtener más información acerca de cómo generar el esquema.</span><span class="sxs-lookup"><span data-stu-id="639a5-174">See [Get metadata for SQL Server operations in Visual Studio using the SQL adapter](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md) for more information about how to generate the schema.</span></span> <span data-ttu-id="639a5-175">Realice las tareas siguientes al generar el esquema.</span><span class="sxs-lookup"><span data-stu-id="639a5-175">Perform the following tasks when generating the schema.</span></span> <span data-ttu-id="639a5-176">Omitir el primer paso si no desea especificar las propiedades de enlace en tiempo de diseño.</span><span class="sxs-lookup"><span data-stu-id="639a5-176">Skip the first step if you do not want to specify the binding properties at design time.</span></span>  
  
1.  <span data-ttu-id="639a5-177">Especifique un valor para **InboundOperationType** y **NotificationStatement** al generar el esquema de propiedades de enlace.</span><span class="sxs-lookup"><span data-stu-id="639a5-177">Specify a value for **InboundOperationType** and **NotificationStatement** binding properties while generating the schema.</span></span> <span data-ttu-id="639a5-178">Para obtener más información acerca de esta propiedad de enlace, consulte [Obtenga información sobre el adaptador de BizTalk para las propiedades de enlace del adaptador de SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-178">For more information about this binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <span data-ttu-id="639a5-179">Para obtener instrucciones sobre cómo especificar las propiedades de enlace, consulte [configurar las propiedades de enlace del adaptador de SQL](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-179">For instructions on how to specify binding properties, see [Configure the binding properties for the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span></span>  
  
2.  <span data-ttu-id="639a5-180">Seleccione el tipo de contrato **(operaciones de entrada) de servicio**.</span><span class="sxs-lookup"><span data-stu-id="639a5-180">Select the contract type as **Service (Inbound operations)**.</span></span>  
  
3.  <span data-ttu-id="639a5-181">Genere el esquema para el **notificación** operación.</span><span class="sxs-lookup"><span data-stu-id="639a5-181">Generate schema for the **Notification** operation.</span></span>  
  
4.  <span data-ttu-id="639a5-182">Seleccione el tipo de contrato **Client (Outbound operations)**.</span><span class="sxs-lookup"><span data-stu-id="639a5-182">Select the contract type as **Client (Outbound operations)**.</span></span>  
  
5.  <span data-ttu-id="639a5-183">Genere el esquema para el **seleccione** operación en **empleado** tabla.</span><span class="sxs-lookup"><span data-stu-id="639a5-183">Generate schema for the **Select** operation on **Employee** table.</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="639a5-184">Definición de los mensajes y tipos de mensaje</span><span class="sxs-lookup"><span data-stu-id="639a5-184">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="639a5-185">El esquema que ha generado anteriormente describe los "tipos" necesarios para los mensajes en la orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-185">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="639a5-186">Un mensaje suele ser una variable, el tipo para el que está definido por el esquema correspondiente.</span><span class="sxs-lookup"><span data-stu-id="639a5-186">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="639a5-187">Una vez que se genera el esquema, debe vincularlo a los mensajes desde la vista de orquestación de BizTalk del proyecto.</span><span class="sxs-lookup"><span data-stu-id="639a5-187">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  
  
 <span data-ttu-id="639a5-188">Este tema, debe crear tres mensajes: uno para recibir notificaciones de la base de datos de SQL Server, uno para realizar la operación de selección y otro para recibir la respuesta para la operación de selección.</span><span class="sxs-lookup"><span data-stu-id="639a5-188">For this topic, you must create three messages—one to receive notifications from the SQL Server database, one to perform the Select operation, and one to receive the response for Select operation.</span></span>  
  
 <span data-ttu-id="639a5-189">Realice los pasos siguientes para crear mensajes y vincularlos a esquema.</span><span class="sxs-lookup"><span data-stu-id="639a5-189">Perform the following steps to create messages and link them to schema.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="639a5-190">Para crear mensajes y vínculo a esquema</span><span class="sxs-lookup"><span data-stu-id="639a5-190">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="639a5-191">Agregar una orquestación al proyecto de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-191">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="639a5-192">En el Explorador de soluciones, haga clic en el nombre del proyecto de BizTalk, seleccione **agregar**y, a continuación, haga clic en **nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="639a5-192">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="639a5-193">Escriba un nombre para la orquestación de BizTalk y, a continuación, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="639a5-193">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="639a5-194">Abra la ventana Vista orquestación del proyecto de BizTalk, si aún no está abierto.</span><span class="sxs-lookup"><span data-stu-id="639a5-194">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="639a5-195">Haga clic en **vista**, apunte a **Other Windows**y, a continuación, haga clic en **Vista orquestación**.</span><span class="sxs-lookup"><span data-stu-id="639a5-195">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="639a5-196">En el **Vista orquestación**, haga clic en **mensajes**y, a continuación, haga clic en **nuevo mensaje**.</span><span class="sxs-lookup"><span data-stu-id="639a5-196">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="639a5-197">Haga clic en el mensaje recién creado y, a continuación, seleccione **ventana propiedades**.</span><span class="sxs-lookup"><span data-stu-id="639a5-197">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="639a5-198">En el **propiedades** panel **Message_1**, realice lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-198">In the **Properties** pane for **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="639a5-199">Use</span><span class="sxs-lookup"><span data-stu-id="639a5-199">Use this</span></span>|<span data-ttu-id="639a5-200">Para</span><span class="sxs-lookup"><span data-stu-id="639a5-200">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="639a5-201">Identificador</span><span class="sxs-lookup"><span data-stu-id="639a5-201">Identifier</span></span>|<span data-ttu-id="639a5-202">Tipo `NotifyReceive`.</span><span class="sxs-lookup"><span data-stu-id="639a5-202">Type `NotifyReceive`.</span></span>|  
    |<span data-ttu-id="639a5-203">Tipo de mensaje</span><span class="sxs-lookup"><span data-stu-id="639a5-203">Message Type</span></span>|<span data-ttu-id="639a5-204">En la lista desplegable, expanda **esquemas**y seleccione *SQLNotify.Notification*, donde *SQLNotify* es el nombre de su proyecto de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-204">From the drop-down list, expand **Schemas**, and select *SQLNotify.Notification*, where *SQLNotify* is the name of your BizTalk project.</span></span> <span data-ttu-id="639a5-205">*Notificación* es el esquema generado para el **notificación** operación.</span><span class="sxs-lookup"><span data-stu-id="639a5-205">*Notification* is the schema generated for the **Notification** operation.</span></span>|  
  
6.  <span data-ttu-id="639a5-206">Repita el paso 3 para crear dos nuevos mensajes.</span><span class="sxs-lookup"><span data-stu-id="639a5-206">Repeat step 3 to create two new messages.</span></span> <span data-ttu-id="639a5-207">En el **propiedades** panel para el nuevo mensaje, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-207">In the **Properties** pane for the new message, do the following:</span></span>  
  
    |<span data-ttu-id="639a5-208">Identificador de conjunto para</span><span class="sxs-lookup"><span data-stu-id="639a5-208">Set Identifier to</span></span>|<span data-ttu-id="639a5-209">Establecer el tipo de mensaje en</span><span class="sxs-lookup"><span data-stu-id="639a5-209">Set Message Type to</span></span>|  
    |-----------------------|-------------------------|  
    |<span data-ttu-id="639a5-210">Select</span><span class="sxs-lookup"><span data-stu-id="639a5-210">Select</span></span>|<span data-ttu-id="639a5-211">*SQLNotify.TableOperation_dbo_Employee.Select*, donde *TableOperation_dbo_Employee* es el esquema generado para el **seleccione** operación</span><span class="sxs-lookup"><span data-stu-id="639a5-211">*SQLNotify.TableOperation_dbo_Employee.Select*, where  *TableOperation_dbo_Employee* is the schema generated for the **Select** operation</span></span>|  
    |<span data-ttu-id="639a5-212">SelectResponse</span><span class="sxs-lookup"><span data-stu-id="639a5-212">SelectResponse</span></span>|<span data-ttu-id="639a5-213">*SQLNotify.TableOperation_dbo_Employee.SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="639a5-213">*SQLNotify.TableOperation_dbo_Employee.SelectResponse*</span></span>|  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="639a5-214">Configuración de la orquestación</span><span class="sxs-lookup"><span data-stu-id="639a5-214">Setting up the Orchestration</span></span>  
 <span data-ttu-id="639a5-215">Debe crear una orquestación de BizTalk para utilizar [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] para recibir mensajes de notificación de la base de datos de SQL Server y, a continuación, actualizar las filas para el que se recibió la notificación.</span><span class="sxs-lookup"><span data-stu-id="639a5-215">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving notification messages from the SQL Server database and then updating the rows for which notification was received.</span></span> <span data-ttu-id="639a5-216">En esta orquestación, el adaptador recibe el mensaje de notificación basado en la instrucción SELECT especificada para el **NotificationStatement** enlaza la propiedad.</span><span class="sxs-lookup"><span data-stu-id="639a5-216">In this orchestration, the adapter receives the notification message based on the SELECT statement specified for the **NotificationStatement** binding property.</span></span> <span data-ttu-id="639a5-217">El mensaje de notificación se recibe en una ubicación de archivo.</span><span class="sxs-lookup"><span data-stu-id="639a5-217">The notification message is received at a FILE location.</span></span> <span data-ttu-id="639a5-218">Una vez que se recibe la respuesta, la orquestación construye un mensaje que se usará para actualizar las filas para el que se recibe la notificación.</span><span class="sxs-lookup"><span data-stu-id="639a5-218">Once the response is received, the orchestration constructs a message that will be used to update the rows for which notification is received.</span></span> <span data-ttu-id="639a5-219">También se recibe la respuesta para este mensaje en la misma ubicación de archivo.</span><span class="sxs-lookup"><span data-stu-id="639a5-219">The response for this message is also received at the same FILE location.</span></span>  
  
 <span data-ttu-id="639a5-220">Por lo tanto, la orquestación debe contener lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-220">So, your orchestration must contain the following:</span></span>  
  
- <span data-ttu-id="639a5-221">Puerto para recibir mensajes de notificación de recepción unidireccional.</span><span class="sxs-lookup"><span data-stu-id="639a5-221">A one-way receive port to receive notification messages.</span></span>  
  
- <span data-ttu-id="639a5-222">Puerto para enviar mensajes al actualizar las filas y recibir la respuesta para el mismo de envío bidireccional.</span><span class="sxs-lookup"><span data-stu-id="639a5-222">A two-way send port to send messages to update rows and receive response for the same.</span></span>  
  
- <span data-ttu-id="639a5-223">Un **construir mensaje** forma para construir mensajes, para ejecutar la operación de actualización dentro de la orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-223">A **Construct Message** shape to construct messages, to execute the Update operation, within the orchestration.</span></span>  
  
- <span data-ttu-id="639a5-224">Un archivo de puerto de envío para guardar la respuesta para la operación de actualización.</span><span class="sxs-lookup"><span data-stu-id="639a5-224">A FILE send port to save the response for the Update operation.</span></span>  
  
- <span data-ttu-id="639a5-225">Formas de envío y recepción.</span><span class="sxs-lookup"><span data-stu-id="639a5-225">Receive and send shapes.</span></span>  
  
  <span data-ttu-id="639a5-226">Una orquestación de ejemplo es similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="639a5-226">A sample orchestration resembles the following.</span></span>  
  
  <span data-ttu-id="639a5-227">![Orquestación para recibir notificaciones de SQL Server](../../adapters-and-accelerators/adapter-sql/media/f13ad3b8-8161-42e5-a521-424bbf549ad5.gif "f13ad3b8-8161-42e5-a521-424bbf549ad5")</span><span class="sxs-lookup"><span data-stu-id="639a5-227">![Orchestration to receive SQL Server notifications](../../adapters-and-accelerators/adapter-sql/media/f13ad3b8-8161-42e5-a521-424bbf549ad5.gif "f13ad3b8-8161-42e5-a521-424bbf549ad5")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="639a5-228">Agregar formas de mensaje</span><span class="sxs-lookup"><span data-stu-id="639a5-228">Adding Message Shapes</span></span>  
 <span data-ttu-id="639a5-229">Asegúrese de que especificar las siguientes propiedades para cada una de las formas de mensaje.</span><span class="sxs-lookup"><span data-stu-id="639a5-229">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="639a5-230">Los nombres que aparecen en la columna de forma son los nombres de las formas de mensaje como se muestra en la orquestación simplemente mencionadas.</span><span class="sxs-lookup"><span data-stu-id="639a5-230">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="639a5-231">Forma</span><span class="sxs-lookup"><span data-stu-id="639a5-231">Shape</span></span>|<span data-ttu-id="639a5-232">Tipo de forma</span><span class="sxs-lookup"><span data-stu-id="639a5-232">Shape Type</span></span>|<span data-ttu-id="639a5-233">Propiedades</span><span class="sxs-lookup"><span data-stu-id="639a5-233">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="639a5-234">ReceiveNotification</span><span class="sxs-lookup"><span data-stu-id="639a5-234">ReceiveNotification</span></span>|<span data-ttu-id="639a5-235">Receive</span><span class="sxs-lookup"><span data-stu-id="639a5-235">Receive</span></span>|<span data-ttu-id="639a5-236">-Establecer **nombre** a *ReceiveNotification*</span><span class="sxs-lookup"><span data-stu-id="639a5-236">- Set **Name** to *ReceiveNotification*</span></span><br /><br /> <span data-ttu-id="639a5-237">-Establecer **activar** a *True*</span><span class="sxs-lookup"><span data-stu-id="639a5-237">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="639a5-238">SaveNotification</span><span class="sxs-lookup"><span data-stu-id="639a5-238">SaveNotification</span></span>|<span data-ttu-id="639a5-239">Send</span><span class="sxs-lookup"><span data-stu-id="639a5-239">Send</span></span>|<span data-ttu-id="639a5-240">-Establecer **nombre** a *SaveNotification*</span><span class="sxs-lookup"><span data-stu-id="639a5-240">- Set **Name** to *SaveNotification*</span></span>|  
|<span data-ttu-id="639a5-241">SendSelectMessage</span><span class="sxs-lookup"><span data-stu-id="639a5-241">SendSelectMessage</span></span>|<span data-ttu-id="639a5-242">Send</span><span class="sxs-lookup"><span data-stu-id="639a5-242">Send</span></span>|<span data-ttu-id="639a5-243">-Establecer **nombre** a *SendSelectMessage*</span><span class="sxs-lookup"><span data-stu-id="639a5-243">- Set **Name** to *SendSelectMessage*</span></span>|  
|<span data-ttu-id="639a5-244">ReceiveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="639a5-244">ReceiveSelectResponse</span></span>|<span data-ttu-id="639a5-245">Receive</span><span class="sxs-lookup"><span data-stu-id="639a5-245">Receive</span></span>|<span data-ttu-id="639a5-246">-Establecer **nombre** a *ReceiveSelectResponse*</span><span class="sxs-lookup"><span data-stu-id="639a5-246">- Set **Name** to *ReceiveSelectResponse*</span></span>|  
|<span data-ttu-id="639a5-247">SaveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="639a5-247">SaveSelectResponse</span></span>|<span data-ttu-id="639a5-248">Send</span><span class="sxs-lookup"><span data-stu-id="639a5-248">Send</span></span>|<span data-ttu-id="639a5-249">-Establecer **nombre** a *SaveSelectResponse*</span><span class="sxs-lookup"><span data-stu-id="639a5-249">- Set **Name** to *SaveSelectResponse*</span></span>|  
  
### <a name="adding-construct-message-shape"></a><span data-ttu-id="639a5-250">Adición de la forma construir mensaje</span><span class="sxs-lookup"><span data-stu-id="639a5-250">Adding Construct Message Shape</span></span>  
 <span data-ttu-id="639a5-251">Puede usar el **construir mensaje** forma para generar un mensaje de solicitud dentro de la operación para realizar la operación de selección.</span><span class="sxs-lookup"><span data-stu-id="639a5-251">You can use the **Construct Message** shape to generate a request message within the operation to perform the Select operation.</span></span> <span data-ttu-id="639a5-252">Para ello, debe agregar un **construir mensaje** forma y dentro de ese un **asignación de mensajes** forma a la orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-252">To do so, you must add a **Construct Message** shape and within that a **Message Assignment** shape to your orchestration.</span></span> <span data-ttu-id="639a5-253">En este ejemplo, el **asignación de mensajes** forma invoca el código que genera un mensaje que se envía a SQL Server para realizar la operación de selección.</span><span class="sxs-lookup"><span data-stu-id="639a5-253">For this example, the **Message Assignment** shape invokes code that generates a message that is sent to SQL Server to perform the Select operation.</span></span> <span data-ttu-id="639a5-254">El **asignación de mensajes** forma también establece la acción para el mensaje para enviarlo a SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-254">The **Message Assignment** shape also sets the action for the message to be sent to SQL Server.</span></span>  
  
 <span data-ttu-id="639a5-255">Para la forma construir mensaje, establezca la **mensaje construido** propiedad **seleccione**.</span><span class="sxs-lookup"><span data-stu-id="639a5-255">For the construct message shape, set the **Message Constructed** property to **Select**.</span></span>  
  
 <span data-ttu-id="639a5-256">El código para generar la respuesta podría ser parte de la misma solución de Visual Studio que el proyecto de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-256">The code to generate the response could be part of the same Visual Studio solution as your BizTalk project.</span></span> <span data-ttu-id="639a5-257">Un código de ejemplo para generar un mensaje de respuesta tiene este aspecto.</span><span class="sxs-lookup"><span data-stu-id="639a5-257">A sample code for generating a response message looks like this.</span></span>  
  
```  
namespace SampleMessageCreator  
{  
    public class SampleMessageCreator  
    {  
        private static XmlDocument Message;  
        private static string XmlFileLocation;  
        private static string ResponseDoc;  
        public static XmlDocument XMLMessageCreator()  
        {  
            XmlFileLocation = "C:\\TestLocation\\CreateMessage";  
            try  
            {  
                ResponseDoc = (Directory.GetFiles(XmlFileLocation, "*.xml", SearchOption.TopDirectoryOnly))[0];  
            }  
            catch (Exception ex)  
            {  
                Console.WriteLine("Trying to get XML from: " + XmlFileLocation);  
                Console.WriteLine("EXCEPTION: " + ex.ToString());  
                throw ex;  
            }  
            //Create Message From XML  
            Message = new XmlDocument();  
            Message.PreserveWhitespace = true;  
            Message.Load(ResponseDoc);  
            return Message;  
        }   
    }  
}  
```  
  
 <span data-ttu-id="639a5-258">Para que el fragmento de código anterior para que pueda generar un mensaje de solicitud, debe tener un mensaje de solicitud XML (para la operación de selección en la tabla Employee) en la ubicación especificada para el `XmlFileLocation` variable.</span><span class="sxs-lookup"><span data-stu-id="639a5-258">For the preceding code excerpt to be able to generate a request message, you must have an XML request message (for the Select operation on the Employee table) in the location specified for the `XmlFileLocation` variable.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="639a5-259">Después de compilar el proyecto, se crearán SampleMessageCreator.dll en el directorio del proyecto.</span><span class="sxs-lookup"><span data-stu-id="639a5-259">After you build the project, SampleMessageCreator.dll will be created in the project directory.</span></span> <span data-ttu-id="639a5-260">Debe agregar este archivo DLL a la caché de ensamblados global (GAC).</span><span class="sxs-lookup"><span data-stu-id="639a5-260">You must add this DLL to the global assembly cache (GAC).</span></span> <span data-ttu-id="639a5-261">Además, debe agregar el SampleMessageCreator.dll como referencia en el proyecto de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="639a5-261">Also, you must add the SampleMessageCreator.dll as a reference in the BizTalk project.</span></span>  
  
 <span data-ttu-id="639a5-262">Agregue la siguiente expresión para invocar este código desde el **asignación de mensajes** forma y para establecer la acción para el mensaje.</span><span class="sxs-lookup"><span data-stu-id="639a5-262">Add the following expression to invoke this code from the **Message Assignment** shape and to set the action for message.</span></span> <span data-ttu-id="639a5-263">Para agregar una expresión, haga doble clic en el **asignación de mensajes** forma para abrir el Editor de expresiones.</span><span class="sxs-lookup"><span data-stu-id="639a5-263">To add an expression, double-click the **Message Assignment** shape to open the Expression Editor.</span></span>  
  
```  
Select = SampleMessageCreator.SampleMessageCreator.XMLMessageCreator();  
Select(WCF.Action) = "TableOp/Select/dbo/Employee";  
```  
  
### <a name="adding-ports"></a><span data-ttu-id="639a5-264">Agregar puertos</span><span class="sxs-lookup"><span data-stu-id="639a5-264">Adding Ports</span></span>  
 <span data-ttu-id="639a5-265">Asegúrese de que especificar las siguientes propiedades para cada uno de los puertos lógicos.</span><span class="sxs-lookup"><span data-stu-id="639a5-265">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="639a5-266">Los nombres que aparecen en la columna puerto son los nombres de los puertos tal como se muestra en la orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-266">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="639a5-267">Puerto</span><span class="sxs-lookup"><span data-stu-id="639a5-267">Port</span></span>|<span data-ttu-id="639a5-268">Propiedades</span><span class="sxs-lookup"><span data-stu-id="639a5-268">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="639a5-269">SQLNotifyPort</span><span class="sxs-lookup"><span data-stu-id="639a5-269">SQLNotifyPort</span></span>|<span data-ttu-id="639a5-270">-Establecer **identificador** a *SQLNotifyPort*</span><span class="sxs-lookup"><span data-stu-id="639a5-270">- Set **Identifier** to *SQLNotifyPort*</span></span><br /><br /> <span data-ttu-id="639a5-271">-Establecer **tipo** a *SQLNotifyPortType*</span><span class="sxs-lookup"><span data-stu-id="639a5-271">- Set **Type** to *SQLNotifyPortType*</span></span><br /><br /> <span data-ttu-id="639a5-272">-Establecer **patrón de comunicación** a *unidireccional*</span><span class="sxs-lookup"><span data-stu-id="639a5-272">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="639a5-273">-Establecer **dirección de comunicación** a *de recepción*</span><span class="sxs-lookup"><span data-stu-id="639a5-273">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="639a5-274">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="639a5-274">SaveMessagePort</span></span>|<span data-ttu-id="639a5-275">-Establecer **identificador** a *SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="639a5-275">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="639a5-276">-Establecer **tipo** a *SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="639a5-276">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="639a5-277">-Establecer **patrón de comunicación** a *unidireccional*</span><span class="sxs-lookup"><span data-stu-id="639a5-277">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="639a5-278">-Establecer **dirección de comunicación** a *enviar*</span><span class="sxs-lookup"><span data-stu-id="639a5-278">- Set **Communication Direction** to *Send*</span></span><br /><br /> <span data-ttu-id="639a5-279">-Creación de una operación *Notify*.</span><span class="sxs-lookup"><span data-stu-id="639a5-279">- Create an operation *Notify*.</span></span> <span data-ttu-id="639a5-280">Esta operación se usa para los mensajes de notificación.</span><span class="sxs-lookup"><span data-stu-id="639a5-280">This operation is used for notification messages.</span></span><br /><br /> <span data-ttu-id="639a5-281">-Creación de una operación *seleccione*.</span><span class="sxs-lookup"><span data-stu-id="639a5-281">- Create an operation *Select*.</span></span> <span data-ttu-id="639a5-282">Esta operación se usa para los mensajes de respuesta de select.</span><span class="sxs-lookup"><span data-stu-id="639a5-282">This operation is used for select response messages.</span></span>|  
|<span data-ttu-id="639a5-283">SQLOutboundPort</span><span class="sxs-lookup"><span data-stu-id="639a5-283">SQLOutboundPort</span></span>|<span data-ttu-id="639a5-284">-Establecer **identificador** a *SQLOutboundPort*</span><span class="sxs-lookup"><span data-stu-id="639a5-284">- Set **Identifier** to *SQLOutboundPort*</span></span><br /><br /> <span data-ttu-id="639a5-285">-Establecer **tipo** a *SQLOutboundPortType*</span><span class="sxs-lookup"><span data-stu-id="639a5-285">- Set **Type** to *SQLOutboundPortType*</span></span><br /><br /> <span data-ttu-id="639a5-286">-Establecer **patrón de comunicación** a *de solicitud-respuesta*</span><span class="sxs-lookup"><span data-stu-id="639a5-286">- Set **Communication Pattern** to *Request-Response*</span></span><br /><br /> <span data-ttu-id="639a5-287">-Establecer **dirección de comunicación** a *envío y recepción*</span><span class="sxs-lookup"><span data-stu-id="639a5-287">- Set **Communication Direction** to *Send-Receive*</span></span>|  
  
### <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="639a5-288">Especifique los mensajes para las formas Acción y conectar a los puertos</span><span class="sxs-lookup"><span data-stu-id="639a5-288">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="639a5-289">En la tabla siguiente especifica las propiedades y sus valores que se deben establecer para especificar los mensajes para las formas Acción y vincular los mensajes a los puertos.</span><span class="sxs-lookup"><span data-stu-id="639a5-289">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="639a5-290">Los nombres que aparecen en la columna de forma son los nombres de las formas de mensaje como se muestra en la orquestación que se ha mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="639a5-290">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="639a5-291">Forma</span><span class="sxs-lookup"><span data-stu-id="639a5-291">Shape</span></span>|<span data-ttu-id="639a5-292">Propiedades</span><span class="sxs-lookup"><span data-stu-id="639a5-292">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="639a5-293">ReceiveNotification</span><span class="sxs-lookup"><span data-stu-id="639a5-293">ReceiveNotification</span></span>|<span data-ttu-id="639a5-294">-Establecer **mensaje** a *NotifyReceive*</span><span class="sxs-lookup"><span data-stu-id="639a5-294">- Set **Message** to *NotifyReceive*</span></span><br /><br /> <span data-ttu-id="639a5-295">-Establecer **operación** a *SQLNotifyPort.Notify.Request*</span><span class="sxs-lookup"><span data-stu-id="639a5-295">- Set **Operation** to *SQLNotifyPort.Notify.Request*</span></span>|  
|<span data-ttu-id="639a5-296">SaveNotification</span><span class="sxs-lookup"><span data-stu-id="639a5-296">SaveNotification</span></span>|<span data-ttu-id="639a5-297">-Establecer **mensaje** a *NotifyReceive*</span><span class="sxs-lookup"><span data-stu-id="639a5-297">- Set **Message** to *NotifyReceive*</span></span><br /><br /> <span data-ttu-id="639a5-298">-Establecer **operación** a *SaveMessagePort.Notify.Request*</span><span class="sxs-lookup"><span data-stu-id="639a5-298">- Set **Operation** to *SaveMessagePort.Notify.Request*</span></span>|  
|<span data-ttu-id="639a5-299">SendSelectMessage</span><span class="sxs-lookup"><span data-stu-id="639a5-299">SendSelectMessage</span></span>|<span data-ttu-id="639a5-300">-Establecer **mensaje** a *seleccione*</span><span class="sxs-lookup"><span data-stu-id="639a5-300">- Set **Message** to *Select*</span></span><br /><br /> <span data-ttu-id="639a5-301">-Establecer **operación** a *SQLOutboundPort.Select.Request*</span><span class="sxs-lookup"><span data-stu-id="639a5-301">- Set **Operation** to *SQLOutboundPort.Select.Request*</span></span>|  
|<span data-ttu-id="639a5-302">ReceiveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="639a5-302">ReceiveSelectResponse</span></span>|<span data-ttu-id="639a5-303">-Establecer **mensaje** a *SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="639a5-303">- Set **Message** to *SelectResponse*</span></span><br /><br /> <span data-ttu-id="639a5-304">-Establecer **operación** a *SQLOutboundPort.Select.Response*</span><span class="sxs-lookup"><span data-stu-id="639a5-304">- Set **Operation** to *SQLOutboundPort.Select.Response*</span></span>|  
|<span data-ttu-id="639a5-305">SaveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="639a5-305">SaveSelectResponse</span></span>|<span data-ttu-id="639a5-306">-Establecer **mensaje** a *SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="639a5-306">- Set **Message** to *SelectResponse*</span></span><br /><br /> <span data-ttu-id="639a5-307">-Establecer **operación** a *SaveMessagePort.Select.Request*</span><span class="sxs-lookup"><span data-stu-id="639a5-307">- Set **Operation** to *SaveMessagePort.Select.Request*</span></span>|  
  
 <span data-ttu-id="639a5-308">Después de especificar estas propiedades, están conectados a los puertos y formas de mensaje y se completa la orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-308">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
 <span data-ttu-id="639a5-309">Ahora debe compilar la solución de BizTalk e implementarla en un [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="639a5-309">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="639a5-310">Para obtener más información, consulte [compilar y ejecutar orquestaciones](../../core/building-and-running-orchestrations.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-310">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="639a5-311">Configuración de la aplicación de BizTalk</span><span class="sxs-lookup"><span data-stu-id="639a5-311">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="639a5-312">Después de haber implementado el proyecto de BizTalk, aparece la orquestación que creó anteriormente en el **orquestaciones** panel en la consola de administración de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-312">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="639a5-313">Debe usar la consola de administración de BizTalk Server para configurar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="639a5-313">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="639a5-314">Para ver un tutorial, vea [Tutorial: implementar una aplicación básica de BizTalk](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-314">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="639a5-315">Configuración de una aplicación implica:</span><span class="sxs-lookup"><span data-stu-id="639a5-315">Configuring an application involves:</span></span>  
  
- <span data-ttu-id="639a5-316">Selección de un host de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="639a5-316">Selecting a host for the application.</span></span>  
  
- <span data-ttu-id="639a5-317">Asignación de los puertos que ha creado en la orquestación con puertos físicos en la consola de administración de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-317">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="639a5-318">Para esta orquestación, debe:</span><span class="sxs-lookup"><span data-stu-id="639a5-318">For this orchestration you must:</span></span>  
  
  - <span data-ttu-id="639a5-319">Definir un WCF-Custom físico o puerto de recepción unidireccionales de WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="639a5-319">Define a physical WCF-Custom or WCF-SQL one-way receive port.</span></span> <span data-ttu-id="639a5-320">Este puerto de escucha de notificaciones que proceden de la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-320">This port listens for notifications coming from the SQL Server database.</span></span> <span data-ttu-id="639a5-321">Para obtener información sobre cómo crear los puertos, consulte [configurar manualmente un enlace de puerto físico al adaptador de SQL](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-321">For information about how to create ports, see [Manually configure a physical port binding to the SQL adapter](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span></span> <span data-ttu-id="639a5-322">Asegúrese de que especificar las siguientes propiedades de enlace para el puerto de recepción.</span><span class="sxs-lookup"><span data-stu-id="639a5-322">Make sure you specify the following binding properties for the receive port.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="639a5-323">No es necesario realizar este paso si especifica las propiedades de enlace en tiempo de diseño.</span><span class="sxs-lookup"><span data-stu-id="639a5-323">You do not need to perform this step if you specified the binding properties at design time.</span></span> <span data-ttu-id="639a5-324">En tal caso, puede crear un WCF-custom o WCF-SQL puerto de recepción, con el conjunto de propiedades de enlace necesaria, importando el archivo de enlace creado por el [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="639a5-324">In such a case, you can create a WCF-custom or WCF-SQL receive port, with the required binding properties set, by importing the binding file created by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="639a5-325">Para obtener más información, consulte [configurar un enlace de puerto físico mediante un archivo de enlace de puerto para usar el adaptador SQL](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-325">For more information see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
    |<span data-ttu-id="639a5-326">Propiedad de enlace</span><span class="sxs-lookup"><span data-stu-id="639a5-326">Binding Property</span></span>|<span data-ttu-id="639a5-327">Valor</span><span class="sxs-lookup"><span data-stu-id="639a5-327">Value</span></span>|  
    |----------------------|-----------|  
    |<span data-ttu-id="639a5-328">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="639a5-328">**InboundOperationType**</span></span>|<span data-ttu-id="639a5-329">Establezca esta opción en **notificación**.</span><span class="sxs-lookup"><span data-stu-id="639a5-329">Set this to **Notification**.</span></span>|  
    |<span data-ttu-id="639a5-330">**NotificationStatement**</span><span class="sxs-lookup"><span data-stu-id="639a5-330">**NotificationStatement**</span></span>|<span data-ttu-id="639a5-331">Establezca esta opción en:</span><span class="sxs-lookup"><span data-stu-id="639a5-331">Set this to:</span></span><br /><br /> `SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0`<br /><br /> <span data-ttu-id="639a5-332">**Nota:** específicamente debe especificar los nombres de columna en la instrucción como se muestra en la siguiente instrucción SELECT.</span><span class="sxs-lookup"><span data-stu-id="639a5-332">**Note:** You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="639a5-333">Además, siempre debe especificar el nombre de tabla, junto con el nombre del esquema.</span><span class="sxs-lookup"><span data-stu-id="639a5-333">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="639a5-334">Por ejemplo, `dbo.Employee`.</span><span class="sxs-lookup"><span data-stu-id="639a5-334">For example, `dbo.Employee`.</span></span>|  
    |<span data-ttu-id="639a5-335">**NotifyOnListenerStart**</span><span class="sxs-lookup"><span data-stu-id="639a5-335">**NotifyOnListenerStart**</span></span>|<span data-ttu-id="639a5-336">Establezca esta opción en **True**.</span><span class="sxs-lookup"><span data-stu-id="639a5-336">Set this to **True**.</span></span>|  
  
     <span data-ttu-id="639a5-337">Para obtener más información acerca de las propiedades de enlace diferente, consulte [Obtenga información sobre el adaptador de BizTalk para las propiedades de enlace del adaptador de SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-337">For more information about the different binding properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="639a5-338">Se recomienda configurar el nivel de aislamiento de transacción y el tiempo de espera de transacción al realizar operaciones de entrada mediante el [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="639a5-338">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="639a5-339">Puede hacerlo agregando el servicio de puerto de recepción de comportamiento al configurar el WCF-Custom o WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="639a5-339">You can do so by adding the service behavior while configuring the WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="639a5-340">Para obtener instrucciones sobre cómo agregar el comportamiento del servicio, consulte [configurar el nivel de aislamiento de transacción y el tiempo de espera de transacción con SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-340">For instruction on how to add the service behavior, see [Configure Transaction Isolation Level and Transaction Timeout with SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span></span>  
  
  - <span data-ttu-id="639a5-341">Definir un puerto de envío físico de WCF-Custom o WCF-SQL para enviar mensajes a la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-341">Define a physical WCF-Custom or WCF-SQL send port to send messages to the SQL Server database.</span></span> <span data-ttu-id="639a5-342">También debe especificar la acción en el puerto de envío.</span><span class="sxs-lookup"><span data-stu-id="639a5-342">You must also specify the action in the send port.</span></span>  
  
  - <span data-ttu-id="639a5-343">Definir una ubicación en el disco duro y un puerto de archivo correspondiente donde la orquestación de BizTalk quitará los mensajes de la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="639a5-343">Define a location on the hard disk and a corresponding file port where the BizTalk orchestration will drop the messages from the SQL Server database.</span></span> <span data-ttu-id="639a5-344">Estos serán los mensajes de notificación recibidos de SQL Server y los mensajes de la selección y el puerto de envío de la operación de actualización que se realiza a través de WCF-Custom o WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="639a5-344">These will be the notification messages received from SQL Server and messages for the Select and Update operation you perform through the WCF-Custom or WCF-SQL send port.</span></span>  
  
## <a name="starting-the-application"></a><span data-ttu-id="639a5-345">Iniciar la aplicación</span><span class="sxs-lookup"><span data-stu-id="639a5-345">Starting the Application</span></span>  
 <span data-ttu-id="639a5-346">Debe iniciar la aplicación de BizTalk para recibir mensajes de notificación de la base de datos de SQL Server y para realizar las operaciones subsiguientes de Select y Update.</span><span class="sxs-lookup"><span data-stu-id="639a5-346">You must start the BizTalk application for receiving notification messages from the SQL Server database and for performing the subsequent Select and Update operations.</span></span> <span data-ttu-id="639a5-347">Para obtener instrucciones acerca de cómo iniciar una aplicación de BizTalk, consulte [cómo iniciar una orquestación](../../core/how-to-start-an-orchestration.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-347">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>
  
 <span data-ttu-id="639a5-348">En esta etapa, asegúrese de que:</span><span class="sxs-lookup"><span data-stu-id="639a5-348">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="639a5-349">El WCF-Custom o WCF-SQL unidireccional puerto de recepción, que recibe los mensajes de notificación de SQL Server se está ejecutando la base de datos.</span><span class="sxs-lookup"><span data-stu-id="639a5-349">The WCF-Custom or WCF-SQL one-way receive port, which receives the notification messages from the SQL Server database is running.</span></span>  
  
-   <span data-ttu-id="639a5-350">Seleccione el puerto de envío WCF-Custom o WCF-SQL para realizar y se está ejecutando operaciones de actualización en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-350">The WCF-Custom or WCF-SQL send port to perform Select and Update operations on the Employee table is running.</span></span>  
  
-   <span data-ttu-id="639a5-351">El puerto de envío de archivo que recibe los mensajes de SQL Server, se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="639a5-351">The FILE send port, which receives messages from SQL Server, is running.</span></span>  
  
-   <span data-ttu-id="639a5-352">La orquestación de BizTalk para la operación se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="639a5-352">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="639a5-353">Ejecutar la operación</span><span class="sxs-lookup"><span data-stu-id="639a5-353">Executing the Operation</span></span>  
 <span data-ttu-id="639a5-354">Para ejecutar esta operación, debe insertar un registro en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-354">To execute this operation, you must insert a record into the Employee table.</span></span> <span data-ttu-id="639a5-355">Imaginemos que inserta un registro con los detalles siguientes:</span><span class="sxs-lookup"><span data-stu-id="639a5-355">Let us assume you insert a record with following details:</span></span>  
  
```  
Name = John Smith  
Designation = Manager  
Salary = 100000  
```  
  
 <span data-ttu-id="639a5-356">Además, asegúrese de seleccionar el mensaje XML para realizar y las operaciones de actualización está disponible en C:\TestLocation\MessageIn.</span><span class="sxs-lookup"><span data-stu-id="639a5-356">Also, make sure the XML message to perform Select and Update operations is available at C:\TestLocation\MessageIn.</span></span> <span data-ttu-id="639a5-357">El archivo XML debe ser similar a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-357">The XML file should resemble the following:</span></span>  
  
```  
<Select xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
  <Columns>Employee_ID,Name,Status</Columns>  
  <Query>where Status=0;UPDATE Employee SET Status=1 WHERE Status=0</Query>  
</Select>  
```  
  
 <span data-ttu-id="639a5-358">Una vez insertado el registro, el siguiente conjunto de acciones tienen lugar, en la misma secuencia:</span><span class="sxs-lookup"><span data-stu-id="639a5-358">Once the record is inserted, the following set of actions take place, in the same sequence:</span></span>  
  
-   <span data-ttu-id="639a5-359">El adaptador recibe un mensaje de notificación que se parezca a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-359">The adapter receives a notification message that resembles the following:</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Insert</Info>   
      <Source>Data</Source>   
      <Type>Change</Type>   
    </Notification>  
    ```  
  
     <span data-ttu-id="639a5-360">Este mensaje le notifica que se insertó un registro en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-360">This message notifies that a record was inserted in the Employee table.</span></span> <span data-ttu-id="639a5-361">Tenga en cuenta que el valor de la `<Info>` elemento es "Insertar".</span><span class="sxs-lookup"><span data-stu-id="639a5-361">Note that the value for the `<Info>` element is “Insert”.</span></span>  
  
-   <span data-ttu-id="639a5-362">El adaptador ejecuta la operación de selección.</span><span class="sxs-lookup"><span data-stu-id="639a5-362">The adapter executes the Select operation.</span></span> <span data-ttu-id="639a5-363">Dado que la operación de selección XML también incluye una instrucción Update, también se ejecuta la instrucción Update.</span><span class="sxs-lookup"><span data-stu-id="639a5-363">Because the Select operation XML also includes an Update statement, the Update statement is also executed.</span></span> <span data-ttu-id="639a5-364">Es la siguiente respuesta de SQL Server para la instrucción Select.</span><span class="sxs-lookup"><span data-stu-id="639a5-364">The next response from SQL Server is for the Select statement.</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <SelectResponse xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
      <SelectResult>  
        <Employee xmlns="http://schemas.microsoft.com/Sql/2008/05/Types/Tables/dbo">  
          <Employee_ID>10006</Employee_ID>   
          <Name>John</Name>   
          <Status>0</Status>  
        </Employee>  
      </SelectResult>  
    </SelectResponse>  
    ```  
  
     <span data-ttu-id="639a5-365">Esta respuesta muestra que se inserta un registro en la tabla de empleados y el estado de ese registro es 0.</span><span class="sxs-lookup"><span data-stu-id="639a5-365">This response shows that a record was inserted into the Employee table and the Status for that record is 0.</span></span>  
  
-   <span data-ttu-id="639a5-366">Como parte de la instrucción Select, también se ejecuta la instrucción Update y la columna de estado para el nuevo registro se cambia a 1.</span><span class="sxs-lookup"><span data-stu-id="639a5-366">As part of the Select statement, the Update statement is also executed and the Status column for the new record is changed to 1.</span></span> <span data-ttu-id="639a5-367">Esto vuelve a desencadena otra notificación de SQL Server y el adaptador recibe un mensaje de notificación correspondiente, que es similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="639a5-367">This again triggers another notification from SQL Server and the adapter receives a corresponding notification message, that resembles the following:</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Update</Info>   
      <Source>Data</Source>   
      <Type>Change</Type>   
    </Notification>  
    ```  
  
     <span data-ttu-id="639a5-368">Este mensaje le notifica que se actualizó un registro en la tabla Employee.</span><span class="sxs-lookup"><span data-stu-id="639a5-368">This message notifies that a record was updated in the Employee table.</span></span> <span data-ttu-id="639a5-369">Tenga en cuenta que el valor de la `<Info>` elemento es "Update".</span><span class="sxs-lookup"><span data-stu-id="639a5-369">Note that the value for the `<Info>` element is “Update”.</span></span>  
  
-   <span data-ttu-id="639a5-370">Después de la segunda notificación, el adaptador ejecuta la instrucción Select.</span><span class="sxs-lookup"><span data-stu-id="639a5-370">After the second notification, the adapter executes the Select statement.</span></span> <span data-ttu-id="639a5-371">Sin embargo, dado que no hay ningún registro ahora tiene el estado como 0, el adaptador obtiene una respuesta vacía similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="639a5-371">However, because there are no records now that have Status as 0, the adapter gets an empty response resembling the following.</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <SelectResponse xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
      <SelectResult />   
    </SelectResponse>  
    ```  
  
## <a name="best-practices"></a><span data-ttu-id="639a5-372">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="639a5-372">Best Practices</span></span>  
 <span data-ttu-id="639a5-373">Una vez que haya implementado y configurado el proyecto de BizTalk, puede exportar opciones de configuración a un archivo XML llamado el archivo de enlace.</span><span class="sxs-lookup"><span data-stu-id="639a5-373">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the binding file.</span></span> <span data-ttu-id="639a5-374">Cuando genere un archivo de enlace, puede importar los valores de configuración desde el archivo, por lo que no es necesario crear los puertos de envío y recepción para la misma orquestación.</span><span class="sxs-lookup"><span data-stu-id="639a5-374">Once you generate a binding file, you can import the configuration settings from the file, so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="639a5-375">Para obtener más información acerca de los archivos de enlace, consulte [enlaces del adaptador SQL reutilizar](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="639a5-375">For more information about binding files, see [Reuse SQL adapter bindings](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="639a5-376">Vea también</span><span class="sxs-lookup"><span data-stu-id="639a5-376">See Also</span></span>  
 [<span data-ttu-id="639a5-377">Recibir notificaciones de consulta SQL con BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="639a5-377">Receive SQL Query Notifications using BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)